[{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\scripts\\test-rpg.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testRpg.js` or `TestRpg.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":87,"fix":{"range":[86,86],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`../src/rpg.js` import should occur after import of `path`","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":87,"fix":{"range":[0,136],"text":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { createCharacter, getCharacter, saveCharacter, applyXp } from '../src/rpg.js';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":2,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":20,"fix":{"range":[104,104],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":3,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":24,"fix":{"range":[128,128],"text":"node:"}},{"ruleId":"no-unused-vars","severity":1,"message":"'resetData' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":10,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":10,"endColumn":4,"fix":{"range":[336,336],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `e`.","line":10,"column":12,"nodeType":"Identifier","messageId":"with-name","endLine":10,"endColumn":13,"fix":{"range":[343,347],"text":""}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":10,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":10,"endColumn":13,"fix":{"range":[344,345],"text":"error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":17,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":28},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":20,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":20,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[625,652],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":24,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":24,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[697,727],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":26,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":26,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[733,766],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":30,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":30,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[858,889],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[895,953],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1081,1123],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":41,"column":13,"nodeType":"Identifier","messageId":"catch-error-name","endLine":41,"endColumn":14,"fix":{"range":[1142,1162],"text":"error => console.error(error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":41,"column":18,"nodeType":"MemberExpression","messageId":"unexpected","endLine":41,"endColumn":31}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import { createCharacter, getCharacter, saveCharacter, applyXp } from '../src/rpg.js';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nfunction resetData() {\r\n  // simple: remove data file if exists to start fresh\r\n  try {\r\n    const p = path.join(process.cwd(), 'data', 'rpg.json');\r\n    if (fs.existsSync(p)) fs.unlinkSync(p);\r\n  } catch (e) { /* ignore */ }\r\n}\r\n\r\nasync function run() {\r\n  const user = 'testuser1234';\r\n  // remove existing char if any\r\n  const existing = getCharacter(user);\r\n  if (existing) console.log('Existing character:', existing);\r\n  else {\r\n    const c = createCharacter(user, 'Tester');\r\n    console.log('Created:', c);\r\n  }\r\n\r\n  let char = getCharacter(user);\r\n  console.log('Initial:', char);\r\n\r\n  console.log('Applying 25 XP...');\r\n  applyXp(user, char, 25);\r\n  saveCharacter(user, char);\r\n  char = getCharacter(user);\r\n  console.log('After XP:', char);\r\n\r\n  console.log('Spending 1 skill point on atk if available');\r\n  if ((char.skillPoints || 0) >= 1) {\r\n    char.atk += 1;\r\n    char.skillPoints -= 1;\r\n    saveCharacter(user, char);\r\n  }\r\n  console.log('Final:', getCharacter(user));\r\n}\r\n\r\nrun().catch(e => console.error(e));\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\achievements.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":150,"column":36,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":150,"endColumn":44,"fix":{"range":[3969,3977],"text":"0x8B_8B_8B"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":151,"column":32,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":151,"endColumn":40,"fix":{"range":[4028,4036],"text":"0x4C_AF_50"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":152,"column":32,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":152,"endColumn":40,"fix":{"range":[4089,4097],"text":"0x9C_27_B0"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":153,"column":42,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":153,"endColumn":50,"fix":{"range":[4158,4166],"text":"0xFF_98_00"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":174,"column":66,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":174,"endColumn":72,"fix":{"range":[4681,4689],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":176,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":176,"endColumn":6,"fix":{"range":[4736,4736],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":177,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":177,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4760,4813],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":184,"column":81,"nodeType":"Literal","messageId":"error","endLine":184,"endColumn":85,"suggestions":[{"messageId":"replace","fix":{"range":[4979,4983],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":185,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":185,"endColumn":6,"fix":{"range":[4996,4996],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":186,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":186,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5020,5073],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":10,"nodeType":"MemberExpression","endLine":191,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":7,"nodeType":"MemberExpression","endLine":192,"endColumn":36},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":213,"column":12,"nodeType":"MemberExpression","endLine":213,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":221,"column":18,"nodeType":"MemberExpression","endLine":221,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":222,"column":9,"nodeType":"MemberExpression","endLine":222,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":231,"column":27,"nodeType":"MemberExpression","endLine":231,"endColumn":65},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":258,"column":12,"nodeType":"MemberExpression","endLine":258,"endColumn":50},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":258,"column":54,"nodeType":"Literal","messageId":"error","endLine":258,"endColumn":58,"suggestions":[{"messageId":"replace","fix":{"range":[7182,7186],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":266,"column":61,"nodeType":"MemberExpression","endLine":266,"endColumn":88},{"ruleId":"sonarjs/prefer-immediate-return","severity":2,"message":"Immediately return this expression instead of assigning it to the temporary variable \"users\".","line":270,"column":19,"nodeType":"CallExpression","messageId":"doImmediateAction","endLine":278,"endColumn":23,"fix":{"range":[7449,7788],"text":"return Object.entries(this.userAchievements)\r\n      .map(([userId, data]) => ({\r\n        userId,\r\n        total_points: data.total_points,\r\n        level: data.level,\r\n        achievements_count: data.achievements.length\r\n      }))\r\n      .sort((a, b) => b.total_points - a.total_points)\r\n      .slice(0, limit)"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (316). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":316,"endColumn":33}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":10,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst ACHIEVEMENTS_FILE = path.join(process.cwd(), 'data', 'achievements.json');\r\n\r\n// Achievement definitions with wholesome and creative themes\r\nconst ACHIEVEMENT_DEFINITIONS = {\r\n  // RPG Achievements\r\n  'first_character': {\r\n    id: 'first_character',\r\n    name: 'üéÆ Born to Adventure',\r\n    description: 'Create your first RPG character',\r\n    icon: 'üé≠',\r\n    category: 'rpg',\r\n    rarity: 'common',\r\n    points: 10,\r\n    condition: (stats) => stats.characters_created >= 1\r\n  },\r\n  'class_master': {\r\n    id: 'class_master',\r\n    name: 'üèÜ Class Act',\r\n    description: 'Try all character classes',\r\n    icon: 'üëë',\r\n    category: 'rpg',\r\n    rarity: 'rare',\r\n    points: 50,\r\n    condition: (stats) => stats.classes_tried >= 4\r\n  },\r\n  'dragon_slayer': {\r\n    id: 'dragon_slayer',\r\n    name: 'üê≤ Dragon\\'s Bane',\r\n    description: 'Defeat 10 boss monsters',\r\n    icon: '‚öîÔ∏è',\r\n    category: 'rpg',\r\n    rarity: 'epic',\r\n    points: 100,\r\n    condition: (stats) => stats.bosses_defeated >= 10\r\n  },\r\n  'treasure_hunter': {\r\n    id: 'treasure_hunter',\r\n    name: 'üíé Hidden Riches',\r\n    description: 'Find 50 items while exploring',\r\n    icon: 'üí∞',\r\n    category: 'rpg',\r\n    rarity: 'rare',\r\n    points: 75,\r\n    condition: (stats) => stats.items_found >= 50\r\n  },\r\n\r\n  // Game Achievements\r\n  'trivia_master': {\r\n    id: 'trivia_master',\r\n    name: 'üß† Knowledge Seeker',\r\n    description: 'Answer 100 trivia questions correctly',\r\n    icon: 'üéì',\r\n    category: 'games',\r\n    rarity: 'epic',\r\n    points: 150,\r\n    condition: (stats) => stats.trivia_correct >= 100\r\n  },\r\n  'memory_champion': {\r\n    id: 'memory_champion',\r\n    name: 'üß© Mind Palace',\r\n    description: 'Complete 20 memory games',\r\n    icon: 'üèõÔ∏è',\r\n    category: 'games',\r\n    rarity: 'rare',\r\n    points: 80,\r\n    condition: (stats) => stats.memory_games_completed >= 20\r\n  },\r\n  'hangman_legend': {\r\n    id: 'hangman_legend',\r\n    name: 'üî§ Word Wizard',\r\n    description: 'Win 50 hangman games',\r\n    icon: 'üìö',\r\n    category: 'games',\r\n    rarity: 'epic',\r\n    points: 120,\r\n    condition: (stats) => stats.hangman_wins >= 50\r\n  },\r\n\r\n  // Social Achievements\r\n  'poll_creator': {\r\n    id: 'poll_creator',\r\n    name: 'üìä Voice of the People',\r\n    description: 'Create 10 polls',\r\n    icon: 'üó≥Ô∏è',\r\n    category: 'social',\r\n    rarity: 'common',\r\n    points: 25,\r\n    condition: (stats) => stats.polls_created >= 10\r\n  },\r\n  'community_helper': {\r\n    id: 'community_helper',\r\n    name: 'ü§ù Helpful Soul',\r\n    description: 'Help other users 25 times',\r\n    icon: 'üåü',\r\n    category: 'social',\r\n    rarity: 'rare',\r\n    points: 60,\r\n    condition: (stats) => stats.help_actions >= 25\r\n  },\r\n\r\n  // Special Achievements\r\n  'bot_friend': {\r\n    id: 'bot_friend',\r\n    name: 'üí¨ Chatty Companion',\r\n    description: 'Have 500 conversations with the bot',\r\n    icon: 'üíï',\r\n    category: 'special',\r\n    rarity: 'legendary',\r\n    points: 200,\r\n    condition: (stats) => stats.messages_sent >= 500\r\n  },\r\n  'early_adopter': {\r\n    id: 'early_adopter',\r\n    name: 'üöÄ Pioneer',\r\n    description: 'Be among the first to use all new features',\r\n    icon: '‚≠ê',\r\n    category: 'special',\r\n    rarity: 'legendary',\r\n    points: 300,\r\n    condition: (stats) => stats.features_tried >= 10\r\n  },\r\n\r\n  // Fun Achievements\r\n  'lucky_duck': {\r\n    id: 'lucky_duck',\r\n    name: 'üçÄ Fortunate Soul',\r\n    description: 'Get heads 10 times in a row on coin flips',\r\n    icon: 'üé∞',\r\n    category: 'fun',\r\n    rarity: 'epic',\r\n    points: 90,\r\n    condition: (stats) => stats.coin_streak >= 10\r\n  },\r\n  'weather_watcher': {\r\n    id: 'weather_watcher',\r\n    name: 'üå§Ô∏è Weather Wise',\r\n    description: 'Check weather for 20 different locations',\r\n    icon: 'üåç',\r\n    category: 'fun',\r\n    rarity: 'common',\r\n    points: 30,\r\n    condition: (stats) => stats.weather_checks >= 20\r\n  }\r\n};\r\n\r\nconst ACHIEVEMENT_RARITIES = {\r\n  common: { name: 'Common', color: 0x8B8B8B, multiplier: 1 },\r\n  rare: { name: 'Rare', color: 0x4CAF50, multiplier: 1.5 },\r\n  epic: { name: 'Epic', color: 0x9C27B0, multiplier: 2 },\r\n  legendary: { name: 'Legendary', color: 0xFF9800, multiplier: 3 }\r\n};\r\n\r\nclass AchievementManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadAchievements();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(ACHIEVEMENTS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(ACHIEVEMENTS_FILE)) {\r\n      fs.writeFileSync(ACHIEVEMENTS_FILE, JSON.stringify({}));\r\n    }\r\n  }\r\n\r\n  loadAchievements() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(ACHIEVEMENTS_FILE, 'utf8'));\r\n      this.userAchievements = data;\r\n    } catch (error) {\r\n      console.error('Failed to load achievements:', error);\r\n      this.userAchievements = {};\r\n    }\r\n  }\r\n\r\n  saveAchievements() {\r\n    try {\r\n      fs.writeFileSync(ACHIEVEMENTS_FILE, JSON.stringify(this.userAchievements, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save achievements:', error);\r\n    }\r\n  }\r\n\r\n  getUserStats(userId) {\r\n    if (!this.userAchievements[userId]) {\r\n      this.userAchievements[userId] = {\r\n        achievements: [],\r\n        stats: {\r\n          characters_created: 0,\r\n          classes_tried: 0,\r\n          bosses_defeated: 0,\r\n          items_found: 0,\r\n          trivia_correct: 0,\r\n          memory_games_completed: 0,\r\n          hangman_wins: 0,\r\n          polls_created: 0,\r\n          help_actions: 0,\r\n          messages_sent: 0,\r\n          features_tried: 0,\r\n          coin_streak: 0,\r\n          weather_checks: 0\r\n        },\r\n        total_points: 0,\r\n        level: 1\r\n      };\r\n    }\r\n    return this.userAchievements[userId];\r\n  }\r\n\r\n  updateStats(userId, statUpdates) {\r\n    const userData = this.getUserStats(userId);\r\n\r\n    // Update stats\r\n    for (const [stat, value] of Object.entries(statUpdates)) {\r\n      if (typeof userData.stats[stat] === 'number') {\r\n        userData.stats[stat] += value;\r\n      }\r\n    }\r\n\r\n    // Check for new achievements\r\n    const newAchievements = this.checkAchievements(userId);\r\n\r\n    // Update total points and level\r\n    userData.total_points = userData.achievements.reduce((total, achievementId) => {\r\n      const achievement = ACHIEVEMENT_DEFINITIONS[achievementId];\r\n      return total + (achievement ? achievement.points : 0);\r\n    }, 0);\r\n\r\n    userData.level = Math.floor(userData.total_points / 100) + 1;\r\n\r\n    this.saveAchievements();\r\n    return { newAchievements, userData };\r\n  }\r\n\r\n  checkAchievements(userId) {\r\n    const userData = this.getUserStats(userId);\r\n    const stats = userData.stats;\r\n    const earnedAchievements = userData.achievements;\r\n    const newAchievements = [];\r\n\r\n    for (const [achievementId, achievement] of Object.entries(ACHIEVEMENT_DEFINITIONS)) {\r\n      if (!earnedAchievements.includes(achievementId) && achievement.condition(stats)) {\r\n        earnedAchievements.push(achievementId);\r\n        newAchievements.push(achievement);\r\n      }\r\n    }\r\n\r\n    return newAchievements;\r\n  }\r\n\r\n  getAchievementInfo(achievementId) {\r\n    return ACHIEVEMENT_DEFINITIONS[achievementId] || null;\r\n  }\r\n\r\n  getAllAchievements() {\r\n    return ACHIEVEMENT_DEFINITIONS;\r\n  }\r\n\r\n  getUserAchievements(userId) {\r\n    return this.getUserStats(userId).achievements.map(id => ACHIEVEMENT_DEFINITIONS[id]).filter(Boolean);\r\n  }\r\n\r\n  getLeaderboard(limit = 10) {\r\n    const users = Object.entries(this.userAchievements)\r\n      .map(([userId, data]) => ({\r\n        userId,\r\n        total_points: data.total_points,\r\n        level: data.level,\r\n        achievements_count: data.achievements.length\r\n      }))\r\n      .sort((a, b) => b.total_points - a.total_points)\r\n      .slice(0, limit);\r\n\r\n    return users;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const achievementManager = new AchievementManager();\r\n\r\n// Convenience functions\r\nexport function updateUserStats(userId, statUpdates) {\r\n  return achievementManager.updateStats(userId, statUpdates);\r\n}\r\n\r\nexport function getUserStats(userId) {\r\n  return achievementManager.getUserStats(userId);\r\n}\r\n\r\nexport function checkUserAchievements(userId) {\r\n  return achievementManager.checkAchievements(userId);\r\n}\r\n\r\nexport function getAchievementInfo(achievementId) {\r\n  return achievementManager.getAchievementInfo(achievementId);\r\n}\r\n\r\nexport function getAllAchievements() {\r\n  return achievementManager.getAllAchievements();\r\n}\r\n\r\nexport function getUserAchievements(userId) {\r\n  return achievementManager.getUserAchievements(userId);\r\n}\r\n\r\nexport function getAchievementLeaderboard(limit = 10) {\r\n  return achievementManager.getLeaderboard(limit);\r\n}\r\n\r\nexport { ACHIEVEMENT_RARITIES };","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\aiassistant.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":13,"column":27,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":13,"endColumn":33,"fix":{"range":[337,343],"text":"300_000"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'initializeAI' has too many lines (74). Maximum allowed is 50.","line":31,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":104,"endColumn":4},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'generateResponse' has too many lines (93). Maximum allowed is 50.","line":113,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":205,"endColumn":4},{"ruleId":"max-statements","severity":1,"message":"Async method 'generateResponse' has too many statements (40). Maximum allowed is 30.","line":113,"column":25,"nodeType":"FunctionExpression","messageId":"exceed","endLine":205,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'generateResponse' has a complexity of 16. Maximum allowed is 10.","line":113,"column":25,"nodeType":"FunctionExpression","messageId":"complex","endLine":205,"endColumn":4},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":117,"column":17,"nodeType":"Literal","messageId":"error","endLine":117,"endColumn":21,"suggestions":[{"messageId":"replace","fix":{"range":[3924,3928],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":125,"column":35,"nodeType":"CallExpression","messageId":"substring","endLine":125,"endColumn":59,"fix":{"range":[4126,4135],"text":"slice"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":164,"column":54,"nodeType":"Literal","messageId":"error","endLine":164,"endColumn":58,"suggestions":[{"messageId":"replace","fix":{"range":[5443,5447],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-array-push-push","severity":2,"message":"Do not call `Array#push()` multiple times.","line":186,"column":15,"nodeType":"Identifier","messageId":"error","endLine":186,"endColumn":19,"fix":{"range":[6262,6327],"text":", { role: 'assistant', content: response });"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":201,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":201,"endColumn":6,"fix":{"range":[6783,6783],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":236,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":236,"endColumn":6,"fix":{"range":[8087,8087],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":239,"column":12,"nodeType":"Literal","messageId":"error","endLine":239,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[8183,8187],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[8183,8187],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":273,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":273,"endColumn":6,"fix":{"range":[9330,9330],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":276,"column":12,"nodeType":"Literal","messageId":"error","endLine":276,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[9415,9419],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[9415,9419],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (619). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":619,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":317,"column":28,"nodeType":"MemberExpression","endLine":317,"endColumn":44},{"ruleId":"unicorn/better-regex","severity":2,"message":"/[.!?]+/ can be optimized to /[!.?]+/.","line":341,"column":34,"nodeType":"Literal","messageId":"better-regex","endLine":341,"endColumn":42,"fix":{"range":[12861,12869],"text":"/[!.?]+/"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":344,"column":41,"nodeType":"CallExpression","messageId":"substring","endLine":344,"endColumn":76,"fix":{"range":[13017,13043],"text":"slice(0, Math.max(0, maxLength - 3)"}},{"ruleId":"no-unused-vars","severity":1,"message":"'translations' is assigned a value but never used.","line":348,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":348,"endColumn":23},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":359,"column":16,"nodeType":"MemberExpression","endLine":359,"endColumn":44},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":368,"column":12,"nodeType":"CallExpression","messageId":"array-from","endLine":368,"endColumn":47,"fix":{"range":[13911,13946],"text":"[...this.aiModels.entries()]"}},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":376,"column":12,"nodeType":"CallExpression","messageId":"array-from","endLine":376,"endColumn":58,"fix":{"range":[14116,14162],"text":"[...this.personalityProfiles.entries()]"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":393,"column":32,"nodeType":"Literal","messageId":"error","endLine":393,"endColumn":36,"suggestions":[{"messageId":"replace","fix":{"range":[14639,14643],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 333. Maximum allowed is 120.","line":433,"column":1,"nodeType":"Program","messageId":"max","endLine":433,"endColumn":334},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":434,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":434,"endColumn":6,"fix":{"range":[16477,16477],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 526. Maximum allowed is 120.","line":435,"column":1,"nodeType":"Program","messageId":"max","endLine":435,"endColumn":527},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":437,"column":79,"nodeType":"Identifier","messageId":"method","endLine":437,"endColumn":86,"fix":{"range":[17171,17171],"text":"All"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":437,"column":223,"nodeType":"Identifier","messageId":"method","endLine":437,"endColumn":230,"fix":{"range":[17315,17315],"text":"All"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 321. Maximum allowed is 120.","line":443,"column":1,"nodeType":"Program","messageId":"max","endLine":443,"endColumn":322},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":444,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":444,"endColumn":6,"fix":{"range":[17859,17859],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 614. Maximum allowed is 120.","line":445,"column":1,"nodeType":"Program","messageId":"max","endLine":445,"endColumn":615},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":447,"column":49,"nodeType":"Identifier","messageId":"method","endLine":447,"endColumn":56,"fix":{"range":[18611,18611],"text":"All"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 602. Maximum allowed is 120.","line":453,"column":1,"nodeType":"Program","messageId":"max","endLine":453,"endColumn":603},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":454,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":454,"endColumn":6,"fix":{"range":[19475,19475],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 704. Maximum allowed is 120.","line":455,"column":1,"nodeType":"Program","messageId":"max","endLine":455,"endColumn":705},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":457,"column":86,"nodeType":"Identifier","messageId":"method","endLine":457,"endColumn":93,"fix":{"range":[20354,20354],"text":"All"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 820. Maximum allowed is 120.","line":461,"column":1,"nodeType":"Program","messageId":"max","endLine":461,"endColumn":821},{"ruleId":"max-len","severity":2,"message":"This line has a length of 1052. Maximum allowed is 120.","line":465,"column":1,"nodeType":"Program","messageId":"max","endLine":465,"endColumn":1053},{"ruleId":"max-len","severity":2,"message":"This line has a length of 1046. Maximum allowed is 120.","line":469,"column":1,"nodeType":"Program","messageId":"max","endLine":469,"endColumn":1047},{"ruleId":"max-len","severity":2,"message":"This line has a length of 984. Maximum allowed is 120.","line":473,"column":1,"nodeType":"Program","messageId":"max","endLine":473,"endColumn":985},{"ruleId":"max-len","severity":2,"message":"This line has a length of 780. Maximum allowed is 120.","line":477,"column":1,"nodeType":"Program","messageId":"max","endLine":477,"endColumn":781},{"ruleId":"max-len","severity":2,"message":"This line has a length of 533. Maximum allowed is 120.","line":481,"column":1,"nodeType":"Program","messageId":"max","endLine":481,"endColumn":534},{"ruleId":"max-len","severity":2,"message":"This line has a length of 778. Maximum allowed is 120.","line":485,"column":1,"nodeType":"Program","messageId":"max","endLine":485,"endColumn":779},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":502,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":502,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[27248,27299],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/better-regex","severity":2,"message":"/[.!?]+/ can be optimized to /[!.?]+/.","line":507,"column":34,"nodeType":"Literal","messageId":"better-regex","endLine":507,"endColumn":42,"fix":{"range":[27415,27423],"text":"/[!.?]+/"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":508,"column":32,"nodeType":"Identifier","messageId":"method","endLine":508,"endColumn":39,"fix":{"range":[27472,27472],"text":"All"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/[^a-zA-Z]/g can be optimized to /[^A-Za-z]/g.","line":508,"column":40,"nodeType":"Literal","messageId":"better-regex","endLine":508,"endColumn":52,"fix":{"range":[27473,27485],"text":"/[^A-Za-z]/g"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":524,"column":9,"nodeType":"MemberExpression","endLine":524,"endColumn":25},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":525,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":525,"endColumn":8,"fix":{"range":[28002,28002],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `error`.","line":525,"column":16,"nodeType":"Identifier","messageId":"with-name","endLine":525,"endColumn":21,"fix":{"range":[28009,28017],"text":""}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":526,"column":9,"nodeType":"MemberExpression","endLine":526,"endColumn":25},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":539,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":539,"endColumn":79,"fix":{"range":[28363,28433],"text":"'Try asking me about games - I have trivia, RPG adventures, and more!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":540,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":540,"endColumn":57,"fix":{"range":[28444,28492],"text":"'Ask me to tell you a joke or share a fun fact!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":541,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":541,"endColumn":60,"fix":{"range":[28503,28554],"text":"'Want to play a game? Try /tictactoe or /connect4!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":542,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":542,"endColumn":60,"fix":{"range":[28565,28616],"text":"'Create an RPG character and start your adventure!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":548,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":548,"endColumn":62,"fix":{"range":[28693,28746],"text":"'üéÆ Try the new Connect Four game with AI opponents!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":549,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":549,"endColumn":52,"fix":{"range":[28757,28800],"text":"'üß† Challenge yourself with a trivia quiz!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":550,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":550,"endColumn":42,"fix":{"range":[28811,28844],"text":"'‚öîÔ∏è Continue your RPG adventure!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":551,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":551,"endColumn":39,"fix":{"range":[28855,28885],"text":"'üéØ Play some strategy games!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":554,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":554,"endColumn":53,"fix":{"range":[28924,28968],"text":"'üìö Ask me about programming or technology!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":555,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":555,"endColumn":57,"fix":{"range":[28979,29027],"text":"'üî¢ Want to learn something new with fun facts?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":556,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":556,"endColumn":47,"fix":{"range":[29038,29076],"text":"'üíª I can help with coding questions!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":557,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":557,"endColumn":42,"fix":{"range":[29087,29120],"text":"'üß™ Explore scientific concepts!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":560,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":560,"endColumn":37,"fix":{"range":[29154,29182],"text":"'üòÇ Let me tell you a joke!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":561,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":561,"endColumn":44,"fix":{"range":[29193,29228],"text":"'üé≠ Generate a fun superhero name!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":562,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":562,"endColumn":46,"fix":{"range":[29239,29276],"text":"'üîÆ Ask the magic 8-ball a question!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":563,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":563,"endColumn":48,"fix":{"range":[29287,29326],"text":"'üìñ Want me to create a story for you?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":566,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":566,"endColumn":41,"fix":{"range":[29363,29395],"text":"'üë• Check out the guild system!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":567,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":567,"endColumn":51,"fix":{"range":[29406,29448],"text":"'üí∞ Try the economy and trading features!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":568,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":568,"endColumn":49,"fix":{"range":[29459,29499],"text":"'üèÜ View your achievements and profile!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":569,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":569,"endColumn":47,"fix":{"range":[29510,29548],"text":"'ü§ù Join a party for multiplayer fun!'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":573,"column":12,"nodeType":"MemberExpression","endLine":573,"endColumn":33}],"suppressedMessages":[],"errorCount":63,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":42,"fixableWarningCount":0,"source":"/**\r\n * Advanced AI Assistant System for Discord bot.\r\n * Provides multiple AI models, personalities, and content generation capabilities.\r\n */\r\n\r\nimport 'dotenv/config';\r\nimport { getGuild } from './storage.js';\r\nimport { logger } from './logger.js';\r\n\r\n/**\r\n * Configuration constants for AI assistant.\r\n */\r\nconst CACHE_DURATION_MS = 300000; // 5 minutes\r\nconst MAX_CONVERSATION_HISTORY = 10;\r\n\r\n/**\r\n * Advanced AI Assistant System with Multiple AI Models and Capabilities.\r\n */\r\nclass AIAssistantManager {\r\n  constructor() {\r\n    this.conversationHistory = new Map();\r\n    this.aiModels = new Map();\r\n    this.responseCache = new Map();\r\n    this.personalityProfiles = new Map();\r\n    this.initializeAI();\r\n  }\r\n\r\n  /**\r\n   * Initializes AI models and personality profiles.\r\n   */\r\n  initializeAI() {\r\n    logger.info('Initializing AI models and personality profiles');\r\n\r\n    // Initialize different AI model configurations\r\n    this.aiModels.set('creative', {\r\n      name: 'Creative Writer',\r\n      description: 'Specialized in creative writing, stories, and artistic content',\r\n      prompt: 'You are a creative writing AI. Write engaging, imaginative content with vivid descriptions and compelling narratives.',\r\n      temperature: 0.8,\r\n      maxTokens: 800\r\n    });\r\n\r\n    this.aiModels.set('technical', {\r\n      name: 'Technical Expert',\r\n      description: 'Specialized in programming, technology, and technical explanations',\r\n      prompt: 'You are a technical expert AI. Provide accurate, detailed technical information with code examples when relevant.',\r\n      temperature: 0.3,\r\n      maxTokens: 600\r\n    });\r\n\r\n    this.aiModels.set('helpful', {\r\n      name: 'Helpful Assistant',\r\n      description: 'General purpose helpful AI for everyday questions',\r\n      prompt: 'You are a helpful AI assistant. Provide clear, accurate, and useful responses to help users with their questions.',\r\n      temperature: 0.5,\r\n      maxTokens: 500\r\n    });\r\n\r\n    this.aiModels.set('funny', {\r\n      name: 'Comedy Bot',\r\n      description: 'Specialized in humor, jokes, and entertaining responses',\r\n      prompt: 'You are a comedy AI. Make people laugh with witty, clever, and appropriate humor.',\r\n      temperature: 0.7,\r\n      maxTokens: 400\r\n    });\r\n\r\n    this.aiModels.set('educational', {\r\n      name: 'Teacher Bot',\r\n      description: 'Specialized in education and learning',\r\n      prompt: 'You are an educational AI. Explain concepts clearly, provide examples, and help users learn new things.',\r\n      temperature: 0.4,\r\n      maxTokens: 700\r\n    });\r\n\r\n    // Initialize personality profiles\r\n    this.personalityProfiles.set('professional', {\r\n      name: 'Professional',\r\n      style: 'formal, precise, and business-like',\r\n      responses: 'structured and informative'\r\n    });\r\n\r\n    this.personalityProfiles.set('friendly', {\r\n      name: 'Friendly',\r\n      style: 'warm, approachable, and casual',\r\n      responses: 'conversational and engaging'\r\n    });\r\n\r\n    this.personalityProfiles.set('energetic', {\r\n      name: 'Energetic',\r\n      style: 'exciting, enthusiastic, and dynamic',\r\n      responses: 'lively and motivating'\r\n    });\r\n\r\n    this.personalityProfiles.set('wise', {\r\n      name: 'Wise Mentor',\r\n      style: 'thoughtful, reflective, and insightful',\r\n      responses: 'profound and meaningful'\r\n    });\r\n\r\n    logger.info('AI initialization completed', {\r\n      modelsCount: this.aiModels.size,\r\n      personalitiesCount: this.personalityProfiles.size\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Generates an AI response based on user message and options.\r\n   * @param {string} userId - User identifier\r\n   * @param {string} message - User message\r\n   * @param {object} options - Generation options\r\n   * @returns {Promise<string>} AI response\r\n   */\r\n  async generateResponse(userId, message, options = {}) {\r\n    const {\r\n      model = 'helpful',\r\n      personality = 'friendly',\r\n      guildId = null,\r\n      context = ''\r\n    } = options;\r\n\r\n    if (!message || typeof message !== 'string') {\r\n      throw new Error('Invalid message provided');\r\n    }\r\n\r\n    const cacheKey = `${userId}_${message.substring(0, 50)}_${model}_${personality}`;\r\n    const cached = this.responseCache.get(cacheKey);\r\n    if (cached && Date.now() - cached.timestamp < CACHE_DURATION_MS) {\r\n      logger.debug('Using cached response', { userId, cacheKey });\r\n      return cached.response;\r\n    }\r\n\r\n    try {\r\n      logger.debug('Generating AI response', { userId, model, personality, messageLength: message.length });\r\n\r\n      // Build enhanced context\r\n      const history = this.conversationHistory.get(userId) || [];\r\n      const modelConfig = this.aiModels.get(model);\r\n      const personalityConfig = this.personalityProfiles.get(personality);\r\n\r\n      if (!modelConfig) {\r\n        throw new Error(`Unknown model: ${model}`);\r\n      }\r\n\r\n      if (!personalityConfig) {\r\n        throw new Error(`Unknown personality: ${personality}`);\r\n      }\r\n\r\n      const systemPrompt = `${modelConfig.prompt}\r\n\r\nPersonality: ${personalityConfig.style}\r\nResponse style: ${personalityConfig.responses}\r\n\r\nContext: ${context}\r\nPrevious conversation:\r\n${history.slice(-3).map(h => `${h.role}: ${h.content}`).join('\\n')}\r\n\r\nUser message: ${message}\r\n\r\nProvide a response that matches the specified model and personality.`;\r\n\r\n      let response;\r\n\r\n      // Try local model first if configured\r\n      const guildCfg = guildId ? getGuild(guildId) : null;\r\n      const localUrl = guildCfg?.modelUrl || process.env.LOCAL_MODEL_URL;\r\n\r\n      if (localUrl) {\r\n        logger.debug('Attempting local AI call', { userId, localUrl });\r\n        response = await this.callLocalAI(localUrl, systemPrompt, modelConfig);\r\n      }\r\n\r\n      // Fallback to OpenAI\r\n      if (!response && process.env.OPENAI_API_KEY) {\r\n        logger.debug('Attempting OpenAI call', { userId });\r\n        response = await this.callOpenAI(systemPrompt, modelConfig);\r\n      }\r\n\r\n      // Enhanced fallback with personality\r\n      if (!response) {\r\n        logger.debug('Using fallback response', { userId, model, personality });\r\n        response = this.generateFallbackResponse(message, model, personality);\r\n      }\r\n\r\n      // Store in history\r\n      history.push({ role: 'user', content: message });\r\n      history.push({ role: 'assistant', content: response });\r\n      if (history.length > MAX_CONVERSATION_HISTORY) {\r\n        history.splice(0, history.length - MAX_CONVERSATION_HISTORY);\r\n      }\r\n      this.conversationHistory.set(userId, history);\r\n\r\n      // Cache response\r\n      this.responseCache.set(cacheKey, {\r\n        response,\r\n        timestamp: Date.now()\r\n      });\r\n\r\n      logger.debug('Response generated successfully', { userId, responseLength: response.length });\r\n      return response;\r\n\r\n    } catch (error) {\r\n      logger.error('AI Assistant error', error, { userId, model, personality });\r\n      return this.generateFallbackResponse(message, model, personality);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calls a local AI model.\r\n   * @param {string} url - Local model URL\r\n   * @param {string} prompt - Prompt to send\r\n   * @param {object} config - Model configuration\r\n   * @returns {Promise<string|null>} Response or null if failed\r\n   */\r\n  async callLocalAI(url, prompt, config) {\r\n    try {\r\n      logger.debug('Calling local AI', { url, maxTokens: config.maxTokens, temperature: config.temperature });\r\n\r\n      const response = await fetch(`${url.replace(/\\/$/, '')}/v1/chat/completions`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          model: 'local-model',\r\n          messages: [{ role: 'user', content: prompt }],\r\n          max_tokens: config.maxTokens,\r\n          temperature: config.temperature\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const content = data.choices?.[0]?.message?.content;\r\n        return content || 'No response from local AI';\r\n      }\r\n\r\n      logger.warn('Local AI call failed with status', { status: response.status, url });\r\n    } catch (error) {\r\n      logger.error('Local AI call error', error, { url });\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Calls OpenAI API.\r\n   * @param {string} prompt - Prompt to send\r\n   * @param {object} config - Model configuration\r\n   * @returns {Promise<string|null>} Response or null if failed\r\n   */\r\n  async callOpenAI(prompt, config) {\r\n    try {\r\n      logger.debug('Calling OpenAI API', { maxTokens: config.maxTokens, temperature: config.temperature });\r\n\r\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${process.env.OPENAI_API_KEY}`\r\n        },\r\n        body: JSON.stringify({\r\n          model: 'gpt-4o-mini',\r\n          messages: [{ role: 'user', content: prompt }],\r\n          max_tokens: config.maxTokens,\r\n          temperature: config.temperature\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const content = data.choices?.[0]?.message?.content;\r\n        return content || 'No response from OpenAI';\r\n      }\r\n\r\n      logger.warn('OpenAI call failed with status', { status: response.status });\r\n    } catch (error) {\r\n      logger.error('OpenAI call error', error);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Generates a fallback response when AI models are unavailable.\r\n   * @param {string} message - Original user message\r\n   * @param {string} model - AI model type\r\n   * @param {string} personality - Personality type\r\n   * @returns {string} Fallback response\r\n   */\r\n  generateFallbackResponse(message, model, personality) {\r\n    logger.debug('Generating fallback response', { model, personality, messageLength: message.length });\r\n\r\n    const responses = {\r\n      creative: [\r\n        `üé® Creatively speaking about \"${message}\" - I imagine a world where ideas flow like rivers of color!`,\r\n        `‚ú® My artistic mind sees \"${message}\" as a canvas of infinite possibilities and beautiful expressions.`,\r\n        `üé≠ In the theater of imagination, \"${message}\" becomes a masterpiece of creativity and wonder.`\r\n      ],\r\n      technical: [\r\n        `üîß Analyzing \"${message}\" from a technical perspective reveals interesting possibilities and considerations.`,\r\n        `‚öôÔ∏è From an engineering standpoint, \"${message}\" presents several technical angles worth exploring.`,\r\n        `üíª The technical analysis of \"${message}\" suggests multiple approaches and solutions.`\r\n      ],\r\n      helpful: [\r\n        `ü§ù I'd be happy to help with \"${message}\". Let me provide you with some useful information and guidance.`,\r\n        `üí° Regarding \"${message}\", here are some helpful insights and suggestions to consider.`,\r\n        `üåü I'm here to assist with \"${message}\". Let's explore this together and find the best approach.`\r\n      ],\r\n      funny: [\r\n        `üòÇ \"${message}\"? That's hilarious! Let me respond with some witty commentary and humorous observations.`,\r\n        `ü§£ Oh man, \"${message}\" cracks me up! Here's my comedic take on this situation.`,\r\n        `üòÑ I love the humor in \"${message}\"! Let me match that energy with some clever wit.`\r\n      ],\r\n      educational: [\r\n        `üìö Let's learn about \"${message}\". This is a great opportunity to explore new concepts and understanding.`,\r\n        `üéì From an educational perspective, \"${message}\" offers valuable learning opportunities and insights.`,\r\n        `üî¨ Scientifically examining \"${message}\" reveals fascinating principles and concepts to understand.`\r\n      ]\r\n    };\r\n\r\n    const modelResponses = responses[model] || responses.helpful;\r\n    const response = modelResponses[Math.floor(Math.random() * modelResponses.length)];\r\n\r\n    logger.debug('Fallback response generated', { model, responseLength: response.length });\r\n    return response;\r\n  }\r\n\r\n  // Advanced AI Features\r\n  async analyzeSentiment(text) {\r\n    // Simple sentiment analysis\r\n    const positiveWords = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'fantastic', 'love', 'like', 'awesome', 'brilliant'];\r\n    const negativeWords = ['bad', 'terrible', 'awful', 'hate', 'dislike', 'worst', 'horrible', 'angry', 'sad', 'disappointed'];\r\n\r\n    const lowerText = text.toLowerCase();\r\n    const positiveCount = positiveWords.reduce((count, word) => count + (lowerText.includes(word) ? 1 : 0), 0);\r\n    const negativeCount = negativeWords.reduce((count, word) => count + (lowerText.includes(word) ? 1 : 0), 0);\r\n\r\n    if (positiveCount > negativeCount) return 'positive';\r\n    if (negativeCount > positiveCount) return 'negative';\r\n    return 'neutral';\r\n  }\r\n\r\n  async generateSummary(text, maxLength = 200) {\r\n    // Simple text summarization\r\n    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\r\n    const summary = sentences.slice(0, 2).join('. ') + '.';\r\n\r\n    return summary.length > maxLength ? summary.substring(0, maxLength - 3) + '...' : summary;\r\n  }\r\n\r\n  async translateText(text, targetLanguage = 'es') {\r\n    const translations = {\r\n      'hello': { 'es': 'hola', 'fr': 'bonjour', 'de': 'hallo', 'it': 'ciao' },\r\n      'goodbye': { 'es': 'adi√≥s', 'fr': 'au revoir', 'de': 'tsch√ºss', 'it': 'ciao' },\r\n      'thank you': { 'es': 'gracias', 'fr': 'merci', 'de': 'danke', 'it': 'grazie' },\r\n      'yes': { 'es': 's√≠', 'fr': 'oui', 'de': 'ja', 'it': 's√¨' },\r\n      'no': { 'es': 'no', 'fr': 'non', 'de': 'nein', 'it': 'no' }\r\n    };\r\n\r\n    const lowerText = text.toLowerCase();\r\n    for (const [english, translations] of Object.entries(translations)) {\r\n      if (lowerText.includes(english)) {\r\n        return translations[targetLanguage] || text;\r\n      }\r\n    }\r\n\r\n    return `Translation to ${targetLanguage}: ${text}`;\r\n  }\r\n\r\n  // AI Model Management\r\n  getAvailableModels() {\r\n    return Array.from(this.aiModels.entries()).map(([key, config]) => ({\r\n      id: key,\r\n      name: config.name,\r\n      description: config.description\r\n    }));\r\n  }\r\n\r\n  getAvailablePersonalities() {\r\n    return Array.from(this.personalityProfiles.entries()).map(([key, config]) => ({\r\n      id: key,\r\n      name: config.name,\r\n      style: config.style\r\n    }));\r\n  }\r\n\r\n  // Advanced Context Management\r\n  setUserContext(userId, context) {\r\n    if (!this.conversationHistory.has(userId)) {\r\n      this.conversationHistory.set(userId, []);\r\n    }\r\n    this.conversationHistory.get(userId).context = context;\r\n  }\r\n\r\n  getUserContext(userId) {\r\n    const history = this.conversationHistory.get(userId);\r\n    return history?.context || null;\r\n  }\r\n\r\n  clearUserHistory(userId) {\r\n    this.conversationHistory.delete(userId);\r\n  }\r\n\r\n  // AI-Powered Content Generation\r\n  async generateIdeas(topic, count = 5) {\r\n    const ideas = [\r\n      `Revolutionary ${topic} concept with unprecedented innovation`,\r\n      `Creative ${topic} solution that breaks traditional boundaries`,\r\n      `Unique ${topic} approach combining multiple disciplines`,\r\n      `Futuristic ${topic} design with cutting-edge technology`,\r\n      `Elegant ${topic} solution that simplifies complex problems`\r\n    ];\r\n\r\n    return ideas.slice(0, count);\r\n  }\r\n\r\n  async generateCodeSnippet(language, description) {\r\n    const snippets = {\r\n      'javascript': this.generateJavaScriptSnippet(description),\r\n      'python': this.generatePythonSnippet(description),\r\n      'java': this.generateJavaSnippet(description),\r\n      'cpp': this.generateCppSnippet(description),\r\n      'c#': this.generateCSharpSnippet(description),\r\n      'go': this.generateGoSnippet(description),\r\n      'rust': this.generateRustSnippet(description),\r\n      'php': this.generatePhpSnippet(description),\r\n      'ruby': this.generateRubySnippet(description),\r\n      'swift': this.generateSwiftSnippet(description)\r\n    };\r\n\r\n    return snippets[language.toLowerCase()] || this.generateJavaScriptSnippet(description);\r\n  }\r\n\r\n  generateJavaScriptSnippet(description) {\r\n    const lowerDesc = description.toLowerCase();\r\n    if (lowerDesc.includes('function') || lowerDesc.includes('method')) {\r\n      return `// ${description}\\nfunction performTask(data) {\\n  // Implementation for ${description.toLowerCase()}\\n  try {\\n    // Your logic here\\n    return processData(data);\\n  } catch (error) {\\n    console.error('Error:', error.message);\\n    throw error;\\n  }\\n}\\n\\n// Usage example\\nconst result = performTask(inputData);`;\r\n    } else if (lowerDesc.includes('class') || lowerDesc.includes('object')) {\r\n      return `// ${description}\\nclass DataProcessor {\\n  constructor(options = {}) {\\n    this.options = options;\\n    this.cache = new Map();\\n  }\\n\\n  // Main method implementation\\n  process(data) {\\n    // Implementation for ${description.toLowerCase()}\\n    if (this.cache.has(data)) {\\n      return this.cache.get(data);\\n    }\\n\\n    const result = this.transformData(data);\\n    this.cache.set(data, result);\\n    return result;\\n  }\\n\\n  transformData(data) {\\n    // Transform logic here\\n    return data;\\n  }\\n}`;\r\n    }\r\n    return `// ${description}\\n// Implementation example\\nconst ${description.replace(/\\s+/g, '').toLowerCase()} = (input) => {\\n  // Your implementation here\\n  return input;\\n};\\n\\n// Usage\\nconst result = ${description.replace(/\\s+/g, '').toLowerCase()}(inputValue);`;\r\n  }\r\n\r\n  generatePythonSnippet(description) {\r\n    const lowerDesc = description.toLowerCase();\r\n    if (lowerDesc.includes('function') || lowerDesc.includes('method')) {\r\n      return `# ${description}\\ndef perform_task(data):\\n    \"\"\"\\n    Implementation for ${description.lower()}\\n    \"\"\"\\n    try:\\n        # Your logic here\\n        return process_data(data)\\n    except Exception as e:\\n        print(f\"Error: {e}\")\\n        raise\\n\\n# Usage example\\nresult = perform_task(input_data)`;\r\n    } else if (lowerDesc.includes('class') || lowerDesc.includes('object')) {\r\n      return `# ${description}\\nclass DataProcessor:\\n    def __init__(self, options=None):\\n        self.options = options or {}\\n        self.cache = {}\\n\\n    def process(self, data):\\n        \"\"\"\\n        Implementation for ${description.lower()}\\n        \"\"\"\\n        if data in self.cache:\\n            return self.cache[data]\\n\\n        result = self.transform_data(data)\\n        self.cache[data] = result\\n        return result\\n\\n    def transform_data(self, data):\\n        \"\"\"Transform logic here\"\"\"\\n        return data\\n\\n# Usage\\nprocessor = DataProcessor()\\nresult = processor.process(input_data)`;\r\n    }\r\n    return `# ${description}\\ndef ${description.replace(/\\s+/g, '_').lower()}():\\n    # Your implementation here\\n    return input_value`;\r\n  }\r\n\r\n  generateJavaSnippet(description) {\r\n    const lowerDesc = description.toLowerCase();\r\n    if (lowerDesc.includes('function') || lowerDesc.includes('method')) {\r\n      return `// ${description}\\npublic class TaskProcessor {\\n    public static Object performTask(Object data) {\\n        try {\\n            // Implementation for ${description.toLowerCase()}\\n            return processData(data);\\n        } catch (Exception e) {\\n            System.err.println(\"Error: \" + e.getMessage());\\n            throw e;\\n        }\\n    }\\n\\n    private static Object processData(Object data) {\\n        // Your logic here\\n        return data;\\n    }\\n\\n    // Usage\\n    public static void main(String[] args) {\\n        Object result = performTask(inputData);\\n    }\\n}`;\r\n    } else if (lowerDesc.includes('class') || lowerDesc.includes('object')) {\r\n      return `// ${description}\\npublic class DataProcessor {\\n    private Map<Object, Object> cache;\\n    private Map<String, Object> options;\\n\\n    public DataProcessor(Map<String, Object> options) {\\n        this.options = options;\\n        this.cache = new HashMap<>();\\n    }\\n\\n    public Object process(Object data) {\\n        // Implementation for ${description.toLowerCase()}\\n        if (cache.containsKey(data)) {\\n            return cache.get(data);\\n        }\\n\\n        Object result = transformData(data);\\n        cache.put(data, result);\\n        return result;\\n    }\\n\\n    private Object transformData(Object data) {\\n        // Transform logic here\\n        return data;\\n    }\\n}`;\r\n    }\r\n    return `// ${description}\\n// Implementation example\\npublic class ${description.replace(/\\s+/g, '')} {\\n    public static void main(String[] args) {\\n        // Your implementation here\\n    }\\n}`;\r\n  }\r\n\r\n  generateCppSnippet(description) {\r\n    return `// ${description}\\n#include <iostream>\\n#include <string>\\n#include <map>\\n\\nclass DataProcessor {\\nprivate:\\n    std::map<std::string, std::string> cache;\\n    std::map<std::string, std::string> options;\\n\\npublic:\\n    DataProcessor() {}\\n\\n    // Implementation for ${description.toLowerCase()}\\n    std::string process(std::string data) {\\n        if (cache.find(data) != cache.end()) {\\n            return cache[data];\\n        }\\n\\n        std::string result = transformData(data);\\n        cache[data] = result;\\n        return result;\\n    }\\n\\nprivate:\\n    std::string transformData(std::string data) {\\n        // Transform logic here\\n        return data;\\n    }\\n};\\n\\n// Usage\\nint main() {\\n    DataProcessor processor;\\n    std::string result = processor.process(\"input\");\\n    return 0;\\n}`;\r\n  }\r\n\r\n  generateCSharpSnippet(description) {\r\n    return `// ${description}\\nusing System;\\nusing System.Collections.Generic;\\n\\npublic class DataProcessor\\n{\\n    private Dictionary<string, object> cache;\\n    private Dictionary<string, object> options;\\n\\n    public DataProcessor(Dictionary<string, object> options = null)\\n    {\\n        this.options = options ?? new Dictionary<string, object>();\\n        this.cache = new Dictionary<string, object>();\\n    }\\n\\n    // Implementation for ${description.toLowerCase()}\\n    public object Process(object data)\\n    {\\n        string key = data.ToString();\\n        if (cache.ContainsKey(key))\\n        {\\n            return cache[key];\\n        }\\n\\n        object result = TransformData(data);\\n        cache[key] = result;\\n        return result;\\n    }\\n\\n    private object TransformData(object data)\\n    {\\n        // Transform logic here\\n        return data;\\n    }\\n}\\n\\n// Usage\\nclass Program\\n{\\n    static void Main()\\n    {\\n        var processor = new DataProcessor();\\n        var result = processor.Process(\"input\");\\n    }\\n}`;\r\n  }\r\n\r\n  generateGoSnippet(description) {\r\n    return `// ${description}\\npackage main\\n\\nimport (\\n\\t\"fmt\"\\n\\t\"sync\"\\n)\\n\\ntype DataProcessor struct {\\n\\tcache   map[string]interface{}\\n\\toptions map[string]interface{}\\n\\tmutex   sync.RWMutex\\n}\\n\\nfunc NewDataProcessor(options map[string]interface{}) *DataProcessor {\\n\\treturn &DataProcessor{\\n\\t\\tcache:   make(map[string]interface{}),\\n\\t\\toptions: options,\\n\\t}\\n}\\n\\n// Implementation for ${description.toLowerCase()}\\nfunc (dp *DataProcessor) Process(data interface{}) interface{} {\\n\\tkey := fmt.Sprintf(\"%v\", data)\\n\\tdp.mutex.RLock()\\n\\tif result, exists := dp.cache[key]; exists {\\n\\t\\tdp.mutex.RUnlock()\\n\\t\\treturn result\\n\\t}\\n\\tdp.mutex.RUnlock()\\n\\n\\tresult := dp.transformData(data)\\n\\tdp.mutex.Lock()\\n\\tdp.cache[key] = result\\n\\tdp.mutex.Unlock()\\n\\treturn result\\n}\\n\\nfunc (dp *DataProcessor) transformData(data interface{}) interface{} {\\n\\t// Transform logic here\\n\\treturn data\\n}\\n\\n// Usage\\nfunc main() {\\n\\tprocessor := NewDataProcessor(nil)\\n\\tresult := processor.Process(\"input\")\\n\\tfmt.Println(result)\\n}`;\r\n  }\r\n\r\n  generateRustSnippet(description) {\r\n    return `// ${description}\\nuse std::collections::HashMap;\\n\\nstruct DataProcessor {\\n    cache: HashMap<String, String>,\\n    options: HashMap<String, String>,\\n}\\n\\nimpl DataProcessor {\\n    fn new(options: HashMap<String, String>) -> Self {\\n        DataProcessor {\\n            cache: HashMap::new(),\\n            options,\\n        }\\n    }\\n\\n    // Implementation for ${description.toLowerCase()}\\n    fn process(&mut self, data: &str) -> String {\\n        if let Some(result) = self.cache.get(data) {\\n            return result.clone();\\n        }\\n\\n        let result = self.transform_data(data);\\n        self.cache.insert(data.to_string(), result.clone());\\n        result\\n    }\\n\\n    fn transform_data(&self, data: &str) -> String {\\n        // Transform logic here\\n        data.to_string()\\n    }\\n}\\n\\n// Usage\\nfn main() {\\n    let mut processor = DataProcessor::new(HashMap::new());\\n    let result = processor.process(\"input\");\\n    println!(\"{}\", result);\\n}`;\r\n  }\r\n\r\n  generatePhpSnippet(description) {\r\n    return `<?php\\n// ${description}\\nclass DataProcessor {\\n    private $cache = [];\\n    private $options = [];\\n\\n    public function __construct(array $options = []) {\\n        $this->options = $options;\\n    }\\n\\n    // Implementation for ${description.toLowerCase()}\\n    public function process($data) {\\n        $key = serialize($data);\\n        if (isset($this->cache[$key])) {\\n            return $this->cache[$key];\\n        }\\n\\n        $result = $this->transformData($data);\\n        $this->cache[$key] = $result;\\n        return $result;\\n    }\\n\\n    private function transformData($data) {\\n        // Transform logic here\\n        return $data;\\n    }\\n}\\n\\n// Usage\\n$processor = new DataProcessor();\\n$result = $processor->process('input');\\necho $result;\\n?>`;\r\n  }\r\n\r\n  generateRubySnippet(description) {\r\n    return `# ${description}\\nclass DataProcessor\\n  def initialize(options = {})\\n    @cache = {}\\n    @options = options\\n  end\\n\\n  # Implementation for ${description.lower()}\\n  def process(data)\\n    key = data.hash\\n    return @cache[key] if @cache.key?(key)\\n\\n    result = transform_data(data)\\n    @cache[key] = result\\n    result\\n  end\\n\\n  private\\n\\n  def transform_data(data)\\n    # Transform logic here\\n    data\\n  end\\nend\\n\\n# Usage\\nprocessor = DataProcessor.new\\nresult = processor.process('input')\\nputs result`;\r\n  }\r\n\r\n  generateSwiftSnippet(description) {\r\n    return `// ${description}\\nimport Foundation\\n\\nclass DataProcessor {\\n    private var cache: [String: Any] = [:]\\n    private var options: [String: Any]\\n\\n    init(options: [String: Any] = [:]) {\\n        self.options = options\\n    }\\n\\n    // Implementation for ${description.lower()}\\n    func process(_ data: Any) -> Any {\\n        let key = String(describing: data)\\n        if let cached = cache[key] {\\n            return cached\\n        }\\n\\n        let result = transformData(data)\\n        cache[key] = result\\n        return result\\n    }\\n\\n    private func transformData(_ data: Any) -> Any {\\n        // Transform logic here\\n        return data\\n    }\\n}\\n\\n// Usage\\nlet processor = DataProcessor()\\nlet result = processor.process(\"input\")\\nprint(result)`;\r\n  }\r\n\r\n  // AI Learning and Improvement\r\n  async analyzeResponseQuality(userId, message, response, rating) {\r\n    // Store response quality data for model improvement\r\n    const qualityData = {\r\n      userId,\r\n      message,\r\n      response,\r\n      rating,\r\n      timestamp: Date.now(),\r\n      length: response.length,\r\n      complexity: this.calculateComplexity(response)\r\n    };\r\n\r\n    // In a real implementation, this would be used to fine-tune models\r\n    console.log('Response quality data:', qualityData);\r\n  }\r\n\r\n  calculateComplexity(text) {\r\n    const words = text.split(' ').length;\r\n    const sentences = text.split(/[.!?]+/).length;\r\n    const avgWordLength = text.replace(/[^a-zA-Z]/g, '').length / Math.max(1, words);\r\n\r\n    return {\r\n      wordCount: words,\r\n      sentenceCount: sentences,\r\n      avgWordLength: Math.round(avgWordLength * 100) / 100\r\n    };\r\n  }\r\n\r\n  // Multi-Model Response Generation\r\n  async generateMultiModelResponse(userId, message, models = ['helpful', 'creative']) {\r\n    const responses = {};\r\n\r\n    for (const model of models) {\r\n      try {\r\n        const response = await this.generateResponse(userId, message, { model });\r\n        responses[model] = response;\r\n      } catch (error) {\r\n        responses[model] = `Error generating response from ${model} model`;\r\n      }\r\n    }\r\n\r\n    return responses;\r\n  }\r\n\r\n  // AI-Powered Recommendations\r\n  async generateRecommendations(userId, type = 'general') {\r\n    const history = this.conversationHistory.get(userId) || [];\r\n\r\n    if (history.length === 0) {\r\n      return [\r\n        \"Try asking me about games - I have trivia, RPG adventures, and more!\",\r\n        \"Ask me to tell you a joke or share a fun fact!\",\r\n        \"Want to play a game? Try /tictactoe or /connect4!\",\r\n        \"Create an RPG character and start your adventure!\"\r\n      ];\r\n    }\r\n\r\n    const recommendations = {\r\n      gaming: [\r\n        \"üéÆ Try the new Connect Four game with AI opponents!\",\r\n        \"üß† Challenge yourself with a trivia quiz!\",\r\n        \"‚öîÔ∏è Continue your RPG adventure!\",\r\n        \"üéØ Play some strategy games!\"\r\n      ],\r\n      learning: [\r\n        \"üìö Ask me about programming or technology!\",\r\n        \"üî¢ Want to learn something new with fun facts?\",\r\n        \"üíª I can help with coding questions!\",\r\n        \"üß™ Explore scientific concepts!\"\r\n      ],\r\n      fun: [\r\n        \"üòÇ Let me tell you a joke!\",\r\n        \"üé≠ Generate a fun superhero name!\",\r\n        \"üîÆ Ask the magic 8-ball a question!\",\r\n        \"üìñ Want me to create a story for you?\"\r\n      ],\r\n      social: [\r\n        \"üë• Check out the guild system!\",\r\n        \"üí∞ Try the economy and trading features!\",\r\n        \"üèÜ View your achievements and profile!\",\r\n        \"ü§ù Join a party for multiplayer fun!\"\r\n      ]\r\n    };\r\n\r\n    return recommendations[type] || recommendations.general;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const aiAssistant = new AIAssistantManager();\r\n\r\n// Convenience functions\r\nexport async function generateResponse(userId, message, options = {}) {\r\n  return aiAssistant.generateResponse(userId, message, options);\r\n}\r\n\r\nexport async function analyzeSentiment(text) {\r\n  return aiAssistant.analyzeSentiment(text);\r\n}\r\n\r\nexport async function generateSummary(text, maxLength = 200) {\r\n  return aiAssistant.generateSummary(text, maxLength);\r\n}\r\n\r\nexport async function translateText(text, targetLanguage = 'es') {\r\n  return aiAssistant.translateText(text, targetLanguage);\r\n}\r\n\r\nexport function getAvailableModels() {\r\n  return aiAssistant.getAvailableModels();\r\n}\r\n\r\nexport function getAvailablePersonalities() {\r\n  return aiAssistant.getAvailablePersonalities();\r\n}\r\n\r\nexport function clearUserHistory(userId) {\r\n  return aiAssistant.clearUserHistory(userId);\r\n}\r\n\r\nexport async function generateIdeas(topic, count = 5) {\r\n  return aiAssistant.generateIdeas(topic, count);\r\n}\r\n\r\nexport async function generateCodeSnippet(language, description) {\r\n  return aiAssistant.generateCodeSnippet(language, description);\r\n}\r\n\r\nexport async function generateRecommendations(userId, type = 'general') {\r\n  return aiAssistant.generateRecommendations(userId, type);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\chat.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"max-len","severity":2,"message":"This line has a length of 124. Maximum allowed is 120.","line":3,"column":1,"nodeType":"Program","messageId":"max","endLine":3,"endColumn":125},{"ruleId":"no-unused-vars","severity":1,"message":"'logError' is defined but never used.","line":13,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":26},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":25,"column":34,"nodeType":"Identifier","messageId":"error","endLine":25,"endColumn":42,"fix":{"range":[939,947],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":26,"column":29,"nodeType":"Identifier","messageId":"error","endLine":26,"endColumn":37,"fix":{"range":[1022,1030],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":27,"column":29,"nodeType":"Identifier","messageId":"error","endLine":27,"endColumn":37,"fix":{"range":[1102,1110],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":28,"column":27,"nodeType":"Identifier","messageId":"error","endLine":28,"endColumn":35,"fix":{"range":[1186,1194],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":29,"column":23,"nodeType":"Identifier","messageId":"error","endLine":29,"endColumn":31,"fix":{"range":[1264,1272],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseFloat` over `parseFloat`.","line":30,"column":24,"nodeType":"Identifier","messageId":"error","endLine":30,"endColumn":34,"fix":{"range":[1338,1348],"text":"Number.parseFloat"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":34,"column":29,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":34,"endColumn":35,"fix":{"range":[1503,1509],"text":"300_000"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'callLocalModel' has too many lines (101). Maximum allowed is 50.","line":43,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":143,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'callLocalModel' has too many statements (39). Maximum allowed is 30.","line":43,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":143,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'callLocalModel' has a complexity of 22. Maximum allowed is 10.","line":43,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":143,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed.","line":43,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":43,"endColumn":30},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":49,"column":58,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":49,"endColumn":63,"fix":{"range":[2159,2164],"text":"30_000"}},{"ruleId":"security/detect-possible-timing-attacks","severity":1,"message":"Potential timing attack, left side: true","line":54,"column":5,"nodeType":"IfStatement","endLine":122,"endColumn":6},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 4 times.","line":59,"column":25,"nodeType":"Literal","endLine":59,"endColumn":42},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":76,"column":72,"nodeType":"Literal","messageId":"error","endLine":76,"endColumn":76,"suggestions":[{"messageId":"replace","fix":{"range":[3017,3021],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":78,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":78,"endColumn":6,"fix":{"range":[3031,3031],"text":"\n"}},{"ruleId":"security/detect-possible-timing-attacks","severity":1,"message":"Potential timing attack, left side: true","line":78,"column":12,"nodeType":"IfStatement","endLine":122,"endColumn":6},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":101,"column":65,"nodeType":"Literal","messageId":"error","endLine":101,"endColumn":69,"suggestions":[{"messageId":"replace","fix":{"range":[3809,3813],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":103,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":103,"endColumn":6,"fix":{"range":[3823,3823],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":121,"column":48,"nodeType":"Literal","messageId":"error","endLine":121,"endColumn":52,"suggestions":[{"messageId":"replace","fix":{"range":[4388,4392],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":132,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":132,"endColumn":4,"fix":{"range":[4603,4603],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":132,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":132,"endColumn":15,"fix":{"range":[4611,4977],"text":"error) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (error.name === 'AbortError') {\r\n      logger.warn('Local model request timed out');\r\n      throw new Error('Local model request timed out after 30 seconds');\r\n    }\r\n\r\n    logger.error('Local model error', error instanceof Error ? error : new Error(String(error)));\r\n    throw error instanceof Error ? error : new Error(String(error"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'respondWithOpenAI' has too many lines (59). Maximum allowed is 50.","line":188,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":246,"endColumn":2},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":199,"column":58,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":199,"endColumn":63,"fix":{"range":[7080,7085],"text":"60_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":235,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":235,"endColumn":4,"fix":{"range":[8113,8113],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'handleMessage' has too many lines (97). Maximum allowed is 50.","line":253,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":349,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'handleMessage' has too many statements (39). Maximum allowed is 30.","line":253,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":349,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'handleMessage' has a complexity of 24. Maximum allowed is 10.","line":253,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":349,"endColumn":2},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":259,"column":14,"nodeType":"Literal","messageId":"error","endLine":259,"endColumn":18,"suggestions":[{"messageId":"remove","fix":{"range":[8954,8958],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[8954,8958],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":265,"column":14,"nodeType":"Literal","messageId":"error","endLine":265,"endColumn":18,"suggestions":[{"messageId":"remove","fix":{"range":[9168,9172],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[9168,9172],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":268,"column":33,"nodeType":"Identifier","messageId":"method","endLine":268,"endColumn":40,"fix":{"range":[9223,9223],"text":"All"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":297,"column":14,"nodeType":"Literal","messageId":"error","endLine":297,"endColumn":18,"suggestions":[{"messageId":"remove","fix":{"range":[10133,10137],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[10133,10137],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (586). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":587,"endColumn":1},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":303,"column":71,"nodeType":"Literal","messageId":"error","endLine":303,"endColumn":75,"suggestions":[{"messageId":"replace","fix":{"range":[10299,10303],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":310,"column":14,"nodeType":"Literal","messageId":"error","endLine":310,"endColumn":18,"suggestions":[{"messageId":"remove","fix":{"range":[10630,10634],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[10630,10634],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":315,"column":43,"nodeType":"CallExpression","messageId":"substring","endLine":315,"endColumn":81,"fix":{"range":[10804,10834],"text":"slice(0, Math.max(0, MAX_PROMPT_LENGTH)"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":332,"column":50,"nodeType":"CallExpression","messageId":"substring","endLine":332,"endColumn":92,"fix":{"range":[11369,11401],"text":"slice(0, Math.max(0, MAX_RESPONSE_LENGTH)"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":338,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":338,"endColumn":4,"fix":{"range":[11500,11500],"text":"\n"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":373,"column":48,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":373,"endColumn":98,"fix":{"range":[12878,12928],"text":"(LOCAL_MODEL_URL ? 'Local Model ‚úì' : 'Basic Chat ‚úì')"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":385,"column":82,"nodeType":"CallExpression","messageId":"substring","endLine":385,"endColumn":106,"fix":{"range":[13670,13679],"text":"slice"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":389,"column":10,"nodeType":"Literal","messageId":"error","endLine":389,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[13737,13741],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[13737,13741],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'generateChatResponse' has too many lines (82). Maximum allowed is 50.","line":400,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":481,"endColumn":2},{"ruleId":"max-len","severity":2,"message":"This line has a length of 223. Maximum allowed is 120.","line":404,"column":1,"nodeType":"Program","messageId":"max","endLine":404,"endColumn":224},{"ruleId":"max-len","severity":2,"message":"This line has a length of 141. Maximum allowed is 120.","line":417,"column":1,"nodeType":"Program","messageId":"max","endLine":417,"endColumn":142},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":425,"column":31,"nodeType":"CallExpression","messageId":"substring","endLine":425,"endColumn":80,"fix":{"range":[15261,15293],"text":"slice(0, Math.max(0, MAX_RESPONSE_LENGTH)"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":433,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":433,"endColumn":6,"fix":{"range":[15534,15534],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":433,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":433,"endColumn":17,"fix":{"range":[15542,15644],"text":"error) {\r\n      logger.warn('Local model failed for chat, falling back to OpenAI', {\r\n        error: error"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":455,"column":28,"nodeType":"CallExpression","messageId":"substring","endLine":455,"endColumn":74,"fix":{"range":[16335,16367],"text":"slice(0, Math.max(0, MAX_RESPONSE_LENGTH)"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":462,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":462,"endColumn":6,"fix":{"range":[16566,16566],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":462,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":462,"endColumn":17,"fix":{"range":[16574,16634],"text":"error) {\r\n      logger.error('OpenAI API failed for chat', error"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 146. Maximum allowed is 120.","line":472,"column":1,"nodeType":"Program","messageId":"max","endLine":472,"endColumn":148},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":473,"column":37,"nodeType":"CallExpression","messageId":"substring","endLine":473,"endColumn":60,"fix":{"range":[16985,16994],"text":"slice"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 132. Maximum allowed is 120.","line":474,"column":1,"nodeType":"Program","messageId":"max","endLine":474,"endColumn":134},{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":505,"column":33,"nodeType":"Literal","endLine":505,"endColumn":47},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":519,"column":1,"nodeType":"Program","messageId":"max","endLine":519,"endColumn":145},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":519,"column":12,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":519,"endColumn":144,"fix":{"range":[18849,18981],"text":"'Wanna play? Try /rps <rock|paper|scissors>, /roll 2d6, or /8ball <question> ‚Äî or DM me directly and say \"roll 1d20\" or \"rps rock\".'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":522,"column":10,"nodeType":"Literal","messageId":"error","endLine":522,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[19000,19004],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[19000,19004],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":552,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":552,"endColumn":4,"fix":{"range":[19942,19942],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":583,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":583,"endColumn":72,"fix":{"range":[20988,21055],"text":"'Why did the developer go broke? Because he used up all his cache.'"}}],"suppressedMessages":[],"errorCount":52,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":30,"fixableWarningCount":0,"source":"/**\r\n * Chat module for ULTRA Discord Bot.\r\n * Handles AI-powered conversations and direct message interactions with enhanced error handling and performance monitoring.\r\n *\r\n * @fileoverview Advanced chat system with multiple AI providers, conversation memory, and fallback mechanisms.\r\n * @author ULTRA Bot Development Team\r\n * @version 3.0.1\r\n * @license MIT\r\n */\r\n\r\nimport 'dotenv/config';\r\nimport { getGuild } from './storage.js';\r\nimport { logger, logError } from './logger.js';\r\n\r\n/**\r\n * Configuration constants for chat functionality.\r\n */\r\nconst OPENAI_KEY = process.env.OPENAI_API_KEY;\r\nconst LOCAL_MODEL_URL = process.env.LOCAL_MODEL_URL;\r\nconst LOCAL_MODEL_API = process.env.LOCAL_MODEL_API || 'openai-compatible';\r\nconst OPENWEBUI_BASE = process.env.OPENWEBUI_BASE;\r\nconst OPENWEBUI_PATH = process.env.OPENWEBUI_PATH || '/api/chat';\r\n\r\n// Chat configuration with environment variable support\r\nconst DEFAULT_CHAT_COOLDOWN_MS = parseInt(process.env.CHAT_COOLDOWN_MS || '2000', 10);\r\nconst DEFAULT_MAX_HISTORY = parseInt(process.env.CHAT_MAX_HISTORY || '8', 10);\r\nconst MAX_RESPONSE_LENGTH = parseInt(process.env.MAX_RESPONSE_LENGTH || '2000', 10);\r\nconst MAX_PROMPT_LENGTH = parseInt(process.env.MAX_PROMPT_LENGTH || '1000', 10);\r\nconst AI_MAX_TOKENS = parseInt(process.env.AI_MAX_TOKENS || '512', 10);\r\nconst AI_TEMPERATURE = parseFloat(process.env.AI_TEMPERATURE || '0.8');\r\n\r\n// Performance limits\r\nconst MAX_CONVERSATION_MEMORY_MB = 50; // Limit memory usage\r\nconst CLEANUP_INTERVAL_MS = 300000; // 5 minutes cleanup\r\n\r\n/**\r\n * Calls a local AI model with enhanced error handling and timeout protection.\r\n * @param {string} prompt - The prompt to send to the model\r\n * @param {string} [url] - The model endpoint URL\r\n * @param {string} [api] - The API type ('openai-compatible', 'openwebui', etc.)\r\n * @returns {Promise<string|null>} The model response or null if failed\r\n */\r\nasync function callLocalModel(prompt, url = LOCAL_MODEL_URL, api = LOCAL_MODEL_API) {\r\n  if (!url) {\r\n    throw new Error('Local model URL not configured');\r\n  }\r\n\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout\r\n\r\n  try {\r\n    let response;\r\n\r\n    if (api === 'openai-compatible') {\r\n      const res = await fetch(`${url.replace(/\\/$/, '')}/v1/chat/completions`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'User-Agent': 'ULTRA-Bot/3.0.1'\r\n        },\r\n        body: JSON.stringify({\r\n          model: 'gpt-oss-20b',\r\n          messages: [{ role: 'user', content: prompt }],\r\n          max_tokens: AI_MAX_TOKENS,\r\n          temperature: AI_TEMPERATURE\r\n        }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Local model API error ${res.status}: ${errorText}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n      response = data.choices?.[0]?.message?.content ?? data.result ?? null;\r\n\r\n    } else if (api === 'openwebui') {\r\n      const base = OPENWEBUI_BASE || url;\r\n      if (!base) {\r\n        throw new Error('OpenWebUI base URL not configured');\r\n      }\r\n\r\n      const fullUrl = `${base.replace(/\\/$/, '')}${OPENWEBUI_PATH}`;\r\n      const res = await fetch(fullUrl, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'User-Agent': 'ULTRA-Bot/3.0.1'\r\n        },\r\n        body: JSON.stringify({ prompt }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`OpenWebUI API error ${res.status}: ${errorText}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n      response = data.response ?? data.output ?? data.result ?? null;\r\n\r\n    } else {\r\n      // Generic endpoint fallback\r\n      const res = await fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'User-Agent': 'ULTRA-Bot/3.0.1'\r\n        },\r\n        body: JSON.stringify({ prompt }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Generic model API error ${res.status}: ${errorText}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n      response = data.result ?? data.output ?? null;\r\n    }\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    if (!response || typeof response !== 'string') {\r\n      throw new Error('Invalid or empty response from local model');\r\n    }\r\n\r\n    return response.trim();\r\n\r\n  } catch (err) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (err.name === 'AbortError') {\r\n      logger.warn('Local model request timed out');\r\n      throw new Error('Local model request timed out after 30 seconds');\r\n    }\r\n\r\n    logger.error('Local model error', err instanceof Error ? err : new Error(String(err)));\r\n    throw err instanceof Error ? err : new Error(String(err));\r\n  }\r\n}\r\n\r\n// In-memory storage for conversation history and cooldowns with memory management\r\nconst conversationMap = new Map();\r\nconst cooldownMap = new Map();\r\n\r\n// Memory management - periodic cleanup to prevent memory leaks\r\nsetInterval(() => {\r\n  const now = Date.now();\r\n  const maxAge = 24 * 60 * 60 * 1000; // 24 hours\r\n\r\n  // Clean up old cooldowns\r\n  for (const [userId, timestamp] of cooldownMap.entries()) {\r\n    if (now - timestamp > maxAge) {\r\n      cooldownMap.delete(userId);\r\n    }\r\n  }\r\n\r\n  // Clean up old conversations (keep recent ones)\r\n  let totalMemory = 0;\r\n  for (const [userId, history] of conversationMap.entries()) {\r\n    // Estimate memory usage (rough calculation)\r\n    const memoryEstimate = JSON.stringify(history).length * 2; // UTF-16 estimate\r\n    totalMemory += memoryEstimate;\r\n\r\n    // Remove old conversations if memory usage is too high\r\n    if (totalMemory > MAX_CONVERSATION_MEMORY_MB * 1024 * 1024) {\r\n      conversationMap.delete(userId);\r\n    }\r\n  }\r\n\r\n  if (totalMemory > MAX_CONVERSATION_MEMORY_MB * 1024 * 1024 * 0.8) {\r\n    logger.warn('High conversation memory usage detected', {\r\n      totalMemoryMB: (totalMemory / (1024 * 1024)).toFixed(2),\r\n      conversations: conversationMap.size,\r\n      cooldowns: cooldownMap.size\r\n    });\r\n  }\r\n}, CLEANUP_INTERVAL_MS);\r\n\r\n/**\r\n * Sends a prompt to OpenAI and returns the response with enhanced error handling.\r\n * @param {Array<{role: string, content: string}>|string} messages - Chat messages or single prompt string\r\n * @returns {Promise<string|null>} AI response or null if failed\r\n */\r\nexport async function respondWithOpenAI(messages) {\r\n  if (!OPENAI_KEY) {\r\n    throw new Error('OPENAI_API_KEY not set. Please configure your OpenAI API key in .env file.');\r\n  }\r\n\r\n  // Convert single prompt to messages format\r\n  const messageArray = Array.isArray(messages) ? messages : [{ role: 'user', content: messages }];\r\n\r\n  logger.debug('Calling OpenAI API', { messageCount: messageArray.length });\r\n\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), 60000); // 60 second timeout for OpenAI\r\n\r\n  try {\r\n    const res = await fetch('https://api.openai.com/v1/chat/completions', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${OPENAI_KEY}`,\r\n        'User-Agent': 'ULTRA-Bot/3.0.1'\r\n      },\r\n      body: JSON.stringify({\r\n        model: process.env.OPENAI_MODEL || 'gpt-4o-mini',\r\n        messages: messageArray,\r\n        max_tokens: AI_MAX_TOKENS,\r\n        temperature: AI_TEMPERATURE,\r\n      }),\r\n      signal: controller.signal\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    if (!res.ok) {\r\n      const text = await res.text();\r\n      throw new Error(`OpenAI API error ${res.status}: ${text}`);\r\n    }\r\n\r\n    const data = await res.json();\r\n    const content = data.choices?.[0]?.message?.content?.trim();\r\n\r\n    if (!content) {\r\n      throw new Error('OpenAI returned empty response');\r\n    }\r\n\r\n    logger.debug('OpenAI response received', { contentLength: content.length });\r\n    return content;\r\n\r\n  } catch (error) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (error.name === 'AbortError') {\r\n      logger.warn('OpenAI request timed out');\r\n      throw new Error('OpenAI request timed out after 60 seconds');\r\n    }\r\n\r\n    logger.error('OpenAI API error', error instanceof Error ? error : new Error(String(error)));\r\n    throw error instanceof Error ? error : new Error(String(error));\r\n  }\r\n}\r\n\r\n/**\r\n * Handles incoming Discord messages for chat functionality.\r\n * @param {object} message - Discord message object\r\n * @returns {Promise<string|null>} Response message or null if no response needed\r\n */\r\nexport async function handleMessage(message) {\r\n  const isDM = message.channel.type === 1 || message.channel?.type === 'DM';\r\n\r\n  try {\r\n    // Ignore bots and system messages\r\n    if (message.author.bot || message.system) {\r\n      return null;\r\n    }\r\n\r\n    // Only respond to DMs or mentions\r\n    const isMention = message.mentions && message.mentions.has && message.mentions.has(message.client.user.id);\r\n    if (!isDM && !isMention) {\r\n      return null;\r\n    }\r\n\r\n    const raw = message.content.replace(/<@!?.+?>/g, '').trim() || '';\r\n\r\n    logger.debug('Processing chat message', {\r\n      userId: message.author.id,\r\n      username: message.author.username,\r\n      isDM,\r\n      isMention,\r\n      messageLength: message.content.length,\r\n      processedLength: raw.length\r\n    });\r\n\r\n    // Handle special commands\r\n    const commandResponse = handleSpecialCommands(raw, message);\r\n    if (commandResponse) {\r\n      return commandResponse;\r\n    }\r\n\r\n    const prompt = raw;\r\n\r\n    // Check cooldown system\r\n    const COOLDOWN_MS = Number(process.env.CHAT_COOLDOWN_MS || DEFAULT_CHAT_COOLDOWN_MS);\r\n    const lastInteraction = cooldownMap.get(message.author.id) || 0;\r\n    const now = Date.now();\r\n\r\n    if (now - lastInteraction < COOLDOWN_MS) {\r\n      logger.debug('Chat cooldown active', {\r\n        userId: message.author.id,\r\n        remainingMs: COOLDOWN_MS - (now - lastInteraction)\r\n      });\r\n      return null;\r\n    }\r\n\r\n    cooldownMap.set(message.author.id, now);\r\n\r\n    // Get guild configuration\r\n    const guildCfg = message.guild?.id ? getGuild(message.guild.id) : null;\r\n    const useLocalUrl = guildCfg?.modelUrl || LOCAL_MODEL_URL;\r\n    const useLocalApi = guildCfg?.modelApi || LOCAL_MODEL_API;\r\n    const chatEnabled = guildCfg?.chatEnabled ?? true;\r\n\r\n    if (message.guild?.id && !chatEnabled) {\r\n      logger.debug('Chat disabled for guild', { guildId: message.guild.id });\r\n      return null;\r\n    }\r\n\r\n    // Get and update conversation history\r\n    let history = conversationMap.get(message.author.id) || [];\r\n    history.push({ role: 'user', content: prompt.substring(0, MAX_PROMPT_LENGTH) });\r\n\r\n    // Trim history to prevent memory issues\r\n    const MAX_HISTORY = Number(process.env.CHAT_MAX_HISTORY || DEFAULT_MAX_HISTORY);\r\n    if (history.length > MAX_HISTORY) {\r\n      history = history.slice(-MAX_HISTORY);\r\n    }\r\n\r\n    // Generate AI response\r\n    const response = await generateChatResponse(prompt, message, history, {\r\n      useLocalUrl,\r\n      useLocalApi,\r\n      isDM\r\n    });\r\n\r\n    // Update conversation history with response\r\n    if (response) {\r\n      history.push({ role: 'assistant', content: response.substring(0, MAX_RESPONSE_LENGTH) });\r\n      conversationMap.set(message.author.id, history);\r\n    }\r\n\r\n    return response;\r\n\r\n  } catch (error) {\r\n    logger.error('Chat message handling failed', error, {\r\n      userId: message.author.id,\r\n      username: message.author.username,\r\n      messageLength: message.content.length,\r\n      channelName: message.channel.name,\r\n      isDM\r\n    });\r\n\r\n    return 'ü§ñ Oops! Something went wrong processing your message. Please try again.';\r\n  }\r\n}\r\n\r\n/**\r\n * Handles special chat commands.\r\n * @param {string} command - The command text\r\n * @param {object} message - Discord message object\r\n * @returns {string|null} Command response or null if not a special command\r\n */\r\nfunction handleSpecialCommands(command, message) {\r\n  const lowerCommand = command.toLowerCase();\r\n\r\n  if (lowerCommand === '!clear') {\r\n    conversationMap.delete(message.author.id);\r\n    logger.info('Conversation cleared', { userId: message.author.id });\r\n    return 'üßπ Conversation cleared! Starting fresh.';\r\n  }\r\n\r\n  if (lowerCommand === '!help') {\r\n    return 'ü§ñ **Available Commands:**\\n‚Ä¢ `!clear` - Clear conversation history\\n‚Ä¢ `!status` - Check bot status\\n‚Ä¢ `!commands` - List all commands\\n‚Ä¢ Just chat normally for AI responses!';\r\n  }\r\n\r\n  if (lowerCommand === '!status') {\r\n    const guilds = message.client.guilds.cache.size;\r\n    const users = message.client.guilds.cache.reduce((total, guild) => total + guild.memberCount, 0);\r\n    const aiStatus = OPENAI_KEY ? 'OpenAI ‚úì' : LOCAL_MODEL_URL ? 'Local Model ‚úì' : 'Basic Chat ‚úì';\r\n\r\n    return `ü§ñ **Bot Status:**\\n‚Ä¢ Servers: ${guilds}\\n‚Ä¢ Users: ${users}\\n‚Ä¢ AI: ${aiStatus}\\n‚Ä¢ Version: ULTRA v3.0`;\r\n  }\r\n\r\n  if (lowerCommand === '!commands') {\r\n    return 'üìö **All Commands:**\\n‚Ä¢ `/help` - Dynamic help system\\n‚Ä¢ `/rpg` - RPG adventures\\n‚Ä¢ `/trivia` - Quiz games\\n‚Ä¢ `/music` - Music system\\n‚Ä¢ `/guild` - Guild management\\n‚Ä¢ `/trade` - Trading system\\n‚Ä¢ `/profile` - User profiles\\n‚Ä¢ `/achievements` - Achievement system\\n‚Ä¢ And many more! Use `/help` for details.';\r\n  }\r\n\r\n  // Check for playful prompts (8ball, rps, dice rolls, jokes)\r\n  const playfulResponse = handlePlayfulPrompt(command, message);\r\n  if (playfulResponse) {\r\n    logger.debug('Playful prompt handled', { userId: message.author.id, command: command.substring(0, 50) });\r\n    return playfulResponse;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Generates a chat response using available AI models.\r\n * @param {string} prompt - User prompt\r\n * @param {object} message - Discord message object\r\n * @param {Array} history - Conversation history\r\n * @param {object} options - Configuration options\r\n * @returns {Promise<string|null>} AI response or null\r\n */\r\nasync function generateChatResponse(prompt, message, history, options) {\r\n  const { useLocalUrl, useLocalApi, isDM } = options;\r\n\r\n  // Build enhanced context prompt\r\n  const contextPrompt = `You are ULTRA, an advanced AI Discord bot with many features including RPG games, trivia, music, trading, and more. You have a friendly, helpful personality and love to engage users in conversation.\r\n\r\nCurrent context:\r\n- User: ${message.author.username}\r\n- Channel: ${isDM ? 'Direct Message' : message.channel.name}\r\n- Server: ${message.guild?.name || 'Direct Message'}\r\n- Time: ${new Date().toLocaleString()}\r\n\r\nPrevious conversation:\r\n${history.slice(-3).map(h => `${h.role}: ${h.content}`).join('\\n')}\r\n\r\nUser's message: ${prompt}\r\n\r\nRespond naturally and helpfully. If they're asking about bot features, mention relevant commands. Keep responses engaging but not too long.`;\r\n\r\n  // Try local model first if configured\r\n  if (useLocalUrl) {\r\n    try {\r\n      logger.debug('Attempting local model for chat', { userId: message.author.id });\r\n      const response = await callLocalModel(contextPrompt, useLocalUrl, useLocalApi);\r\n      if (response) {\r\n        const cleanResponse = response.trim().substring(0, MAX_RESPONSE_LENGTH);\r\n        logger.info('Local model chat response generated', {\r\n          userId: message.author.id,\r\n          responseLength: cleanResponse.length,\r\n          model: useLocalApi\r\n        });\r\n        return cleanResponse;\r\n      }\r\n    } catch (err) {\r\n      logger.warn('Local model failed for chat, falling back to OpenAI', {\r\n        error: err.message,\r\n        userId: message.author.id\r\n      });\r\n    }\r\n  }\r\n\r\n  // Try OpenAI if available\r\n  if (OPENAI_KEY) {\r\n    try {\r\n      logger.debug('Attempting OpenAI for chat', { userId: message.author.id });\r\n      const messages = [\r\n        {\r\n          role: 'system',\r\n          content: 'You are ULTRA, an advanced AI Discord bot with RPG games, trivia, music, trading, and many other features. Be friendly, helpful, and engaging. Keep responses under 2000 characters.'\r\n        },\r\n        ...history.map(h => ({ role: h.role, content: h.content }))\r\n      ];\r\n\r\n      const reply = await respondWithOpenAI(messages);\r\n      if (reply) {\r\n        const cleanReply = reply.trim().substring(0, MAX_RESPONSE_LENGTH);\r\n        logger.info('OpenAI chat response generated', {\r\n          userId: message.author.id,\r\n          responseLength: cleanReply.length\r\n        });\r\n        return cleanReply;\r\n      }\r\n    } catch (err) {\r\n      logger.error('OpenAI API failed for chat', err, {\r\n        userId: message.author.id,\r\n        promptLength: prompt.length\r\n      });\r\n    }\r\n  }\r\n\r\n  // Fallback responses\r\n  const fallbackResponses = [\r\n    `üí≠ I'm thinking... \"${prompt}\" is an interesting message! While my AI brain is loading, did you know you can use /rpg to start an adventure?`,\r\n    `ü§î Processing your message: \"${prompt.substring(0, 50)}${prompt.length > 50 ? '...' : ''}\". My neural networks are warming up! Try /help to explore all features.`,\r\n    `üß† Analyzing: \"${prompt}\". I'm getting smarter every day! Meanwhile, you can play /trivia or start an RPG adventure with /rpg.`,\r\n    `‚ö° \"${prompt}\" - fascinating input! While I'm connecting to my AI core, why not try /music to play some tunes?`\r\n  ];\r\n\r\n  const fallbackResponse = fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];\r\n  logger.debug('Using fallback chat response', { userId: message.author.id });\r\n  return fallbackResponse;\r\n}\r\n\r\n/**\r\n * Handles playful prompts and mini-games in chat.\r\n * @param {string} text - User input text\r\n * @param {object} message - Discord message object\r\n * @returns {string|null} Response or null if not a playful prompt\r\n */\r\nfunction handlePlayfulPrompt(text, message) {\r\n  const lower = text.toLowerCase();\r\n\r\n  // 8ball: starts with 8ball or 'magic 8' or contains '?'\r\n  if (lower.startsWith('8ball') || lower.startsWith('8-ball') || /\\b8 ball\\b/.test(lower)) {\r\n    return eightBallReply();\r\n  }\r\n\r\n  // rps: 'rps <choice>' or 'rock/paper/scissors' direct\r\n  const rpsMatch = lower.match(/\\brps\\s+(rock|paper|scissors)\\b/) || lower.match(/\\b(rock|paper|scissors)\\b/);\r\n  if (rpsMatch) {\r\n    const userChoice = rpsMatch[1];\r\n    return playRPS(userChoice, message.author.username);\r\n  }\r\n\r\n  // roll: 'roll 2d6' or '2d6' or 'roll d20'\r\n  const rollMatch = lower.match(/(\\d+)?d(\\d+)/);\r\n  if (rollMatch) {\r\n    const n = Number(rollMatch[1] || 1);\r\n    const sides = Number(rollMatch[2]);\r\n    return rollDice(n, sides, message.author.username);\r\n  }\r\n\r\n  // joke request\r\n  if (/(tell me a joke|joke|make me laugh)/.test(lower)) {\r\n    return randomJoke();\r\n  }\r\n\r\n  // prompt to play\r\n  if (/\\b(play|game|let's play|wanna play)\\b/.test(lower)) {\r\n    return `Wanna play? Try /rps <rock|paper|scissors>, /roll 2d6, or /8ball <question> ‚Äî or DM me directly and say \"roll 1d20\" or \"rps rock\".`;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Generates a Magic 8-Ball response.\r\n * @returns {string} 8-ball answer\r\n */\r\nfunction eightBallReply() {\r\n  const answers = [\r\n    'It is certain.', 'Without a doubt.', 'You may rely on it.', 'Ask again later.',\r\n    'Better not tell you now.', 'My reply is no.', 'Very doubtful.'\r\n  ];\r\n  return answers[Math.floor(Math.random() * answers.length)];\r\n}\r\n\r\n/**\r\n * Plays Rock-Paper-Scissors.\r\n * @param {string} userChoice - User's choice (rock/paper/scissors)\r\n * @param {string} username - User's name for response\r\n * @returns {string} Game result\r\n */\r\nfunction playRPS(userChoice, username) {\r\n  const choices = ['rock', 'paper', 'scissors'];\r\n  const bot = choices[Math.floor(Math.random() * 3)];\r\n  let result = 'tie';\r\n\r\n  if ((userChoice === 'rock' && bot === 'scissors') ||\r\n      (userChoice === 'paper' && bot === 'rock') ||\r\n      (userChoice === 'scissors' && bot === 'paper')) {\r\n    result = 'you win';\r\n  } else if (userChoice !== bot) {\r\n    result = 'you lose';\r\n  }\r\n\r\n  return `${username} chose ${userChoice}, I chose ${bot} ‚Äî ${result}!`;\r\n}\r\n\r\n/**\r\n * Rolls dice and returns the result.\r\n * @param {number} n - Number of dice\r\n * @param {number} sides - Number of sides per die\r\n * @param {string} username - User's name for response\r\n * @returns {string} Dice roll result\r\n */\r\nfunction rollDice(n, sides, username) {\r\n  const maxDice = 100; // Prevent abuse\r\n  const actualDice = Math.min(maxDice, Math.max(1, n));\r\n  const rolls = Array.from({ length: actualDice }, () => 1 + Math.floor(Math.random() * sides));\r\n  const sum = rolls.reduce((a, b) => a + b, 0);\r\n\r\n  return `${username} rolled ${actualDice}d${sides}: [${rolls.join(', ')}] = ${sum}`;\r\n}\r\n\r\n/**\r\n * Returns a random joke.\r\n * @returns {string} A random joke\r\n */\r\nfunction randomJoke() {\r\n  const jokes = [\r\n    \"I told my computer I needed a break, and it said: 'No problem ‚Äî I'll go to sleep.'\",\r\n    'Why do programmers prefer dark mode? Because light attracts bugs!',\r\n    \"Why did the developer go broke? Because he used up all his cache.\"\r\n  ];\r\n  return jokes[Math.floor(Math.random() * jokes.length)];\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commandLoader.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":6,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":6,"endColumn":20,"fix":{"range":[138,138],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":7,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":7,"endColumn":24,"fix":{"range":[162,162],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":37,"fix":{"range":[206,206],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:url` over `url`.","line":8,"column":31,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":8,"endColumn":36,"fix":{"range":[201,201],"text":"node:"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 125. Maximum allowed is 120.","line":19,"column":1,"nodeType":"Program","messageId":"max","endLine":19,"endColumn":126},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":48,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":48,"endColumn":4,"fix":{"range":[1468,1468],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":87,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":87,"endColumn":4,"fix":{"range":[2765,2765],"text":"\n"}}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"/**\r\n * Command loader module for Discord bot.\r\n * Dynamically loads command modules from the commands directory.\r\n */\r\n\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { pathToFileURL } from 'url';\r\nimport { logger } from './logger.js';\r\n\r\n/**\r\n * Supported command file extensions.\r\n */\r\nconst COMMAND_EXTENSIONS = ['.js', '.mjs', '.cjs'];\r\n\r\n/**\r\n * Loads all command modules from the commands directory.\r\n * @param {import('discord.js').Client} client - Discord client instance\r\n * @returns {Promise<{total: number, loaded: number}>} Object with total command files found and successfully loaded commands\r\n */\r\nexport async function loadCommands(client) {\r\n  const commandsPath = path.join(process.cwd(), 'src', 'commands');\r\n  let loadedCount = 0;\r\n  let total = 0;\r\n\r\n  logger.info('Loading commands', { path: commandsPath });\r\n\r\n  if (!fs.existsSync(commandsPath)) {\r\n    logger.warn('Commands directory does not exist', { path: commandsPath });\r\n    return { total: 0, loaded: 0 };\r\n  }\r\n\r\n  try {\r\n    const files = fs.readdirSync(commandsPath).filter(file =>\r\n      COMMAND_EXTENSIONS.some(ext => file.endsWith(ext))\r\n    );\r\n\r\n    total = files.length;\r\n    logger.info('Found command files', { count: total, files });\r\n\r\n    for (const file of files) {\r\n      if (await loadCommandFile(client, commandsPath, file)) {\r\n        loadedCount++;\r\n      }\r\n    }\r\n\r\n    logger.success('Commands loaded successfully', { total, loaded: loadedCount });\r\n  } catch (error) {\r\n    const err = error instanceof Error ? error : new Error(String(error));\r\n    logger.error('Failed to load commands', err, { path: commandsPath });\r\n  }\r\n\r\n  return { total, loaded: loadedCount };\r\n}\r\n\r\n/**\r\n * Loads a single command file and registers it with the client.\r\n * @param {import('discord.js').Client} client - Discord client instance\r\n * @param {string} commandsPath - Path to commands directory\r\n * @param {string} file - Command file name\r\n * @returns {Promise<boolean>} Success status of command loading\r\n */\r\nasync function loadCommandFile(client, commandsPath, file) {\r\n  const filePath = path.join(commandsPath, file);\r\n\r\n  try {\r\n    const moduleUrl = pathToFileURL(filePath).href;\r\n    const commandModule = await import(moduleUrl);\r\n\r\n    if (!commandModule.data || !commandModule.execute) {\r\n      logger.warn('Command file missing required exports', {\r\n        file,\r\n        hasData: !!commandModule.data,\r\n        hasExecute: !!commandModule.execute\r\n      });\r\n      return false;\r\n    }\r\n\r\n    const commandName = commandModule.data.name;\r\n    client.commands.set(commandName, {\r\n      data: commandModule.data,\r\n      execute: commandModule.execute\r\n    });\r\n\r\n    logger.debug('Command loaded', { name: commandName, file });\r\n    return true;\r\n  } catch (error) {\r\n    const err = error instanceof Error ? error : new Error(String(error));\r\n    logger.error('Failed to load command file', err, { file, filePath });\r\n    return false;\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\8ball.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\n\r\nconst answers = [\r\n  'It is certain.', 'Without a doubt.', 'You may rely on it.', 'Ask again later.',\r\n  'Better not tell you now.', 'My reply is no.', 'Very doubtful.', 'Yes definitely.', 'Most likely.',\r\n  'Cannot predict now.', 'Concentrate and ask again.', 'Do not count on it.', 'Outlook good.',\r\n  'Yes.', 'Signs point to yes.', 'Reply hazy, try again.', 'My sources say no.',\r\n  'As I see it, yes.', 'Outlook not so good.', 'Absolutely.', 'Certainly not.'\r\n];\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('8ball')\r\n  .setDescription('Ask the magic 8-ball a question')\r\n  .addStringOption(opt => opt.setName('question').setDescription('Your question').setRequired(true));\r\n\r\nexport async function execute(interaction) {\r\n  const ans = answers[Math.floor(Math.random() * answers.length)];\r\n  await interaction.reply(`${ans}`);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\achievements.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (223). Maximum allowed is 100.","line":11,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":233,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (63). Maximum allowed is 30.","line":11,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":233,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 44. Maximum allowed is 20.","line":11,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":233,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 59 to the 15 allowed.","line":11,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":11,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":30,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":30,"endColumn":25,"fix":{"range":[1307,9745],"text":"switch (sub) {\n    case 'view': {\r\n      try {\r\n        const userAchievements = getUserAchievements(userId) || [];\r\n        const allAchievements = getAllAchievements() || {};\r\n\r\n        // Group achievements by category with validation\r\n        const achievementsByCategory = {};\r\n        if (Array.isArray(userAchievements)) {\r\n          userAchievements.forEach(achievement => {\r\n            if (achievement && achievement.category && typeof achievement.category === 'string') {\r\n              if (!achievementsByCategory[achievement.category]) {\r\n                achievementsByCategory[achievement.category] = [];\r\n              }\r\n              achievementsByCategory[achievement.category].push(achievement);\r\n            }\r\n          });\r\n        }\r\n\r\n        // Calculate completion stats with safe division\r\n        const totalAchievements = Object.keys(allAchievements).length;\r\n        const earnedCount = Array.isArray(userAchievements) ? userAchievements.length : 0;\r\n        const completionPercentage = totalAchievements > 0 ? Math.round((earnedCount / totalAchievements) * 100) : 0;\r\n        const totalPoints = Array.isArray(userAchievements) ?\r\n          userAchievements.reduce((sum, a) => sum + (a?.points || 0), 0) : 0;\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üèÜ ${interaction.user.username}'s Achievements`)\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**Progress:** ${earnedCount}/${totalAchievements} (${completionPercentage}%)\\n**Achievement Points:** ${totalPoints}`)\r\n          .setThumbnail(interaction.user.displayAvatarURL());\r\n\r\n        // Add category sections with validation\r\n        const categoryEmojis = {\r\n          rpg: 'üéÆ',\r\n          games: 'üéØ',\r\n          social: 'ü§ù',\r\n          special: '‚≠ê',\r\n          fun: 'üé™'\r\n        };\r\n\r\n        for (const [category, achievements] of Object.entries(achievementsByCategory)) {\r\n          if (!Array.isArray(achievements)) continue;\r\n\r\n          const categoryEmoji = categoryEmojis[category] || 'üèÜ';\r\n          const achievementList = achievements\r\n            .filter(a => a && a.icon && a.name && typeof a.points === 'number')\r\n            .sort((a, b) => (b.points || 0) - (a.points || 0))\r\n            .map(a => `${a.icon} **${a.name}** (${a.points} pts)`)\r\n            .join('\\n');\r\n\r\n          if (achievementList) {\r\n            embed.addFields({\r\n              name: `${categoryEmoji} ${category.toUpperCase()} (${achievements.length})`,\r\n              value: achievementList.length > 1024 ? achievementList.substring(0, 1021) + '...' : achievementList,\r\n              inline: false\r\n            });\r\n          }\r\n        }\r\n\r\n        // Add unearned achievements preview with validation\r\n        const allAchievementsArray = Object.values(allAchievements).filter(a => a && a.id);\r\n        const unearnedAchievements = allAchievementsArray.filter(a =>\r\n          !userAchievements.some(ua => ua && ua.id === a.id)\r\n        );\r\n\r\n        if (unearnedAchievements.length > 0) {\r\n          const nextAchievements = unearnedAchievements\r\n            .filter(a => a && typeof a.points === 'number')\r\n            .sort((a, b) => (a.points || 0) - (b.points || 0))\r\n            .slice(0, 3);\r\n\r\n          if (nextAchievements.length > 0) {\r\n            const nextList = nextAchievements.map(a => `${a.icon || 'üèÜ'} ${a.name || 'Unknown'} (${a.points || 0} pts)`).join('\\n');\r\n            embed.addFields({\r\n              name: 'üéØ Next Challenges',\r\n              value: nextList.length > 1024 ? nextList.substring(0, 1021) + '...' : nextList,\r\n              inline: false\r\n            });\r\n          }\r\n        }\r\n\r\n        // Add achievement action buttons\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder()\r\n            .setCustomId(`achievements_refresh:${userId}`)\r\n            .setLabel('üîÑ Refresh')\r\n            .setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder()\r\n            .setCustomId(`achievements_leaderboard:${userId}`)\r\n            .setLabel('üèÖ Leaderboard')\r\n            .setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching achievements:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load achievements. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'leaderboard': {\r\n      try {\r\n        const leaderboard = getAchievementLeaderboard(10) || [];\r\n\r\n        if (!Array.isArray(leaderboard) || leaderboard.length === 0) {\r\n          return interaction.reply({\r\n            content: 'üìä No achievement data available yet. Be the first to earn achievements!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const userRank = leaderboard.findIndex(entry => entry && entry.userId === userId) + 1;\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üèÖ Achievement Leaderboard')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**Your Rank:** ${userRank > 0 ? `#${userRank}` : 'Not ranked yet'}`);\r\n\r\n        const leaderboardText = leaderboard.slice(0, 10).map((entry, index) => {\r\n          if (!entry || typeof entry.total_points !== 'number') return null;\r\n          const rank = index + 1;\r\n          const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n          const level = entry.level || 1;\r\n          return `${medal} **#${rank}** - ${entry.total_points} pts (Level ${level})`;\r\n        }).filter(Boolean).join('\\n');\r\n\r\n        if (leaderboardText) {\r\n          embed.addFields({\r\n            name: 'üèÜ Top Achievers',\r\n            value: leaderboardText.length > 1024 ? leaderboardText.substring(0, 1021) + '...' : leaderboardText,\r\n            inline: false\r\n          });\r\n        }\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching leaderboard:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load leaderboard. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'stats': {\r\n      try {\r\n        const userStats = updateUserStats(userId, {}) || { userData: null, newAchievements: [] };\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üìä ${interaction.user.username}'s Statistics`)\r\n          .setColor(0x0099FF)\r\n          .setDescription('Your detailed activity statistics!');\r\n\r\n        // Safely extract stats with defaults\r\n        const stats = {\r\n          commands_used: userStats.userData?.commands_used || 0,\r\n          achievements_earned: Array.isArray(userStats.userData?.achievements) ? userStats.userData.achievements.length : 0,\r\n          achievement_points: userStats.userData?.achievement_points || 0,\r\n          gold_earned: userStats.userData?.gold_earned || 0,\r\n          battles_fought: userStats.userData?.battles_fought || 0,\r\n          games_played: userStats.userData?.games_played || 0,\r\n          member_since: userStats.userData?.member_since ? new Date(userStats.userData.member_since).toLocaleDateString() : 'Unknown',\r\n          level: userStats.userData?.level || 1\r\n        };\r\n\r\n        embed.addFields(\r\n          { name: 'üéÆ Commands Used', value: stats.commands_used.toString(), inline: true },\r\n          { name: 'üèÜ Achievements Earned', value: stats.achievements_earned.toString(), inline: true },\r\n          { name: '‚≠ê Achievement Points', value: stats.achievement_points.toString(), inline: true },\r\n          { name: 'üí∞ Gold Earned', value: stats.gold_earned.toString(), inline: true },\r\n          { name: '‚öîÔ∏è Battles Fought', value: stats.battles_fought.toString(), inline: true },\r\n          { name: 'üéØ Games Played', value: stats.games_played.toString(), inline: true },\r\n          { name: 'üìÖ Member Since', value: stats.member_since, inline: true },\r\n          { name: 'üèÖ Level', value: stats.level.toString(), inline: true }\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching stats:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load statistics. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":38,"column":28,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":38,"endColumn":35,"fix":{"range":[1636,2039],"text":"for (const achievement of userAchievements) {\r\n            if (achievement && achievement.category && typeof achievement.category === 'string') {\r\n              if (!achievementsByCategory[achievement.category]) {\r\n                achievementsByCategory[achievement.category] = [];\r\n              }\r\n              achievementsByCategory[achievement.category].push(achievement);\r\n            }\r\n          }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":57,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":57,"endColumn":29,"fix":{"range":[2672,2680],"text":"0xFF_D7_00"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 145. Maximum allowed is 120.","line":58,"column":1,"nodeType":"Program","messageId":"max","endLine":58,"endColumn":146},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":71,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":71,"endColumn":54},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":73,"column":33,"nodeType":"MemberExpression","endLine":73,"endColumn":57},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":80,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":86,"endColumn":12},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":83,"column":54,"nodeType":"CallExpression","messageId":"substring","endLine":83,"endColumn":88,"fix":{"range":[3839,3848],"text":"slice"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":101,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":108,"endColumn":12},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":105,"column":47,"nodeType":"CallExpression","messageId":"substring","endLine":105,"endColumn":74,"fix":{"range":[4829,4838],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":125,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":125,"endColumn":8,"fix":{"range":[5495,5495],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":126,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":126,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5521,5574],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":133,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":133,"endColumn":6,"fix":{"range":[5759,5759],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":148,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":148,"endColumn":29,"fix":{"range":[6366,6374],"text":"0xFF_D7_00"}},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":149,"column":60,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":149,"endColumn":74},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":152,"column":72,"nodeType":"Literal","messageId":"error","endLine":152,"endColumn":76,"suggestions":[{"messageId":"remove","fix":{"range":[6630,6634],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[6630,6634],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Do not nest ternary expressions.","line":154,"column":65,"nodeType":"ConditionalExpression","messageId":"too-deep","endLine":154,"endColumn":89},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":162,"column":52,"nodeType":"CallExpression","messageId":"substring","endLine":162,"endColumn":86,"fix":{"range":[7103,7112],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":169,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":169,"endColumn":8,"fix":{"range":[7269,7269],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":170,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":170,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7295,7347],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":177,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":177,"endColumn":6,"fix":{"range":[7531,7531],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":179,"column":70,"nodeType":"Literal","messageId":"error","endLine":179,"endColumn":74,"suggestions":[{"messageId":"replace","fix":{"range":[7643,7647],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":183,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":183,"endColumn":29,"fix":{"range":[7806,7814],"text":"0x00_99_FF"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 124. Maximum allowed is 120.","line":189,"column":1,"nodeType":"Program","messageId":"max","endLine":189,"endColumn":125},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":211,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":211,"endColumn":8,"fix":{"range":[9492,9492],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":212,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":212,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9518,9564],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":220,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":220,"endColumn":4,"fix":{"range":[9752,9752],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":221,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":221,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9774,9825],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":229,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":229,"endColumn":6,"fix":{"range":[10089,10089],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":230,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":230,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10118,10175],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":29,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":16,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { getUserAchievements, getAllAchievements, getAchievementLeaderboard, updateUserStats } from '../achievements.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('achievements')\r\n  .setDescription('View achievements, stats, and leaderboards')\r\n  .addSubcommand(sub => sub.setName('view').setDescription('View your achievements'))\r\n  .addSubcommand(sub => sub.setName('leaderboard').setDescription('View achievement leaderboard'))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('View detailed statistics'));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    // Validate interaction object\r\n    if (!interaction || !interaction.user || !interaction.options) {\r\n      throw new Error('Invalid interaction object');\r\n    }\r\n\r\n    const sub = interaction.options.getSubcommand();\r\n    const userId = interaction.user.id;\r\n\r\n    // Validate subcommand\r\n    const validSubcommands = ['view', 'leaderboard', 'stats'];\r\n    if (!validSubcommands.includes(sub)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Invalid subcommand. Please use view, leaderboard, or stats.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    if (sub === 'view') {\r\n      try {\r\n        const userAchievements = getUserAchievements(userId) || [];\r\n        const allAchievements = getAllAchievements() || {};\r\n\r\n        // Group achievements by category with validation\r\n        const achievementsByCategory = {};\r\n        if (Array.isArray(userAchievements)) {\r\n          userAchievements.forEach(achievement => {\r\n            if (achievement && achievement.category && typeof achievement.category === 'string') {\r\n              if (!achievementsByCategory[achievement.category]) {\r\n                achievementsByCategory[achievement.category] = [];\r\n              }\r\n              achievementsByCategory[achievement.category].push(achievement);\r\n            }\r\n          });\r\n        }\r\n\r\n        // Calculate completion stats with safe division\r\n        const totalAchievements = Object.keys(allAchievements).length;\r\n        const earnedCount = Array.isArray(userAchievements) ? userAchievements.length : 0;\r\n        const completionPercentage = totalAchievements > 0 ? Math.round((earnedCount / totalAchievements) * 100) : 0;\r\n        const totalPoints = Array.isArray(userAchievements) ?\r\n          userAchievements.reduce((sum, a) => sum + (a?.points || 0), 0) : 0;\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üèÜ ${interaction.user.username}'s Achievements`)\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**Progress:** ${earnedCount}/${totalAchievements} (${completionPercentage}%)\\n**Achievement Points:** ${totalPoints}`)\r\n          .setThumbnail(interaction.user.displayAvatarURL());\r\n\r\n        // Add category sections with validation\r\n        const categoryEmojis = {\r\n          rpg: 'üéÆ',\r\n          games: 'üéØ',\r\n          social: 'ü§ù',\r\n          special: '‚≠ê',\r\n          fun: 'üé™'\r\n        };\r\n\r\n        for (const [category, achievements] of Object.entries(achievementsByCategory)) {\r\n          if (!Array.isArray(achievements)) continue;\r\n\r\n          const categoryEmoji = categoryEmojis[category] || 'üèÜ';\r\n          const achievementList = achievements\r\n            .filter(a => a && a.icon && a.name && typeof a.points === 'number')\r\n            .sort((a, b) => (b.points || 0) - (a.points || 0))\r\n            .map(a => `${a.icon} **${a.name}** (${a.points} pts)`)\r\n            .join('\\n');\r\n\r\n          if (achievementList) {\r\n            embed.addFields({\r\n              name: `${categoryEmoji} ${category.toUpperCase()} (${achievements.length})`,\r\n              value: achievementList.length > 1024 ? achievementList.substring(0, 1021) + '...' : achievementList,\r\n              inline: false\r\n            });\r\n          }\r\n        }\r\n\r\n        // Add unearned achievements preview with validation\r\n        const allAchievementsArray = Object.values(allAchievements).filter(a => a && a.id);\r\n        const unearnedAchievements = allAchievementsArray.filter(a =>\r\n          !userAchievements.some(ua => ua && ua.id === a.id)\r\n        );\r\n\r\n        if (unearnedAchievements.length > 0) {\r\n          const nextAchievements = unearnedAchievements\r\n            .filter(a => a && typeof a.points === 'number')\r\n            .sort((a, b) => (a.points || 0) - (b.points || 0))\r\n            .slice(0, 3);\r\n\r\n          if (nextAchievements.length > 0) {\r\n            const nextList = nextAchievements.map(a => `${a.icon || 'üèÜ'} ${a.name || 'Unknown'} (${a.points || 0} pts)`).join('\\n');\r\n            embed.addFields({\r\n              name: 'üéØ Next Challenges',\r\n              value: nextList.length > 1024 ? nextList.substring(0, 1021) + '...' : nextList,\r\n              inline: false\r\n            });\r\n          }\r\n        }\r\n\r\n        // Add achievement action buttons\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder()\r\n            .setCustomId(`achievements_refresh:${userId}`)\r\n            .setLabel('üîÑ Refresh')\r\n            .setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder()\r\n            .setCustomId(`achievements_leaderboard:${userId}`)\r\n            .setLabel('üèÖ Leaderboard')\r\n            .setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching achievements:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load achievements. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'leaderboard') {\r\n      try {\r\n        const leaderboard = getAchievementLeaderboard(10) || [];\r\n\r\n        if (!Array.isArray(leaderboard) || leaderboard.length === 0) {\r\n          return interaction.reply({\r\n            content: 'üìä No achievement data available yet. Be the first to earn achievements!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const userRank = leaderboard.findIndex(entry => entry && entry.userId === userId) + 1;\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üèÖ Achievement Leaderboard')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**Your Rank:** ${userRank > 0 ? `#${userRank}` : 'Not ranked yet'}`);\r\n\r\n        const leaderboardText = leaderboard.slice(0, 10).map((entry, index) => {\r\n          if (!entry || typeof entry.total_points !== 'number') return null;\r\n          const rank = index + 1;\r\n          const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n          const level = entry.level || 1;\r\n          return `${medal} **#${rank}** - ${entry.total_points} pts (Level ${level})`;\r\n        }).filter(Boolean).join('\\n');\r\n\r\n        if (leaderboardText) {\r\n          embed.addFields({\r\n            name: 'üèÜ Top Achievers',\r\n            value: leaderboardText.length > 1024 ? leaderboardText.substring(0, 1021) + '...' : leaderboardText,\r\n            inline: false\r\n          });\r\n        }\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching leaderboard:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load leaderboard. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'stats') {\r\n      try {\r\n        const userStats = updateUserStats(userId, {}) || { userData: null, newAchievements: [] };\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üìä ${interaction.user.username}'s Statistics`)\r\n          .setColor(0x0099FF)\r\n          .setDescription('Your detailed activity statistics!');\r\n\r\n        // Safely extract stats with defaults\r\n        const stats = {\r\n          commands_used: userStats.userData?.commands_used || 0,\r\n          achievements_earned: Array.isArray(userStats.userData?.achievements) ? userStats.userData.achievements.length : 0,\r\n          achievement_points: userStats.userData?.achievement_points || 0,\r\n          gold_earned: userStats.userData?.gold_earned || 0,\r\n          battles_fought: userStats.userData?.battles_fought || 0,\r\n          games_played: userStats.userData?.games_played || 0,\r\n          member_since: userStats.userData?.member_since ? new Date(userStats.userData.member_since).toLocaleDateString() : 'Unknown',\r\n          level: userStats.userData?.level || 1\r\n        };\r\n\r\n        embed.addFields(\r\n          { name: 'üéÆ Commands Used', value: stats.commands_used.toString(), inline: true },\r\n          { name: 'üèÜ Achievements Earned', value: stats.achievements_earned.toString(), inline: true },\r\n          { name: '‚≠ê Achievement Points', value: stats.achievement_points.toString(), inline: true },\r\n          { name: 'üí∞ Gold Earned', value: stats.gold_earned.toString(), inline: true },\r\n          { name: '‚öîÔ∏è Battles Fought', value: stats.battles_fought.toString(), inline: true },\r\n          { name: 'üéØ Games Played', value: stats.games_played.toString(), inline: true },\r\n          { name: 'üìÖ Member Since', value: stats.member_since, inline: true },\r\n          { name: 'üèÖ Level', value: stats.level.toString(), inline: true }\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n      } catch (error) {\r\n        console.error('Error fetching stats:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to load statistics. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('Achievement command error:', error);\r\n    try {\r\n      if (interaction && typeof interaction.reply === 'function') {\r\n        await interaction.reply({\r\n          content: '‚ùå An unexpected error occurred. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    } catch (replyError) {\r\n      console.error('Failed to send error reply:', replyError);\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\admin.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":145,"fix":{"range":[144,144],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'checkAutoMod' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (552). Maximum allowed is 100.","line":49,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":600,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (162). Maximum allowed is 30.","line":49,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":600,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 103. Maximum allowed is 20.","line":49,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":600,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 126 to the 15 allowed.","line":49,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":49,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":82,"column":7,"nodeType":null,"messageId":"prefer-switch","endLine":82,"endColumn":27,"fix":{"range":[4403,24940],"text":"switch (sub) {\n      case 'warn': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const severity = interaction.options.getString('severity') || 'medium';\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (!['low', 'medium', 'high'].includes(severity)) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid severity. Must be low, medium, or high.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot warn yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const warning = warnUser(guildId, targetUser.id, interaction.user.id, reason.trim(), severity);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('‚ö†Ô∏è User Warned')\r\n            .setColor(0xFFA500)\r\n            .setDescription(`**${targetUser.username}** has been warned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: 'üö® Severity', value: severity.toUpperCase(), inline: true }\r\n            );\r\n\r\n          // Track moderation achievement\r\n          updateUserStats(interaction.user.id, { moderation_actions: 1 });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n\r\n          // Send DM to warned user if possible\r\n          try {\r\n            await targetUser.send(`‚ö†Ô∏è **Warning from ${interaction.guild.name}:**\\n${reason}`);\r\n          } catch (dmError) {\r\n            console.log('Could not send DM to warned user:', dmError.message);\r\n          }\r\n        } catch (warnError) {\r\n          console.error('Error warning user:', warnError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to warn user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'mute': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const durationMinutes = interaction.options.getInteger('duration') || 60;\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (durationMinutes < 1 || durationMinutes > 1440) { // Max 24 hours\r\n          return interaction.reply({\r\n            content: '‚ùå Duration must be between 1 and 1440 minutes (24 hours).',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot mute yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const durationMs = durationMinutes * 60 * 1000;\r\n          const mute = muteUser(guildId, targetUser.id, interaction.user.id, reason.trim(), durationMs);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üîá User Muted')\r\n            .setColor(0xFF6B6B)\r\n            .setDescription(`**${targetUser.username}** has been muted for ${durationMinutes} minutes.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: '‚è∞ Duration', value: `${durationMinutes} minutes`, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (muteError) {\r\n          console.error('Error muting user:', muteError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to mute user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'unmute': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason') || 'Manual unmute';\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const { unmuteUser } = await import('../moderation.js');\r\n          const result = unmuteUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          if (!result) {\r\n            return interaction.reply({\r\n              content: '‚ùå User is not currently muted.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üîä User Unmuted')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`**${targetUser.username}** has been unmuted.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (unmuteError) {\r\n          console.error('Error unmuting user:', unmuteError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to unmute user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'ban': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const durationHours = interaction.options.getInteger('duration');\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (durationHours !== null && (durationHours < 1 || durationHours > 168)) { // Max 1 week\r\n          return interaction.reply({\r\n            content: '‚ùå Duration must be between 1 and 168 hours (1 week) or leave empty for permanent.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot ban yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const durationMs = durationHours ? durationHours * 60 * 60 * 1000 : null;\r\n          const ban = banUser(guildId, targetUser.id, interaction.user.id, reason.trim(), durationMs);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üî® User Banned')\r\n            .setColor(0xFF0000)\r\n            .setDescription(`**${targetUser.username}** has been ${durationMs ? 'temporarily ' : 'permanently '}banned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: '‚è∞ Duration', value: durationMs ? `${durationHours} hours` : 'Permanent', inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (banError) {\r\n          console.error('Error banning user:', banError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to ban user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'unban': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason') || 'Manual unban';\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const { unbanUser } = await import('../moderation.js');\r\n          const result = unbanUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          if (!result) {\r\n            return interaction.reply({\r\n              content: '‚ùå User is not currently banned.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('‚úÖ User Unbanned')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`**${targetUser.username}** has been unbanned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (unbanError) {\r\n          console.error('Error unbanning user:', unbanError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to unban user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'kick': {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot kick yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const kick = kickUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üë¢ User Kicked')\r\n            .setColor(0xFF8C00)\r\n            .setDescription(`**${targetUser.username}** has been kicked from the server.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (kickError) {\r\n          console.error('Error kicking user:', kickError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to kick user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'check': {\r\n        const targetUser = interaction.options.getUser('user');\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const warnings = getUserWarnings(guildId, targetUser.id) || [];\r\n          const modStats = getUserModStats(guildId, targetUser.id) || {\r\n            risk_level: 'low',\r\n            warnings: 0,\r\n            kicks: 0,\r\n            mutes: 0,\r\n            bans: 0,\r\n            total_actions: 0\r\n          };\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle(`üîç Moderation Check - ${targetUser.username}`)\r\n            .setColor(modStats.risk_level === 'critical' ? 0xFF0000 :\r\n                     modStats.risk_level === 'high' ? 0xFFA500 :\r\n                     modStats.risk_level === 'medium' ? 0xFFFF00 : 0x00FF00)\r\n            .setThumbnail(targetUser.displayAvatarURL())\r\n            .setDescription(`**Risk Level:** ${modStats.risk_level.toUpperCase()}`)\r\n            .addFields(\r\n              { name: '‚ö†Ô∏è Warnings', value: String(modStats.warnings || 0), inline: true },\r\n              { name: 'üë¢ Kicks', value: String(modStats.kicks || 0), inline: true },\r\n              { name: 'üîá Mutes', value: String(modStats.mutes || 0), inline: true },\r\n              { name: 'üî® Bans', value: String(modStats.bans || 0), inline: true },\r\n              { name: 'üìä Total Actions', value: String(modStats.total_actions || 0), inline: true }\r\n            );\r\n\r\n          if (Array.isArray(warnings) && warnings.length > 0) {\r\n            const recentWarnings = warnings.filter(w => w && w.active).slice(0, 3);\r\n            if (recentWarnings.length > 0) {\r\n              const warningList = recentWarnings.map(w =>\r\n                `‚ö†Ô∏è **${(w.severity || 'medium').toUpperCase()}** - ${w.reason || 'No reason'} (${w.timestamp ? new Date(w.timestamp).toLocaleDateString() : 'Unknown date'})`\r\n              ).join('\\n');\r\n\r\n              embed.addFields({\r\n                name: 'üìã Recent Warnings',\r\n                value: warningList.length > 1024 ? warningList.substring(0, 1021) + '...' : warningList,\r\n                inline: false\r\n              });\r\n            }\r\n          }\r\n\r\n          // Add action buttons based on current status\r\n          const row = new ActionRowBuilder();\r\n          try {\r\n            const { isUserMuted, isUserBanned } = await import('../moderation.js');\r\n\r\n            if (isUserMuted(guildId, targetUser.id)) {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_unmute:${targetUser.id}:${guildId}`)\r\n                .setLabel('üîä Unmute')\r\n                .setStyle(ButtonStyle.Success));\r\n            } else {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_warn:${targetUser.id}:${guildId}`)\r\n                .setLabel('‚ö†Ô∏è Warn')\r\n                .setStyle(ButtonStyle.Secondary));\r\n            }\r\n\r\n            if (isUserBanned(guildId, targetUser.id)) {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_unban:${targetUser.id}:${guildId}`)\r\n                .setLabel('‚úÖ Unban')\r\n                .setStyle(ButtonStyle.Success));\r\n            } else {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_mute:${targetUser.id}:${guildId}`)\r\n                .setLabel('üîá Mute')\r\n                .setStyle(ButtonStyle.Danger));\r\n            }\r\n          } catch (importError) {\r\n            console.error('Error importing moderation functions:', importError);\r\n          }\r\n\r\n          await interaction.reply({ embeds: [embed], components: row.components.length > 0 ? [row] : [] });\r\n        } catch (checkError) {\r\n          console.error('Error checking user moderation status:', checkError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to check user moderation status. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'history': {\r\n        const limit = interaction.options.getInteger('limit') || 20;\r\n\r\n        // Validate inputs\r\n        if (limit < 1 || limit > 100) {\r\n          return interaction.reply({\r\n            content: '‚ùå Limit must be between 1 and 100.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const modActions = getModActions(guildId, limit) || [];\r\n\r\n          if (!Array.isArray(modActions) || modActions.length === 0) {\r\n            return interaction.reply({\r\n              content: 'üìã No moderation actions found.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üìã Moderation History')\r\n            .setColor(0x0099FF)\r\n            .setDescription(`Recent ${modActions.length} moderation actions`);\r\n\r\n          modActions.slice(0, 10).forEach((action, index) => { // Limit to 10 to avoid embed size limits\r\n            if (!action) return;\r\n            const timestamp = action.timestamp ? new Date(action.timestamp).toLocaleString() : 'Unknown';\r\n            const actionEmoji = {\r\n              warn: '‚ö†Ô∏è',\r\n              mute: 'üîá',\r\n              unmute: 'üîä',\r\n              ban: 'üî®',\r\n              unban: '‚úÖ',\r\n              kick: 'üë¢'\r\n            }[action.action] || 'üìù';\r\n\r\n            embed.addFields({\r\n              name: `${actionEmoji} ${action.action ? action.action.toUpperCase() : 'UNKNOWN'} #${index + 1}`,\r\n              value: `**Target:** <@${action.targetUserId || 'Unknown'}>\\n**Moderator:** <@${action.moderatorId || 'Unknown'}>\\n**Reason:** ${action.reason || 'No reason'}\\n**Time:** ${timestamp}`,\r\n              inline: false\r\n            });\r\n          });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (historyError) {\r\n          console.error('Error fetching moderation history:', historyError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to fetch moderation history. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      \n      break;\n      }\n      case 'stats': {\r\n        try {\r\n          const modActions = getModActions(guildId, 100) || [];\r\n\r\n          // Calculate statistics safely\r\n          const actionCounts = {};\r\n          const modCounts = {};\r\n          let totalActions = 0;\r\n\r\n          if (Array.isArray(modActions)) {\r\n            modActions.forEach(action => {\r\n              if (!action) return;\r\n              const actionType = action.action || 'unknown';\r\n              actionCounts[actionType] = (actionCounts[actionType] || 0) + 1;\r\n              if (action.moderatorId) {\r\n                modCounts[action.moderatorId] = (modCounts[action.moderatorId] || 0) + 1;\r\n              }\r\n              totalActions++;\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üìä Server Moderation Statistics')\r\n            .setColor(0x0099FF)\r\n            .setDescription(`Analysis of moderation activities in ${interaction.guild?.name || 'Unknown Server'}`)\r\n            .addFields(\r\n              { name: 'üìà Total Actions', value: totalActions.toString(), inline: true },\r\n              { name: 'üìÖ Period', value: 'Last 100 actions', inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Active Moderators', value: Object.keys(modCounts).length.toString(), inline: true }\r\n            );\r\n\r\n          // Action breakdown\r\n          const actionBreakdown = Object.entries(actionCounts)\r\n            .map(([action, count]) => `${action}: ${count}`)\r\n            .join('\\n');\r\n\r\n          embed.addFields({\r\n            name: 'üìã Action Breakdown',\r\n            value: actionBreakdown || 'No actions',\r\n            inline: false\r\n          });\r\n\r\n          // Top moderators\r\n          const topMods = Object.entries(modCounts)\r\n            .sort(([,a], [,b]) => b - a)\r\n            .slice(0, 5)\r\n            .map(([modId, count]) => `<@${modId}>: ${count} actions`)\r\n            .join('\\n');\r\n\r\n          embed.addFields({\r\n            name: 'üèÜ Top Moderators',\r\n            value: topMods || 'No moderators',\r\n            inline: false\r\n          });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (statsError) {\r\n          console.error('Error fetching moderation statistics:', statsError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to fetch moderation statistics. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n      \n      break;\n      }\n      // No default\n      }"}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 4 times.","line":90,"column":22,"nodeType":"Literal","endLine":90,"endColumn":58},{"ruleId":"no-unused-vars","severity":1,"message":"'warning' is assigned a value but never used.","line":110,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":24},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":114,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":114,"endColumn":31,"fix":{"range":[5598,5606],"text":"0xFF_A5_00"}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 6 times.","line":118,"column":23,"nodeType":"Literal","endLine":118,"endColumn":40},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":119,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":119,"endColumn":91,"fix":{"range":[5956,5965],"text":"slice"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":129,"column":11,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":133,"endColumn":12},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":131,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":131,"endColumn":12,"fix":{"range":[6466,6466],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":132,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":132,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[6498,6564],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":134,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":134,"endColumn":10,"fix":{"range":[6588,6588],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":135,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":135,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6620,6668],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":142,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":142,"endColumn":8,"fix":{"range":[6851,6851],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'mute' is assigned a value but never used.","line":171,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":21},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":175,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":175,"endColumn":31,"fix":{"range":[8135,8143],"text":"0xFF_6B_6B"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":180,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":180,"endColumn":91,"fix":{"range":[8523,8532],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":185,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":185,"endColumn":10,"fix":{"range":[8750,8750],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":186,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":186,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8782,8829],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":193,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":193,"endColumn":8,"fix":{"range":[9012,9012],"text":"\n"}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":200,"column":22,"nodeType":"Literal","endLine":200,"endColumn":48},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":209,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":214,"endColumn":12},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":218,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":218,"endColumn":31,"fix":{"range":[9901,9909],"text":"0x00_FF_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":223,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":223,"endColumn":91,"fix":{"range":[10260,10269],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":227,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":227,"endColumn":10,"fix":{"range":[10397,10397],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":228,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":228,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10431,10482],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":235,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":235,"endColumn":8,"fix":{"range":[10667,10667],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":263,"column":79,"nodeType":"Literal","messageId":"error","endLine":263,"endColumn":83,"suggestions":[{"messageId":"replace","fix":{"range":[11791,11795],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'ban' is assigned a value but never used.","line":264,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":20},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":268,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":268,"endColumn":31,"fix":{"range":[12011,12019],"text":"0xFF_00_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":273,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":273,"endColumn":91,"fix":{"range":[12416,12425],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":278,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":278,"endColumn":10,"fix":{"range":[12666,12666],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":279,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":279,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[12697,12744],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":286,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":286,"endColumn":8,"fix":{"range":[12926,12926],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (600). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":600,"endColumn":2},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":302,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":307,"endColumn":12},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":311,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":311,"endColumn":31,"fix":{"range":[13812,13820],"text":"0x00_FF_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":316,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":316,"endColumn":91,"fix":{"range":[14172,14181],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":320,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":320,"endColumn":10,"fix":{"range":[14309,14309],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":321,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":321,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[14342,14393],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":328,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":328,"endColumn":8,"fix":{"range":[14577,14577],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'kick' is assigned a value but never used.","line":348,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":348,"endColumn":21},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":352,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":352,"endColumn":31,"fix":{"range":[15438,15446],"text":"0xFF_8C_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":357,"column":66,"nodeType":"CallExpression","messageId":"substring","endLine":357,"endColumn":91,"fix":{"range":[15812,15821],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":361,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":361,"endColumn":10,"fix":{"range":[15949,15949],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":362,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":362,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15981,16029],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":369,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":369,"endColumn":8,"fix":{"range":[16212,16212],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":393,"column":60,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":393,"endColumn":68,"fix":{"range":[17033,17041],"text":"0xFF_00_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 21.","line":394,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":394,"endColumn":22,"fix":{"range":[17045,17066],"text":"              "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":394,"column":55,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":394,"endColumn":63,"fix":{"range":[17099,17107],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 21.","line":395,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":395,"endColumn":22,"fix":{"range":[17111,17132],"text":"                "}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Do not nest ternary expressions.","line":395,"column":22,"nodeType":"ConditionalExpression","messageId":"too-deep","endLine":395,"endColumn":76},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":395,"column":57,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":395,"endColumn":65,"fix":{"range":[17167,17175],"text":"0xFF_FF_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":395,"column":68,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":395,"endColumn":76,"fix":{"range":[17178,17186],"text":"0x00_FF_00"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":406,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":419,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":408,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":418,"endColumn":14},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":415,"column":52,"nodeType":"CallExpression","messageId":"substring","endLine":415,"endColumn":82,"fix":{"range":[18432,18441],"text":"slice"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":423,"column":11,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":451,"endColumn":12},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":426,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":436,"endColumn":14},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":431,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":431,"endColumn":14,"fix":{"range":[19049,19049],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":438,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":448,"endColumn":14},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":443,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":443,"endColumn":14,"fix":{"range":[19574,19574],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":449,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":449,"endColumn":12,"fix":{"range":[19821,19821],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":450,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":450,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[19857,19925],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":454,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":454,"endColumn":10,"fix":{"range":[20060,20060],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":455,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":455,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[20093,20161],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":462,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":462,"endColumn":8,"fix":{"range":[20363,20363],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":476,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":481,"endColumn":12},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":485,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":485,"endColumn":31,"fix":{"range":[21151,21159],"text":"0x00_99_FF"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":488,"column":35,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":488,"endColumn":42,"fix":{"range":[21254,22130],"text":"for (const [index, action] of modActions.slice(0, 10).entries()) { // Limit to 10 to avoid embed size limits\r\n            if (!action) continue;\r\n            const timestamp = action.timestamp ? new Date(action.timestamp).toLocaleString() : 'Unknown';\r\n            const actionEmoji = {\r\n              warn: '‚ö†Ô∏è',\r\n              mute: 'üîá',\r\n              unmute: 'üîä',\r\n              ban: 'üî®',\r\n              unban: '‚úÖ',\r\n              kick: 'üë¢'\r\n            }[action.action] || 'üìù';\r\n\r\n            embed.addFields({\r\n              name: `${actionEmoji} ${action.action ? action.action.toUpperCase() : 'UNKNOWN'} #${index + 1}`,\r\n              value: `**Target:** <@${action.targetUserId || 'Unknown'}>\\n**Moderator:** <@${action.moderatorId || 'Unknown'}>\\n**Reason:** ${action.reason || 'No reason'}\\n**Time:** ${timestamp}`,\r\n              inline: false\r\n            });\r\n          }"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":508,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":508,"endColumn":10,"fix":{"range":[22200,22200],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":509,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":509,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[22235,22301],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":516,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":516,"endColumn":8,"fix":{"range":[22499,22499],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":525,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":535,"endColumn":12},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":526,"column":24,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":526,"endColumn":31,"fix":{"range":[22813,23217],"text":"for (const action of modActions) {\r\n              if (!action) continue;\r\n              const actionType = action.action || 'unknown';\r\n              actionCounts[actionType] = (actionCounts[actionType] || 0) + 1;\r\n              if (action.moderatorId) {\r\n                modCounts[action.moderatorId] = (modCounts[action.moderatorId] || 0) + 1;\r\n              }\r\n              totalActions++;\r\n            }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":529,"column":15,"nodeType":"MemberExpression","endLine":529,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":529,"column":43,"nodeType":"MemberExpression","endLine":529,"endColumn":67},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":539,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":539,"endColumn":31,"fix":{"range":[23358,23366],"text":"0x00_99_FF"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":572,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":572,"endColumn":10,"fix":{"range":[24641,24641],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":573,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":573,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[24674,24741],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":580,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":580,"endColumn":6,"fix":{"range":[24947,24947],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":581,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":581,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[24981,25051],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":587,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":587,"endColumn":4,"fix":{"range":[25242,25242],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":588,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":588,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[25264,25309],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":596,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":596,"endColumn":6,"fix":{"range":[25608,25608],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":597,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":597,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[25637,25694],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":65,"fatalErrorCount":0,"warningCount":27,"fixableErrorCount":49,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, PermissionFlagsBits, MessageFlags } from 'discord.js';\r\nimport {\r\n  warnUser,\r\n  muteUser,\r\n  banUser,\r\n  kickUser,\r\n  getUserWarnings,\r\n  getModActions,\r\n  getUserModStats,\r\n  checkAutoMod\r\n} from '../moderation.js';\r\nimport { updateUserStats } from '../achievements.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('admin')\r\n  .setDescription('Advanced server administration and moderation tools')\r\n  .setDefaultMemberPermissions(PermissionFlagsBits.Administrator)\r\n  .addSubcommand(sub => sub.setName('warn').setDescription('Warn a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to warn').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Warning reason').setRequired(true))\r\n    .addStringOption(opt => opt.setName('severity').setDescription('Warning severity').addChoices(\r\n      { name: 'Low', value: 'low' },\r\n      { name: 'Medium', value: 'medium' },\r\n      { name: 'High', value: 'high' }\r\n    ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('mute').setDescription('Mute a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to mute').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Mute reason').setRequired(true))\r\n    .addIntegerOption(opt => opt.setName('duration').setDescription('Duration in minutes').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('unmute').setDescription('Unmute a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to unmute').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Unmute reason').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('ban').setDescription('Ban a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to ban').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Ban reason').setRequired(true))\r\n    .addIntegerOption(opt => opt.setName('duration').setDescription('Duration in hours (leave empty for permanent)').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('unban').setDescription('Unban a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to unban').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Unban reason').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('kick').setDescription('Kick a user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to kick').setRequired(true))\r\n    .addStringOption(opt => opt.setName('reason').setDescription('Kick reason').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('check').setDescription('Check user moderation status')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to check').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('history').setDescription('View moderation history')\r\n    .addIntegerOption(opt => opt.setName('limit').setDescription('Number of actions to show').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('View server moderation statistics'));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    // Validate interaction object\r\n    if (!interaction || !interaction.member || !interaction.user || !interaction.guild || !interaction.options) {\r\n      throw new Error('Invalid interaction object');\r\n    }\r\n\r\n    // Check if user has administrator permissions\r\n    if (!interaction.member.permissions.has(PermissionFlagsBits.Administrator)) {\r\n      return interaction.reply({\r\n        content: '‚ùå You need Administrator permissions to use this command.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const sub = interaction.options.getSubcommand();\r\n    const guildId = interaction.guild.id;\r\n\r\n    // Validate subcommand\r\n    const validSubcommands = ['warn', 'mute', 'unmute', 'ban', 'unban', 'kick', 'check', 'history', 'stats'];\r\n    if (!validSubcommands.includes(sub)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Invalid subcommand. Please use a valid admin subcommand.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Validate guild ID\r\n    if (!guildId || typeof guildId !== 'string') {\r\n      throw new Error('Invalid guild ID');\r\n    }\r\n\r\n    try {\r\n      if (sub === 'warn') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const severity = interaction.options.getString('severity') || 'medium';\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (!['low', 'medium', 'high'].includes(severity)) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid severity. Must be low, medium, or high.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot warn yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const warning = warnUser(guildId, targetUser.id, interaction.user.id, reason.trim(), severity);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('‚ö†Ô∏è User Warned')\r\n            .setColor(0xFFA500)\r\n            .setDescription(`**${targetUser.username}** has been warned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: 'üö® Severity', value: severity.toUpperCase(), inline: true }\r\n            );\r\n\r\n          // Track moderation achievement\r\n          updateUserStats(interaction.user.id, { moderation_actions: 1 });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n\r\n          // Send DM to warned user if possible\r\n          try {\r\n            await targetUser.send(`‚ö†Ô∏è **Warning from ${interaction.guild.name}:**\\n${reason}`);\r\n          } catch (dmError) {\r\n            console.log('Could not send DM to warned user:', dmError.message);\r\n          }\r\n        } catch (warnError) {\r\n          console.error('Error warning user:', warnError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to warn user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'mute') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const durationMinutes = interaction.options.getInteger('duration') || 60;\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (durationMinutes < 1 || durationMinutes > 1440) { // Max 24 hours\r\n          return interaction.reply({\r\n            content: '‚ùå Duration must be between 1 and 1440 minutes (24 hours).',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot mute yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const durationMs = durationMinutes * 60 * 1000;\r\n          const mute = muteUser(guildId, targetUser.id, interaction.user.id, reason.trim(), durationMs);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üîá User Muted')\r\n            .setColor(0xFF6B6B)\r\n            .setDescription(`**${targetUser.username}** has been muted for ${durationMinutes} minutes.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: '‚è∞ Duration', value: `${durationMinutes} minutes`, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (muteError) {\r\n          console.error('Error muting user:', muteError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to mute user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'unmute') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason') || 'Manual unmute';\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const { unmuteUser } = await import('../moderation.js');\r\n          const result = unmuteUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          if (!result) {\r\n            return interaction.reply({\r\n              content: '‚ùå User is not currently muted.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üîä User Unmuted')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`**${targetUser.username}** has been unmuted.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (unmuteError) {\r\n          console.error('Error unmuting user:', unmuteError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to unmute user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'ban') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n        const durationHours = interaction.options.getInteger('duration');\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (durationHours !== null && (durationHours < 1 || durationHours > 168)) { // Max 1 week\r\n          return interaction.reply({\r\n            content: '‚ùå Duration must be between 1 and 168 hours (1 week) or leave empty for permanent.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot ban yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const durationMs = durationHours ? durationHours * 60 * 60 * 1000 : null;\r\n          const ban = banUser(guildId, targetUser.id, interaction.user.id, reason.trim(), durationMs);\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üî® User Banned')\r\n            .setColor(0xFF0000)\r\n            .setDescription(`**${targetUser.username}** has been ${durationMs ? 'temporarily ' : 'permanently '}banned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true },\r\n              { name: '‚è∞ Duration', value: durationMs ? `${durationHours} hours` : 'Permanent', inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (banError) {\r\n          console.error('Error banning user:', banError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to ban user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'unban') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason') || 'Manual unban';\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const { unbanUser } = await import('../moderation.js');\r\n          const result = unbanUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          if (!result) {\r\n            return interaction.reply({\r\n              content: '‚ùå User is not currently banned.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('‚úÖ User Unbanned')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`**${targetUser.username}** has been unbanned.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (unbanError) {\r\n          console.error('Error unbanning user:', unbanError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to unban user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'kick') {\r\n        const targetUser = interaction.options.getUser('user');\r\n        const reason = interaction.options.getString('reason');\r\n\r\n        // Validate inputs\r\n        if (!targetUser || !reason || reason.trim().length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user or reason provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (targetUser.id === interaction.user.id) {\r\n          return interaction.reply({\r\n            content: '‚ùå You cannot kick yourself!',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const kick = kickUser(guildId, targetUser.id, interaction.user.id, reason.trim());\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üë¢ User Kicked')\r\n            .setColor(0xFF8C00)\r\n            .setDescription(`**${targetUser.username}** has been kicked from the server.`)\r\n            .addFields(\r\n              { name: 'üë§ User', value: `<@${targetUser.id}>`, inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Moderator', value: `<@${interaction.user.id}>`, inline: true },\r\n              { name: 'üìã Reason', value: reason.length > 1024 ? reason.substring(0, 1021) + '...' : reason, inline: true }\r\n            );\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (kickError) {\r\n          console.error('Error kicking user:', kickError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to kick user. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'check') {\r\n        const targetUser = interaction.options.getUser('user');\r\n\r\n        // Validate inputs\r\n        if (!targetUser) {\r\n          return interaction.reply({\r\n            content: '‚ùå Invalid user provided.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const warnings = getUserWarnings(guildId, targetUser.id) || [];\r\n          const modStats = getUserModStats(guildId, targetUser.id) || {\r\n            risk_level: 'low',\r\n            warnings: 0,\r\n            kicks: 0,\r\n            mutes: 0,\r\n            bans: 0,\r\n            total_actions: 0\r\n          };\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle(`üîç Moderation Check - ${targetUser.username}`)\r\n            .setColor(modStats.risk_level === 'critical' ? 0xFF0000 :\r\n                     modStats.risk_level === 'high' ? 0xFFA500 :\r\n                     modStats.risk_level === 'medium' ? 0xFFFF00 : 0x00FF00)\r\n            .setThumbnail(targetUser.displayAvatarURL())\r\n            .setDescription(`**Risk Level:** ${modStats.risk_level.toUpperCase()}`)\r\n            .addFields(\r\n              { name: '‚ö†Ô∏è Warnings', value: String(modStats.warnings || 0), inline: true },\r\n              { name: 'üë¢ Kicks', value: String(modStats.kicks || 0), inline: true },\r\n              { name: 'üîá Mutes', value: String(modStats.mutes || 0), inline: true },\r\n              { name: 'üî® Bans', value: String(modStats.bans || 0), inline: true },\r\n              { name: 'üìä Total Actions', value: String(modStats.total_actions || 0), inline: true }\r\n            );\r\n\r\n          if (Array.isArray(warnings) && warnings.length > 0) {\r\n            const recentWarnings = warnings.filter(w => w && w.active).slice(0, 3);\r\n            if (recentWarnings.length > 0) {\r\n              const warningList = recentWarnings.map(w =>\r\n                `‚ö†Ô∏è **${(w.severity || 'medium').toUpperCase()}** - ${w.reason || 'No reason'} (${w.timestamp ? new Date(w.timestamp).toLocaleDateString() : 'Unknown date'})`\r\n              ).join('\\n');\r\n\r\n              embed.addFields({\r\n                name: 'üìã Recent Warnings',\r\n                value: warningList.length > 1024 ? warningList.substring(0, 1021) + '...' : warningList,\r\n                inline: false\r\n              });\r\n            }\r\n          }\r\n\r\n          // Add action buttons based on current status\r\n          const row = new ActionRowBuilder();\r\n          try {\r\n            const { isUserMuted, isUserBanned } = await import('../moderation.js');\r\n\r\n            if (isUserMuted(guildId, targetUser.id)) {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_unmute:${targetUser.id}:${guildId}`)\r\n                .setLabel('üîä Unmute')\r\n                .setStyle(ButtonStyle.Success));\r\n            } else {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_warn:${targetUser.id}:${guildId}`)\r\n                .setLabel('‚ö†Ô∏è Warn')\r\n                .setStyle(ButtonStyle.Secondary));\r\n            }\r\n\r\n            if (isUserBanned(guildId, targetUser.id)) {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_unban:${targetUser.id}:${guildId}`)\r\n                .setLabel('‚úÖ Unban')\r\n                .setStyle(ButtonStyle.Success));\r\n            } else {\r\n              row.addComponents(new ButtonBuilder()\r\n                .setCustomId(`admin_mute:${targetUser.id}:${guildId}`)\r\n                .setLabel('üîá Mute')\r\n                .setStyle(ButtonStyle.Danger));\r\n            }\r\n          } catch (importError) {\r\n            console.error('Error importing moderation functions:', importError);\r\n          }\r\n\r\n          await interaction.reply({ embeds: [embed], components: row.components.length > 0 ? [row] : [] });\r\n        } catch (checkError) {\r\n          console.error('Error checking user moderation status:', checkError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to check user moderation status. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'history') {\r\n        const limit = interaction.options.getInteger('limit') || 20;\r\n\r\n        // Validate inputs\r\n        if (limit < 1 || limit > 100) {\r\n          return interaction.reply({\r\n            content: '‚ùå Limit must be between 1 and 100.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        try {\r\n          const modActions = getModActions(guildId, limit) || [];\r\n\r\n          if (!Array.isArray(modActions) || modActions.length === 0) {\r\n            return interaction.reply({\r\n              content: 'üìã No moderation actions found.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üìã Moderation History')\r\n            .setColor(0x0099FF)\r\n            .setDescription(`Recent ${modActions.length} moderation actions`);\r\n\r\n          modActions.slice(0, 10).forEach((action, index) => { // Limit to 10 to avoid embed size limits\r\n            if (!action) return;\r\n            const timestamp = action.timestamp ? new Date(action.timestamp).toLocaleString() : 'Unknown';\r\n            const actionEmoji = {\r\n              warn: '‚ö†Ô∏è',\r\n              mute: 'üîá',\r\n              unmute: 'üîä',\r\n              ban: 'üî®',\r\n              unban: '‚úÖ',\r\n              kick: 'üë¢'\r\n            }[action.action] || 'üìù';\r\n\r\n            embed.addFields({\r\n              name: `${actionEmoji} ${action.action ? action.action.toUpperCase() : 'UNKNOWN'} #${index + 1}`,\r\n              value: `**Target:** <@${action.targetUserId || 'Unknown'}>\\n**Moderator:** <@${action.moderatorId || 'Unknown'}>\\n**Reason:** ${action.reason || 'No reason'}\\n**Time:** ${timestamp}`,\r\n              inline: false\r\n            });\r\n          });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (historyError) {\r\n          console.error('Error fetching moderation history:', historyError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to fetch moderation history. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n      } else if (sub === 'stats') {\r\n        try {\r\n          const modActions = getModActions(guildId, 100) || [];\r\n\r\n          // Calculate statistics safely\r\n          const actionCounts = {};\r\n          const modCounts = {};\r\n          let totalActions = 0;\r\n\r\n          if (Array.isArray(modActions)) {\r\n            modActions.forEach(action => {\r\n              if (!action) return;\r\n              const actionType = action.action || 'unknown';\r\n              actionCounts[actionType] = (actionCounts[actionType] || 0) + 1;\r\n              if (action.moderatorId) {\r\n                modCounts[action.moderatorId] = (modCounts[action.moderatorId] || 0) + 1;\r\n              }\r\n              totalActions++;\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üìä Server Moderation Statistics')\r\n            .setColor(0x0099FF)\r\n            .setDescription(`Analysis of moderation activities in ${interaction.guild?.name || 'Unknown Server'}`)\r\n            .addFields(\r\n              { name: 'üìà Total Actions', value: totalActions.toString(), inline: true },\r\n              { name: 'üìÖ Period', value: 'Last 100 actions', inline: true },\r\n              { name: 'üëÆ‚Äç‚ôÇÔ∏è Active Moderators', value: Object.keys(modCounts).length.toString(), inline: true }\r\n            );\r\n\r\n          // Action breakdown\r\n          const actionBreakdown = Object.entries(actionCounts)\r\n            .map(([action, count]) => `${action}: ${count}`)\r\n            .join('\\n');\r\n\r\n          embed.addFields({\r\n            name: 'üìã Action Breakdown',\r\n            value: actionBreakdown || 'No actions',\r\n            inline: false\r\n          });\r\n\r\n          // Top moderators\r\n          const topMods = Object.entries(modCounts)\r\n            .sort(([,a], [,b]) => b - a)\r\n            .slice(0, 5)\r\n            .map(([modId, count]) => `<@${modId}>: ${count} actions`)\r\n            .join('\\n');\r\n\r\n          embed.addFields({\r\n            name: 'üèÜ Top Moderators',\r\n            value: topMods || 'No moderators',\r\n            inline: false\r\n          });\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } catch (statsError) {\r\n          console.error('Error fetching moderation statistics:', statsError);\r\n          await interaction.reply({\r\n            content: '‚ùå Failed to fetch moderation statistics. Please try again.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n      }\r\n    } catch (subcommandError) {\r\n      console.error(`Error processing ${sub} subcommand:`, subcommandError);\r\n      await interaction.reply({\r\n        content: `‚ùå An error occurred while processing the ${sub} command. Please try again.`,\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('Admin command error:', error);\r\n    try {\r\n      if (interaction && typeof interaction.reply === 'function') {\r\n        await interaction.reply({\r\n          content: '‚ùå An unexpected error occurred while processing the admin command. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    } catch (replyError) {\r\n      console.error('Failed to send error reply:', replyError);\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\ai.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (464). Maximum allowed is 100.","line":40,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":503,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (147). Maximum allowed is 30.","line":40,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":503,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 86. Maximum allowed is 20.","line":40,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":503,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 111 to the 15 allowed.","line":40,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":40,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":58,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":58,"endColumn":25,"fix":{"range":[3780,18895],"text":"switch (sub) {\n    case 'chat': {\r\n      const message = interaction.options.getString('message');\r\n      const model = interaction.options.getString('model') || 'helpful';\r\n      const personality = interaction.options.getString('personality') || 'friendly';\r\n\r\n      // Validate inputs\r\n      if (!message || message.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a message to send to the AI.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (message.length > 2000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Message is too long. Please keep it under 2000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const validModels = ['creative', 'technical', 'helpful', 'funny', 'educational'];\r\n      if (!validModels.includes(model)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid model. Please choose from: creative, technical, helpful, funny, educational.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const validPersonalities = ['professional', 'friendly', 'energetic', 'wise'];\r\n      if (!validPersonalities.includes(personality)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid personality. Please choose from: professional, friendly, energetic, wise.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const response = await generateResponse(interaction.user.id, message.trim(), {\r\n          model,\r\n          personality,\r\n          guildId: interaction.guild?.id\r\n        });\r\n\r\n        if (!response || typeof response !== 'string') {\r\n          throw new Error('Invalid AI response');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`ü§ñ ${model.charAt(0).toUpperCase() + model.slice(1)} AI Response`)\r\n          .setColor(0x0099FF)\r\n          .setDescription(response.length > 4000 ? response.substring(0, 3997) + '...' : response)\r\n          .addFields(\r\n            { name: 'Model', value: model, inline: true },\r\n            { name: 'Personality', value: personality, inline: true }\r\n          );\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder()\r\n            .setCustomId(`ai_chat:${model}:${personality}:${interaction.user.id}`)\r\n            .setLabel('üí¨ Continue Chat')\r\n            .setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder()\r\n            .setCustomId(`ai_clear:${interaction.user.id}`)\r\n            .setLabel('üóëÔ∏è Clear History')\r\n            .setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } catch (error) {\r\n        console.error('AI chat error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate AI response. Please try again.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'analyze': {\r\n      const text = interaction.options.getString('text');\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to analyze.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too long. Please keep it under 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const sentiment = await analyzeSentiment(text.trim());\r\n\r\n        if (!sentiment || !['positive', 'negative', 'neutral'].includes(sentiment)) {\r\n          throw new Error('Invalid sentiment result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üìä Sentiment Analysis')\r\n          .setColor(sentiment === 'positive' ? 0x00FF00 : sentiment === 'negative' ? 0xFF0000 : 0xFFFF00)\r\n          .setDescription(`**Text:** ${text.length > 500 ? text.substring(0, 497) + '...' : text}`)\r\n          .addFields({\r\n            name: 'Sentiment',\r\n            value: sentiment.toUpperCase(),\r\n            inline: false\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Sentiment analysis error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to analyze sentiment.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'summarize': {\r\n      const text = interaction.options.getString('text');\r\n      const maxLength = interaction.options.getInteger('length') || 200;\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to summarize.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length < 50) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too short to summarize. Please provide at least 50 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (maxLength < 50 || maxLength > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Summary length must be between 50 and 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const summary = await generateSummary(text.trim(), maxLength);\r\n\r\n        if (!summary || typeof summary !== 'string') {\r\n          throw new Error('Invalid summary result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üìù Text Summary')\r\n          .setColor(0x9932CC)\r\n          .setDescription(summary.length > 4000 ? summary.substring(0, 3997) + '...' : summary)\r\n          .addFields({\r\n            name: 'Original Length',\r\n            value: `${text.length} characters`,\r\n            inline: true\r\n          }, {\r\n            name: 'Summary Length',\r\n            value: `${summary.length} characters`,\r\n            inline: true\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Summarization error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to summarize text.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'translate': {\r\n      const text = interaction.options.getString('text');\r\n      const language = interaction.options.getString('language');\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to translate.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (!language || language.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please specify a target language.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too long. Please keep it under 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const translation = await translateText(text.trim(), language.trim());\r\n\r\n        if (!translation || typeof translation !== 'string') {\r\n          throw new Error('Invalid translation result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üåê Translation')\r\n          .setColor(0x4CAF50)\r\n          .addFields(\r\n            { name: 'Original', value: text.length > 1024 ? text.substring(0, 1021) + '...' : text, inline: false },\r\n            { name: `Translated (${language.toUpperCase()})`, value: translation.length > 1024 ? translation.substring(0, 1021) + '...' : translation, inline: false }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Translation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to translate text.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'ideas': {\r\n      const topic = interaction.options.getString('topic');\r\n      const count = interaction.options.getInteger('count') || 5;\r\n\r\n      // Validate inputs\r\n      if (!topic || topic.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a topic for idea generation.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (count < 1 || count > 10) {\r\n        return interaction.reply({\r\n          content: '‚ùå Number of ideas must be between 1 and 10.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (topic.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Topic is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const ideas = await generateIdeas(topic.trim(), count);\r\n\r\n        if (!Array.isArray(ideas) || ideas.length === 0) {\r\n          throw new Error('Invalid ideas result');\r\n        }\r\n\r\n        const validIdeas = ideas.filter(idea => idea && typeof idea === 'string').slice(0, count);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üí° Ideas for \"${topic}\"`)\r\n          .setColor(0xFF9800)\r\n          .setDescription(validIdeas.map((idea, index) => `${index + 1}. ${idea.substring(0, 200)}`).join('\\n'));\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Idea generation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate ideas.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'code': {\r\n      const language = interaction.options.getString('language');\r\n      const description = interaction.options.getString('description');\r\n\r\n      // Validate inputs\r\n      if (!language || language.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please specify a programming language.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (!description || description.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a description for the code.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (language.length > 20 || description.length > 500) {\r\n        return interaction.reply({\r\n          content: '‚ùå Language or description is too long.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const code = await generateCodeSnippet(language.trim(), description.trim());\r\n\r\n        if (!code || typeof code !== 'string') {\r\n          throw new Error('Invalid code result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üíª ${language.toUpperCase()} Code`)\r\n          .setColor(0x333333)\r\n          .setDescription('```' + language.toLowerCase() + '\\n' + (code.length > 1500 ? code.substring(0, 1497) + '...' : code) + '\\n```')\r\n          .addFields({\r\n            name: 'Description',\r\n            value: description.length > 1024 ? description.substring(0, 1021) + '...' : description,\r\n            inline: false\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Code generation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate code.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'models': {\r\n      try {\r\n        const models = getAvailableModels();\r\n\r\n        if (!Array.isArray(models)) {\r\n          throw new Error('Invalid models data');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('ü§ñ Available AI Models')\r\n          .setColor(0x0099FF);\r\n\r\n        const validModels = models.filter(model => model && model.name && model.description).slice(0, 10);\r\n        validModels.forEach(model => {\r\n          embed.addFields({\r\n            name: model.name.substring(0, 256),\r\n            value: model.description.substring(0, 1024),\r\n            inline: false\r\n          });\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Error fetching models:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch available models.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'personalities': {\r\n      try {\r\n        const personalities = getAvailablePersonalities();\r\n\r\n        if (!Array.isArray(personalities)) {\r\n          throw new Error('Invalid personalities data');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé≠ Available Personalities')\r\n          .setColor(0xE91E63);\r\n\r\n        const validPersonalities = personalities.filter(p => p && p.name && p.style).slice(0, 10);\r\n        validPersonalities.forEach(personality => {\r\n          embed.addFields({\r\n            name: personality.name.substring(0, 256),\r\n            value: `Style: ${personality.style.substring(0, 768)}`,\r\n            inline: false\r\n          });\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Error fetching personalities:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch available personalities.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'recommend': {\r\n      try {\r\n        const recommendations = await generateRecommendations(interaction.user.id, 'general');\r\n\r\n        if (!Array.isArray(recommendations)) {\r\n          throw new Error('Invalid recommendations result');\r\n        }\r\n\r\n        const validRecommendations = recommendations.filter(rec => rec && typeof rec === 'string').slice(0, 10);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üí° Personalized Recommendations')\r\n          .setColor(0xFFC107)\r\n          .setDescription(validRecommendations.map((rec, index) => `${index + 1}. ${rec.substring(0, 200)}`).join('\\n'));\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n      } catch (error) {\r\n        console.error('Recommendation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate recommendations.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'clear': {\r\n      try {\r\n        clearUserHistory(interaction.user.id);\r\n        await interaction.reply({\r\n          content: 'üßπ **AI conversation history cleared!** Starting fresh.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      } catch (error) {\r\n        console.error('Error clearing history:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to clear conversation history.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":107,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":107,"endColumn":29,"fix":{"range":[5667,5675],"text":"0x00_99_FF"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":108,"column":52,"nodeType":"CallExpression","messageId":"substring","endLine":108,"endColumn":79,"fix":{"range":[5738,5747],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":127,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":127,"endColumn":8,"fix":{"range":[6489,6489],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":128,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":128,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6515,6554],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":135,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":135,"endColumn":6,"fix":{"range":[6736,6736],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":162,"column":48,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":162,"endColumn":56,"fix":{"range":[7646,7654],"text":"0x00_FF_00"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":162,"column":59,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":162,"endColumn":105,"fix":{"range":[7657,7703],"text":"(sentiment === 'negative' ? 0xFF0000 : 0xFFFF00)"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":162,"column":86,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":162,"endColumn":94,"fix":{"range":[7684,7692],"text":"0xFF_00_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":162,"column":97,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":162,"endColumn":105,"fix":{"range":[7695,7703],"text":"0xFF_FF_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":163,"column":60,"nodeType":"CallExpression","messageId":"substring","endLine":163,"endColumn":82,"fix":{"range":[7770,7779],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":172,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":172,"endColumn":8,"fix":{"range":[8016,8016],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":173,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":173,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8042,8092],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":180,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":180,"endColumn":6,"fix":{"range":[8253,8253],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":215,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":215,"endColumn":29,"fix":{"range":[9426,9434],"text":"0x99_32_CC"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":216,"column":51,"nodeType":"CallExpression","messageId":"substring","endLine":216,"endColumn":77,"fix":{"range":[9495,9504],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":229,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":229,"endColumn":8,"fix":{"range":[9883,9883],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":230,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":230,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9909,9954],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":237,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":237,"endColumn":6,"fix":{"range":[10112,10112],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":272,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":272,"endColumn":29,"fix":{"range":[11270,11278],"text":"0x4C_AF_50"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":274,"column":61,"nodeType":"CallExpression","messageId":"substring","endLine":274,"endColumn":84,"fix":{"range":[11369,11378],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":275,"column":98,"nodeType":"CallExpression","messageId":"substring","endLine":275,"endColumn":128,"fix":{"range":[11531,11540],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":280,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":280,"endColumn":8,"fix":{"range":[11670,11670],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":281,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":281,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[11696,11739],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":288,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":288,"endColumn":6,"fix":{"range":[11897,11897],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (503). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":503,"endColumn":2},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":324,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":324,"endColumn":29,"fix":{"range":[13139,13147],"text":"0xFF_98_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":325,"column":76,"nodeType":"CallExpression","messageId":"substring","endLine":325,"endColumn":98,"fix":{"range":[13230,13239],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":329,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":329,"endColumn":8,"fix":{"range":[13331,13331],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":330,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":330,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[13357,13404],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":337,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":337,"endColumn":6,"fix":{"range":[13562,13562],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":372,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":372,"endColumn":29,"fix":{"range":[14772,14780],"text":"0x33_33_33"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":373,"column":89,"nodeType":"CallExpression","messageId":"substring","endLine":373,"endColumn":112,"fix":{"range":[14876,14885],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":376,"column":48,"nodeType":"CallExpression","messageId":"substring","endLine":376,"endColumn":78,"fix":{"range":[15040,15049],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":382,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":382,"endColumn":8,"fix":{"range":[15191,15191],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":383,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":383,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15217,15264],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":390,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":390,"endColumn":6,"fix":{"range":[15421,15421],"text":"\n"}},{"ruleId":"unicorn/prefer-type-error","severity":2,"message":"`new Error()` is too unspecific for a type check. Use `new TypeError()` instead.","line":395,"column":21,"nodeType":"Identifier","messageId":"prefer-type-error","endLine":395,"endColumn":26,"fix":{"range":[15572,15572],"text":"Type"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":400,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":400,"endColumn":29,"fix":{"range":[15725,15733],"text":"0x00_99_FF"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":403,"column":21,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":403,"endColumn":28,"fix":{"range":[15855,16076],"text":"for (const model of validModels) {\r\n          embed.addFields({\r\n            name: model.name.substring(0, 256),\r\n            value: model.description.substring(0, 1024),\r\n            inline: false\r\n          });\r\n        }"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":405,"column":19,"nodeType":"CallExpression","messageId":"substring","endLine":405,"endColumn":47,"fix":{"range":[15945,15954],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":406,"column":20,"nodeType":"CallExpression","messageId":"substring","endLine":406,"endColumn":56,"fix":{"range":[16002,16011],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":412,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":412,"endColumn":8,"fix":{"range":[16142,16142],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":413,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":413,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16168,16215],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":420,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":420,"endColumn":6,"fix":{"range":[16381,16381],"text":"\n"}},{"ruleId":"unicorn/prefer-type-error","severity":2,"message":"`new Error()` is too unspecific for a type check. Use `new TypeError()` instead.","line":425,"column":21,"nodeType":"Identifier","messageId":"prefer-type-error","endLine":425,"endColumn":26,"fix":{"range":[16560,16560],"text":"Type"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":430,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":430,"endColumn":29,"fix":{"range":[16724,16732],"text":"0xE9_1E_63"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":433,"column":28,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":433,"endColumn":35,"fix":{"range":[16846,17097],"text":"for (const personality of validPersonalities) {\r\n          embed.addFields({\r\n            name: personality.name.substring(0, 256),\r\n            value: `Style: ${personality.style.substring(0, 768)}`,\r\n            inline: false\r\n          });\r\n        }"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":435,"column":19,"nodeType":"CallExpression","messageId":"substring","endLine":435,"endColumn":53,"fix":{"range":[16955,16964],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":436,"column":30,"nodeType":"CallExpression","messageId":"substring","endLine":436,"endColumn":65,"fix":{"range":[17022,17031],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":442,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":442,"endColumn":8,"fix":{"range":[17163,17163],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":443,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":443,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[17189,17243],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":450,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":450,"endColumn":6,"fix":{"range":[17416,17416],"text":"\n"}},{"ruleId":"unicorn/prefer-type-error","severity":2,"message":"`new Error()` is too unspecific for a type check. Use `new TypeError()` instead.","line":455,"column":21,"nodeType":"Identifier","messageId":"prefer-type-error","endLine":455,"endColumn":26,"fix":{"range":[17629,17629],"text":"Type"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":461,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":461,"endColumn":29,"fix":{"range":[17916,17924],"text":"0xFF_C1_07"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":462,"column":85,"nodeType":"CallExpression","messageId":"substring","endLine":462,"endColumn":106,"fix":{"range":[18015,18024],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":466,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":466,"endColumn":8,"fix":{"range":[18147,18147],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":467,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":467,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18173,18219],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":474,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":474,"endColumn":6,"fix":{"range":[18387,18387],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":481,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":481,"endColumn":8,"fix":{"range":[18653,18653],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":482,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":482,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18679,18727],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":490,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":490,"endColumn":4,"fix":{"range":[18902,18902],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":491,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":491,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18924,18966],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":499,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":499,"endColumn":6,"fix":{"range":[19230,19230],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":500,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":500,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[19259,19316],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":57,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":53,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport {\r\n  generateResponse,\r\n  analyzeSentiment,\r\n  generateSummary,\r\n  translateText,\r\n  getAvailableModels,\r\n  getAvailablePersonalities,\r\n  clearUserHistory,\r\n  generateIdeas,\r\n  generateCodeSnippet,\r\n  generateRecommendations\r\n} from '../aiassistant.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('ai')\r\n  .setDescription('Advanced AI assistant with multiple models and personalities')\r\n  .addSubcommand(sub => sub.setName('chat').setDescription('Chat with AI assistant').addStringOption(opt => opt.setName('message').setDescription('Your message').setRequired(true)).addStringOption(opt => opt.setName('model').setDescription('AI model to use').addChoices(\r\n    { name: 'Creative Writer', value: 'creative' },\r\n    { name: 'Technical Expert', value: 'technical' },\r\n    { name: 'Helpful Assistant', value: 'helpful' },\r\n    { name: 'Comedy Bot', value: 'funny' },\r\n    { name: 'Teacher Bot', value: 'educational' }\r\n  ).setRequired(false)).addStringOption(opt => opt.setName('personality').setDescription('AI personality').addChoices(\r\n    { name: 'Professional', value: 'professional' },\r\n    { name: 'Friendly', value: 'friendly' },\r\n    { name: 'Energetic', value: 'energetic' },\r\n    { name: 'Wise Mentor', value: 'wise' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('analyze').setDescription('Analyze text sentiment').addStringOption(opt => opt.setName('text').setDescription('Text to analyze').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('summarize').setDescription('Summarize text').addStringOption(opt => opt.setName('text').setDescription('Text to summarize').setRequired(true)).addIntegerOption(opt => opt.setName('length').setDescription('Max summary length').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('translate').setDescription('Translate text').addStringOption(opt => opt.setName('text').setDescription('Text to translate').setRequired(true)).addStringOption(opt => opt.setName('language').setDescription('Target language').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('ideas').setDescription('Generate ideas').addStringOption(opt => opt.setName('topic').setDescription('Topic for ideas').setRequired(true)).addIntegerOption(opt => opt.setName('count').setDescription('Number of ideas').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('code').setDescription('Generate code').addStringOption(opt => opt.setName('language').setDescription('Programming language').setRequired(true)).addStringOption(opt => opt.setName('description').setDescription('Code description').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('models').setDescription('List available AI models'))\r\n  .addSubcommand(sub => sub.setName('personalities').setDescription('List available personalities'))\r\n  .addSubcommand(sub => sub.setName('recommend').setDescription('Get personalized recommendations'))\r\n  .addSubcommand(sub => sub.setName('clear').setDescription('Clear conversation history'));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    // Validate interaction object\r\n    if (!interaction || !interaction.user || !interaction.options) {\r\n      throw new Error('Invalid interaction object');\r\n    }\r\n\r\n    const sub = interaction.options.getSubcommand();\r\n\r\n    // Validate subcommand\r\n    const validSubcommands = ['chat', 'analyze', 'summarize', 'translate', 'ideas', 'code', 'models', 'personalities', 'recommend', 'clear'];\r\n    if (!validSubcommands.includes(sub)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Invalid subcommand. Please use a valid AI subcommand.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    if (sub === 'chat') {\r\n      const message = interaction.options.getString('message');\r\n      const model = interaction.options.getString('model') || 'helpful';\r\n      const personality = interaction.options.getString('personality') || 'friendly';\r\n\r\n      // Validate inputs\r\n      if (!message || message.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a message to send to the AI.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (message.length > 2000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Message is too long. Please keep it under 2000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const validModels = ['creative', 'technical', 'helpful', 'funny', 'educational'];\r\n      if (!validModels.includes(model)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid model. Please choose from: creative, technical, helpful, funny, educational.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const validPersonalities = ['professional', 'friendly', 'energetic', 'wise'];\r\n      if (!validPersonalities.includes(personality)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid personality. Please choose from: professional, friendly, energetic, wise.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const response = await generateResponse(interaction.user.id, message.trim(), {\r\n          model,\r\n          personality,\r\n          guildId: interaction.guild?.id\r\n        });\r\n\r\n        if (!response || typeof response !== 'string') {\r\n          throw new Error('Invalid AI response');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`ü§ñ ${model.charAt(0).toUpperCase() + model.slice(1)} AI Response`)\r\n          .setColor(0x0099FF)\r\n          .setDescription(response.length > 4000 ? response.substring(0, 3997) + '...' : response)\r\n          .addFields(\r\n            { name: 'Model', value: model, inline: true },\r\n            { name: 'Personality', value: personality, inline: true }\r\n          );\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder()\r\n            .setCustomId(`ai_chat:${model}:${personality}:${interaction.user.id}`)\r\n            .setLabel('üí¨ Continue Chat')\r\n            .setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder()\r\n            .setCustomId(`ai_clear:${interaction.user.id}`)\r\n            .setLabel('üóëÔ∏è Clear History')\r\n            .setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } catch (error) {\r\n        console.error('AI chat error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate AI response. Please try again.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'analyze') {\r\n      const text = interaction.options.getString('text');\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to analyze.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too long. Please keep it under 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const sentiment = await analyzeSentiment(text.trim());\r\n\r\n        if (!sentiment || !['positive', 'negative', 'neutral'].includes(sentiment)) {\r\n          throw new Error('Invalid sentiment result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üìä Sentiment Analysis')\r\n          .setColor(sentiment === 'positive' ? 0x00FF00 : sentiment === 'negative' ? 0xFF0000 : 0xFFFF00)\r\n          .setDescription(`**Text:** ${text.length > 500 ? text.substring(0, 497) + '...' : text}`)\r\n          .addFields({\r\n            name: 'Sentiment',\r\n            value: sentiment.toUpperCase(),\r\n            inline: false\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Sentiment analysis error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to analyze sentiment.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'summarize') {\r\n      const text = interaction.options.getString('text');\r\n      const maxLength = interaction.options.getInteger('length') || 200;\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to summarize.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length < 50) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too short to summarize. Please provide at least 50 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (maxLength < 50 || maxLength > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Summary length must be between 50 and 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const summary = await generateSummary(text.trim(), maxLength);\r\n\r\n        if (!summary || typeof summary !== 'string') {\r\n          throw new Error('Invalid summary result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üìù Text Summary')\r\n          .setColor(0x9932CC)\r\n          .setDescription(summary.length > 4000 ? summary.substring(0, 3997) + '...' : summary)\r\n          .addFields({\r\n            name: 'Original Length',\r\n            value: `${text.length} characters`,\r\n            inline: true\r\n          }, {\r\n            name: 'Summary Length',\r\n            value: `${summary.length} characters`,\r\n            inline: true\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Summarization error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to summarize text.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'translate') {\r\n      const text = interaction.options.getString('text');\r\n      const language = interaction.options.getString('language');\r\n\r\n      // Validate inputs\r\n      if (!text || text.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide text to translate.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (!language || language.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please specify a target language.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (text.length > 1000) {\r\n        return interaction.reply({\r\n          content: '‚ùå Text is too long. Please keep it under 1000 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const translation = await translateText(text.trim(), language.trim());\r\n\r\n        if (!translation || typeof translation !== 'string') {\r\n          throw new Error('Invalid translation result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üåê Translation')\r\n          .setColor(0x4CAF50)\r\n          .addFields(\r\n            { name: 'Original', value: text.length > 1024 ? text.substring(0, 1021) + '...' : text, inline: false },\r\n            { name: `Translated (${language.toUpperCase()})`, value: translation.length > 1024 ? translation.substring(0, 1021) + '...' : translation, inline: false }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Translation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to translate text.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'ideas') {\r\n      const topic = interaction.options.getString('topic');\r\n      const count = interaction.options.getInteger('count') || 5;\r\n\r\n      // Validate inputs\r\n      if (!topic || topic.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a topic for idea generation.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (count < 1 || count > 10) {\r\n        return interaction.reply({\r\n          content: '‚ùå Number of ideas must be between 1 and 10.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (topic.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Topic is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const ideas = await generateIdeas(topic.trim(), count);\r\n\r\n        if (!Array.isArray(ideas) || ideas.length === 0) {\r\n          throw new Error('Invalid ideas result');\r\n        }\r\n\r\n        const validIdeas = ideas.filter(idea => idea && typeof idea === 'string').slice(0, count);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üí° Ideas for \"${topic}\"`)\r\n          .setColor(0xFF9800)\r\n          .setDescription(validIdeas.map((idea, index) => `${index + 1}. ${idea.substring(0, 200)}`).join('\\n'));\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Idea generation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate ideas.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'code') {\r\n      const language = interaction.options.getString('language');\r\n      const description = interaction.options.getString('description');\r\n\r\n      // Validate inputs\r\n      if (!language || language.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please specify a programming language.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (!description || description.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a description for the code.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (language.length > 20 || description.length > 500) {\r\n        return interaction.reply({\r\n          content: '‚ùå Language or description is too long.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const code = await generateCodeSnippet(language.trim(), description.trim());\r\n\r\n        if (!code || typeof code !== 'string') {\r\n          throw new Error('Invalid code result');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üíª ${language.toUpperCase()} Code`)\r\n          .setColor(0x333333)\r\n          .setDescription('```' + language.toLowerCase() + '\\n' + (code.length > 1500 ? code.substring(0, 1497) + '...' : code) + '\\n```')\r\n          .addFields({\r\n            name: 'Description',\r\n            value: description.length > 1024 ? description.substring(0, 1021) + '...' : description,\r\n            inline: false\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } catch (error) {\r\n        console.error('Code generation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate code.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'models') {\r\n      try {\r\n        const models = getAvailableModels();\r\n\r\n        if (!Array.isArray(models)) {\r\n          throw new Error('Invalid models data');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('ü§ñ Available AI Models')\r\n          .setColor(0x0099FF);\r\n\r\n        const validModels = models.filter(model => model && model.name && model.description).slice(0, 10);\r\n        validModels.forEach(model => {\r\n          embed.addFields({\r\n            name: model.name.substring(0, 256),\r\n            value: model.description.substring(0, 1024),\r\n            inline: false\r\n          });\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Error fetching models:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch available models.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'personalities') {\r\n      try {\r\n        const personalities = getAvailablePersonalities();\r\n\r\n        if (!Array.isArray(personalities)) {\r\n          throw new Error('Invalid personalities data');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé≠ Available Personalities')\r\n          .setColor(0xE91E63);\r\n\r\n        const validPersonalities = personalities.filter(p => p && p.name && p.style).slice(0, 10);\r\n        validPersonalities.forEach(personality => {\r\n          embed.addFields({\r\n            name: personality.name.substring(0, 256),\r\n            value: `Style: ${personality.style.substring(0, 768)}`,\r\n            inline: false\r\n          });\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Error fetching personalities:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch available personalities.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'recommend') {\r\n      try {\r\n        const recommendations = await generateRecommendations(interaction.user.id, 'general');\r\n\r\n        if (!Array.isArray(recommendations)) {\r\n          throw new Error('Invalid recommendations result');\r\n        }\r\n\r\n        const validRecommendations = recommendations.filter(rec => rec && typeof rec === 'string').slice(0, 10);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üí° Personalized Recommendations')\r\n          .setColor(0xFFC107)\r\n          .setDescription(validRecommendations.map((rec, index) => `${index + 1}. ${rec.substring(0, 200)}`).join('\\n'));\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n      } catch (error) {\r\n        console.error('Recommendation error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to generate recommendations.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'clear') {\r\n      try {\r\n        clearUserHistory(interaction.user.id);\r\n        await interaction.reply({\r\n          content: 'üßπ **AI conversation history cleared!** Starting fresh.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      } catch (error) {\r\n        console.error('Error clearing history:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to clear conversation history.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('AI command error:', error);\r\n    try {\r\n      if (interaction && typeof interaction.reply === 'function') {\r\n        await interaction.reply({\r\n          content: '‚ùå An unexpected error occurred. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    } catch (replyError) {\r\n      console.error('Failed to send error reply:', replyError);\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\api.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":78,"fix":{"range":[77,77],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'setAPIKey' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'getAPIKey' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (381). Maximum allowed is 100.","line":29,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":409,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (115). Maximum allowed is 30.","line":29,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":409,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 99. Maximum allowed is 20.","line":29,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":409,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 85 to the 15 allowed.","line":29,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":29,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":47,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":47,"endColumn":25,"fix":{"range":[2309,16030],"text":"switch (sub) {\n    case 'news': {\r\n      const query = interaction.options.getString('query') || 'technology';\r\n\r\n      // Validate inputs\r\n      if (query && query.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Search query is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getNews(query, 5);\r\n        if (!result || !result.success) {\r\n          return interaction.reply({\r\n            content: `‚ùå ${result?.reason || 'Failed to fetch news. Please try again later.'}`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (!Array.isArray(result.data) || result.data.length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå No news articles found for this query.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üì∞ Latest News: ${query}`)\r\n          .setColor(0x0099FF);\r\n\r\n        result.data.slice(0, 3).forEach((article, index) => {\r\n          if (article && article.title && article.url) {\r\n            const title = article.title.substring(0, 256);\r\n            const description = article.description ?\r\n              (article.description.length > 500 ? article.description.substring(0, 497) + '...' : article.description) :\r\n              'No description available';\r\n            embed.addFields({\r\n              name: `${index + 1}. ${title}`,\r\n              value: `${description}\\n[Read more](${article.url})`,\r\n              inline: false\r\n            });\r\n          }\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('News fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch news. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'joke': {\r\n      try {\r\n        const result = await getRandomJoke();\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get joke. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const jokeData = result.data;\r\n        if (!jokeData.setup || !jokeData.punchline) {\r\n          throw new Error('Invalid joke data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üòÇ Random Joke')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**${jokeData.setup}**\\n\\n${jokeData.punchline}`)\r\n          .setFooter({ text: 'Powered by Official Joke API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Joke fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get joke. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'catfact': {\r\n      try {\r\n        const result = await getCatFact();\r\n        if (!result || !result.success || !result.data || !result.data.fact) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get cat fact. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üê± Cat Fact')\r\n          .setColor(0xFF69B4)\r\n          .setDescription(result.data.fact.length > 2000 ? result.data.fact.substring(0, 1997) + '...' : result.data.fact)\r\n          .setFooter({ text: 'Powered by Cat Facts API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Cat fact fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get cat fact. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'numberfact': {\r\n      const number = interaction.options.getInteger('number');\r\n\r\n      // Validate inputs\r\n      if (number !== null && (number < 1 || number > 1000)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Number must be between 1 and 1000.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getNumberFact(number);\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get number fact. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üî¢ Fact about ${result.data.number}`)\r\n          .setColor(0x9932CC)\r\n          .setDescription(result.data.text.length > 2000 ? result.data.text.substring(0, 1997) + '...' : result.data.text)\r\n          .setFooter({ text: 'Powered by Numbers API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Number fact fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get number fact. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'dadjoke': {\r\n      try {\r\n        const result = await getDadJoke();\r\n        if (!result || !result.success || !result.data || !result.data.joke) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get dad joke. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üë®‚Äçü¶≥ Dad Joke')\r\n          .setColor(0xFF8C00)\r\n          .setDescription(result.data.joke.length > 2000 ? result.data.joke.substring(0, 1997) + '...' : result.data.joke)\r\n          .setFooter({ text: 'Powered by Dad Jokes API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Dad joke fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get dad joke. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'programquote': {\r\n      try {\r\n        const result = await getProgrammingQuote();\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get programming quote. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const quoteData = result.data;\r\n        if (!quoteData.en || !quoteData.author || typeof quoteData.rating !== 'number') {\r\n          throw new Error('Invalid quote data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üíª Programming Quote')\r\n          .setColor(0x4CAF50)\r\n          .addFields(\r\n            { name: 'Quote', value: `\"${quoteData.en.substring(0, 1000)}\"`, inline: false },\r\n            { name: 'Author', value: quoteData.author.substring(0, 256), inline: true },\r\n            { name: 'Rating', value: `‚≠ê ${quoteData.rating}`, inline: true }\r\n          )\r\n          .setFooter({ text: 'Powered by Programming Quotes API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Programming quote fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get programming quote. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'github': {\r\n      const username = interaction.options.getString('username');\r\n\r\n      // Validate inputs\r\n      if (!username || username.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a GitHub username.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (username.length > 39 || !/^[a-zA-Z0-9](?:[a-zA-Z0-9]|-(?=[a-zA-Z0-9])){0,38}$/.test(username)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid GitHub username format.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getGitHubStats(username.trim());\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: `‚ùå Failed to get GitHub stats for ${username}. User may not exist.`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const userData = result.data;\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üêô GitHub Stats: ${userData.name || username}`)\r\n          .setColor(0x333333)\r\n          .setDescription(userData.bio ? userData.bio.substring(0, 500) : 'No bio available')\r\n          .addFields(\r\n            { name: 'üìç Location', value: userData.location || 'Not specified', inline: true },\r\n            { name: 'üìö Public Repos', value: String(userData.publicRepos || 0), inline: true },\r\n            { name: 'üë• Followers', value: String(userData.followers || 0), inline: true },\r\n            { name: 'üë§ Following', value: String(userData.following || 0), inline: true }\r\n          )\r\n          .setFooter({\r\n            text: userData.created ? `Account created: ${new Date(userData.created).toLocaleDateString()}` : 'Account creation date unknown'\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('GitHub stats fetch error:', error);\r\n        await interaction.reply({\r\n          content: `‚ùå Failed to get GitHub stats for ${username}. Please try again later.`,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'weather': {\r\n      const location = interaction.options.getString('location');\r\n\r\n      // Validate inputs\r\n      if (!location || location.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a location.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (location.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Location name is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getWeather(location.trim());\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: `‚ùå ${result?.reason || 'Failed to get weather data. Please check the location name.'}`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const data = result.data;\r\n        // Validate weather data structure\r\n        if (!data.name || !data.sys || !data.main || !data.weather || !data.wind) {\r\n          throw new Error('Invalid weather data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üå§Ô∏è Weather in ${data.name}, ${data.sys.country}`)\r\n          .setColor(0x0099FF)\r\n          .addFields(\r\n            { name: 'üå°Ô∏è Temperature', value: `**${Math.round(data.main.temp)}¬∞C** (Feels like ${Math.round(data.main.feels_like)}¬∞C)`, inline: true },\r\n            { name: 'üíß Humidity', value: `**${data.main.humidity}%**`, inline: true },\r\n            { name: 'üå¨Ô∏è Wind', value: `**${Math.round(data.wind.speed * 3.6)} km/h**`, inline: true },\r\n            { name: 'üå•Ô∏è Conditions', value: `${getWeatherEmoji(data.weather[0].main)} **${data.weather[0].description}**`, inline: true },\r\n            { name: 'üìä Pressure', value: `**${data.main.pressure} hPa**`, inline: true },\r\n            { name: 'üëÅÔ∏è Visibility', value: `**${(data.visibility / 1000).toFixed(1)} km**`, inline: true }\r\n          )\r\n          .setFooter({ text: 'Powered by OpenWeatherMap' })\r\n          .setTimestamp();\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Weather fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get weather data. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'stats': {\r\n      try {\r\n        const stats = getIntegrationStats() || {\r\n          apiKeys: 0,\r\n          totalUsage: 0,\r\n          totalErrors: 0,\r\n          cacheSize: 0\r\n        };\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîå API Integration Statistics')\r\n          .setColor(0x9932CC)\r\n          .setDescription('External service usage and performance')\r\n          .addFields(\r\n            { name: 'üîë Configured APIs', value: String(stats.apiKeys || 0), inline: true },\r\n            { name: 'üìä Total Requests', value: String(stats.totalUsage || 0), inline: true },\r\n            { name: '‚ùå Errors', value: String(stats.totalErrors || 0), inline: true },\r\n            { name: 'üíæ Cache Size', value: `${stats.cacheSize || 0} entries`, inline: true }\r\n          );\r\n\r\n        if ((stats.totalUsage || 0) > 0) {\r\n          const successRate = (((stats.totalUsage || 0) - (stats.totalErrors || 0)) / (stats.totalUsage || 1) * 100).toFixed(1);\r\n          embed.addFields({\r\n            name: 'üìà Success Rate',\r\n            value: `${successRate}%`,\r\n            inline: true\r\n          });\r\n        }\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        console.error('Stats fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch API statistics. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":76,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":76,"endColumn":29,"fix":{"range":[3336,3344],"text":"0x00_99_FF"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":78,"column":33,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":78,"endColumn":40,"fix":{"range":[3358,3968],"text":"for (const [index, article] of result.data.slice(0, 3).entries()) {\r\n          if (article && article.title && article.url) {\r\n            const title = article.title.substring(0, 256);\r\n            const description = article.description ?\r\n              (article.description.length > 500 ? article.description.substring(0, 497) + '...' : article.description) :\r\n              'No description available';\r\n            embed.addFields({\r\n              name: `${index + 1}. ${title}`,\r\n              value: `${description}\\n[Read more](${article.url})`,\r\n              inline: false\r\n            });\r\n          }\r\n        }"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":80,"column":27,"nodeType":"CallExpression","messageId":"substring","endLine":80,"endColumn":58,"fix":{"range":[3511,3520],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":82,"column":51,"nodeType":"CallExpression","messageId":"substring","endLine":82,"endColumn":88,"fix":{"range":[3656,3665],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":93,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":93,"endColumn":8,"fix":{"range":[4034,4034],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":94,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":94,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4060,4102],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":101,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":101,"endColumn":6,"fix":{"range":[4280,4280],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":118,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":118,"endColumn":29,"fix":{"range":[4875,4883],"text":"0xFF_D7_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":123,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":123,"endColumn":8,"fix":{"range":[5092,5092],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":124,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":124,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5118,5160],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":131,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":131,"endColumn":6,"fix":{"range":[5336,5336],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":143,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":143,"endColumn":29,"fix":{"range":[5787,5795],"text":"0xFF_69_B4"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":144,"column":60,"nodeType":"CallExpression","messageId":"substring","endLine":144,"endColumn":95,"fix":{"range":[5874,5883],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":148,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":148,"endColumn":8,"fix":{"range":[6047,6047],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":149,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":149,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6073,6119],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":156,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":156,"endColumn":6,"fix":{"range":[6299,6299],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":178,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":178,"endColumn":29,"fix":{"range":[7084,7092],"text":"0x99_32_CC"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":179,"column":60,"nodeType":"CallExpression","messageId":"substring","endLine":179,"endColumn":95,"fix":{"range":[7171,7180],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":183,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":183,"endColumn":8,"fix":{"range":[7342,7342],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":184,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":184,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7368,7417],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":191,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":191,"endColumn":6,"fix":{"range":[7600,7600],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":203,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":203,"endColumn":29,"fix":{"range":[8054,8062],"text":"0xFF_8C_00"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":204,"column":60,"nodeType":"CallExpression","messageId":"substring","endLine":204,"endColumn":95,"fix":{"range":[8141,8150],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":208,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":208,"endColumn":8,"fix":{"range":[8314,8314],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":209,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":209,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8340,8386],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":216,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":216,"endColumn":6,"fix":{"range":[8566,8566],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":233,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":233,"endColumn":29,"fix":{"range":[9232,9240],"text":"0x4C_AF_50"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":235,"column":41,"nodeType":"CallExpression","messageId":"substring","endLine":235,"endColumn":72,"fix":{"range":[9319,9328],"text":"slice"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":236,"column":38,"nodeType":"CallExpression","messageId":"substring","endLine":236,"endColumn":72,"fix":{"range":[9414,9423],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":242,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":242,"endColumn":8,"fix":{"range":[9675,9675],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":243,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":243,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9701,9756],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":250,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":250,"endColumn":6,"fix":{"range":[9945,9945],"text":"\n"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/^[a-zA-Z0-9](?:[a-zA-Z0-9]|-(?=[a-zA-Z0-9])){0,38}$/ can be optimized to /^[\\dA-Za-z](?:[\\dA-Za-z]|-(?=[\\dA-Za-z])){0,38}$/.","line":261,"column":36,"nodeType":"Literal","messageId":"better-regex","endLine":261,"endColumn":89,"fix":{"range":[10322,10375],"text":"/^[\\dA-Za-z](?:[\\dA-Za-z]|-(?=[\\dA-Za-z])){0,38}$/"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":280,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":280,"endColumn":29,"fix":{"range":[11059,11067],"text":"0x33_33_33"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":281,"column":42,"nodeType":"CallExpression","messageId":"substring","endLine":281,"endColumn":72,"fix":{"range":[11124,11133],"text":"slice"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":293,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":293,"endColumn":8,"fix":{"range":[11826,11826],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":294,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":294,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[11852,11902],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (424). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":424,"endColumn":2},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":301,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":301,"endColumn":6,"fix":{"range":[12102,12102],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":336,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":336,"endColumn":29,"fix":{"range":[13388,13396],"text":"0x00_99_FF"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":349,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":349,"endColumn":8,"fix":{"range":[14278,14278],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":350,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":350,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[14304,14349],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":357,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":357,"endColumn":6,"fix":{"range":[14533,14533],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":368,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":368,"endColumn":29,"fix":{"range":[14856,14864],"text":"0x99_32_CC"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":378,"column":1,"nodeType":"Program","messageId":"max","endLine":378,"endColumn":129},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":387,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":387,"endColumn":8,"fix":{"range":[15775,15775],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":388,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":388,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15801,15844],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":396,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":396,"endColumn":4,"fix":{"range":[16037,16037],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":397,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":397,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16059,16102],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":405,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":405,"endColumn":6,"fix":{"range":[16366,16366],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":406,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":406,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16395,16452],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":423,"column":10,"nodeType":"MemberExpression","endLine":423,"endColumn":27}],"suppressedMessages":[],"errorCount":45,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":40,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, MessageFlags } from 'discord.js';\r\nimport {\r\n  getNews,\r\n  getRandomJoke,\r\n  getCatFact,\r\n  getNumberFact,\r\n  getDadJoke,\r\n  getProgrammingQuote,\r\n  getGitHubStats,\r\n  getWeather,\r\n  setAPIKey,\r\n  getAPIKey,\r\n  getIntegrationStats\r\n} from '../integrations.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('api')\r\n  .setDescription('External API integrations - news, jokes, facts, and more')\r\n  .addSubcommand(sub => sub.setName('news').setDescription('Get latest news').addStringOption(opt => opt.setName('query').setDescription('Search topic').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('joke').setDescription('Get a random joke'))\r\n  .addSubcommand(sub => sub.setName('catfact').setDescription('Get a random cat fact'))\r\n  .addSubcommand(sub => sub.setName('numberfact').setDescription('Get a fact about a number').addIntegerOption(opt => opt.setName('number').setDescription('Number (1-1000, random if not specified)').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('dadjoke').setDescription('Get a dad joke'))\r\n  .addSubcommand(sub => sub.setName('programquote').setDescription('Get a programming quote'))\r\n  .addSubcommand(sub => sub.setName('github').setDescription('Get GitHub user stats').addStringOption(opt => opt.setName('username').setDescription('GitHub username').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('weather').setDescription('Get weather info').addStringOption(opt => opt.setName('location').setDescription('Location').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('API usage statistics'));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    // Validate interaction object\r\n    if (!interaction || !interaction.user || !interaction.options) {\r\n      throw new Error('Invalid interaction object');\r\n    }\r\n\r\n    const sub = interaction.options.getSubcommand();\r\n\r\n    // Validate subcommand\r\n    const validSubcommands = ['news', 'joke', 'catfact', 'numberfact', 'dadjoke', 'programquote', 'github', 'weather', 'stats'];\r\n    if (!validSubcommands.includes(sub)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Invalid subcommand. Please use a valid API subcommand.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    if (sub === 'news') {\r\n      const query = interaction.options.getString('query') || 'technology';\r\n\r\n      // Validate inputs\r\n      if (query && query.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Search query is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getNews(query, 5);\r\n        if (!result || !result.success) {\r\n          return interaction.reply({\r\n            content: `‚ùå ${result?.reason || 'Failed to fetch news. Please try again later.'}`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (!Array.isArray(result.data) || result.data.length === 0) {\r\n          return interaction.reply({\r\n            content: '‚ùå No news articles found for this query.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üì∞ Latest News: ${query}`)\r\n          .setColor(0x0099FF);\r\n\r\n        result.data.slice(0, 3).forEach((article, index) => {\r\n          if (article && article.title && article.url) {\r\n            const title = article.title.substring(0, 256);\r\n            const description = article.description ?\r\n              (article.description.length > 500 ? article.description.substring(0, 497) + '...' : article.description) :\r\n              'No description available';\r\n            embed.addFields({\r\n              name: `${index + 1}. ${title}`,\r\n              value: `${description}\\n[Read more](${article.url})`,\r\n              inline: false\r\n            });\r\n          }\r\n        });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('News fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch news. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'joke') {\r\n      try {\r\n        const result = await getRandomJoke();\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get joke. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const jokeData = result.data;\r\n        if (!jokeData.setup || !jokeData.punchline) {\r\n          throw new Error('Invalid joke data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üòÇ Random Joke')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`**${jokeData.setup}**\\n\\n${jokeData.punchline}`)\r\n          .setFooter({ text: 'Powered by Official Joke API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Joke fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get joke. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'catfact') {\r\n      try {\r\n        const result = await getCatFact();\r\n        if (!result || !result.success || !result.data || !result.data.fact) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get cat fact. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üê± Cat Fact')\r\n          .setColor(0xFF69B4)\r\n          .setDescription(result.data.fact.length > 2000 ? result.data.fact.substring(0, 1997) + '...' : result.data.fact)\r\n          .setFooter({ text: 'Powered by Cat Facts API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Cat fact fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get cat fact. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'numberfact') {\r\n      const number = interaction.options.getInteger('number');\r\n\r\n      // Validate inputs\r\n      if (number !== null && (number < 1 || number > 1000)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Number must be between 1 and 1000.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getNumberFact(number);\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get number fact. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üî¢ Fact about ${result.data.number}`)\r\n          .setColor(0x9932CC)\r\n          .setDescription(result.data.text.length > 2000 ? result.data.text.substring(0, 1997) + '...' : result.data.text)\r\n          .setFooter({ text: 'Powered by Numbers API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Number fact fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get number fact. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'dadjoke') {\r\n      try {\r\n        const result = await getDadJoke();\r\n        if (!result || !result.success || !result.data || !result.data.joke) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get dad joke. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üë®‚Äçü¶≥ Dad Joke')\r\n          .setColor(0xFF8C00)\r\n          .setDescription(result.data.joke.length > 2000 ? result.data.joke.substring(0, 1997) + '...' : result.data.joke)\r\n          .setFooter({ text: 'Powered by Dad Jokes API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Dad joke fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get dad joke. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'programquote') {\r\n      try {\r\n        const result = await getProgrammingQuote();\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to get programming quote. Please try again later.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const quoteData = result.data;\r\n        if (!quoteData.en || !quoteData.author || typeof quoteData.rating !== 'number') {\r\n          throw new Error('Invalid quote data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üíª Programming Quote')\r\n          .setColor(0x4CAF50)\r\n          .addFields(\r\n            { name: 'Quote', value: `\"${quoteData.en.substring(0, 1000)}\"`, inline: false },\r\n            { name: 'Author', value: quoteData.author.substring(0, 256), inline: true },\r\n            { name: 'Rating', value: `‚≠ê ${quoteData.rating}`, inline: true }\r\n          )\r\n          .setFooter({ text: 'Powered by Programming Quotes API' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Programming quote fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get programming quote. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'github') {\r\n      const username = interaction.options.getString('username');\r\n\r\n      // Validate inputs\r\n      if (!username || username.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a GitHub username.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (username.length > 39 || !/^[a-zA-Z0-9](?:[a-zA-Z0-9]|-(?=[a-zA-Z0-9])){0,38}$/.test(username)) {\r\n        return interaction.reply({\r\n          content: '‚ùå Invalid GitHub username format.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getGitHubStats(username.trim());\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: `‚ùå Failed to get GitHub stats for ${username}. User may not exist.`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const userData = result.data;\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üêô GitHub Stats: ${userData.name || username}`)\r\n          .setColor(0x333333)\r\n          .setDescription(userData.bio ? userData.bio.substring(0, 500) : 'No bio available')\r\n          .addFields(\r\n            { name: 'üìç Location', value: userData.location || 'Not specified', inline: true },\r\n            { name: 'üìö Public Repos', value: String(userData.publicRepos || 0), inline: true },\r\n            { name: 'üë• Followers', value: String(userData.followers || 0), inline: true },\r\n            { name: 'üë§ Following', value: String(userData.following || 0), inline: true }\r\n          )\r\n          .setFooter({\r\n            text: userData.created ? `Account created: ${new Date(userData.created).toLocaleDateString()}` : 'Account creation date unknown'\r\n          });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('GitHub stats fetch error:', error);\r\n        await interaction.reply({\r\n          content: `‚ùå Failed to get GitHub stats for ${username}. Please try again later.`,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'weather') {\r\n      const location = interaction.options.getString('location');\r\n\r\n      // Validate inputs\r\n      if (!location || location.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Please provide a location.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (location.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Location name is too long. Please keep it under 100 characters.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        const result = await getWeather(location.trim());\r\n        if (!result || !result.success || !result.data) {\r\n          return interaction.reply({\r\n            content: `‚ùå ${result?.reason || 'Failed to get weather data. Please check the location name.'}`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        const data = result.data;\r\n        // Validate weather data structure\r\n        if (!data.name || !data.sys || !data.main || !data.weather || !data.wind) {\r\n          throw new Error('Invalid weather data structure');\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üå§Ô∏è Weather in ${data.name}, ${data.sys.country}`)\r\n          .setColor(0x0099FF)\r\n          .addFields(\r\n            { name: 'üå°Ô∏è Temperature', value: `**${Math.round(data.main.temp)}¬∞C** (Feels like ${Math.round(data.main.feels_like)}¬∞C)`, inline: true },\r\n            { name: 'üíß Humidity', value: `**${data.main.humidity}%**`, inline: true },\r\n            { name: 'üå¨Ô∏è Wind', value: `**${Math.round(data.wind.speed * 3.6)} km/h**`, inline: true },\r\n            { name: 'üå•Ô∏è Conditions', value: `${getWeatherEmoji(data.weather[0].main)} **${data.weather[0].description}**`, inline: true },\r\n            { name: 'üìä Pressure', value: `**${data.main.pressure} hPa**`, inline: true },\r\n            { name: 'üëÅÔ∏è Visibility', value: `**${(data.visibility / 1000).toFixed(1)} km**`, inline: true }\r\n          )\r\n          .setFooter({ text: 'Powered by OpenWeatherMap' })\r\n          .setTimestamp();\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Weather fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to get weather data. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n    } else if (sub === 'stats') {\r\n      try {\r\n        const stats = getIntegrationStats() || {\r\n          apiKeys: 0,\r\n          totalUsage: 0,\r\n          totalErrors: 0,\r\n          cacheSize: 0\r\n        };\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîå API Integration Statistics')\r\n          .setColor(0x9932CC)\r\n          .setDescription('External service usage and performance')\r\n          .addFields(\r\n            { name: 'üîë Configured APIs', value: String(stats.apiKeys || 0), inline: true },\r\n            { name: 'üìä Total Requests', value: String(stats.totalUsage || 0), inline: true },\r\n            { name: '‚ùå Errors', value: String(stats.totalErrors || 0), inline: true },\r\n            { name: 'üíæ Cache Size', value: `${stats.cacheSize || 0} entries`, inline: true }\r\n          );\r\n\r\n        if ((stats.totalUsage || 0) > 0) {\r\n          const successRate = (((stats.totalUsage || 0) - (stats.totalErrors || 0)) / (stats.totalUsage || 1) * 100).toFixed(1);\r\n          embed.addFields({\r\n            name: 'üìà Success Rate',\r\n            value: `${successRate}%`,\r\n            inline: true\r\n          });\r\n        }\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        console.error('Stats fetch error:', error);\r\n        await interaction.reply({\r\n          content: '‚ùå Failed to fetch API statistics. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('API command error:', error);\r\n    try {\r\n      if (interaction && typeof interaction.reply === 'function') {\r\n        await interaction.reply({\r\n          content: '‚ùå An unexpected error occurred. Please try again later.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    } catch (replyError) {\r\n      console.error('Failed to send error reply:', replyError);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getWeatherEmoji(condition) {\r\n  const emojis = {\r\n    'Clear': '‚òÄÔ∏è',\r\n    'Clouds': '‚òÅÔ∏è',\r\n    'Rain': 'üåßÔ∏è',\r\n    'Drizzle': 'üå¶Ô∏è',\r\n    'Thunderstorm': '‚õàÔ∏è',\r\n    'Snow': '‚ùÑÔ∏è',\r\n    'Mist': 'üå´Ô∏è',\r\n    'Fog': 'üå´Ô∏è',\r\n    'Haze': 'üå´Ô∏è'\r\n  };\r\n  return emojis[condition] || 'üå§Ô∏è';\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\coinflip.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\n\r\nconst sides = ['Heads', 'Tails'];\r\nconst coins = ['ü™ô', 'üí∞', 'ü•á'];\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('coinflip')\r\n  .setDescription('Flip a coin and get heads or tails')\r\n  .addIntegerOption(option =>\r\n    option.setName('count')\r\n      .setDescription('Number of coins to flip (1-10)')\r\n      .setMinValue(1)\r\n      .setMaxValue(10)\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n  const count = interaction.options.getInteger('count') || 1;\r\n  const results = [];\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const result = sides[Math.floor(Math.random() * sides.length)];\r\n    const coin = coins[Math.floor(Math.random() * coins.length)];\r\n    results.push(`${coin} ${result}`);\r\n  }\r\n\r\n  const headsCount = results.filter(r => r.includes('Heads')).length;\r\n  const tailsCount = results.filter(r => r.includes('Tails')).length;\r\n\r\n  let response = `**Coin Flip${count > 1 ? 's' : ''}:**\\n${results.join('\\n')}\\n\\n`;\r\n  response += `**Results:** ${headsCount} Heads, ${tailsCount} Tails`;\r\n\r\n  if (count === 1) {\r\n    response = `**Coin Flip:** ${results[0]}\\n\\n**Result:** ${headsCount > tailsCount ? 'üü¢ Heads!' : 'üî¥ Tails!'}`;\r\n  }\r\n\r\n  await interaction.reply({ content: response });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\connect4.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":124,"fix":{"range":[160,160],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'MessageFlags' is defined but never used.","line":2,"column":91,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":103},{"ruleId":"import/namespace","severity":2,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":6,"column":61,"nodeType":"Literal","endLine":6,"endColumn":88},{"ruleId":"import/no-deprecated","severity":1,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":6,"column":61,"nodeType":"Literal","endLine":6,"endColumn":88},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":26,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":26,"endColumn":4,"fix":{"range":[1066,1069],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":27,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":27,"endColumn":6,"fix":{"range":[1076,1081],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":28,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":28,"endColumn":6,"fix":{"range":[1140,1145],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":30,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":30,"endColumn":6,"fix":{"range":[1224,1229],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":31,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":31,"endColumn":6,"fix":{"range":[1270,1275],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":32,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":32,"endColumn":8,"fix":{"range":[1319,1326],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":33,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":33,"endColumn":6,"fix":{"range":[1408,1413],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":35,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":35,"endColumn":6,"fix":{"range":[1418,1423],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":36,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":36,"endColumn":6,"fix":{"range":[1471,1476],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":37,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":37,"endColumn":8,"fix":{"range":[1512,1519],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":38,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":38,"endColumn":6,"fix":{"range":[1618,1623],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":40,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":40,"endColumn":6,"fix":{"range":[1628,1633],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":41,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":41,"endColumn":6,"fix":{"range":[1661,1666],"text":"    "}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":41,"column":41,"nodeType":"CallExpression","messageId":"substr","endLine":41,"endColumn":80,"fix":{"range":[1728,1739],"text":"slice(2, 11"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":43,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":43,"endColumn":6,"fix":{"range":[1747,1752],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":6,"fix":{"range":[1778,1783],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":45,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":45,"endColumn":8,"fix":{"range":[1804,1811],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":46,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":46,"endColumn":8,"fix":{"range":[1824,1831],"text":"      "}},{"ruleId":"unicorn/new-for-builtins","severity":2,"message":"Use `new Array()` instead of `Array()`.","line":46,"column":15,"nodeType":"CallExpression","messageId":"enforce","endLine":46,"endColumn":23,"fix":{"range":[1838,1838],"text":"new "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":46,"column":29,"nodeType":"Literal","messageId":"error","endLine":46,"endColumn":33,"suggestions":[{"messageId":"replace","fix":{"range":[1852,1856],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/new-for-builtins","severity":2,"message":"Use `new Array()` instead of `Array()`.","line":46,"column":45,"nodeType":"CallExpression","messageId":"enforce","endLine":46,"endColumn":53,"fix":{"range":[1868,1868],"text":"new "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":46,"column":59,"nodeType":"Literal","messageId":"error","endLine":46,"endColumn":63,"suggestions":[{"messageId":"replace","fix":{"range":[1882,1886],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":47,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":47,"endColumn":8,"fix":{"range":[1891,1898],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":48,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":48,"endColumn":10,"fix":{"range":[1910,1919],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":49,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":49,"endColumn":10,"fix":{"range":[2001,2010],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":50,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":50,"endColumn":8,"fix":{"range":[2078,2085],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":51,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":51,"endColumn":8,"fix":{"range":[2089,2096],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":52,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":52,"endColumn":8,"fix":{"range":[2119,2126],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":53,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":53,"endColumn":8,"fix":{"range":[2145,2152],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":54,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":54,"endColumn":8,"fix":{"range":[2173,2180],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":55,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":55,"endColumn":8,"fix":{"range":[2217,2224],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":56,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":56,"endColumn":6,"fix":{"range":[2245,2250],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":58,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":58,"endColumn":6,"fix":{"range":[2256,2261],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":59,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":59,"endColumn":6,"fix":{"range":[2282,2287],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":61,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":61,"endColumn":6,"fix":{"range":[2328,2333],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":62,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":62,"endColumn":4,"fix":{"range":[2383,2386],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":62,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":62,"endColumn":5,"fix":{"range":[2387,2387],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":63,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":63,"endColumn":6,"fix":{"range":[2405,2410],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":64,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":64,"endColumn":4,"fix":{"range":[2457,2460],"text":"  "}},{"ruleId":"max-statements","severity":1,"message":"Async function 'sendConnect4Board' has too many statements (34). Maximum allowed is 30.","line":67,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":165,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'sendConnect4Board' has a complexity of 26. Maximum allowed is 20.","line":67,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":165,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 34 to the 15 allowed.","line":67,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":67,"endColumn":33},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":68,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":68,"endColumn":4,"fix":{"range":[2528,2531],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":69,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":69,"endColumn":6,"fix":{"range":[2538,2543],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":71,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":71,"endColumn":6,"fix":{"range":[2625,2630],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":72,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":72,"endColumn":6,"fix":{"range":[2651,2656],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":73,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":73,"endColumn":6,"fix":{"range":[2700,2705],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":8,"fix":{"range":[2720,2727],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":76,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":76,"endColumn":8,"fix":{"range":[2762,2769],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":77,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":77,"endColumn":10,"fix":{"range":[2794,2803],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":77,"column":31,"nodeType":"MemberExpression","endLine":77,"endColumn":46},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":78,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":78,"endColumn":10,"fix":{"range":[2842,2851],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":79,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":79,"endColumn":12,"fix":{"range":[2903,2914],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":79,"column":12,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":83,"endColumn":13},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":80,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":80,"endColumn":14,"fix":{"range":[2921,2934],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":81,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":81,"endColumn":12,"fix":{"range":[2991,3002],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":81,"column":12,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":81,"endColumn":13,"fix":{"range":[3003,3003],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":82,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":82,"endColumn":14,"fix":{"range":[3026,3039],"text":"            "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":82,"column":14,"nodeType":"MemberExpression","messageId":"unexpected","endLine":82,"endColumn":27,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3039,3097],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":83,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":83,"endColumn":12,"fix":{"range":[3099,3110],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":84,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":84,"endColumn":10,"fix":{"range":[3113,3122],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":85,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":85,"endColumn":8,"fix":{"range":[3125,3132],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":87,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":87,"endColumn":8,"fix":{"range":[3137,3144],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":88,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":88,"endColumn":8,"fix":{"range":[3168,3175],"text":"      "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":88,"column":29,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":88,"endColumn":41,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[2606,3208],"text":", id } = gameState;\r\n\r\n     // Check for winner\r\n     const winner = checkConnect4Winner(board);\r\n     if (winner) {\r\n       gameState.status = 'completed';\r\n\r\n       if (winner !== 'tie') {\r\n         const winnerPlayer = players[winner];\r\n         if (winnerPlayer.id !== 'ai' && winnerPlayer.id) {\r\n           try {\r\n             updateUserStats(winnerPlayer.id, { connect4_wins: 1 });\r\n           } catch (statsError) {\r\n             console.error('Failed to update user stats:', statsError);\r\n           }\r\n         }\r\n       }\r\n\r\n       // Clean up game state\r\n       connect4Games.delete(id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":90,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":90,"endColumn":8,"fix":{"range":[3214,3221],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":91,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":91,"endColumn":10,"fix":{"range":[3261,3270],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":92,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":92,"endColumn":10,"fix":{"range":[3313,3322],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":92,"column":39,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":92,"endColumn":47,"fix":{"range":[3351,3359],"text":"0xFF_A5_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":92,"column":50,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":92,"endColumn":58,"fix":{"range":[3362,3370],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":93,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":93,"endColumn":10,"fix":{"range":[3373,3382],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":93,"column":77,"nodeType":"MemberExpression","endLine":93,"endColumn":92},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":94,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":94,"endColumn":10,"fix":{"range":[3496,3505],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":95,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":95,"endColumn":12,"fix":{"range":[3519,3530],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":96,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":96,"endColumn":12,"fix":{"range":[3552,3563],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":97,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":97,"endColumn":12,"fix":{"range":[3599,3610],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":98,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":98,"endColumn":10,"fix":{"range":[3625,3634],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":100,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":100,"endColumn":8,"fix":{"range":[3641,3648],"text":"      "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":100,"column":8,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":104,"endColumn":9,"fix":{"range":[3648,3898],"text":"await (interaction.replied || interaction.deferred ? safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] }) : safeInteractionReply(interaction, { embeds: [resultEmbed] }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":101,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":101,"endColumn":10,"fix":{"range":[3700,3709],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":102,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":102,"endColumn":8,"fix":{"range":[3795,3802],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":102,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":102,"endColumn":9,"fix":{"range":[3803,3803],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":103,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":103,"endColumn":10,"fix":{"range":[3812,3821],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":104,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":104,"endColumn":8,"fix":{"range":[3890,3897],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":105,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":105,"endColumn":8,"fix":{"range":[3900,3907],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":106,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":106,"endColumn":6,"fix":{"range":[3916,3921],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":108,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":108,"endColumn":6,"fix":{"range":[3926,3931],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":109,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":109,"endColumn":6,"fix":{"range":[3964,3969],"text":"    "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":109,"column":24,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":109,"endColumn":36,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[2606,3999],"text":", id } = gameState;\r\n\r\n     // Check for winner\r\n     const winner = checkConnect4Winner(board);\r\n     if (winner) {\r\n       gameState.status = 'completed';\r\n\r\n       if (winner !== 'tie') {\r\n         const winnerPlayer = players[winner];\r\n         if (winnerPlayer.id !== 'ai' && winnerPlayer.id) {\r\n           try {\r\n             updateUserStats(winnerPlayer.id, { connect4_wins: 1 });\r\n           } catch (statsError) {\r\n             console.error('Failed to update user stats:', statsError);\r\n           }\r\n         }\r\n       }\r\n\r\n       // Clean up game state\r\n       connect4Games.delete(gameState.id);\r\n\r\n       const resultEmbed = new EmbedBuilder()\r\n         .setTitle('üéØ Connect Four - Game Over!')\r\n         .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n         .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner]?.name || 'Unknown'} wins!**`)\r\n         .addFields({\r\n           name: 'Final Board',\r\n           value: formatConnect4Board(board),\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [resultEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     // Update game state in storage\r\n     connect4Games.set(id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":111,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":111,"endColumn":6,"fix":{"range":[4016,4021],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":112,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":112,"endColumn":8,"fix":{"range":[4055,4062],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":113,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":113,"endColumn":8,"fix":{"range":[4092,4099],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":113,"column":44,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":113,"endColumn":52,"fix":{"range":[4135,4143],"text":"0xFF_00_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":113,"column":55,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":113,"endColumn":63,"fix":{"range":[4146,4154],"text":"0xFF_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":114,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":114,"endColumn":8,"fix":{"range":[4157,4164],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":114,"column":27,"nodeType":"MemberExpression","endLine":114,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":114,"column":79,"nodeType":"MemberExpression","endLine":114,"endColumn":101},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":115,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":115,"endColumn":8,"fix":{"range":[4277,4284],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":116,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":116,"endColumn":10,"fix":{"range":[4298,4307],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":117,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":117,"endColumn":10,"fix":{"range":[4328,4337],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":118,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":118,"endColumn":10,"fix":{"range":[4373,4382],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":119,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":119,"endColumn":8,"fix":{"range":[4397,4404],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":121,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":121,"endColumn":6,"fix":{"range":[4411,4416],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":122,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":122,"endColumn":6,"fix":{"range":[4490,4495],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":123,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":123,"endColumn":6,"fix":{"range":[4533,4538],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":125,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":125,"endColumn":6,"fix":{"range":[4578,4583],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":126,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":126,"endColumn":8,"fix":{"range":[4620,4627],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":126,"column":24,"nodeType":"MemberExpression","endLine":126,"endColumn":37},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":128,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":128,"endColumn":8,"fix":{"range":[4699,4706],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":129,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":129,"endColumn":10,"fix":{"range":[4742,4751],"text":"        "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":129,"column":36,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":129,"endColumn":48,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[2606,4789],"text":", id } = gameState;\r\n\r\n     // Check for winner\r\n     const winner = checkConnect4Winner(board);\r\n     if (winner) {\r\n       gameState.status = 'completed';\r\n\r\n       if (winner !== 'tie') {\r\n         const winnerPlayer = players[winner];\r\n         if (winnerPlayer.id !== 'ai' && winnerPlayer.id) {\r\n           try {\r\n             updateUserStats(winnerPlayer.id, { connect4_wins: 1 });\r\n           } catch (statsError) {\r\n             console.error('Failed to update user stats:', statsError);\r\n           }\r\n         }\r\n       }\r\n\r\n       // Clean up game state\r\n       connect4Games.delete(gameState.id);\r\n\r\n       const resultEmbed = new EmbedBuilder()\r\n         .setTitle('üéØ Connect Four - Game Over!')\r\n         .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n         .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner]?.name || 'Unknown'} wins!**`)\r\n         .addFields({\r\n           name: 'Final Board',\r\n           value: formatConnect4Board(board),\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [resultEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     // Update game state in storage\r\n     connect4Games.set(gameState.id, gameState);\r\n\r\n     const embed = new EmbedBuilder()\r\n       .setTitle('üéØ Connect Four')\r\n       .setColor(currentPlayer === 'red' ? 0xFF0000 : 0xFFFF00)\r\n       .setDescription(`${players[currentPlayer]?.name || 'Unknown'}'s turn ${players[currentPlayer]?.symbol || '‚ùì'}`)\r\n       .addFields({\r\n         name: 'Game Board',\r\n         value: formatConnect4Board(board),\r\n         inline: false\r\n       });\r\n\r\n     // Create column buttons (0-6) - Split into two rows since max 5 per row\r\n     const row1 = new ActionRowBuilder();\r\n     const row2 = new ActionRowBuilder();\r\n\r\n     for (let col = 0; col < 7; col++) {\r\n       const canPlay = board[0][col] === null; // Check if top row is empty\r\n\r\n       const button = new ButtonBuilder()\r\n         .setCustomId(`c4_${col}_${id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":130,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":130,"endColumn":10,"fix":{"range":[4794,4803],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":131,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":131,"endColumn":10,"fix":{"range":[4828,4837],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":132,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":132,"endColumn":10,"fix":{"range":[4954,4963],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":134,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":134,"endColumn":8,"fix":{"range":[5030,5037],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":135,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":135,"endColumn":10,"fix":{"range":[5053,5062],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":136,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":136,"endColumn":8,"fix":{"range":[5091,5098],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":136,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":136,"endColumn":9,"fix":{"range":[5099,5099],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":137,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":137,"endColumn":10,"fix":{"range":[5108,5117],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":138,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":138,"endColumn":8,"fix":{"range":[5146,5153],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":139,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":139,"endColumn":6,"fix":{"range":[5156,5161],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":141,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":141,"endColumn":6,"fix":{"range":[5166,5171],"text":"    "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":141,"column":6,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":145,"endColumn":7,"fix":{"range":[5171,5437],"text":"await (interaction.replied || interaction.deferred ? safeInteractionUpdate(interaction, { embeds: [embed], components: [row1, row2] }) : safeInteractionReply(interaction, { embeds: [embed], components: [row1, row2] }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":142,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":142,"endColumn":8,"fix":{"range":[5223,5230],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":143,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":143,"endColumn":6,"fix":{"range":[5320,5325],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":143,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":143,"endColumn":7,"fix":{"range":[5326,5326],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":144,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":144,"endColumn":8,"fix":{"range":[5335,5342],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":145,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":145,"endColumn":6,"fix":{"range":[5431,5436],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":147,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":147,"endColumn":6,"fix":{"range":[5441,5446],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":148,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":148,"endColumn":6,"fix":{"range":[5476,5481],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":149,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":149,"endColumn":8,"fix":{"range":[5547,5554],"text":"      "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":149,"column":24,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":149,"endColumn":25,"fix":{"range":[5570,5571],"text":""}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":150,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":150,"endColumn":10,"fix":{"range":[5580,5589],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":151,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":151,"endColumn":12,"fix":{"range":[5596,5607],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":12,"fix":{"range":[5661,5672],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":153,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":153,"endColumn":14,"fix":{"range":[5696,5709],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":154,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":154,"endColumn":14,"fix":{"range":[5753,5766],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":155,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":155,"endColumn":12,"fix":{"range":[5816,5827],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":156,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":156,"endColumn":10,"fix":{"range":[5830,5839],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":156,"column":10,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":156,"endColumn":11,"fix":{"range":[5840,5840],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":157,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":157,"endColumn":12,"fix":{"range":[5860,5871],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":157,"column":12,"nodeType":"MemberExpression","messageId":"unexpected","endLine":157,"endColumn":25,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5871,5912],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":10,"fix":{"range":[5914,5923],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":8,"fix":{"range":[5926,5933],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":6,"fix":{"range":[5944,5949],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":161,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":161,"endColumn":4,"fix":{"range":[5952,5955],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":161,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":161,"endColumn":5,"fix":{"range":[5956,5956],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":162,"endColumn":6,"fix":{"range":[5974,5979],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":162,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":162,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5979,6028],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":163,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":163,"endColumn":6,"fix":{"range":[6030,6035],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":164,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":164,"endColumn":4,"fix":{"range":[6176,6179],"text":"  "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":177,"column":28,"nodeType":"MemberExpression","endLine":177,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":177,"column":28,"nodeType":"MemberExpression","endLine":177,"endColumn":38},{"ruleId":"complexity","severity":2,"message":"Function 'checkConnect4Winner' has a complexity of 26. Maximum allowed is 20.","line":185,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":232,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed.","line":185,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":185,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":189,"column":20,"nodeType":"MemberExpression","endLine":189,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":189,"column":20,"nodeType":"MemberExpression","endLine":189,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":190,"column":19,"nodeType":"MemberExpression","endLine":190,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":190,"column":51,"nodeType":"MemberExpression","endLine":190,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":190,"column":83,"nodeType":"MemberExpression","endLine":190,"endColumn":93},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":199,"column":20,"nodeType":"MemberExpression","endLine":199,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":199,"column":20,"nodeType":"MemberExpression","endLine":199,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":200,"column":19,"nodeType":"MemberExpression","endLine":200,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":200,"column":51,"nodeType":"MemberExpression","endLine":200,"endColumn":70},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":200,"column":83,"nodeType":"MemberExpression","endLine":200,"endColumn":102},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":209,"column":20,"nodeType":"MemberExpression","endLine":209,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":209,"column":20,"nodeType":"MemberExpression","endLine":209,"endColumn":30},{"ruleId":"max-len","severity":2,"message":"This line has a length of 125. Maximum allowed is 120.","line":210,"column":1,"nodeType":"Program","messageId":"max","endLine":210,"endColumn":126},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":219,"column":20,"nodeType":"MemberExpression","endLine":219,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":219,"column":20,"nodeType":"MemberExpression","endLine":219,"endColumn":30},{"ruleId":"max-len","severity":2,"message":"This line has a length of 125. Maximum allowed is 120.","line":220,"column":1,"nodeType":"Program","messageId":"max","endLine":220,"endColumn":126},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":231,"column":10,"nodeType":"Literal","messageId":"error","endLine":231,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[7984,7988],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[7984,7988],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":235,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":235,"endColumn":4,"fix":{"range":[8050,8053],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":236,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":236,"endColumn":6,"fix":{"range":[8060,8065],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":237,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":237,"endColumn":6,"fix":{"range":[8091,8096],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":238,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":238,"endColumn":8,"fix":{"range":[8158,8165],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":239,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":239,"endColumn":6,"fix":{"range":[8212,8217],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":241,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":241,"endColumn":6,"fix":{"range":[8222,8227],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":243,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":243,"endColumn":6,"fix":{"range":[8259,8264],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":244,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":244,"endColumn":6,"fix":{"range":[8312,8317],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":245,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":245,"endColumn":8,"fix":{"range":[8355,8362],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":245,"column":12,"nodeType":"MemberExpression","endLine":245,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":245,"column":12,"nodeType":"MemberExpression","endLine":245,"endColumn":22},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":246,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":246,"endColumn":10,"fix":{"range":[8398,8407],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":246,"column":10,"nodeType":"MemberExpression","endLine":246,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":246,"column":10,"nodeType":"MemberExpression","endLine":246,"endColumn":20},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":246,"column":31,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":246,"endColumn":54,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.currentPlayer","property":"currentPlayer"},"fix":{"range":[8240,8451],"text":", currentPlayer } = gameState;\r\n\r\n     // Find the lowest available row in the column\r\n     for (let row = 5; row >= 0; row--) {\r\n       if (board[row][column] === null) {\r\n         board[row][column] = currentPlayer"},"desc":"Replace `gameState.currentPlayer` with destructured property `currentPlayer`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":247,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":247,"endColumn":10,"fix":{"range":[8454,8463],"text":"        "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":247,"column":36,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":247,"endColumn":59,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.currentPlayer","property":"currentPlayer"},"fix":{"range":[8240,8512],"text":", currentPlayer } = gameState;\r\n\r\n     // Find the lowest available row in the column\r\n     for (let row = 5; row >= 0; row--) {\r\n       if (board[row][column] === null) {\r\n         board[row][column] = gameState.currentPlayer;\r\n         gameState.currentPlayer = currentPlayer"},"desc":"Replace `gameState.currentPlayer` with destructured property `currentPlayer`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":248,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":248,"endColumn":10,"fix":{"range":[8544,8553],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":249,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":249,"endColumn":8,"fix":{"range":[8567,8574],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":250,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":250,"endColumn":6,"fix":{"range":[8577,8582],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":252,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":252,"endColumn":6,"fix":{"range":[8587,8592],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":253,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":253,"endColumn":4,"fix":{"range":[8625,8628],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":253,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":253,"endColumn":5,"fix":{"range":[8629,8629],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":254,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":254,"endColumn":6,"fix":{"range":[8647,8652],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":254,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":254,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8652,8700],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":255,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":255,"endColumn":6,"fix":{"range":[8702,8707],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":256,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":256,"endColumn":4,"fix":{"range":[8722,8725],"text":"  "}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 21 to the 15 allowed.","line":259,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":259,"endColumn":27},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":260,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":260,"endColumn":4,"fix":{"range":[8782,8785],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":261,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":261,"endColumn":6,"fix":{"range":[8792,8797],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":262,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":262,"endColumn":6,"fix":{"range":[8827,8832],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":263,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":263,"endColumn":8,"fix":{"range":[8869,8876],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":263,"column":12,"nodeType":"MemberExpression","endLine":263,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":264,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":264,"endColumn":10,"fix":{"range":[8907,8916],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":265,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":265,"endColumn":8,"fix":{"range":[8945,8952],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":266,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":266,"endColumn":6,"fix":{"range":[8955,8960],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":268,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":268,"endColumn":6,"fix":{"range":[8965,8970],"text":"    "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":268,"column":48,"nodeType":"Literal","messageId":"error","endLine":268,"endColumn":52,"suggestions":[{"messageId":"remove","fix":{"range":[9012,9016],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[9012,9016],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":270,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":270,"endColumn":6,"fix":{"range":[9021,9026],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":271,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":271,"endColumn":8,"fix":{"range":[9049,9056],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":272,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":272,"endColumn":10,"fix":{"range":[9072,9081],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":273,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":273,"endColumn":10,"fix":{"range":[9124,9133],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":274,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":274,"endColumn":10,"fix":{"range":[9210,9219],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":275,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":275,"endColumn":10,"fix":{"range":[9306,9315],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":276,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":276,"endColumn":8,"fix":{"range":[9394,9401],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":278,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":278,"endColumn":8,"fix":{"range":[9406,9413],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":279,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":279,"endColumn":10,"fix":{"range":[9431,9440],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":280,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":280,"endColumn":10,"fix":{"range":[9487,9496],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":281,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":281,"endColumn":10,"fix":{"range":[9558,9567],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":283,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":283,"endColumn":10,"fix":{"range":[9614,9623],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":284,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":284,"endColumn":10,"fix":{"range":[9683,9692],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":286,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":286,"endColumn":10,"fix":{"range":[9741,9750],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":287,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":287,"endColumn":10,"fix":{"range":[9768,9777],"text":"        "}},{"ruleId":"unicorn/prefer-array-find","severity":2,"message":"Prefer `.find(‚Ä¶)` over `.filter(‚Ä¶)`.","line":287,"column":48,"nodeType":"Identifier","messageId":"error-variable","endLine":287,"endColumn":54,"fix":{"range":[37,13755],"text":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { connect4Games } from '../game-states.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\nimport { safeInteractionReply, safeInteractionUpdate } from '../interactionHandlers.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('connect4')\r\n  .setDescription('Play Connect Four - strategic dropping game')\r\n  .addUserOption(option =>\r\n    option.setName('opponent')\r\n      .setDescription('Player to challenge')\r\n      .setRequired(true))\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('AI difficulty (if playing against AI)')\r\n      .addChoices(\r\n        { name: 'Easy', value: 'easy' },\r\n        { name: 'Medium', value: 'medium' },\r\n        { name: 'Hard', value: 'hard' }\r\n      )\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n   try {\r\n     const opponent = interaction.options.getUser('opponent');\r\n     const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n\r\n     // Validation: Cannot play against self\r\n     if (opponent.id === interaction.user.id) {\r\n       throw new CommandError('You cannot play against yourself!', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     // Validation: Require difficulty for AI games\r\n     if (opponent.bot && !difficulty) {\r\n       throw new CommandError('Please specify difficulty when playing against AI.', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     // Generate unique game ID\r\n     const gameId = `c4_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n     // Initialize game state\r\n     const gameState = {\r\n       id: gameId,\r\n       board: Array(6).fill(null).map(() => Array(7).fill(null)),\r\n       players: {\r\n         red: { id: interaction.user.id, name: interaction.user.username, symbol: 'üî¥' },\r\n         yellow: { id: opponent.id, name: opponent.username, symbol: 'üü°' }\r\n       },\r\n       currentPlayer: 'red',\r\n       status: 'active',\r\n       isAI: opponent.bot,\r\n       difficulty: difficulty || 'medium',\r\n       created: Date.now()\r\n     };\r\n\r\n     // Store game state\r\n     connect4Games.set(gameId, gameState);\r\n\r\n     await sendConnect4Board(interaction, gameState);\r\n   } catch (error) {\r\n     await handleCommandError(interaction, error);\r\n   }\r\n}\r\n\r\nasync function sendConnect4Board(interaction, gameState) {\r\n   try {\r\n     const { board, players, currentPlayer, status, isAI, difficulty } = gameState;\r\n\r\n     // Check for winner\r\n     const winner = checkConnect4Winner(board);\r\n     if (winner) {\r\n       gameState.status = 'completed';\r\n\r\n       if (winner !== 'tie') {\r\n         const winnerPlayer = players[winner];\r\n         if (winnerPlayer.id !== 'ai' && winnerPlayer.id) {\r\n           try {\r\n             updateUserStats(winnerPlayer.id, { connect4_wins: 1 });\r\n           } catch (statsError) {\r\n             console.error('Failed to update user stats:', statsError);\r\n           }\r\n         }\r\n       }\r\n\r\n       // Clean up game state\r\n       connect4Games.delete(gameState.id);\r\n\r\n       const resultEmbed = new EmbedBuilder()\r\n         .setTitle('üéØ Connect Four - Game Over!')\r\n         .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n         .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner]?.name || 'Unknown'} wins!**`)\r\n         .addFields({\r\n           name: 'Final Board',\r\n           value: formatConnect4Board(board),\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [resultEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     // Update game state in storage\r\n     connect4Games.set(gameState.id, gameState);\r\n\r\n     const embed = new EmbedBuilder()\r\n       .setTitle('üéØ Connect Four')\r\n       .setColor(currentPlayer === 'red' ? 0xFF0000 : 0xFFFF00)\r\n       .setDescription(`${players[currentPlayer]?.name || 'Unknown'}'s turn ${players[currentPlayer]?.symbol || '‚ùì'}`)\r\n       .addFields({\r\n         name: 'Game Board',\r\n         value: formatConnect4Board(board),\r\n         inline: false\r\n       });\r\n\r\n     // Create column buttons (0-6) - Split into two rows since max 5 per row\r\n     const row1 = new ActionRowBuilder();\r\n     const row2 = new ActionRowBuilder();\r\n\r\n     for (let col = 0; col < 7; col++) {\r\n       const canPlay = board[0][col] === null; // Check if top row is empty\r\n\r\n       const button = new ButtonBuilder()\r\n         .setCustomId(`c4_${col}_${gameState.id}`)\r\n         .setLabel(`${col + 1}`)\r\n         .setStyle(canPlay ? (currentPlayer === 'red' ? ButtonStyle.Danger : ButtonStyle.Secondary) : ButtonStyle.Secondary)\r\n         .setDisabled(!canPlay || (isAI && currentPlayer === 'yellow'));\r\n\r\n       if (col < 5) {\r\n         row1.addComponents(button);\r\n       } else {\r\n         row2.addComponents(button);\r\n       }\r\n     }\r\n\r\n     if (interaction.replied || interaction.deferred) {\r\n       await safeInteractionUpdate(interaction, { embeds: [embed], components: [row1, row2] });\r\n     } else {\r\n       await safeInteractionReply(interaction, { embeds: [embed], components: [row1, row2] });\r\n     }\r\n\r\n     // AI move if it's AI's turn\r\n     if (isAI && currentPlayer === 'yellow' && status === 'active') {\r\n       setTimeout(async () => {\r\n         try {\r\n           const aiMove = getConnect4AIMove(board, difficulty);\r\n           if (aiMove !== null) {\r\n             await makeConnect4Move(gameState, aiMove);\r\n             await sendConnect4Board(interaction, gameState);\r\n           }\r\n         } catch (aiError) {\r\n           console.error('AI move error:', aiError);\r\n         }\r\n       }, 1500);\r\n     }\r\n   } catch (error) {\r\n     console.error('sendConnect4Board error:', error);\r\n     await handleCommandError(interaction, new CommandError('Failed to update game board.', 'UNKNOWN_ERROR', { originalError: error.message }));\r\n   }\r\n}\r\n\r\nfunction formatConnect4Board(board) {\r\n  const symbols = {\r\n    null: '‚¨ú',\r\n    red: 'üî¥',\r\n    yellow: 'üü°'\r\n  };\r\n\r\n  let formatted = '';\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      formatted += symbols[board[row][col]] || '‚¨ú';\r\n    }\r\n    formatted += '\\n';\r\n  }\r\n  formatted += '1Ô∏è‚É£ 2Ô∏è‚É£ 3Ô∏è‚É£ 4Ô∏è‚É£ 5Ô∏è‚É£ 6Ô∏è‚É£ 7Ô∏è‚É£';\r\n  return formatted;\r\n}\r\n\r\nfunction checkConnect4Winner(board) {\r\n  // Check horizontal\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row][col + 1] === cell && board[row][col + 2] === cell && board[row][col + 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check vertical\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col] === cell && board[row + 2][col] === cell && board[row + 3][col] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check diagonal (top-left to bottom-right)\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col + 1] === cell && board[row + 2][col + 2] === cell && board[row + 3][col + 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check diagonal (top-right to bottom-left)\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 3; col < 7; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col - 1] === cell && board[row + 2][col - 2] === cell && board[row + 3][col - 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check for tie\r\n  if (board[0].every(cell => cell !== null)) {\r\n    return 'tie';\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nasync function makeConnect4Move(gameState, column) {\r\n   try {\r\n     // Validate column input\r\n     if (column < 0 || column > 6 || !Number.isInteger(column)) {\r\n       throw new Error(`Invalid column: ${column}`);\r\n     }\r\n\r\n     const { board } = gameState;\r\n\r\n     // Find the lowest available row in the column\r\n     for (let row = 5; row >= 0; row--) {\r\n       if (board[row][column] === null) {\r\n         board[row][column] = gameState.currentPlayer;\r\n         gameState.currentPlayer = gameState.currentPlayer === 'red' ? 'yellow' : 'red';\r\n         return true;\r\n       }\r\n     }\r\n\r\n     return false; // Column is full\r\n   } catch (error) {\r\n     console.error('makeConnect4Move error:', error);\r\n     return false;\r\n   }\r\n}\r\n\r\nfunction getConnect4AIMove(board, difficulty) {\r\n   try {\r\n     const availableColumns = [];\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] === null) {\r\n         availableColumns.push(col);\r\n       }\r\n     }\r\n\r\n     if (availableColumns.length === 0) return null;\r\n\r\n     switch (difficulty) {\r\n       case 'easy': {\r\n         // Random move, but prefer center columns\r\n         const centerColumns = availableColumns.filter(col => col >= 2 && col <= 4);\r\n         const preferredColumns = centerColumns.length > 0 ? centerColumns : availableColumns;\r\n         return preferredColumns[Math.floor(Math.random() * preferredColumns.length)];\r\n       }\r\n\r\n       case 'medium': {\r\n         // Check for winning moves and blocking moves\r\n         const winningCol = findConnect4WinningMove(board, 'yellow');\r\n         if (winningCol !== null) return winningCol;\r\n\r\n         const blockingCol = findConnect4WinningMove(board, 'red');\r\n         if (blockingCol !== null) return blockingCol;\r\n\r\n         // Prefer center\r\n         const center = [3, 2, 4, 1, 5, 0, 6].find(col => availableColumns.includes(col));\r\n         return center !== undefined ? center : availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n       }\r\n\r\n       case 'hard': {\r\n         // Use minimax algorithm for strategic play\r\n         return getConnect4BestMove(board, 'yellow');\r\n       }\r\n\r\n       default: {\r\n         return availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n       }\r\n     }\r\n   } catch (error) {\r\n     console.error('getConnect4AIMove error:', error);\r\n     // Fallback to random move\r\n     const fallbackColumns = [];\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] === null) {\r\n         fallbackColumns.push(col);\r\n       }\r\n     }\r\n     return fallbackColumns.length > 0 ? fallbackColumns[Math.floor(Math.random() * fallbackColumns.length)] : null;\r\n   }\r\n}\r\n\r\nfunction findConnect4WinningMove(board, player) {\r\n  for (let col = 0; col < 7; col++) {\r\n    if (board[0][col] !== null) continue;\r\n\r\n    // Test the move\r\n    const testBoard = board.map(row => [...row]);\r\n    for (let row = 5; row >= 0; row--) {\r\n      if (testBoard[row][col] === null) {\r\n        testBoard[row][col] = player;\r\n        if (checkConnect4Winner(testBoard) === player) {\r\n          return col;\r\n        }\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getConnect4BestMove(board, player) {\r\n   try {\r\n     let bestScore = -Infinity;\r\n     let bestCol = null;\r\n\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] !== null) continue;\r\n\r\n       const testBoard = board.map(row => [...row]);\r\n       let moveValid = false;\r\n\r\n       for (let row = 5; row >= 0; row--) {\r\n         if (testBoard[row][col] === null) {\r\n           testBoard[row][col] = player;\r\n           const score = evaluateConnect4Position(testBoard, 0, player === 'yellow' ? 'red' : 'yellow');\r\n           if (score > bestScore) {\r\n             bestScore = score;\r\n             bestCol = col;\r\n           }\r\n           moveValid = true;\r\n           break;\r\n         }\r\n       }\r\n\r\n       if (!moveValid) continue; // Skip if no valid move in this column\r\n     }\r\n\r\n     // Fallback to center column if no best move found\r\n     return bestCol !== null ? bestCol : 3;\r\n   } catch (error) {\r\n     console.error('getConnect4BestMove error:', error);\r\n     return 3; // Return center column as fallback\r\n   }\r\n}\r\n\r\nfunction evaluateConnect4Position(board, depth, player) {\r\n  const winner = checkConnect4Winner(board);\r\n  if (winner === 'yellow') return 100 - depth;\r\n  if (winner === 'red') return depth - 100;\r\n  if (winner === 'tie') return 0;\r\n\r\n  // Simple heuristic: count potential winning lines\r\n  let score = 0;\r\n\r\n  // Check for 3 in a row (open ended)\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const window = [board[row][col], board[row][col + 1], board[row][col + 2], board[row][col + 3]];\r\n      score += evaluateWindow(window, player);\r\n    }\r\n  }\r\n\r\n  // Check vertical\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      const window = [board[row][col], board[row + 1][col], board[row + 2][col], board[row + 3][col]];\r\n      score += evaluateWindow(window, player);\r\n    }\r\n  }\r\n\r\n  return score;\r\n}\r\n\r\nfunction evaluateWindow(window, player) {\r\n  const opponent = player === 'yellow' ? 'red' : 'yellow';\r\n  let score = 0;\r\n\r\n  if (window.filter(cell => cell === player).length === 4) score += 100;\r\n  else if (window.filter(cell => cell === player).length === 3 && window.filter(cell => cell === null).length === 1) score += 10;\r\n  else if (window.filter(cell => cell === player).length === 2 && window.filter(cell => cell === null).length === 2) score += 2;\r\n\r\n  if (window.filter(cell => cell === opponent).length === 3 && window.filter(cell => cell === null).length === 1) score -= 80;\r\n\r\n  return score;\r\n}\r\n\r\nexport { sendConnect4Board, makeConnect4Move };"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 126. Maximum allowed is 120.","line":288,"column":1,"nodeType":"Program","messageId":"max","endLine":288,"endColumn":127},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":288,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":288,"endColumn":10,"fix":{"range":[9863,9872],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":289,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":289,"endColumn":8,"fix":{"range":[9991,9998],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":291,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":291,"endColumn":8,"fix":{"range":[10003,10010],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":292,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":292,"endColumn":10,"fix":{"range":[10026,10035],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":293,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":293,"endColumn":10,"fix":{"range":[10080,10089],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":294,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":294,"endColumn":8,"fix":{"range":[10135,10142],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":296,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":296,"endColumn":8,"fix":{"range":[10147,10154],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":297,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":297,"endColumn":10,"fix":{"range":[10166,10175],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":298,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":298,"endColumn":8,"fix":{"range":[10254,10261],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":299,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":299,"endColumn":6,"fix":{"range":[10264,10269],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":300,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":300,"endColumn":4,"fix":{"range":[10272,10275],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":300,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":300,"endColumn":5,"fix":{"range":[10276,10276],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":301,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":301,"endColumn":6,"fix":{"range":[10294,10299],"text":"    "}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (408). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":408,"endColumn":48},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":301,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":301,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10299,10348],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":302,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":302,"endColumn":6,"fix":{"range":[10350,10355],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":303,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":303,"endColumn":6,"fix":{"range":[10383,10388],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":304,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":304,"endColumn":6,"fix":{"range":[10417,10422],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":305,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":305,"endColumn":8,"fix":{"range":[10459,10466],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":305,"column":12,"nodeType":"MemberExpression","endLine":305,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":306,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":306,"endColumn":10,"fix":{"range":[10497,10506],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":307,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":307,"endColumn":8,"fix":{"range":[10534,10541],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":308,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":308,"endColumn":6,"fix":{"range":[10544,10549],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":309,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":309,"endColumn":6,"fix":{"range":[10552,10557],"text":"    "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":309,"column":112,"nodeType":"Literal","messageId":"error","endLine":309,"endColumn":116,"suggestions":[{"messageId":"replace","fix":{"range":[10663,10667],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":310,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":310,"endColumn":4,"fix":{"range":[10670,10673],"text":"  "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":315,"column":9,"nodeType":"MemberExpression","endLine":315,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":320,"column":11,"nodeType":"MemberExpression","endLine":320,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":320,"column":11,"nodeType":"MemberExpression","endLine":320,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":321,"column":9,"nodeType":"MemberExpression","endLine":321,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":321,"column":9,"nodeType":"MemberExpression","endLine":321,"endColumn":23},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":329,"column":10,"nodeType":"Literal","messageId":"error","endLine":329,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[11151,11155],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[11151,11155],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed.","line":332,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":332,"endColumn":29},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":333,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":333,"endColumn":4,"fix":{"range":[11210,11213],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":334,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":334,"endColumn":6,"fix":{"range":[11220,11225],"text":"    "}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.NEGATIVE_INFINITY` over `-Infinity`.","line":334,"column":22,"nodeType":"UnaryExpression","messageId":"error","endLine":334,"endColumn":31,"fix":{"range":[11241,11250],"text":"Number.NEGATIVE_INFINITY"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":335,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":335,"endColumn":6,"fix":{"range":[11253,11258],"text":"    "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":335,"column":20,"nodeType":"Literal","messageId":"error","endLine":335,"endColumn":24,"suggestions":[{"messageId":"remove","fix":{"range":[11269,11276],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[11272,11276],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":337,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":337,"endColumn":6,"fix":{"range":[11281,11286],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":338,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":338,"endColumn":8,"fix":{"range":[11323,11330],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":338,"column":12,"nodeType":"MemberExpression","endLine":338,"endColumn":25},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":340,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":340,"endColumn":8,"fix":{"range":[11371,11378],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":341,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":341,"endColumn":8,"fix":{"range":[11425,11432],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":343,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":343,"endColumn":8,"fix":{"range":[11458,11465],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":344,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":344,"endColumn":10,"fix":{"range":[11503,11512],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":344,"column":14,"nodeType":"MemberExpression","endLine":344,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":344,"column":14,"nodeType":"MemberExpression","endLine":344,"endColumn":28},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":345,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":345,"endColumn":12,"fix":{"range":[11549,11560],"text":"          "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":345,"column":12,"nodeType":"MemberExpression","endLine":345,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":345,"column":12,"nodeType":"MemberExpression","endLine":345,"endColumn":26},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":346,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":346,"endColumn":12,"fix":{"range":[11591,11602],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":347,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":347,"endColumn":12,"fix":{"range":[11697,11708],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":347,"column":12,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":350,"endColumn":13},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":348,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":348,"endColumn":14,"fix":{"range":[11734,11747],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":349,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":349,"endColumn":14,"fix":{"range":[11767,11780],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":350,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":350,"endColumn":12,"fix":{"range":[11796,11807],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":351,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":351,"endColumn":12,"fix":{"range":[11810,11821],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":352,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":352,"endColumn":12,"fix":{"range":[11840,11851],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":353,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":353,"endColumn":10,"fix":{"range":[11859,11868],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":354,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":354,"endColumn":8,"fix":{"range":[11871,11878],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":356,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":356,"endColumn":8,"fix":{"range":[11883,11890],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":357,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":357,"endColumn":6,"fix":{"range":[11957,11962],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":359,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":359,"endColumn":6,"fix":{"range":[11967,11972],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":360,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":360,"endColumn":6,"fix":{"range":[12024,12029],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":361,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":361,"endColumn":4,"fix":{"range":[12069,12072],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":361,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":361,"endColumn":5,"fix":{"range":[12073,12073],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":362,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":362,"endColumn":6,"fix":{"range":[12091,12096],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":362,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":362,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[12096,12147],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":363,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":363,"endColumn":6,"fix":{"range":[12149,12154],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":364,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":364,"endColumn":4,"fix":{"range":[12201,12204],"text":"  "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":379,"column":23,"nodeType":"MemberExpression","endLine":379,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":379,"column":23,"nodeType":"MemberExpression","endLine":379,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":379,"column":40,"nodeType":"MemberExpression","endLine":379,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":379,"column":61,"nodeType":"MemberExpression","endLine":379,"endColumn":71},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":379,"column":82,"nodeType":"MemberExpression","endLine":379,"endColumn":92},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":23,"nodeType":"MemberExpression","endLine":387,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":23,"nodeType":"MemberExpression","endLine":387,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":40,"nodeType":"MemberExpression","endLine":387,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":61,"nodeType":"MemberExpression","endLine":387,"endColumn":80},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":82,"nodeType":"MemberExpression","endLine":387,"endColumn":101},{"ruleId":"max-len","severity":2,"message":"This line has a length of 129. Maximum allowed is 120.","line":400,"column":1,"nodeType":"Program","messageId":"max","endLine":400,"endColumn":130},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":401,"column":1,"nodeType":"Program","messageId":"max","endLine":401,"endColumn":129},{"ruleId":"max-len","severity":2,"message":"This line has a length of 126. Maximum allowed is 120.","line":403,"column":1,"nodeType":"Program","messageId":"max","endLine":403,"endColumn":127}],"suppressedMessages":[],"errorCount":259,"fatalErrorCount":0,"warningCount":57,"fixableErrorCount":230,"fixableWarningCount":0,"source":"// Module file for Connect4 command\r\nimport { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { connect4Games } from '../game-states.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\nimport { safeInteractionReply, safeInteractionUpdate } from '../interactionHandlers.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('connect4')\r\n  .setDescription('Play Connect Four - strategic dropping game')\r\n  .addUserOption(option =>\r\n    option.setName('opponent')\r\n      .setDescription('Player to challenge')\r\n      .setRequired(true))\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('AI difficulty (if playing against AI)')\r\n      .addChoices(\r\n        { name: 'Easy', value: 'easy' },\r\n        { name: 'Medium', value: 'medium' },\r\n        { name: 'Hard', value: 'hard' }\r\n      )\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n   try {\r\n     const opponent = interaction.options.getUser('opponent');\r\n     const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n\r\n     // Validation: Cannot play against self\r\n     if (opponent.id === interaction.user.id) {\r\n       throw new CommandError('You cannot play against yourself!', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     // Validation: Require difficulty for AI games\r\n     if (opponent.bot && !difficulty) {\r\n       throw new CommandError('Please specify difficulty when playing against AI.', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     // Generate unique game ID\r\n     const gameId = `c4_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n     // Initialize game state\r\n     const gameState = {\r\n       id: gameId,\r\n       board: Array(6).fill(null).map(() => Array(7).fill(null)),\r\n       players: {\r\n         red: { id: interaction.user.id, name: interaction.user.username, symbol: 'üî¥' },\r\n         yellow: { id: opponent.id, name: opponent.username, symbol: 'üü°' }\r\n       },\r\n       currentPlayer: 'red',\r\n       status: 'active',\r\n       isAI: opponent.bot,\r\n       difficulty: difficulty || 'medium',\r\n       created: Date.now()\r\n     };\r\n\r\n     // Store game state\r\n     connect4Games.set(gameId, gameState);\r\n\r\n     await sendConnect4Board(interaction, gameState);\r\n   } catch (error) {\r\n     await handleCommandError(interaction, error);\r\n   }\r\n}\r\n\r\nasync function sendConnect4Board(interaction, gameState) {\r\n   try {\r\n     const { board, players, currentPlayer, status, isAI, difficulty } = gameState;\r\n\r\n     // Check for winner\r\n     const winner = checkConnect4Winner(board);\r\n     if (winner) {\r\n       gameState.status = 'completed';\r\n\r\n       if (winner !== 'tie') {\r\n         const winnerPlayer = players[winner];\r\n         if (winnerPlayer.id !== 'ai' && winnerPlayer.id) {\r\n           try {\r\n             updateUserStats(winnerPlayer.id, { connect4_wins: 1 });\r\n           } catch (statsError) {\r\n             console.error('Failed to update user stats:', statsError);\r\n           }\r\n         }\r\n       }\r\n\r\n       // Clean up game state\r\n       connect4Games.delete(gameState.id);\r\n\r\n       const resultEmbed = new EmbedBuilder()\r\n         .setTitle('üéØ Connect Four - Game Over!')\r\n         .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n         .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner]?.name || 'Unknown'} wins!**`)\r\n         .addFields({\r\n           name: 'Final Board',\r\n           value: formatConnect4Board(board),\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [resultEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     // Update game state in storage\r\n     connect4Games.set(gameState.id, gameState);\r\n\r\n     const embed = new EmbedBuilder()\r\n       .setTitle('üéØ Connect Four')\r\n       .setColor(currentPlayer === 'red' ? 0xFF0000 : 0xFFFF00)\r\n       .setDescription(`${players[currentPlayer]?.name || 'Unknown'}'s turn ${players[currentPlayer]?.symbol || '‚ùì'}`)\r\n       .addFields({\r\n         name: 'Game Board',\r\n         value: formatConnect4Board(board),\r\n         inline: false\r\n       });\r\n\r\n     // Create column buttons (0-6) - Split into two rows since max 5 per row\r\n     const row1 = new ActionRowBuilder();\r\n     const row2 = new ActionRowBuilder();\r\n\r\n     for (let col = 0; col < 7; col++) {\r\n       const canPlay = board[0][col] === null; // Check if top row is empty\r\n\r\n       const button = new ButtonBuilder()\r\n         .setCustomId(`c4_${col}_${gameState.id}`)\r\n         .setLabel(`${col + 1}`)\r\n         .setStyle(canPlay ? (currentPlayer === 'red' ? ButtonStyle.Danger : ButtonStyle.Secondary) : ButtonStyle.Secondary)\r\n         .setDisabled(!canPlay || (isAI && currentPlayer === 'yellow'));\r\n\r\n       if (col < 5) {\r\n         row1.addComponents(button);\r\n       } else {\r\n         row2.addComponents(button);\r\n       }\r\n     }\r\n\r\n     if (interaction.replied || interaction.deferred) {\r\n       await safeInteractionUpdate(interaction, { embeds: [embed], components: [row1, row2] });\r\n     } else {\r\n       await safeInteractionReply(interaction, { embeds: [embed], components: [row1, row2] });\r\n     }\r\n\r\n     // AI move if it's AI's turn\r\n     if (isAI && currentPlayer === 'yellow' && status === 'active') {\r\n       setTimeout(async () => {\r\n         try {\r\n           const aiMove = getConnect4AIMove(board, difficulty);\r\n           if (aiMove !== null) {\r\n             await makeConnect4Move(gameState, aiMove);\r\n             await sendConnect4Board(interaction, gameState);\r\n           }\r\n         } catch (aiError) {\r\n           console.error('AI move error:', aiError);\r\n         }\r\n       }, 1500);\r\n     }\r\n   } catch (error) {\r\n     console.error('sendConnect4Board error:', error);\r\n     await handleCommandError(interaction, new CommandError('Failed to update game board.', 'UNKNOWN_ERROR', { originalError: error.message }));\r\n   }\r\n}\r\n\r\nfunction formatConnect4Board(board) {\r\n  const symbols = {\r\n    null: '‚¨ú',\r\n    red: 'üî¥',\r\n    yellow: 'üü°'\r\n  };\r\n\r\n  let formatted = '';\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      formatted += symbols[board[row][col]] || '‚¨ú';\r\n    }\r\n    formatted += '\\n';\r\n  }\r\n  formatted += '1Ô∏è‚É£ 2Ô∏è‚É£ 3Ô∏è‚É£ 4Ô∏è‚É£ 5Ô∏è‚É£ 6Ô∏è‚É£ 7Ô∏è‚É£';\r\n  return formatted;\r\n}\r\n\r\nfunction checkConnect4Winner(board) {\r\n  // Check horizontal\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row][col + 1] === cell && board[row][col + 2] === cell && board[row][col + 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check vertical\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col] === cell && board[row + 2][col] === cell && board[row + 3][col] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check diagonal (top-left to bottom-right)\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col + 1] === cell && board[row + 2][col + 2] === cell && board[row + 3][col + 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check diagonal (top-right to bottom-left)\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 3; col < 7; col++) {\r\n      const cell = board[row][col];\r\n      if (cell && board[row + 1][col - 1] === cell && board[row + 2][col - 2] === cell && board[row + 3][col - 3] === cell) {\r\n        return cell;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Check for tie\r\n  if (board[0].every(cell => cell !== null)) {\r\n    return 'tie';\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nasync function makeConnect4Move(gameState, column) {\r\n   try {\r\n     // Validate column input\r\n     if (column < 0 || column > 6 || !Number.isInteger(column)) {\r\n       throw new Error(`Invalid column: ${column}`);\r\n     }\r\n\r\n     const { board } = gameState;\r\n\r\n     // Find the lowest available row in the column\r\n     for (let row = 5; row >= 0; row--) {\r\n       if (board[row][column] === null) {\r\n         board[row][column] = gameState.currentPlayer;\r\n         gameState.currentPlayer = gameState.currentPlayer === 'red' ? 'yellow' : 'red';\r\n         return true;\r\n       }\r\n     }\r\n\r\n     return false; // Column is full\r\n   } catch (error) {\r\n     console.error('makeConnect4Move error:', error);\r\n     return false;\r\n   }\r\n}\r\n\r\nfunction getConnect4AIMove(board, difficulty) {\r\n   try {\r\n     const availableColumns = [];\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] === null) {\r\n         availableColumns.push(col);\r\n       }\r\n     }\r\n\r\n     if (availableColumns.length === 0) return null;\r\n\r\n     switch (difficulty) {\r\n       case 'easy': {\r\n         // Random move, but prefer center columns\r\n         const centerColumns = availableColumns.filter(col => col >= 2 && col <= 4);\r\n         const preferredColumns = centerColumns.length > 0 ? centerColumns : availableColumns;\r\n         return preferredColumns[Math.floor(Math.random() * preferredColumns.length)];\r\n       }\r\n\r\n       case 'medium': {\r\n         // Check for winning moves and blocking moves\r\n         const winningCol = findConnect4WinningMove(board, 'yellow');\r\n         if (winningCol !== null) return winningCol;\r\n\r\n         const blockingCol = findConnect4WinningMove(board, 'red');\r\n         if (blockingCol !== null) return blockingCol;\r\n\r\n         // Prefer center\r\n         const centers = [3, 2, 4, 1, 5, 0, 6].filter(col => availableColumns.includes(col));\r\n         return centers[0] !== undefined ? centers[0] : availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n       }\r\n\r\n       case 'hard': {\r\n         // Use minimax algorithm for strategic play\r\n         return getConnect4BestMove(board, 'yellow');\r\n       }\r\n\r\n       default: {\r\n         return availableColumns[Math.floor(Math.random() * availableColumns.length)];\r\n       }\r\n     }\r\n   } catch (error) {\r\n     console.error('getConnect4AIMove error:', error);\r\n     // Fallback to random move\r\n     const fallbackColumns = [];\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] === null) {\r\n         fallbackColumns.push(col);\r\n       }\r\n     }\r\n     return fallbackColumns.length > 0 ? fallbackColumns[Math.floor(Math.random() * fallbackColumns.length)] : null;\r\n   }\r\n}\r\n\r\nfunction findConnect4WinningMove(board, player) {\r\n  for (let col = 0; col < 7; col++) {\r\n    if (board[0][col] !== null) continue;\r\n\r\n    // Test the move\r\n    const testBoard = board.map(row => [...row]);\r\n    for (let row = 5; row >= 0; row--) {\r\n      if (testBoard[row][col] === null) {\r\n        testBoard[row][col] = player;\r\n        if (checkConnect4Winner(testBoard) === player) {\r\n          return col;\r\n        }\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction getConnect4BestMove(board, player) {\r\n   try {\r\n     let bestScore = -Infinity;\r\n     let bestCol = null;\r\n\r\n     for (let col = 0; col < 7; col++) {\r\n       if (board[0][col] !== null) continue;\r\n\r\n       const testBoard = board.map(row => [...row]);\r\n       let moveValid = false;\r\n\r\n       for (let row = 5; row >= 0; row--) {\r\n         if (testBoard[row][col] === null) {\r\n           testBoard[row][col] = player;\r\n           const score = evaluateConnect4Position(testBoard, 0, player === 'yellow' ? 'red' : 'yellow');\r\n           if (score > bestScore) {\r\n             bestScore = score;\r\n             bestCol = col;\r\n           }\r\n           moveValid = true;\r\n           break;\r\n         }\r\n       }\r\n\r\n       if (!moveValid) continue; // Skip if no valid move in this column\r\n     }\r\n\r\n     // Fallback to center column if no best move found\r\n     return bestCol !== null ? bestCol : 3;\r\n   } catch (error) {\r\n     console.error('getConnect4BestMove error:', error);\r\n     return 3; // Return center column as fallback\r\n   }\r\n}\r\n\r\nfunction evaluateConnect4Position(board, depth, player) {\r\n  const winner = checkConnect4Winner(board);\r\n  if (winner === 'yellow') return 100 - depth;\r\n  if (winner === 'red') return depth - 100;\r\n  if (winner === 'tie') return 0;\r\n\r\n  // Simple heuristic: count potential winning lines\r\n  let score = 0;\r\n\r\n  // Check for 3 in a row (open ended)\r\n  for (let row = 0; row < 6; row++) {\r\n    for (let col = 0; col < 4; col++) {\r\n      const window = [board[row][col], board[row][col + 1], board[row][col + 2], board[row][col + 3]];\r\n      score += evaluateWindow(window, player);\r\n    }\r\n  }\r\n\r\n  // Check vertical\r\n  for (let row = 0; row < 3; row++) {\r\n    for (let col = 0; col < 7; col++) {\r\n      const window = [board[row][col], board[row + 1][col], board[row + 2][col], board[row + 3][col]];\r\n      score += evaluateWindow(window, player);\r\n    }\r\n  }\r\n\r\n  return score;\r\n}\r\n\r\nfunction evaluateWindow(window, player) {\r\n  const opponent = player === 'yellow' ? 'red' : 'yellow';\r\n  let score = 0;\r\n\r\n  if (window.filter(cell => cell === player).length === 4) score += 100;\r\n  else if (window.filter(cell => cell === player).length === 3 && window.filter(cell => cell === null).length === 1) score += 10;\r\n  else if (window.filter(cell => cell === player).length === 2 && window.filter(cell => cell === null).length === 2) score += 2;\r\n\r\n  if (window.filter(cell => cell === opponent).length === 3 && window.filter(cell => cell === null).length === 1) score -= 80;\r\n\r\n  return score;\r\n}\r\n\r\nexport { sendConnect4Board, makeConnect4Move };","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\echo.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('echo')\r\n  .setDescription('Echoes the provided text')\r\n  .addStringOption(opt => opt.setName('text').setDescription('Text to echo').setRequired(true));\r\n\r\nexport async function execute(interaction) {\r\n  const text = interaction.options.getString('text');\r\n  await interaction.reply(text);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\economy.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'addBalance' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'validateUser' is defined but never used.","line":17,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":89},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (386). Maximum allowed is 100.","line":37,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":422,"endColumn":2},{"ruleId":"max-lines-per-function","severity":1,"message":"Async arrow function has too many lines (382). Maximum allowed is 100.","line":38,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":419,"endColumn":3},{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (129). Maximum allowed is 30.","line":38,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":419,"endColumn":3},{"ruleId":"complexity","severity":2,"message":"Async arrow function has a complexity of 40. Maximum allowed is 20.","line":38,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":419,"endColumn":3},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":38,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":38,"endColumn":48,"fix":{"range":[2662,2663],"text":""}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 81 to the 15 allowed.","line":38,"column":51,"nodeType":null,"messageId":"refactorFunction","endLine":38,"endColumn":53},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":41,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":41,"endColumn":28,"fix":{"range":[2732,19127],"text":"switch (sub) {\n    case 'balance': {\r\n      const targetUser = interaction.options.getUser('user') || interaction.user;\r\n      const balance = getBalance(targetUser.id);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üí∞ Balance Check')\r\n      .setColor(0xFFD700)\r\n      .setDescription(`**${targetUser.username}** has **${balance}** gold coins.`)\r\n      .setThumbnail(targetUser.displayAvatarURL());\r\n\r\n    if (targetUser.id === interaction.user.id) {\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_transfer:${interaction.user.id}`).setLabel('üí∏ Transfer').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_market:${interaction.user.id}`).setLabel('üõí Market').setStyle(ButtonStyle.Secondary)\r\n      );\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } else {\r\n      await interaction.reply({ embeds: [embed] });\r\n    }\r\n\r\n  \n    break;\n    }\n    case 'transfer': {\r\n    const targetUser = interaction.options.getUser('user');\r\n    const amount = interaction.options.getInteger('amount');\r\n\r\n    // Validate user input\r\n    validateNotEmpty(targetUser, 'target user');\r\n    validateRange(amount, 1, Number.MAX_SAFE_INTEGER, 'transfer amount');\r\n\r\n    if (targetUser.id === interaction.user.id) {\r\n      throw new CommandError('You cannot transfer gold to yourself!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const balance = getBalance(interaction.user.id);\r\n    if (balance < amount) {\r\n      throw new CommandError(`Insufficient funds! You have ${balance} gold but need ${amount} gold.`, 'INSUFFICIENT_FUNDS');\r\n    }\r\n\r\n    const result = transferBalance(interaction.user.id, targetUser.id, amount);\r\n\r\n    if (result.success) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí∏ Transfer Complete!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`Successfully transferred **${amount}** gold to **${targetUser.username}**!`)\r\n        .addFields(\r\n          { name: 'From', value: interaction.user.username, inline: true },\r\n          { name: 'To', value: targetUser.username, inline: true },\r\n          { name: 'Amount', value: `${amount} gold`, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n    } else {\r\n      throw new CommandError(`Transfer failed: ${result.reason}`, 'COMMAND_ERROR');\r\n    }\r\n\r\n  \n    break;\n    }\n    case 'business': {\r\n    const action = interaction.options.getString('action');\r\n\r\n    if (action === 'create') {\r\n      const businessType = interaction.options.getString('type');\r\n      const investment = interaction.options.getInteger('investment') || 100;\r\n\r\n      // Validate inputs\r\n      validateNotEmpty(businessType, 'business type');\r\n      validateRange(investment, 50, Number.MAX_SAFE_INTEGER, 'investment amount');\r\n\r\n      const validTypes = ['shop', 'farm', 'mine', 'factory', 'bank', 'casino', 'restaurant', 'tech', 'trading'];\r\n      if (!validTypes.includes(businessType)) {\r\n        throw new CommandError(`Invalid business type. Use: ${validTypes.join(', ')}`, 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const result = createBusiness(interaction.user.id, businessType, investment);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üè™ Business Created!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You opened a **${businessType}** with ${investment} gold investment!`)\r\n          .addFields(\r\n            { name: 'üíº Type', value: businessType, inline: true },\r\n            { name: 'üí∞ Investment', value: `${investment} gold`, inline: true },\r\n            { name: 'üìà Income', value: `~${result.business.income}/hour`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Failed to create business: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'collect') {\r\n      const result = collectBusinessIncome(interaction.user.id);\r\n\r\n      if (result.success) {\r\n        if (result.income > 0) {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí∞ Business Income Collected!')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`Collected **${result.income}** gold from your ${result.businesses} business(es)!`);\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } else {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí§ No Income Available')\r\n            .setColor(0xFFA500)\r\n            .setDescription('No income available to collect yet. Check back later!');\r\n\r\n          await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n        }\r\n      } else {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'list') {\r\n      const businesses = getUserBusinesses(interaction.user.id);\r\n\r\n      if (businesses.length === 0) {\r\n        return interaction.reply({ content: 'üè¢ You have no businesses yet. Use `/economy business action:create` to start one!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üè¢ Your Businesses')\r\n        .setColor(0xFFD700)\r\n        .setDescription('Manage your business empire!');\r\n\r\n      businesses.forEach((business, index) => {\r\n        const now = Date.now();\r\n        const hoursSinceCollection = (now - business.lastCollected) / (1000 * 60 * 60);\r\n        const pendingIncome = Math.floor(business.income * hoursSinceCollection);\r\n        const upgradeCost = business.level * 500;\r\n\r\n        embed.addFields({\r\n          name: `${index + 1}. ${business.type.charAt(0).toUpperCase() + business.type.slice(1)} (${business.level}) [${business.id}]`,\r\n          value: `üí∞ Income: ${business.income}/hour\\nüïê Pending: ${pendingIncome} gold\\nüë• Employees: ${business.employees}\\nüîß Upgrades: ${business.upgrades}\\nüí∏ Next Upgrade: ${upgradeCost} gold`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_business:${interaction.user.id}`).setLabel('üè™ Collect Income').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_invest:${interaction.user.id}`).setLabel('üìà Investments').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row], flags: MessageFlags.Ephemeral });\r\n    } else if (action === 'upgrade') {\r\n      const businessId = interaction.options.getString('business_id');\r\n\r\n      validateNotEmpty(businessId, 'business ID');\r\n\r\n      const { upgradeBusiness } = await import('../economy.js');\r\n      const result = upgradeBusiness(interaction.user.id, businessId);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîß Business Upgraded!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Successfully upgraded your **${result.business.type}** business!`)\r\n          .addFields(\r\n            { name: 'üè¢ Business', value: `${result.business.type} (Level ${result.business.level})`, inline: true },\r\n            { name: 'üí∞ New Income', value: `${result.business.income}/hour`, inline: true },\r\n            { name: 'üîß Total Upgrades', value: result.business.upgrades, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Upgrade failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    }\r\n\r\n  \n    break;\n    }\n    case 'market': {\r\n    const action = interaction.options.getString('action');\r\n    const item = interaction.options.getString('item');\r\n    const quantity = interaction.options.getInteger('quantity') || 1;\r\n\r\n    if (action === 'prices') {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìà Market Prices')\r\n        .setColor(0x0099FF);\r\n\r\n      const items = ['health_potion', 'mana_potion', 'iron_ore', 'magic_crystal', 'dragon_scale'];\r\n      items.forEach(itemId => {\r\n        const price = getMarketPrice(itemId);\r\n        embed.addFields({\r\n          name: itemId.replace('_', ' ').toUpperCase(),\r\n          value: `üí∞ ${price} gold each`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_buy:${interaction.user.id}`).setLabel('üõí Buy').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_sell:${interaction.user.id}`).setLabel('üí∏ Sell').setStyle(ButtonStyle.Success)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } else if (action === 'buy') {\r\n      validateNotEmpty(item, 'item to buy');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const price = getMarketPrice(item);\r\n      if (price === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const totalCost = price * quantity;\r\n      const balance = getBalance(interaction.user.id);\r\n      if (balance < totalCost) {\r\n        throw new CommandError(`Insufficient funds! You need ${totalCost} gold but only have ${balance} gold.`, 'INSUFFICIENT_FUNDS');\r\n      }\r\n\r\n      const result = buyFromMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üõí Purchase Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Bought **${quantity}x ${item}** for **${totalCost}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Price per Unit', value: `${price} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Purchase failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'sell') {\r\n      validateNotEmpty(item, 'item to sell');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const marketPrice = getMarketPrice(item);\r\n      if (marketPrice === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const sellPrice = Math.floor(marketPrice * 0.8);\r\n      const totalEarnings = sellPrice * quantity;\r\n\r\n      const result = sellToMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üí∏ Sale Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Sold **${quantity}x ${item}** for **${totalEarnings}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Earnings', value: `${totalEarnings} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Sale failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    }\r\n\r\n  \n    break;\n    }\n    case 'lottery': {\r\n    const ticketPrice = interaction.options.getInteger('ticket_price');\r\n\r\n    validateRange(ticketPrice, 1, 10000, 'ticket price'); // Reasonable limits\r\n\r\n    const currentBalance = getBalance(interaction.user.id);\r\n    if (currentBalance < ticketPrice) {\r\n      throw new CommandError(`Insufficient funds! You need ${ticketPrice} gold but only have ${currentBalance}.`, 'INSUFFICIENT_FUNDS');\r\n    }\r\n\r\n    // Simple lottery with 1/1000 chance of winning\r\n    const prizePool = ticketPrice * 10; // 10x return for winners\r\n    const result = createLottery(interaction.user.id, ticketPrice, prizePool);\r\n\r\n    if (result.success) {\r\n      if (result.isWinner) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üéâ LOTTERY WINNER!')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`üéä **JACKPOT!** You won the lottery!`)\r\n          .addFields(\r\n            { name: 'üé´ Your Number', value: result.lotteryNumber, inline: true },\r\n            { name: 'üèÜ Winning Number', value: result.winningNumber, inline: true },\r\n            { name: 'üí∞ Prize', value: `${result.winnings} gold!`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé´ Lottery Ticket Purchased')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`Your number: **${result.lotteryNumber}**\\nüí∞ Cost: ${ticketPrice} gold\\nüèÜ Jackpot: ${prizePool} gold\\n\\n*Better luck next time!*`);\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n      }\r\n    } else {\r\n      throw new CommandError('Failed to create lottery ticket.', 'COMMAND_ERROR');\r\n    }\r\n\r\n  \n    break;\n    }\n    case 'history': {\r\n    const limit = interaction.options.getInteger('limit') || 10;\r\n    validateRange(limit, 1, 50, 'transaction limit'); // Reasonable limit\r\n\r\n    const transactions = getTransactionHistory(interaction.user.id, limit);\r\n\r\n    if (transactions.length === 0) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìã Transaction History')\r\n        .setColor(0xFFA500)\r\n        .setDescription('No transaction history found.');\r\n\r\n      return await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìã Transaction History')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Your recent ${transactions.length} transactions`);\r\n\r\n    transactions.forEach((txn, index) => {\r\n      const timestamp = new Date(txn.timestamp).toLocaleString();\r\n      const amount = txn.amount > 0 ? `+${txn.amount}` : txn.amount;\r\n\r\n      embed.addFields({\r\n        name: `${index + 1}. ${txn.type.toUpperCase()}`,\r\n        value: `üí∞ **${amount}** gold\\nüìÖ ${timestamp}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  \n    break;\n    }\n    case 'stats': {\r\n    const stats = getUserEconomyStats(interaction.user.id);\r\n    const balance = getBalance(interaction.user.id);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìä Economy Statistics')\r\n      .setColor(0xFFD700)\r\n      .setDescription(`**${interaction.user.username}**'s financial overview`)\r\n      .addFields(\r\n        { name: 'üí∞ Current Balance', value: `${balance} gold`, inline: true },\r\n        { name: 'üìà Total Income', value: `${stats.totalIncome} gold`, inline: true },\r\n        { name: 'üìâ Total Expenses', value: `${stats.totalExpenses} gold`, inline: true },\r\n        { name: 'üèÜ Net Worth', value: `${stats.netWorth} gold`, inline: true },\r\n        { name: 'üè¢ Businesses', value: stats.businesses, inline: true },\r\n        { name: 'üìà Investments', value: stats.investments, inline: true },\r\n        { name: 'üíº Transactions', value: stats.transactionCount, inline: true }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`economy_business:${interaction.user.id}`).setLabel('üè™ Manage Business').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`economy_invest:${interaction.user.id}`).setLabel('üìà Investments').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row], flags: MessageFlags.Ephemeral });\r\n  \n    break;\n    }\n    case 'daily': {\r\n    const result = claimDailyReward(interaction.user.id);\r\n\r\n    if (result.success) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéÅ Daily Reward Claimed!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You claimed your daily reward!`)\r\n        .addFields(\r\n          { name: 'üí∞ Reward', value: `${result.reward} gold`, inline: true },\r\n          { name: 'üî• Streak', value: `${result.streak} days`, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n    } else {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚è∞ Daily Reward Not Available')\r\n        .setColor(0xFFA500)\r\n        .setDescription(`Your daily reward will be available in ${result.hoursLeft} hours.`);\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n  \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":45,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":45,"endColumn":5,"fix":{"range":[2893,2897],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":46,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":46,"endColumn":7,"fix":{"range":[2931,2937],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":47,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":47,"endColumn":7,"fix":{"range":[2968,2974],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":47,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":47,"endColumn":25,"fix":{"range":[2984,2992],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":48,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":48,"endColumn":7,"fix":{"range":[2995,3001],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":49,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":49,"endColumn":7,"fix":{"range":[3079,3085],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":51,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":51,"endColumn":5,"fix":{"range":[3134,3138],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":52,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":52,"endColumn":7,"fix":{"range":[3184,3190],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":53,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":53,"endColumn":9,"fix":{"range":[3241,3249],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":9,"fix":{"range":[3380,3388],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":55,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":55,"endColumn":7,"fix":{"range":[3516,3522],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":56,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":56,"endColumn":7,"fix":{"range":[3526,3532],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":57,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":57,"endColumn":5,"fix":{"range":[3598,3602],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":57,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":57,"endColumn":6,"fix":{"range":[3603,3603],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":7,"fix":{"range":[3612,3618],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":59,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[3665,3669],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":61,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":61,"endColumn":3,"fix":{"range":[3674,3676],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":61,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":61,"endColumn":4,"fix":{"range":[3677,3677],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":62,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":62,"endColumn":5,"fix":{"range":[3710,3714],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":63,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":63,"endColumn":5,"fix":{"range":[3771,3775],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":65,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":65,"endColumn":5,"fix":{"range":[3835,3839],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":66,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":66,"endColumn":5,"fix":{"range":[3863,3867],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":67,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":67,"endColumn":5,"fix":{"range":[3913,3917],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":69,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":69,"endColumn":5,"fix":{"range":[3990,3994],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":70,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":70,"endColumn":7,"fix":{"range":[4040,4046],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":71,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":71,"endColumn":5,"fix":{"range":[4132,4136],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":73,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":73,"endColumn":5,"fix":{"range":[4141,4145],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":74,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":74,"endColumn":5,"fix":{"range":[4195,4199],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":75,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":75,"endColumn":7,"fix":{"range":[4224,4230],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":76,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":76,"endColumn":5,"fix":{"range":[4350,4354],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":78,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":78,"endColumn":5,"fix":{"range":[4359,4363],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":80,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":80,"endColumn":5,"fix":{"range":[4442,4446],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":81,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":81,"endColumn":7,"fix":{"range":[4469,4475],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":82,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":82,"endColumn":9,"fix":{"range":[4509,4517],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":83,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":83,"endColumn":9,"fix":{"range":[4553,4561],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":83,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":83,"endColumn":27,"fix":{"range":[4571,4579],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":84,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":84,"endColumn":9,"fix":{"range":[4582,4590],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":85,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":85,"endColumn":9,"fix":{"range":[4685,4693],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":86,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":86,"endColumn":11,"fix":{"range":[4706,4716],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":87,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":87,"endColumn":11,"fix":{"range":[4783,4793],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":88,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":88,"endColumn":11,"fix":{"range":[4852,4862],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":89,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":89,"endColumn":9,"fix":{"range":[4921,4929],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":91,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":91,"endColumn":7,"fix":{"range":[4935,4941],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":92,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":92,"endColumn":5,"fix":{"range":[4988,4992],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":92,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":92,"endColumn":6,"fix":{"range":[4993,4993],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":93,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":93,"endColumn":7,"fix":{"range":[5002,5008],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":94,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":94,"endColumn":5,"fix":{"range":[5087,5091],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":96,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":96,"endColumn":3,"fix":{"range":[5096,5098],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":96,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":96,"endColumn":4,"fix":{"range":[5099,5099],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":97,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":97,"endColumn":5,"fix":{"range":[5132,5136],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":99,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":99,"endColumn":5,"fix":{"range":[5195,5199],"text":"      "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":99,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":99,"endColumn":30,"fix":{"range":[5199,10255],"text":"switch (action) {\n    case 'create': {\r\n      const businessType = interaction.options.getString('type');\r\n      const investment = interaction.options.getInteger('investment') || 100;\r\n\r\n      // Validate inputs\r\n      validateNotEmpty(businessType, 'business type');\r\n      validateRange(investment, 50, Number.MAX_SAFE_INTEGER, 'investment amount');\r\n\r\n      const validTypes = ['shop', 'farm', 'mine', 'factory', 'bank', 'casino', 'restaurant', 'tech', 'trading'];\r\n      if (!validTypes.includes(businessType)) {\r\n        throw new CommandError(`Invalid business type. Use: ${validTypes.join(', ')}`, 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const result = createBusiness(interaction.user.id, businessType, investment);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üè™ Business Created!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You opened a **${businessType}** with ${investment} gold investment!`)\r\n          .addFields(\r\n            { name: 'üíº Type', value: businessType, inline: true },\r\n            { name: 'üí∞ Investment', value: `${investment} gold`, inline: true },\r\n            { name: 'üìà Income', value: `~${result.business.income}/hour`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Failed to create business: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'collect': {\r\n      const result = collectBusinessIncome(interaction.user.id);\r\n\r\n      if (result.success) {\r\n        if (result.income > 0) {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí∞ Business Income Collected!')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`Collected **${result.income}** gold from your ${result.businesses} business(es)!`);\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } else {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí§ No Income Available')\r\n            .setColor(0xFFA500)\r\n            .setDescription('No income available to collect yet. Check back later!');\r\n\r\n          await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n        }\r\n      } else {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'list': {\r\n      const businesses = getUserBusinesses(interaction.user.id);\r\n\r\n      if (businesses.length === 0) {\r\n        return interaction.reply({ content: 'üè¢ You have no businesses yet. Use `/economy business action:create` to start one!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üè¢ Your Businesses')\r\n        .setColor(0xFFD700)\r\n        .setDescription('Manage your business empire!');\r\n\r\n      businesses.forEach((business, index) => {\r\n        const now = Date.now();\r\n        const hoursSinceCollection = (now - business.lastCollected) / (1000 * 60 * 60);\r\n        const pendingIncome = Math.floor(business.income * hoursSinceCollection);\r\n        const upgradeCost = business.level * 500;\r\n\r\n        embed.addFields({\r\n          name: `${index + 1}. ${business.type.charAt(0).toUpperCase() + business.type.slice(1)} (${business.level}) [${business.id}]`,\r\n          value: `üí∞ Income: ${business.income}/hour\\nüïê Pending: ${pendingIncome} gold\\nüë• Employees: ${business.employees}\\nüîß Upgrades: ${business.upgrades}\\nüí∏ Next Upgrade: ${upgradeCost} gold`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_business:${interaction.user.id}`).setLabel('üè™ Collect Income').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_invest:${interaction.user.id}`).setLabel('üìà Investments').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row], flags: MessageFlags.Ephemeral });\r\n    \n    break;\n    }\n    case 'upgrade': {\r\n      const businessId = interaction.options.getString('business_id');\r\n\r\n      validateNotEmpty(businessId, 'business ID');\r\n\r\n      const { upgradeBusiness } = await import('../economy.js');\r\n      const result = upgradeBusiness(interaction.user.id, businessId);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîß Business Upgraded!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Successfully upgraded your **${result.business.type}** business!`)\r\n          .addFields(\r\n            { name: 'üè¢ Business', value: `${result.business.type} (Level ${result.business.level})`, inline: true },\r\n            { name: 'üí∞ New Income', value: `${result.business.income}/hour`, inline: true },\r\n            { name: 'üîß Total Upgrades', value: result.business.upgrades, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Upgrade failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":100,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":100,"endColumn":7,"fix":{"range":[5227,5233],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":101,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":101,"endColumn":7,"fix":{"range":[5294,5300],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":103,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":103,"endColumn":7,"fix":{"range":[5375,5381],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":104,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":104,"endColumn":7,"fix":{"range":[5401,5407],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":105,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":105,"endColumn":7,"fix":{"range":[5457,5463],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":107,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":107,"endColumn":7,"fix":{"range":[5543,5549],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":108,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":108,"endColumn":7,"fix":{"range":[5657,5663],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":9,"fix":{"range":[5706,5714],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":110,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":110,"endColumn":7,"fix":{"range":[5815,5821],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":112,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":112,"endColumn":7,"fix":{"range":[5826,5832],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":114,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":114,"endColumn":7,"fix":{"range":[5913,5919],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":115,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":115,"endColumn":9,"fix":{"range":[5942,5950],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":116,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":116,"endColumn":11,"fix":{"range":[5984,5994],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":11,"fix":{"range":[6029,6039],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":117,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":117,"endColumn":29,"fix":{"range":[6049,6057],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":118,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":118,"endColumn":11,"fix":{"range":[6060,6070],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":119,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":119,"endColumn":11,"fix":{"range":[6159,6169],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":120,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":120,"endColumn":13,"fix":{"range":[6182,6194],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":121,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":121,"endColumn":13,"fix":{"range":[6251,6263],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":122,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":122,"endColumn":13,"fix":{"range":[6334,6346],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":123,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":123,"endColumn":11,"fix":{"range":[6425,6435],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":125,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":125,"endColumn":9,"fix":{"range":[6441,6449],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":126,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":126,"endColumn":7,"fix":{"range":[6496,6502],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":126,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":126,"endColumn":8,"fix":{"range":[6503,6503],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":127,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":127,"endColumn":9,"fix":{"range":[6512,6520],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":128,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":128,"endColumn":7,"fix":{"range":[6609,6615],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":130,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":130,"endColumn":5,"fix":{"range":[6620,6624],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":130,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":130,"endColumn":6,"fix":{"range":[6625,6625],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":131,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":131,"endColumn":7,"fix":{"range":[6660,6666],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":133,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":133,"endColumn":7,"fix":{"range":[6728,6734],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":134,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":134,"endColumn":9,"fix":{"range":[6757,6765],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":135,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":135,"endColumn":11,"fix":{"range":[6791,6801],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":136,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":136,"endColumn":13,"fix":{"range":[6835,6847],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":137,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":137,"endColumn":13,"fix":{"range":[6891,6903],"text":"              "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":137,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":137,"endColumn":31,"fix":{"range":[6913,6921],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":138,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":138,"endColumn":13,"fix":{"range":[6924,6936],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":140,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":140,"endColumn":11,"fix":{"range":[7040,7050],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":141,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":141,"endColumn":9,"fix":{"range":[7097,7105],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":141,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":141,"endColumn":10,"fix":{"range":[7106,7106],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":142,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":142,"endColumn":11,"fix":{"range":[7115,7125],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":143,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":143,"endColumn":13,"fix":{"range":[7159,7171],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":144,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":144,"endColumn":13,"fix":{"range":[7208,7220],"text":"              "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":144,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":144,"endColumn":31,"fix":{"range":[7230,7238],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":145,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":145,"endColumn":13,"fix":{"range":[7241,7253],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":147,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":147,"endColumn":11,"fix":{"range":[7330,7340],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":148,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":148,"endColumn":9,"fix":{"range":[7418,7426],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":149,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":149,"endColumn":7,"fix":{"range":[7429,7435],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":149,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":149,"endColumn":8,"fix":{"range":[7436,7436],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":150,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":150,"endColumn":9,"fix":{"range":[7445,7453],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":151,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":151,"endColumn":7,"fix":{"range":[7510,7516],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":153,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":153,"endColumn":5,"fix":{"range":[7521,7525],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":153,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":153,"endColumn":6,"fix":{"range":[7526,7526],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":154,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":154,"endColumn":7,"fix":{"range":[7558,7564],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":156,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":156,"endColumn":7,"fix":{"range":[7626,7632],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":9,"fix":{"range":[7664,7672],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":7,"fix":{"range":[7829,7835],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":160,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":160,"endColumn":7,"fix":{"range":[7840,7846],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":161,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":161,"endColumn":9,"fix":{"range":[7880,7888],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":162,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":162,"endColumn":9,"fix":{"range":[7921,7929],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":162,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":162,"endColumn":27,"fix":{"range":[7939,7947],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":163,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":163,"endColumn":9,"fix":{"range":[7950,7958],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":165,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":165,"endColumn":7,"fix":{"range":[8010,8016],"text":"        "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":165,"column":18,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":165,"endColumn":25,"fix":{"range":[8016,8728],"text":"for (const [index, business] of businesses.entries()) {\r\n        const now = Date.now();\r\n        const hoursSinceCollection = (now - business.lastCollected) / (1000 * 60 * 60);\r\n        const pendingIncome = Math.floor(business.income * hoursSinceCollection);\r\n        const upgradeCost = business.level * 500;\r\n\r\n        embed.addFields({\r\n          name: `${index + 1}. ${business.type.charAt(0).toUpperCase() + business.type.slice(1)} (${business.level}) [${business.id}]`,\r\n          value: `üí∞ Income: ${business.income}/hour\\nüïê Pending: ${pendingIncome} gold\\nüë• Employees: ${business.employees}\\nüîß Upgrades: ${business.upgrades}\\nüí∏ Next Upgrade: ${upgradeCost} gold`,\r\n          inline: true\r\n        });\r\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":166,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":166,"endColumn":9,"fix":{"range":[8059,8067],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":167,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":167,"endColumn":9,"fix":{"range":[8092,8100],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":168,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":168,"endColumn":9,"fix":{"range":[8181,8189],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":169,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":169,"endColumn":9,"fix":{"range":[8264,8272],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":171,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":171,"endColumn":9,"fix":{"range":[8317,8325],"text":"          "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 135. Maximum allowed is 120.","line":172,"column":1,"nodeType":"Program","messageId":"max","endLine":172,"endColumn":136},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":172,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":172,"endColumn":11,"fix":{"range":[8344,8354],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 194. Maximum allowed is 120.","line":173,"column":1,"nodeType":"Program","messageId":"max","endLine":173,"endColumn":200},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":173,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":173,"endColumn":11,"fix":{"range":[8481,8491],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":174,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":174,"endColumn":11,"fix":{"range":[8682,8692],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":175,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":175,"endColumn":9,"fix":{"range":[8706,8714],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":176,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":176,"endColumn":7,"fix":{"range":[8719,8725],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":178,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":178,"endColumn":7,"fix":{"range":[8732,8738],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":179,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":179,"endColumn":9,"fix":{"range":[8789,8797],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":180,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":180,"endColumn":9,"fix":{"range":[8934,8942],"text":"          "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":180,"column":91,"nodeType":"Literal","endLine":180,"endColumn":107},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[9075,9081],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":183,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":183,"endColumn":7,"fix":{"range":[9087,9093],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":184,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":184,"endColumn":5,"fix":{"range":[9190,9194],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":184,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":184,"endColumn":6,"fix":{"range":[9195,9195],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":185,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":185,"endColumn":7,"fix":{"range":[9230,9236],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":187,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":187,"endColumn":7,"fix":{"range":[9304,9310],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":189,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":189,"endColumn":7,"fix":{"range":[9358,9364],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":190,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":190,"endColumn":7,"fix":{"range":[9424,9430],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":192,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":192,"endColumn":7,"fix":{"range":[9498,9504],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":193,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":193,"endColumn":9,"fix":{"range":[9527,9535],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":194,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":194,"endColumn":11,"fix":{"range":[9569,9579],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":195,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":195,"endColumn":11,"fix":{"range":[9615,9625],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":195,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":195,"endColumn":29,"fix":{"range":[9635,9643],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":196,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":196,"endColumn":11,"fix":{"range":[9646,9656],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":197,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":197,"endColumn":11,"fix":{"range":[9741,9751],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":198,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":198,"endColumn":13,"fix":{"range":[9764,9776],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":199,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":199,"endColumn":13,"fix":{"range":[9883,9895],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":200,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":200,"endColumn":13,"fix":{"range":[9978,9990],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":201,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":201,"endColumn":11,"fix":{"range":[10068,10078],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":9,"fix":{"range":[10084,10092],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":204,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":204,"endColumn":7,"fix":{"range":[10139,10145],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":204,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":204,"endColumn":8,"fix":{"range":[10146,10146],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":205,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":205,"endColumn":9,"fix":{"range":[10155,10163],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":206,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":206,"endColumn":7,"fix":{"range":[10241,10247],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":207,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":207,"endColumn":5,"fix":{"range":[10250,10254],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":209,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":209,"endColumn":3,"fix":{"range":[10259,10261],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":209,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":209,"endColumn":4,"fix":{"range":[10262,10262],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":210,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":210,"endColumn":5,"fix":{"range":[10293,10297],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":211,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":211,"endColumn":5,"fix":{"range":[10354,10358],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":212,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":212,"endColumn":5,"fix":{"range":[10411,10415],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":214,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":214,"endColumn":5,"fix":{"range":[10484,10488],"text":"      "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":214,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":214,"endColumn":30,"fix":{"range":[10488,13917],"text":"switch (action) {\n    case 'prices': {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìà Market Prices')\r\n        .setColor(0x0099FF);\r\n\r\n      const items = ['health_potion', 'mana_potion', 'iron_ore', 'magic_crystal', 'dragon_scale'];\r\n      items.forEach(itemId => {\r\n        const price = getMarketPrice(itemId);\r\n        embed.addFields({\r\n          name: itemId.replace('_', ' ').toUpperCase(),\r\n          value: `üí∞ ${price} gold each`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_buy:${interaction.user.id}`).setLabel('üõí Buy').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_sell:${interaction.user.id}`).setLabel('üí∏ Sell').setStyle(ButtonStyle.Success)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    \n    break;\n    }\n    case 'buy': {\r\n      validateNotEmpty(item, 'item to buy');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const price = getMarketPrice(item);\r\n      if (price === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const totalCost = price * quantity;\r\n      const balance = getBalance(interaction.user.id);\r\n      if (balance < totalCost) {\r\n        throw new CommandError(`Insufficient funds! You need ${totalCost} gold but only have ${balance} gold.`, 'INSUFFICIENT_FUNDS');\r\n      }\r\n\r\n      const result = buyFromMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üõí Purchase Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Bought **${quantity}x ${item}** for **${totalCost}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Price per Unit', value: `${price} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Purchase failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'sell': {\r\n      validateNotEmpty(item, 'item to sell');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const marketPrice = getMarketPrice(item);\r\n      if (marketPrice === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const sellPrice = Math.floor(marketPrice * 0.8);\r\n      const totalEarnings = sellPrice * quantity;\r\n\r\n      const result = sellToMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üí∏ Sale Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Sold **${quantity}x ${item}** for **${totalEarnings}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Earnings', value: `${totalEarnings} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Sale failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":215,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":215,"endColumn":7,"fix":{"range":[10516,10522],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":216,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":216,"endColumn":9,"fix":{"range":[10556,10564],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":217,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":217,"endColumn":9,"fix":{"range":[10595,10603],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":217,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":217,"endColumn":27,"fix":{"range":[10613,10621],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":219,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":219,"endColumn":7,"fix":{"range":[10627,10633],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":220,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":220,"endColumn":7,"fix":{"range":[10727,10733],"text":"        "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":220,"column":13,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":220,"endColumn":20,"fix":{"range":[10733,10980],"text":"for (const itemId of items) {\r\n        const price = getMarketPrice(itemId);\r\n        embed.addFields({\r\n          name: itemId.replace('_', ' ').toUpperCase(),\r\n          value: `üí∞ ${price} gold each`,\r\n          inline: true\r\n        });\r\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":221,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":221,"endColumn":9,"fix":{"range":[10760,10768],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":222,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":222,"endColumn":9,"fix":{"range":[10807,10815],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":223,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":223,"endColumn":11,"fix":{"range":[10834,10844],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":224,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":224,"endColumn":11,"fix":{"range":[10891,10901],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":225,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":225,"endColumn":11,"fix":{"range":[10934,10944],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":226,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":226,"endColumn":9,"fix":{"range":[10958,10966],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":227,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":227,"endColumn":7,"fix":{"range":[10971,10977],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":229,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":229,"endColumn":7,"fix":{"range":[10984,10990],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":230,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":230,"endColumn":9,"fix":{"range":[11041,11049],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":231,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":231,"endColumn":9,"fix":{"range":[11170,11178],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":232,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":232,"endColumn":7,"fix":{"range":[11300,11306],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":234,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":234,"endColumn":7,"fix":{"range":[11312,11318],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":236,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":236,"endColumn":5,"fix":{"range":[11386,11390],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":236,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":236,"endColumn":6,"fix":{"range":[11391,11391],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":237,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":237,"endColumn":7,"fix":{"range":[11422,11428],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":238,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":238,"endColumn":7,"fix":{"range":[11468,11474],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":240,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":240,"endColumn":7,"fix":{"range":[11543,11549],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":241,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":241,"endColumn":7,"fix":{"range":[11586,11592],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":242,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":242,"endColumn":9,"fix":{"range":[11612,11620],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":243,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":243,"endColumn":7,"fix":{"range":[11708,11714],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":245,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":245,"endColumn":7,"fix":{"range":[11719,11725],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":246,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":246,"endColumn":7,"fix":{"range":[11762,11768],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":247,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":247,"endColumn":7,"fix":{"range":[11818,11824],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":248,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":248,"endColumn":9,"fix":{"range":[11852,11860],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":249,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":249,"endColumn":7,"fix":{"range":[11988,11994],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":251,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":251,"endColumn":7,"fix":{"range":[11999,12005],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":253,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":253,"endColumn":7,"fix":{"range":[12075,12081],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":254,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":254,"endColumn":9,"fix":{"range":[12104,12112],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":255,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":255,"endColumn":11,"fix":{"range":[12146,12156],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":256,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":256,"endColumn":11,"fix":{"range":[12192,12202],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":256,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":256,"endColumn":29,"fix":{"range":[12212,12220],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":257,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":257,"endColumn":11,"fix":{"range":[12223,12233],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":258,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":258,"endColumn":11,"fix":{"range":[12312,12322],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":259,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":259,"endColumn":13,"fix":{"range":[12335,12347],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":260,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":260,"endColumn":13,"fix":{"range":[12396,12408],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":261,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":261,"endColumn":13,"fix":{"range":[12465,12477],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":262,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":262,"endColumn":11,"fix":{"range":[12546,12556],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":264,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":264,"endColumn":9,"fix":{"range":[12562,12570],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":265,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":265,"endColumn":7,"fix":{"range":[12617,12623],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":265,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":265,"endColumn":8,"fix":{"range":[12624,12624],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":266,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":266,"endColumn":9,"fix":{"range":[12633,12641],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":267,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":267,"endColumn":7,"fix":{"range":[12720,12726],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":269,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":269,"endColumn":5,"fix":{"range":[12731,12735],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":269,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":269,"endColumn":6,"fix":{"range":[12736,12736],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":270,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":270,"endColumn":7,"fix":{"range":[12768,12774],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":271,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":271,"endColumn":7,"fix":{"range":[12815,12821],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":273,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":273,"endColumn":7,"fix":{"range":[12890,12896],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":274,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":274,"endColumn":7,"fix":{"range":[12939,12945],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":275,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":275,"endColumn":9,"fix":{"range":[12971,12979],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":276,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":276,"endColumn":7,"fix":{"range":[13067,13073],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":278,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":278,"endColumn":7,"fix":{"range":[13078,13084],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":279,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":279,"endColumn":7,"fix":{"range":[13134,13140],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":281,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":281,"endColumn":7,"fix":{"range":[13187,13193],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":283,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":283,"endColumn":7,"fix":{"range":[13262,13268],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":284,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":284,"endColumn":9,"fix":{"range":[13291,13299],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":285,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":285,"endColumn":11,"fix":{"range":[13333,13343],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":286,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":286,"endColumn":11,"fix":{"range":[13375,13385],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":286,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":286,"endColumn":29,"fix":{"range":[13395,13403],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":287,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":287,"endColumn":11,"fix":{"range":[13406,13416],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":288,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":288,"endColumn":11,"fix":{"range":[13497,13507],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":289,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":289,"endColumn":13,"fix":{"range":[13520,13532],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":290,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":290,"endColumn":13,"fix":{"range":[13581,13593],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":291,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":291,"endColumn":13,"fix":{"range":[13650,13662],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":292,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":292,"endColumn":11,"fix":{"range":[13733,13743],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":294,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":294,"endColumn":9,"fix":{"range":[13749,13757],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":295,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":295,"endColumn":7,"fix":{"range":[13804,13810],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":295,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":295,"endColumn":8,"fix":{"range":[13811,13811],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":296,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":296,"endColumn":9,"fix":{"range":[13820,13828],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":297,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":297,"endColumn":7,"fix":{"range":[13903,13909],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":298,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":298,"endColumn":5,"fix":{"range":[13912,13916],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":300,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":300,"endColumn":3,"fix":{"range":[13921,13923],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":300,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":300,"endColumn":4,"fix":{"range":[13924,13924],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":301,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":301,"endColumn":5,"fix":{"range":[13956,13960],"text":"      "}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (422). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":422,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":303,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":303,"endColumn":5,"fix":{"range":[14031,14035],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":303,"column":35,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":303,"endColumn":40,"fix":{"range":[14065,14070],"text":"10_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":305,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":305,"endColumn":5,"fix":{"range":[14113,14117],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":306,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":306,"endColumn":5,"fix":{"range":[14174,14178],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":307,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":307,"endColumn":7,"fix":{"range":[14215,14221],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":308,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":308,"endColumn":5,"fix":{"range":[14353,14357],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":310,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":310,"endColumn":5,"fix":{"range":[14362,14366],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":311,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":311,"endColumn":5,"fix":{"range":[14415,14419],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":312,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":312,"endColumn":5,"fix":{"range":[14482,14486],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":314,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":314,"endColumn":5,"fix":{"range":[14564,14568],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":315,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":315,"endColumn":7,"fix":{"range":[14591,14597],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":316,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":316,"endColumn":9,"fix":{"range":[14621,14629],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":317,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":317,"endColumn":11,"fix":{"range":[14663,14673],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":318,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":318,"endColumn":11,"fix":{"range":[14706,14716],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":318,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":318,"endColumn":29,"fix":{"range":[14726,14734],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":319,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":319,"endColumn":11,"fix":{"range":[14737,14747],"text":"            "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":319,"column":27,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":319,"endColumn":65,"fix":{"range":[14763,14801],"text":"'üéä **JACKPOT!** You won the lottery!'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":320,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":320,"endColumn":11,"fix":{"range":[14804,14814],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":321,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":321,"endColumn":13,"fix":{"range":[14827,14839],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":322,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":322,"endColumn":13,"fix":{"range":[14911,14923],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":323,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":323,"endColumn":13,"fix":{"range":[14998,15010],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":324,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":324,"endColumn":11,"fix":{"range":[15081,15091],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":326,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":326,"endColumn":9,"fix":{"range":[15097,15105],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":327,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":327,"endColumn":7,"fix":{"range":[15152,15158],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":327,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":327,"endColumn":8,"fix":{"range":[15159,15159],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":328,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":328,"endColumn":9,"fix":{"range":[15168,15176],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":329,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":329,"endColumn":11,"fix":{"range":[15210,15220],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":330,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":330,"endColumn":11,"fix":{"range":[15262,15272],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":330,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":330,"endColumn":29,"fix":{"range":[15282,15290],"text":"0xFF_A5_00"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 157. Maximum allowed is 120.","line":331,"column":1,"nodeType":"Program","messageId":"max","endLine":331,"endColumn":160},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":331,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":331,"endColumn":11,"fix":{"range":[15293,15303],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":333,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":333,"endColumn":9,"fix":{"range":[15456,15464],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":334,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":334,"endColumn":7,"fix":{"range":[15542,15548],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":335,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":335,"endColumn":5,"fix":{"range":[15551,15555],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":335,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":335,"endColumn":6,"fix":{"range":[15556,15556],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":336,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":336,"endColumn":7,"fix":{"range":[15565,15571],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":337,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":337,"endColumn":5,"fix":{"range":[15649,15653],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":339,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":339,"endColumn":3,"fix":{"range":[15658,15660],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":339,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":339,"endColumn":4,"fix":{"range":[15661,15661],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":340,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":340,"endColumn":5,"fix":{"range":[15693,15697],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":341,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":341,"endColumn":5,"fix":{"range":[15759,15763],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":343,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":343,"endColumn":5,"fix":{"range":[15836,15840],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":345,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":345,"endColumn":5,"fix":{"range":[15915,15919],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":346,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":346,"endColumn":7,"fix":{"range":[15953,15959],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":347,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":347,"endColumn":9,"fix":{"range":[15993,16001],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":348,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":348,"endColumn":9,"fix":{"range":[16038,16046],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":348,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":348,"endColumn":27,"fix":{"range":[16056,16064],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":349,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":349,"endColumn":9,"fix":{"range":[16067,16075],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":351,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":351,"endColumn":7,"fix":{"range":[16128,16134],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":352,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":352,"endColumn":5,"fix":{"range":[16219,16223],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":354,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":354,"endColumn":5,"fix":{"range":[16228,16232],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":355,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":355,"endColumn":7,"fix":{"range":[16266,16272],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":356,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":356,"endColumn":7,"fix":{"range":[16309,16315],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":356,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":356,"endColumn":25,"fix":{"range":[16325,16333],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":357,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":357,"endColumn":7,"fix":{"range":[16336,16342],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":359,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":359,"endColumn":5,"fix":{"range":[16413,16417],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":359,"column":18,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":359,"endColumn":25,"fix":{"range":[16417,16777],"text":"for (const [index, txn] of transactions.entries()) {\r\n      const timestamp = new Date(txn.timestamp).toLocaleString();\r\n      const amount = txn.amount > 0 ? `+${txn.amount}` : txn.amount;\r\n\r\n      embed.addFields({\r\n        name: `${index + 1}. ${txn.type.toUpperCase()}`,\r\n        value: `üí∞ **${amount}** gold\\nüìÖ ${timestamp}`,\r\n        inline: true\r\n      });\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":360,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":360,"endColumn":7,"fix":{"range":[16457,16463],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":361,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":361,"endColumn":7,"fix":{"range":[16524,16530],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":363,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":363,"endColumn":7,"fix":{"range":[16596,16602],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":364,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":364,"endColumn":9,"fix":{"range":[16621,16629],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":365,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":365,"endColumn":9,"fix":{"range":[16679,16687],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":366,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":366,"endColumn":9,"fix":{"range":[16737,16745],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":367,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":367,"endColumn":7,"fix":{"range":[16759,16765],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":368,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":368,"endColumn":5,"fix":{"range":[16770,16774],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":370,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":370,"endColumn":5,"fix":{"range":[16781,16785],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":372,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":372,"endColumn":3,"fix":{"range":[16865,16867],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":372,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":372,"endColumn":4,"fix":{"range":[16868,16868],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":373,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":373,"endColumn":5,"fix":{"range":[16898,16902],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":374,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":374,"endColumn":5,"fix":{"range":[16959,16963],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":376,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":376,"endColumn":5,"fix":{"range":[17015,17019],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":377,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":377,"endColumn":7,"fix":{"range":[17053,17059],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":378,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":378,"endColumn":7,"fix":{"range":[17095,17101],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":378,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":378,"endColumn":25,"fix":{"range":[17111,17119],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":379,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":379,"endColumn":7,"fix":{"range":[17122,17128],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":380,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":380,"endColumn":7,"fix":{"range":[17202,17208],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":381,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":381,"endColumn":9,"fix":{"range":[17221,17229],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":382,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":382,"endColumn":9,"fix":{"range":[17302,17310],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":383,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":383,"endColumn":9,"fix":{"range":[17390,17398],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":384,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":384,"endColumn":9,"fix":{"range":[17482,17490],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":385,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":385,"endColumn":9,"fix":{"range":[17564,17572],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":386,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":386,"endColumn":9,"fix":{"range":[17639,17647],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":387,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":387,"endColumn":9,"fix":{"range":[17716,17724],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":388,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":388,"endColumn":7,"fix":{"range":[17798,17804],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":390,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":390,"endColumn":5,"fix":{"range":[17810,17814],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":391,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":391,"endColumn":7,"fix":{"range":[17865,17871],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":392,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":392,"endColumn":7,"fix":{"range":[18009,18015],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":393,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":393,"endColumn":5,"fix":{"range":[18148,18152],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":395,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":395,"endColumn":5,"fix":{"range":[18158,18162],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":396,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":396,"endColumn":3,"fix":{"range":[18259,18261],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":396,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":396,"endColumn":4,"fix":{"range":[18262,18262],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":397,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":397,"endColumn":5,"fix":{"range":[18292,18296],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":399,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":399,"endColumn":5,"fix":{"range":[18353,18357],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":400,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":400,"endColumn":7,"fix":{"range":[18380,18386],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":401,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":401,"endColumn":9,"fix":{"range":[18420,18428],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":402,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":402,"endColumn":9,"fix":{"range":[18467,18475],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":402,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":402,"endColumn":27,"fix":{"range":[18485,18493],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":403,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":403,"endColumn":9,"fix":{"range":[18496,18504],"text":"          "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":403,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":403,"endColumn":57,"fix":{"range":[18520,18552],"text":"'You claimed your daily reward!'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":404,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":404,"endColumn":9,"fix":{"range":[18555,18563],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":405,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":405,"endColumn":11,"fix":{"range":[18576,18586],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":406,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":406,"endColumn":11,"fix":{"range":[18656,18666],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":407,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":407,"endColumn":9,"fix":{"range":[18735,18743],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":409,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":409,"endColumn":7,"fix":{"range":[18749,18755],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":410,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":410,"endColumn":5,"fix":{"range":[18802,18806],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":410,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":410,"endColumn":6,"fix":{"range":[18807,18807],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":411,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":411,"endColumn":7,"fix":{"range":[18816,18822],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":412,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":412,"endColumn":9,"fix":{"range":[18856,18864],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":413,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":413,"endColumn":9,"fix":{"range":[18907,18915],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":413,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":413,"endColumn":27,"fix":{"range":[18925,18933],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":414,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":414,"endColumn":9,"fix":{"range":[18936,18944],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":416,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":416,"endColumn":7,"fix":{"range":[19033,19039],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":417,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":417,"endColumn":5,"fix":{"range":[19117,19121],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":418,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":418,"endColumn":3,"fix":{"range":[19124,19126],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 1.","line":419,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":419,"endColumn":2,"fix":{"range":[19129,19130],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 3.","line":420,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":420,"endColumn":4,"fix":{"range":[19136,19139],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 1.","line":421,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":421,"endColumn":2,"fix":{"range":[19159,19160],"text":"  "}}],"suppressedMessages":[],"errorCount":366,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":359,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport {\r\n  getBalance,\r\n  addBalance,\r\n  transferBalance,\r\n  createBusiness,\r\n  collectBusinessIncome,\r\n  getMarketPrice,\r\n  buyFromMarket,\r\n  sellToMarket,\r\n  getUserEconomyStats,\r\n  getTransactionHistory,\r\n  createLottery,\r\n  getUserBusinesses,\r\n  claimDailyReward\r\n} from '../economy.js';\r\nimport { safeExecuteCommand, CommandError, validateRange, validateNotEmpty, validateUser } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('economy')\r\n  .setDescription('Advanced economy system with banking, businesses, and marketplace')\r\n  .addSubcommand(sub => sub.setName('balance').setDescription('Check your gold balance').addUserOption(opt => opt.setName('user').setDescription('User to check')))\r\n  .addSubcommand(sub => sub.setName('transfer').setDescription('Transfer gold to another user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to transfer to').setRequired(true))\r\n    .addIntegerOption(opt => opt.setName('amount').setDescription('Amount to transfer').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('business').setDescription('Business management')\r\n    .addStringOption(opt => opt.setName('action').setDescription('create|collect|list|upgrade').setRequired(true))\r\n    .addStringOption(opt => opt.setName('type').setDescription('shop|farm|mine|factory|bank|casino|restaurant|tech|trading'))\r\n    .addIntegerOption(opt => opt.setName('investment').setDescription('Initial investment amount'))\r\n    .addStringOption(opt => opt.setName('business_id').setDescription('Business ID to upgrade')))\r\n  .addSubcommand(sub => sub.setName('market').setDescription('Marketplace').addStringOption(opt => opt.setName('action').setDescription('buy|sell|prices').setRequired(true)).addStringOption(opt => opt.setName('item').setDescription('Item to buy/sell')).addIntegerOption(opt => opt.setName('quantity').setDescription('Quantity')))\r\n  .addSubcommand(sub => sub.setName('lottery').setDescription('Play the lottery').addIntegerOption(opt => opt.setName('ticket_price').setDescription('Ticket price').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('history').setDescription('Transaction history').addIntegerOption(opt => opt.setName('limit').setDescription('Number of transactions')))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('Economy statistics'))\r\n  .addSubcommand(sub => sub.setName('daily').setDescription('Claim your daily reward'));\r\n\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    const sub = interaction.options.getSubcommand();\r\n\r\n    if (sub === 'balance') {\r\n      const targetUser = interaction.options.getUser('user') || interaction.user;\r\n      const balance = getBalance(targetUser.id);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üí∞ Balance Check')\r\n      .setColor(0xFFD700)\r\n      .setDescription(`**${targetUser.username}** has **${balance}** gold coins.`)\r\n      .setThumbnail(targetUser.displayAvatarURL());\r\n\r\n    if (targetUser.id === interaction.user.id) {\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_transfer:${interaction.user.id}`).setLabel('üí∏ Transfer').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_market:${interaction.user.id}`).setLabel('üõí Market').setStyle(ButtonStyle.Secondary)\r\n      );\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } else {\r\n      await interaction.reply({ embeds: [embed] });\r\n    }\r\n\r\n  } else if (sub === 'transfer') {\r\n    const targetUser = interaction.options.getUser('user');\r\n    const amount = interaction.options.getInteger('amount');\r\n\r\n    // Validate user input\r\n    validateNotEmpty(targetUser, 'target user');\r\n    validateRange(amount, 1, Number.MAX_SAFE_INTEGER, 'transfer amount');\r\n\r\n    if (targetUser.id === interaction.user.id) {\r\n      throw new CommandError('You cannot transfer gold to yourself!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const balance = getBalance(interaction.user.id);\r\n    if (balance < amount) {\r\n      throw new CommandError(`Insufficient funds! You have ${balance} gold but need ${amount} gold.`, 'INSUFFICIENT_FUNDS');\r\n    }\r\n\r\n    const result = transferBalance(interaction.user.id, targetUser.id, amount);\r\n\r\n    if (result.success) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí∏ Transfer Complete!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`Successfully transferred **${amount}** gold to **${targetUser.username}**!`)\r\n        .addFields(\r\n          { name: 'From', value: interaction.user.username, inline: true },\r\n          { name: 'To', value: targetUser.username, inline: true },\r\n          { name: 'Amount', value: `${amount} gold`, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n    } else {\r\n      throw new CommandError(`Transfer failed: ${result.reason}`, 'COMMAND_ERROR');\r\n    }\r\n\r\n  } else if (sub === 'business') {\r\n    const action = interaction.options.getString('action');\r\n\r\n    if (action === 'create') {\r\n      const businessType = interaction.options.getString('type');\r\n      const investment = interaction.options.getInteger('investment') || 100;\r\n\r\n      // Validate inputs\r\n      validateNotEmpty(businessType, 'business type');\r\n      validateRange(investment, 50, Number.MAX_SAFE_INTEGER, 'investment amount');\r\n\r\n      const validTypes = ['shop', 'farm', 'mine', 'factory', 'bank', 'casino', 'restaurant', 'tech', 'trading'];\r\n      if (!validTypes.includes(businessType)) {\r\n        throw new CommandError(`Invalid business type. Use: ${validTypes.join(', ')}`, 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const result = createBusiness(interaction.user.id, businessType, investment);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üè™ Business Created!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You opened a **${businessType}** with ${investment} gold investment!`)\r\n          .addFields(\r\n            { name: 'üíº Type', value: businessType, inline: true },\r\n            { name: 'üí∞ Investment', value: `${investment} gold`, inline: true },\r\n            { name: 'üìà Income', value: `~${result.business.income}/hour`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Failed to create business: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'collect') {\r\n      const result = collectBusinessIncome(interaction.user.id);\r\n\r\n      if (result.success) {\r\n        if (result.income > 0) {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí∞ Business Income Collected!')\r\n            .setColor(0x00FF00)\r\n            .setDescription(`Collected **${result.income}** gold from your ${result.businesses} business(es)!`);\r\n\r\n          await interaction.reply({ embeds: [embed] });\r\n        } else {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle('üí§ No Income Available')\r\n            .setColor(0xFFA500)\r\n            .setDescription('No income available to collect yet. Check back later!');\r\n\r\n          await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n        }\r\n      } else {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'list') {\r\n      const businesses = getUserBusinesses(interaction.user.id);\r\n\r\n      if (businesses.length === 0) {\r\n        return interaction.reply({ content: 'üè¢ You have no businesses yet. Use `/economy business action:create` to start one!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üè¢ Your Businesses')\r\n        .setColor(0xFFD700)\r\n        .setDescription('Manage your business empire!');\r\n\r\n      businesses.forEach((business, index) => {\r\n        const now = Date.now();\r\n        const hoursSinceCollection = (now - business.lastCollected) / (1000 * 60 * 60);\r\n        const pendingIncome = Math.floor(business.income * hoursSinceCollection);\r\n        const upgradeCost = business.level * 500;\r\n\r\n        embed.addFields({\r\n          name: `${index + 1}. ${business.type.charAt(0).toUpperCase() + business.type.slice(1)} (${business.level}) [${business.id}]`,\r\n          value: `üí∞ Income: ${business.income}/hour\\nüïê Pending: ${pendingIncome} gold\\nüë• Employees: ${business.employees}\\nüîß Upgrades: ${business.upgrades}\\nüí∏ Next Upgrade: ${upgradeCost} gold`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_business:${interaction.user.id}`).setLabel('üè™ Collect Income').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_invest:${interaction.user.id}`).setLabel('üìà Investments').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row], flags: MessageFlags.Ephemeral });\r\n    } else if (action === 'upgrade') {\r\n      const businessId = interaction.options.getString('business_id');\r\n\r\n      validateNotEmpty(businessId, 'business ID');\r\n\r\n      const { upgradeBusiness } = await import('../economy.js');\r\n      const result = upgradeBusiness(interaction.user.id, businessId);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîß Business Upgraded!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Successfully upgraded your **${result.business.type}** business!`)\r\n          .addFields(\r\n            { name: 'üè¢ Business', value: `${result.business.type} (Level ${result.business.level})`, inline: true },\r\n            { name: 'üí∞ New Income', value: `${result.business.income}/hour`, inline: true },\r\n            { name: 'üîß Total Upgrades', value: result.business.upgrades, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Upgrade failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    }\r\n\r\n  } else if (sub === 'market') {\r\n    const action = interaction.options.getString('action');\r\n    const item = interaction.options.getString('item');\r\n    const quantity = interaction.options.getInteger('quantity') || 1;\r\n\r\n    if (action === 'prices') {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìà Market Prices')\r\n        .setColor(0x0099FF);\r\n\r\n      const items = ['health_potion', 'mana_potion', 'iron_ore', 'magic_crystal', 'dragon_scale'];\r\n      items.forEach(itemId => {\r\n        const price = getMarketPrice(itemId);\r\n        embed.addFields({\r\n          name: itemId.replace('_', ' ').toUpperCase(),\r\n          value: `üí∞ ${price} gold each`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_buy:${interaction.user.id}`).setLabel('üõí Buy').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_sell:${interaction.user.id}`).setLabel('üí∏ Sell').setStyle(ButtonStyle.Success)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } else if (action === 'buy') {\r\n      validateNotEmpty(item, 'item to buy');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const price = getMarketPrice(item);\r\n      if (price === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const totalCost = price * quantity;\r\n      const balance = getBalance(interaction.user.id);\r\n      if (balance < totalCost) {\r\n        throw new CommandError(`Insufficient funds! You need ${totalCost} gold but only have ${balance} gold.`, 'INSUFFICIENT_FUNDS');\r\n      }\r\n\r\n      const result = buyFromMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üõí Purchase Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Bought **${quantity}x ${item}** for **${totalCost}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Price per Unit', value: `${price} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Purchase failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n\r\n    } else if (action === 'sell') {\r\n      validateNotEmpty(item, 'item to sell');\r\n      validateRange(quantity, 1, 1000, 'quantity'); // Reasonable limit\r\n\r\n      const marketPrice = getMarketPrice(item);\r\n      if (marketPrice === 0) {\r\n        throw new CommandError(`Item '${item}' is not available in the market.`, 'NOT_FOUND');\r\n      }\r\n\r\n      const sellPrice = Math.floor(marketPrice * 0.8);\r\n      const totalEarnings = sellPrice * quantity;\r\n\r\n      const result = sellToMarket(interaction.user.id, item, quantity);\r\n\r\n      if (result.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üí∏ Sale Complete!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`Sold **${quantity}x ${item}** for **${totalEarnings}** gold!`)\r\n          .addFields(\r\n            { name: 'üì¶ Item', value: item, inline: true },\r\n            { name: 'üî¢ Quantity', value: quantity, inline: true },\r\n            { name: 'üí∞ Earnings', value: `${totalEarnings} gold`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(`Sale failed: ${result.reason}`, 'COMMAND_ERROR');\r\n      }\r\n    }\r\n\r\n  } else if (sub === 'lottery') {\r\n    const ticketPrice = interaction.options.getInteger('ticket_price');\r\n\r\n    validateRange(ticketPrice, 1, 10000, 'ticket price'); // Reasonable limits\r\n\r\n    const currentBalance = getBalance(interaction.user.id);\r\n    if (currentBalance < ticketPrice) {\r\n      throw new CommandError(`Insufficient funds! You need ${ticketPrice} gold but only have ${currentBalance}.`, 'INSUFFICIENT_FUNDS');\r\n    }\r\n\r\n    // Simple lottery with 1/1000 chance of winning\r\n    const prizePool = ticketPrice * 10; // 10x return for winners\r\n    const result = createLottery(interaction.user.id, ticketPrice, prizePool);\r\n\r\n    if (result.success) {\r\n      if (result.isWinner) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üéâ LOTTERY WINNER!')\r\n          .setColor(0xFFD700)\r\n          .setDescription(`üéä **JACKPOT!** You won the lottery!`)\r\n          .addFields(\r\n            { name: 'üé´ Your Number', value: result.lotteryNumber, inline: true },\r\n            { name: 'üèÜ Winning Number', value: result.winningNumber, inline: true },\r\n            { name: 'üí∞ Prize', value: `${result.winnings} gold!`, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé´ Lottery Ticket Purchased')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`Your number: **${result.lotteryNumber}**\\nüí∞ Cost: ${ticketPrice} gold\\nüèÜ Jackpot: ${prizePool} gold\\n\\n*Better luck next time!*`);\r\n\r\n        await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n      }\r\n    } else {\r\n      throw new CommandError('Failed to create lottery ticket.', 'COMMAND_ERROR');\r\n    }\r\n\r\n  } else if (sub === 'history') {\r\n    const limit = interaction.options.getInteger('limit') || 10;\r\n    validateRange(limit, 1, 50, 'transaction limit'); // Reasonable limit\r\n\r\n    const transactions = getTransactionHistory(interaction.user.id, limit);\r\n\r\n    if (transactions.length === 0) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìã Transaction History')\r\n        .setColor(0xFFA500)\r\n        .setDescription('No transaction history found.');\r\n\r\n      return await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìã Transaction History')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Your recent ${transactions.length} transactions`);\r\n\r\n    transactions.forEach((txn, index) => {\r\n      const timestamp = new Date(txn.timestamp).toLocaleString();\r\n      const amount = txn.amount > 0 ? `+${txn.amount}` : txn.amount;\r\n\r\n      embed.addFields({\r\n        name: `${index + 1}. ${txn.type.toUpperCase()}`,\r\n        value: `üí∞ **${amount}** gold\\nüìÖ ${timestamp}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  } else if (sub === 'stats') {\r\n    const stats = getUserEconomyStats(interaction.user.id);\r\n    const balance = getBalance(interaction.user.id);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìä Economy Statistics')\r\n      .setColor(0xFFD700)\r\n      .setDescription(`**${interaction.user.username}**'s financial overview`)\r\n      .addFields(\r\n        { name: 'üí∞ Current Balance', value: `${balance} gold`, inline: true },\r\n        { name: 'üìà Total Income', value: `${stats.totalIncome} gold`, inline: true },\r\n        { name: 'üìâ Total Expenses', value: `${stats.totalExpenses} gold`, inline: true },\r\n        { name: 'üèÜ Net Worth', value: `${stats.netWorth} gold`, inline: true },\r\n        { name: 'üè¢ Businesses', value: stats.businesses, inline: true },\r\n        { name: 'üìà Investments', value: stats.investments, inline: true },\r\n        { name: 'üíº Transactions', value: stats.transactionCount, inline: true }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`economy_business:${interaction.user.id}`).setLabel('üè™ Manage Business').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`economy_invest:${interaction.user.id}`).setLabel('üìà Investments').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row], flags: MessageFlags.Ephemeral });\r\n  } else if (sub === 'daily') {\r\n    const result = claimDailyReward(interaction.user.id);\r\n\r\n    if (result.success) {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéÅ Daily Reward Claimed!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You claimed your daily reward!`)\r\n        .addFields(\r\n          { name: 'üí∞ Reward', value: `${result.reward} gold`, inline: true },\r\n          { name: 'üî• Streak', value: `${result.streak} days`, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n    } else {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚è∞ Daily Reward Not Available')\r\n        .setColor(0xFFA500)\r\n        .setDescription(`Your daily reward will be available in ${result.hoursLeft} hours.`);\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n }, {\r\n   command: 'economy'\r\n });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\explore.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'enterDungeon' is defined but never used.","line":2,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":55},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":3,"column":1,"nodeType":"ImportDeclaration","endLine":3,"endColumn":37,"fix":{"range":[275,275],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`fs` import should occur before import of `discord.js`","line":4,"column":1,"nodeType":"ImportDeclaration","endLine":4,"endColumn":21,"fix":{"range":[0,299],"text":"import fs from 'fs';\r\nimport { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { exploreLocation, unlockLocation, enterDungeon, discoverLocation, getLocations } from '../locations.js';\r\nimport { narrate } from '../rpg.js';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":4,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":4,"endColumn":20,"fix":{"range":[293,293],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":5,"column":1,"nodeType":"ImportDeclaration","endLine":5,"endColumn":25,"fix":{"range":[323,323],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`path` import should occur before import of `discord.js`","line":5,"column":1,"nodeType":"ImportDeclaration","endLine":5,"endColumn":25,"fix":{"range":[0,325],"text":"import path from 'path';\r\nimport { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { exploreLocation, unlockLocation, enterDungeon, discoverLocation, getLocations } from '../locations.js';\r\nimport { narrate } from '../rpg.js';\r\nimport fs from 'fs';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":5,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":5,"endColumn":24,"fix":{"range":[317,317],"text":"node:"}},{"ruleId":"no-unused-vars","severity":1,"message":"'validateRange' is defined but never used.","line":6,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":75},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":12,"column":13,"nodeType":"Literal","messageId":"error","endLine":12,"endColumn":17,"suggestions":[{"messageId":"remove","fix":{"range":[572,579],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[575,579],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'locks' is assigned a value but never used.","line":14,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":25,"column":50,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":25,"endColumn":56,"fix":{"range":[929,937],"text":""}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":28,"column":17,"nodeType":"MemberExpression","endLine":28,"endColumn":23},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":29,"column":11,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":29,"endColumn":17,"fix":{"range":[1085,1127],"text":"c.dailyExplorations === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":30,"column":11,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":30,"endColumn":17,"fix":{"range":[1165,1204],"text":"c.lastDailyReset === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":31,"column":11,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":31,"endColumn":17,"fix":{"range":[1248,1288],"text":"c.sessionXpGained === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":32,"column":11,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":32,"endColumn":17,"fix":{"range":[1324,1365],"text":"c.lastSessionReset === undefined"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":33,"column":7,"nodeType":"MemberExpression","endLine":33,"endColumn":13},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":37,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":37,"endColumn":4,"fix":{"range":[1465,1465],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":37,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":37,"endColumn":15,"fix":{"range":[1473,1532],"text":"error) {\r\n    console.error('Failed to read rpg storage', error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1485,1534],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":48,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":48,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1702,1762],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":49,"column":47,"nodeType":"Literal","messageId":"error","endLine":49,"endColumn":51,"suggestions":[{"messageId":"replace","fix":{"range":[1810,1814],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":52,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":52,"endColumn":4,"fix":{"range":[1882,1882],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":52,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":52,"endColumn":15,"fix":{"range":[1890,2152],"text":"error) {\r\n    console.error('Failed to write RPG data:', error);\r\n    // Attempt to restore from cache if available\r\n    if (cache) {\r\n      console.log('Restoring from cache after write failure');\r\n    } else {\r\n      throw new Error(`Failed to save RPG data: ${error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":53,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":53,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1902,1950],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":56,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":56,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2027,2083],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":57,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":57,"endColumn":6,"fix":{"range":[2090,2090],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":66,"column":16,"nodeType":"MemberExpression","endLine":66,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":95,"column":16,"nodeType":"MemberExpression","endLine":95,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":113,"column":16,"nodeType":"MemberExpression","endLine":113,"endColumn":27},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (166). Maximum allowed is 100.","line":146,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":311,"endColumn":2},{"ruleId":"max-lines-per-function","severity":1,"message":"Async arrow function has too many lines (162). Maximum allowed is 100.","line":147,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":308,"endColumn":4},{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (54). Maximum allowed is 30.","line":147,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":308,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async arrow function has a complexity of 21. Maximum allowed is 20.","line":147,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":308,"endColumn":4},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":147,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":147,"endColumn":48,"fix":{"range":[4971,4972],"text":""}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 28 to the 15 allowed.","line":147,"column":51,"nodeType":null,"messageId":"refactorFunction","endLine":147,"endColumn":53},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":151,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":151,"endColumn":3,"fix":{"range":[5078,5080],"text":"    "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":151,"column":3,"nodeType":null,"messageId":"prefer-switch","endLine":151,"endColumn":28,"fix":{"range":[5080,11862],"text":"switch (sub) {\n  case 'locations': {\r\n    const locations = getLocations();\r\n    const availableLocations = Object.values(locations).filter(loc => loc.unlocked);\r\n\r\n    if (availableLocations.length === 0) {\r\n      return interaction.reply({\r\n        content: 'üèïÔ∏è No locations available yet. Start your adventure by exploring the Whispering Woods!\\nUse `/explore discover location:whispering_woods`',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const dailyCheck = checkDailyLimit(userId);\r\n    const sessionCheck = checkSessionXpCap(userId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üó∫Ô∏è Available Locations')\r\n      .setColor(0x0099FF)\r\n      .setDescription('Choose your adventure!');\r\n\r\n    availableLocations.forEach(location => {\r\n      embed.addFields({\r\n        name: `${location.emoji} ${location.name} (Level ${location.level})`,\r\n        value: `**Type:** ${location.type}\\n**Description:** ${location.description}\\n**Rewards:** ${location.rewards.xp} XP, ${location.rewards.gold} gold`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    // Add usage info\r\n    embed.addFields({\r\n      name: 'üìä Daily Usage',\r\n      value: dailyCheck.allowed ? `Explorations: ${dailyCheck.remaining} remaining` : `Explorations: ${dailyCheck.used}/${dailyCheck.max} (limit reached)`,\r\n      inline: true\r\n    });\r\n\r\n    embed.addFields({\r\n      name: '‚≠ê Session XP',\r\n      value: sessionCheck.allowed ? `XP: ${sessionCheck.remaining} remaining` : `XP: ${sessionCheck.used}/${sessionCheck.max} (cap reached)`,\r\n      inline: true\r\n    });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`explore_unlock:${userId}`).setLabel('üîì Discover More').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`explore_map:${userId}`).setLabel('üó∫Ô∏è View Map').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    \n  break;\n  }\n  case 'discover': {\r\n    const locationName = interaction.options.getString('location');\r\n\r\n    validateNotEmpty(locationName, 'location name');\r\n\r\n    const result = discoverLocation(userId, locationName);\r\n\r\n    if (!result.success) {\r\n      throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n    }\r\n\r\n    const { location, requirements, canUnlock } = result;\r\n\r\n    if (canUnlock) {\r\n      const unlockResult = unlockLocation(userId, locationName);\r\n      if (unlockResult.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üéâ Location Discovered!')\r\n          .setColor(location.color)\r\n          .setDescription(unlockResult.message)\r\n          .addFields(\r\n            { name: 'üìç Location', value: location.name, inline: true },\r\n            { name: 'üèÜ Level', value: location.level, inline: true },\r\n            { name: 'üéØ Type', value: location.type, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(unlockResult.reason || 'Failed to unlock location', 'COMMAND_ERROR');\r\n      }\r\n    } else {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîí Location Locked')\r\n        .setColor(0xFFA500)\r\n        .setDescription(`**${location.name}** is not yet available.`)\r\n        .addFields({\r\n          name: 'Requirements',\r\n          value: `üèÜ **Level ${requirements.level || 'Any'}**\\n‚≠ê **Achievement: ${requirements.achievements?.join(', ') || 'None'}**`,\r\n          inline: false\r\n        });\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'enter': {\r\n    const locationName = interaction.options.getString('location');\r\n\r\n    validateNotEmpty(locationName, 'location name');\r\n\r\n    // Check daily limit\r\n    const dailyCheck = checkDailyLimit(userId);\r\n    if (!dailyCheck.allowed) {\r\n      const resetHours = Math.ceil((24 - (Date.now() - (dailyCheck.resetTime || Date.now())) / 3600000));\r\n      throw new CommandError(`Daily exploration limit reached! You have used ${dailyCheck.used}/${dailyCheck.max} explorations today. Reset in ${resetHours} hours.`, 'COMMAND_ERROR');\r\n    }\r\n\r\n    // Check session XP cap\r\n    const sessionCheck = checkSessionXpCap(userId);\r\n    if (!sessionCheck.allowed) {\r\n      const resetHours = Math.ceil((24 - (Date.now() - (sessionCheck.resetTime || Date.now())) / 3600000));\r\n      throw new CommandError(`Session XP cap reached! You have gained ${sessionCheck.used}/${sessionCheck.max} XP this session. Reset in ${resetHours} hours.`, 'COMMAND_ERROR');\r\n    }\r\n\r\n    const result = exploreLocation(userId, locationName);\r\n\r\n    if (!result.success) {\r\n      throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n    }\r\n\r\n    // Increment daily exploration count\r\n    const incrementResult = incrementDailyExploration(userId);\r\n    if (!incrementResult.success) {\r\n      throw new CommandError(incrementResult.reason || 'Failed to update exploration count', 'COMMAND_ERROR');\r\n    }\r\n\r\n    const { location, encounter, narrative } = result;\r\n\r\n    // Generate AI narrative for the location entry\r\n    let locationNarrative;\r\n    try {\r\n      locationNarrative = await narrate(\r\n        interaction.guildId,\r\n        `${location.ai_prompt} An adventurer enters this mystical place.`,\r\n        `You enter ${location.name}. ${narrative.entry}`\r\n      );\r\n    } catch (narrativeError) {\r\n      console.warn('[EXPLORE] AI narrative generation failed, using fallback:', narrativeError.message);\r\n      locationNarrative = `You enter ${location.name}. ${narrative.entry}`;\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`${location.emoji} ${location.name}`)\r\n      .setColor(location.color)\r\n      .setDescription(locationNarrative)\r\n      .addFields(\r\n        { name: 'üéØ Encounter Type', value: encounter.type.replace('_', ' ').toUpperCase(), inline: true },\r\n        { name: '‚öîÔ∏è Difficulty', value: `Level ${encounter.difficulty}`, inline: true },\r\n        { name: 'üíé Potential Rewards', value: `${encounter.rewards.xp} XP, ${encounter.rewards.gold} gold`, inline: true },\r\n        { name: 'üìä Daily Explorations', value: `${dailyCheck.remaining - 1} remaining`, inline: true },\r\n        { name: '‚≠ê Session XP', value: `${sessionCheck.remaining} remaining`, inline: true }\r\n      );\r\n\r\n    // Add exploration action buttons\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`explore_continue:${locationName}:${userId}`).setLabel('‚öîÔ∏è Continue Adventure').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`explore_leave:${locationName}:${userId}`).setLabel('üèÉ Leave Location').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n    \n  break;\n  }\n  // No default\n  }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":5,"fix":{"range":[5108,5112],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":153,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":153,"endColumn":5,"fix":{"range":[5147,5151],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":155,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":155,"endColumn":5,"fix":{"range":[5235,5239],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":156,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":156,"endColumn":7,"fix":{"range":[5279,5285],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":157,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":157,"endColumn":9,"fix":{"range":[5313,5321],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":158,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":158,"endColumn":9,"fix":{"range":[5473,5481],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":7,"fix":{"range":[5512,5518],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":5,"fix":{"range":[5523,5527],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":162,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":162,"endColumn":5,"fix":{"range":[5532,5536],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":163,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":163,"endColumn":5,"fix":{"range":[5581,5585],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":165,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":165,"endColumn":5,"fix":{"range":[5636,5640],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[5674,5680],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":167,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":167,"endColumn":7,"fix":{"range":[5718,5724],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":167,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":167,"endColumn":25,"fix":{"range":[5734,5742],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":168,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":168,"endColumn":7,"fix":{"range":[5745,5751],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":5,"fix":{"range":[5797,5801],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":170,"column":24,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":170,"endColumn":31,"fix":{"range":[5801,6147],"text":"for (const location of availableLocations) {\r\n      embed.addFields({\r\n        name: `${location.emoji} ${location.name} (Level ${location.level})`,\r\n        value: `**Type:** ${location.type}\\n**Description:** ${location.description}\\n**Rewards:** ${location.rewards.xp} XP, ${location.rewards.gold} gold`,\r\n        inline: false\r\n      });\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":171,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":171,"endColumn":7,"fix":{"range":[5843,5849],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":172,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":172,"endColumn":9,"fix":{"range":[5868,5876],"text":"          "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 157. Maximum allowed is 120.","line":173,"column":1,"nodeType":"Program","messageId":"max","endLine":173,"endColumn":158},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":173,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":173,"endColumn":9,"fix":{"range":[5947,5955],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":174,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":174,"endColumn":9,"fix":{"range":[6106,6114],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":175,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":175,"endColumn":7,"fix":{"range":[6129,6135],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":176,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":176,"endColumn":5,"fix":{"range":[6140,6144],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":178,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":178,"endColumn":5,"fix":{"range":[6151,6155],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":179,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":179,"endColumn":5,"fix":{"range":[6174,6178],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":180,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":180,"endColumn":7,"fix":{"range":[6197,6203],"text":"        "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 155. Maximum allowed is 120.","line":181,"column":1,"nodeType":"Program","messageId":"max","endLine":181,"endColumn":156},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[6228,6234],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":7,"fix":{"range":[6385,6391],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":183,"endColumn":5,"fix":{"range":[6405,6409],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":185,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":185,"endColumn":5,"fix":{"range":[6416,6420],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":186,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":186,"endColumn":7,"fix":{"range":[6439,6445],"text":"        "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 141. Maximum allowed is 120.","line":187,"column":1,"nodeType":"Program","messageId":"max","endLine":187,"endColumn":142},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":187,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":187,"endColumn":7,"fix":{"range":[6468,6474],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":188,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":188,"endColumn":7,"fix":{"range":[6611,6617],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":189,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":189,"endColumn":5,"fix":{"range":[6631,6635],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":191,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":191,"endColumn":5,"fix":{"range":[6642,6646],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":192,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":192,"endColumn":7,"fix":{"range":[6697,6703],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":193,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":193,"endColumn":7,"fix":{"range":[6824,6830],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":194,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":194,"endColumn":5,"fix":{"range":[6945,6949],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":196,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":196,"endColumn":5,"fix":{"range":[6955,6959],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":198,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":198,"endColumn":6,"fix":{"range":[7032,7032],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":199,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":199,"endColumn":5,"fix":{"range":[7065,7069],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":201,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":201,"endColumn":5,"fix":{"range":[7136,7140],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":203,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":203,"endColumn":5,"fix":{"range":[7192,7196],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":205,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":205,"endColumn":5,"fix":{"range":[7254,7258],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":206,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":206,"endColumn":7,"fix":{"range":[7282,7288],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":207,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":207,"endColumn":5,"fix":{"range":[7345,7349],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":209,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":209,"endColumn":5,"fix":{"range":[7354,7358],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":211,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":211,"endColumn":5,"fix":{"range":[7415,7419],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":212,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":212,"endColumn":7,"fix":{"range":[7437,7443],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":213,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":213,"endColumn":7,"fix":{"range":[7503,7509],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":214,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":214,"endColumn":9,"fix":{"range":[7538,7546],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":215,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":215,"endColumn":11,"fix":{"range":[7580,7590],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":216,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":216,"endColumn":11,"fix":{"range":[7628,7638],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":217,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":217,"endColumn":11,"fix":{"range":[7665,7675],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":218,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":218,"endColumn":11,"fix":{"range":[7714,7724],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":219,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":219,"endColumn":13,"fix":{"range":[7737,7749],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":220,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":220,"endColumn":13,"fix":{"range":[7811,7823],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":221,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":221,"endColumn":13,"fix":{"range":[7883,7895],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":222,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":222,"endColumn":11,"fix":{"range":[7952,7962],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":224,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":224,"endColumn":9,"fix":{"range":[7968,7976],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":225,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":225,"endColumn":7,"fix":{"range":[8023,8029],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":225,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":225,"endColumn":8,"fix":{"range":[8030,8030],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":226,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":226,"endColumn":9,"fix":{"range":[8039,8047],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":227,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":227,"endColumn":7,"fix":{"range":[8141,8147],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":228,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":228,"endColumn":5,"fix":{"range":[8150,8154],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":228,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":228,"endColumn":6,"fix":{"range":[8155,8155],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":229,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":229,"endColumn":7,"fix":{"range":[8164,8170],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":230,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":230,"endColumn":9,"fix":{"range":[8204,8212],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":231,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":231,"endColumn":9,"fix":{"range":[8245,8253],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":231,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":231,"endColumn":27,"fix":{"range":[8263,8271],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":232,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":232,"endColumn":9,"fix":{"range":[8274,8282],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":233,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":233,"endColumn":9,"fix":{"range":[8345,8353],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":234,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":234,"endColumn":11,"fix":{"range":[8367,8377],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":235,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":235,"endColumn":11,"fix":{"range":[8400,8410],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":236,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":236,"endColumn":11,"fix":{"range":[8536,8546],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":237,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":237,"endColumn":9,"fix":{"range":[8561,8569],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":239,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":239,"endColumn":7,"fix":{"range":[8576,8582],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":240,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":240,"endColumn":5,"fix":{"range":[8660,8664],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":242,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":242,"endColumn":3,"fix":{"range":[8669,8671],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":242,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":242,"endColumn":4,"fix":{"range":[8672,8672],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":243,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":243,"endColumn":5,"fix":{"range":[8702,8706],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":245,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":245,"endColumn":5,"fix":{"range":[8773,8777],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":247,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":247,"endColumn":5,"fix":{"range":[8829,8833],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":248,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":248,"endColumn":5,"fix":{"range":[8855,8859],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":249,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":249,"endColumn":5,"fix":{"range":[8904,8908],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":250,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":250,"endColumn":7,"fix":{"range":[8936,8942],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":250,"column":96,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":250,"endColumn":103,"fix":{"range":[9031,9038],"text":"3_600_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":251,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":251,"endColumn":7,"fix":{"range":[9043,9049],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":252,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":252,"endColumn":5,"fix":{"range":[9228,9232],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":254,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":254,"endColumn":5,"fix":{"range":[9237,9241],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":255,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":255,"endColumn":5,"fix":{"range":[9266,9270],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":256,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":256,"endColumn":5,"fix":{"range":[9319,9323],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":257,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":257,"endColumn":7,"fix":{"range":[9353,9359],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":257,"column":98,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":257,"endColumn":105,"fix":{"range":[9450,9457],"text":"3_600_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":258,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":258,"endColumn":7,"fix":{"range":[9462,9468],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":259,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":259,"endColumn":5,"fix":{"range":[9641,9645],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":261,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":261,"endColumn":5,"fix":{"range":[9650,9654],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":263,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":263,"endColumn":5,"fix":{"range":[9711,9715],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":264,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":264,"endColumn":7,"fix":{"range":[9739,9745],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":265,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":265,"endColumn":5,"fix":{"range":[9802,9806],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":267,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":267,"endColumn":5,"fix":{"range":[9811,9815],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":268,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":268,"endColumn":5,"fix":{"range":[9853,9857],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":269,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":269,"endColumn":5,"fix":{"range":[9917,9921],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":270,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":270,"endColumn":7,"fix":{"range":[9954,9960],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":271,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":271,"endColumn":5,"fix":{"range":[10066,10070],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":273,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":273,"endColumn":5,"fix":{"range":[10075,10079],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":275,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":275,"endColumn":5,"fix":{"range":[10133,10137],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":276,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":276,"endColumn":5,"fix":{"range":[10186,10190],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":277,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":277,"endColumn":5,"fix":{"range":[10214,10218],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":278,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":278,"endColumn":7,"fix":{"range":[10225,10231],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":279,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":279,"endColumn":9,"fix":{"range":[10267,10275],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":280,"column":1,"nodeType":"Template","messageId":"wrongIndentation","endLine":280,"endColumn":9,"fix":{"range":[10297,10305],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":281,"column":1,"nodeType":"Template","messageId":"wrongIndentation","endLine":281,"endColumn":9,"fix":{"range":[10373,10381],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":282,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":282,"endColumn":7,"fix":{"range":[10431,10437],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":283,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":283,"endColumn":5,"fix":{"range":[10441,10445],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":283,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":283,"endColumn":6,"fix":{"range":[10446,10446],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":284,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":284,"endColumn":7,"fix":{"range":[10473,10479],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":284,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":284,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[10479,10577],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":285,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":285,"endColumn":7,"fix":{"range":[10579,10585],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":286,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":286,"endColumn":5,"fix":{"range":[10656,10660],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":288,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":288,"endColumn":5,"fix":{"range":[10665,10669],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":289,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":289,"endColumn":7,"fix":{"range":[10703,10709],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":290,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":290,"endColumn":7,"fix":{"range":[10758,10764],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":291,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":291,"endColumn":7,"fix":{"range":[10791,10797],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":292,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":292,"endColumn":7,"fix":{"range":[10833,10839],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":293,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":293,"endColumn":9,"fix":{"range":[10852,10860],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":294,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":294,"endColumn":9,"fix":{"range":[10961,10969],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":295,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":295,"endColumn":9,"fix":{"range":[11051,11059],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":296,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":296,"endColumn":9,"fix":{"range":[11177,11185],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":297,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":297,"endColumn":9,"fix":{"range":[11283,11291],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":298,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":298,"endColumn":7,"fix":{"range":[11377,11383],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":300,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":300,"endColumn":5,"fix":{"range":[11389,11393],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":301,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":301,"endColumn":5,"fix":{"range":[11428,11432],"text":"      "}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (311). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":311,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":302,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":302,"endColumn":7,"fix":{"range":[11483,11489],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":303,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":303,"endColumn":7,"fix":{"range":[11633,11639],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":304,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":304,"endColumn":5,"fix":{"range":[11777,11781],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":306,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":306,"endColumn":5,"fix":{"range":[11787,11791],"text":"      "}}],"suppressedMessages":[],"errorCount":165,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":156,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { exploreLocation, unlockLocation, enterDungeon, discoverLocation, getLocations } from '../locations.js';\r\nimport { narrate } from '../rpg.js';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { safeExecuteCommand, CommandError, validateNotEmpty, validateRange } from '../errorHandler.js';\r\n\r\n// RPG data file path\r\nconst FILE = path.join(process.cwd(), 'data', 'rpg.json');\r\n\r\n// in-memory cache to reduce fs reads/writes\r\nlet cache = null;\r\n// simple per-user locks to avoid concurrent writes\r\nconst locks = new Set();\r\n\r\nfunction ensureDir() {\r\n  const dir = path.dirname(FILE);\r\n  if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });\r\n}\r\n\r\nfunction readAll() {\r\n  ensureDir();\r\n  if (!fs.existsSync(FILE)) return {};\r\n  try {\r\n    const raw = JSON.parse(fs.readFileSync(FILE, 'utf8')) || {};\r\n    // migrate / ensure defaults for older characters\r\n    for (const k of Object.keys(raw)) {\r\n      const c = raw[k] || {};\r\n      if (typeof c.dailyExplorations === 'undefined') c.dailyExplorations = 0;\r\n      if (typeof c.lastDailyReset === 'undefined') c.lastDailyReset = Date.now();\r\n      if (typeof c.sessionXpGained === 'undefined') c.sessionXpGained = 0;\r\n      if (typeof c.lastSessionReset === 'undefined') c.lastSessionReset = Date.now();\r\n      raw[k] = c;\r\n    }\r\n    cache = raw;\r\n    return raw;\r\n  } catch (err) {\r\n    console.error('Failed to read rpg storage', err);\r\n    return {};\r\n  }\r\n}\r\n\r\nfunction writeAll(obj) {\r\n  ensureDir();\r\n  try {\r\n    // atomic write: write to temp file then rename\r\n    const tmp = `${FILE}.tmp`;\r\n    console.log(`[EXPLORE DEBUG] Writing to RPG file: ${FILE}`);\r\n    fs.writeFileSync(tmp, JSON.stringify(obj, null, 2), 'utf8');\r\n    fs.renameSync(tmp, FILE);\r\n    cache = obj;\r\n  } catch (err) {\r\n    console.error('Failed to write RPG data:', err);\r\n    // Attempt to restore from cache if available\r\n    if (cache) {\r\n      console.log('Restoring from cache after write failure');\r\n    } else {\r\n      throw new Error(`Failed to save RPG data: ${err.message}`);\r\n    }\r\n  }\r\n}\r\n\r\n// Function to check daily exploration limit\r\nfunction checkDailyLimit(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { allowed: false, reason: 'no_character' };\r\n\r\n  const now = Date.now();\r\n  const dayInMs = 24 * 60 * 60 * 1000;\r\n\r\n  // Check if we need to reset daily count\r\n  if (now - (char.lastDailyReset || 0) >= dayInMs) {\r\n    char.dailyExplorations = 0;\r\n    char.lastDailyReset = now;\r\n    writeAll(all);\r\n  }\r\n\r\n  const maxDaily = 10; // 10 explorations per day\r\n  const used = char.dailyExplorations || 0;\r\n  const allowed = used < maxDaily;\r\n\r\n  return {\r\n    allowed,\r\n    used,\r\n    max: maxDaily,\r\n    remaining: maxDaily - used,\r\n    resetTime: char.lastDailyReset\r\n  };\r\n}\r\n\r\n// Function to increment daily exploration count\r\nfunction incrementDailyExploration(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n\r\n  // Check daily limit first\r\n  const check = checkDailyLimit(userId);\r\n  if (!check.allowed) {\r\n    return { success: false, reason: 'daily_limit_reached' };\r\n  }\r\n\r\n  char.dailyExplorations = (char.dailyExplorations || 0) + 1;\r\n  writeAll(all);\r\n\r\n  return { success: true, newCount: char.dailyExplorations };\r\n}\r\n\r\n// Function to check session XP cap\r\nfunction checkSessionXpCap(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { allowed: false, reason: 'no_character' };\r\n\r\n  const now = Date.now();\r\n  const sessionDurationMs = 24 * 60 * 60 * 1000; // 24 hours\r\n\r\n  // Check if we need to reset session XP\r\n  if (now - (char.lastSessionReset || 0) >= sessionDurationMs) {\r\n    char.sessionXpGained = 0;\r\n    char.lastSessionReset = now;\r\n    writeAll(all);\r\n  }\r\n\r\n  const maxSessionXp = 1000; // 1000 XP per session\r\n  const used = char.sessionXpGained || 0;\r\n  const allowed = used < maxSessionXp;\r\n\r\n  return {\r\n    allowed,\r\n    used,\r\n    max: maxSessionXp,\r\n    remaining: maxSessionXp - used,\r\n    resetTime: char.lastSessionReset\r\n  };\r\n}\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('explore')\r\n  .setDescription('Explore epic RPG locations and dungeons')\r\n  .addSubcommand(sub => sub.setName('locations').setDescription('View available locations'))\r\n  .addSubcommand(sub => sub.setName('discover').setDescription('Discover new locations').addStringOption(opt => opt.setName('location').setDescription('Location to discover').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('enter').setDescription('Enter a location for adventure').addStringOption(opt => opt.setName('location').setDescription('Location to explore').setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    const sub = interaction.options.getSubcommand();\r\n    const userId = interaction.user.id;\r\n\r\n  if (sub === 'locations') {\r\n    const locations = getLocations();\r\n    const availableLocations = Object.values(locations).filter(loc => loc.unlocked);\r\n\r\n    if (availableLocations.length === 0) {\r\n      return interaction.reply({\r\n        content: 'üèïÔ∏è No locations available yet. Start your adventure by exploring the Whispering Woods!\\nUse `/explore discover location:whispering_woods`',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const dailyCheck = checkDailyLimit(userId);\r\n    const sessionCheck = checkSessionXpCap(userId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üó∫Ô∏è Available Locations')\r\n      .setColor(0x0099FF)\r\n      .setDescription('Choose your adventure!');\r\n\r\n    availableLocations.forEach(location => {\r\n      embed.addFields({\r\n        name: `${location.emoji} ${location.name} (Level ${location.level})`,\r\n        value: `**Type:** ${location.type}\\n**Description:** ${location.description}\\n**Rewards:** ${location.rewards.xp} XP, ${location.rewards.gold} gold`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    // Add usage info\r\n    embed.addFields({\r\n      name: 'üìä Daily Usage',\r\n      value: dailyCheck.allowed ? `Explorations: ${dailyCheck.remaining} remaining` : `Explorations: ${dailyCheck.used}/${dailyCheck.max} (limit reached)`,\r\n      inline: true\r\n    });\r\n\r\n    embed.addFields({\r\n      name: '‚≠ê Session XP',\r\n      value: sessionCheck.allowed ? `XP: ${sessionCheck.remaining} remaining` : `XP: ${sessionCheck.used}/${sessionCheck.max} (cap reached)`,\r\n      inline: true\r\n    });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`explore_unlock:${userId}`).setLabel('üîì Discover More').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`explore_map:${userId}`).setLabel('üó∫Ô∏è View Map').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } else if (sub === 'discover') {\r\n    const locationName = interaction.options.getString('location');\r\n\r\n    validateNotEmpty(locationName, 'location name');\r\n\r\n    const result = discoverLocation(userId, locationName);\r\n\r\n    if (!result.success) {\r\n      throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n    }\r\n\r\n    const { location, requirements, canUnlock } = result;\r\n\r\n    if (canUnlock) {\r\n      const unlockResult = unlockLocation(userId, locationName);\r\n      if (unlockResult.success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üéâ Location Discovered!')\r\n          .setColor(location.color)\r\n          .setDescription(unlockResult.message)\r\n          .addFields(\r\n            { name: 'üìç Location', value: location.name, inline: true },\r\n            { name: 'üèÜ Level', value: location.level, inline: true },\r\n            { name: 'üéØ Type', value: location.type, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        throw new CommandError(unlockResult.reason || 'Failed to unlock location', 'COMMAND_ERROR');\r\n      }\r\n    } else {\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîí Location Locked')\r\n        .setColor(0xFFA500)\r\n        .setDescription(`**${location.name}** is not yet available.`)\r\n        .addFields({\r\n          name: 'Requirements',\r\n          value: `üèÜ **Level ${requirements.level || 'Any'}**\\n‚≠ê **Achievement: ${requirements.achievements?.join(', ') || 'None'}**`,\r\n          inline: false\r\n        });\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'enter') {\r\n    const locationName = interaction.options.getString('location');\r\n\r\n    validateNotEmpty(locationName, 'location name');\r\n\r\n    // Check daily limit\r\n    const dailyCheck = checkDailyLimit(userId);\r\n    if (!dailyCheck.allowed) {\r\n      const resetHours = Math.ceil((24 - (Date.now() - (dailyCheck.resetTime || Date.now())) / 3600000));\r\n      throw new CommandError(`Daily exploration limit reached! You have used ${dailyCheck.used}/${dailyCheck.max} explorations today. Reset in ${resetHours} hours.`, 'COMMAND_ERROR');\r\n    }\r\n\r\n    // Check session XP cap\r\n    const sessionCheck = checkSessionXpCap(userId);\r\n    if (!sessionCheck.allowed) {\r\n      const resetHours = Math.ceil((24 - (Date.now() - (sessionCheck.resetTime || Date.now())) / 3600000));\r\n      throw new CommandError(`Session XP cap reached! You have gained ${sessionCheck.used}/${sessionCheck.max} XP this session. Reset in ${resetHours} hours.`, 'COMMAND_ERROR');\r\n    }\r\n\r\n    const result = exploreLocation(userId, locationName);\r\n\r\n    if (!result.success) {\r\n      throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n    }\r\n\r\n    // Increment daily exploration count\r\n    const incrementResult = incrementDailyExploration(userId);\r\n    if (!incrementResult.success) {\r\n      throw new CommandError(incrementResult.reason || 'Failed to update exploration count', 'COMMAND_ERROR');\r\n    }\r\n\r\n    const { location, encounter, narrative } = result;\r\n\r\n    // Generate AI narrative for the location entry\r\n    let locationNarrative;\r\n    try {\r\n      locationNarrative = await narrate(\r\n        interaction.guildId,\r\n        `${location.ai_prompt} An adventurer enters this mystical place.`,\r\n        `You enter ${location.name}. ${narrative.entry}`\r\n      );\r\n    } catch (narrativeError) {\r\n      console.warn('[EXPLORE] AI narrative generation failed, using fallback:', narrativeError.message);\r\n      locationNarrative = `You enter ${location.name}. ${narrative.entry}`;\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`${location.emoji} ${location.name}`)\r\n      .setColor(location.color)\r\n      .setDescription(locationNarrative)\r\n      .addFields(\r\n        { name: 'üéØ Encounter Type', value: encounter.type.replace('_', ' ').toUpperCase(), inline: true },\r\n        { name: '‚öîÔ∏è Difficulty', value: `Level ${encounter.difficulty}`, inline: true },\r\n        { name: 'üíé Potential Rewards', value: `${encounter.rewards.xp} XP, ${encounter.rewards.gold} gold`, inline: true },\r\n        { name: 'üìä Daily Explorations', value: `${dailyCheck.remaining - 1} remaining`, inline: true },\r\n        { name: '‚≠ê Session XP', value: `${sessionCheck.remaining} remaining`, inline: true }\r\n      );\r\n\r\n    // Add exploration action buttons\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`explore_continue:${locationName}:${userId}`).setLabel('‚öîÔ∏è Continue Adventure').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`explore_leave:${locationName}:${userId}`).setLabel('üèÉ Leave Location').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n    }\r\n  }, {\r\n    command: 'explore'\r\n  });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\fun.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'safeInteractionUpdate' is defined but never used.","line":3,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":53},{"ruleId":"import/namespace","severity":2,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":3,"column":61,"nodeType":"Literal","endLine":3,"endColumn":88},{"ruleId":"import/no-deprecated","severity":1,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":3,"column":61,"nodeType":"Literal","endLine":3,"endColumn":88},{"ruleId":"no-unused-vars","severity":1,"message":"'getPersonalityQuestion' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (277). Maximum allowed is 100.","line":70,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":346,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (91). Maximum allowed is 30.","line":70,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":346,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 51. Maximum allowed is 20.","line":70,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":346,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 50 to the 15 allowed.","line":70,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":70,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":74,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":74,"endColumn":25,"fix":{"range":[4091,15158],"text":"switch (sub) {\n    case 'joke': {\r\n      const category = interaction.options.getString('category') || 'general';\r\n      const joke = getRandomJoke(category);\r\n\r\n      if (!joke || !joke.joke) {\r\n        throw new CommandError('Failed to retrieve joke. Please try again.', 'ENTERTAINMENT_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üòÇ Random Joke')\r\n        .setColor(0xFFD700)\r\n        .setDescription(joke.joke)\r\n        .setFooter({ text: `${category.charAt(0).toUpperCase() + category.slice(1)} Jokes` });\r\n\r\n      // Track entertainment stats\r\n      try {\r\n        updateEntertainmentStats(interaction.user.id, 'jokesHeard');\r\n      } catch (error) {\r\n        console.warn('Failed to update joke stats:', error.message);\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_joke:${category}:${interaction.user.id}`).setLabel('üòÇ Another Joke').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_rate:${joke.id}:5:${interaction.user.id}`).setLabel('‚≠ê Rate 5 Stars').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n    \n    break;\n    }\n    case 'story': {\r\n      const prompt = interaction.options.getString('prompt');\r\n      const genre = interaction.options.getString('genre') || 'fantasy';\r\n\r\n      if (!prompt || prompt.trim().length === 0) {\r\n        throw new CommandError('Story prompt cannot be empty.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (prompt.length > 500) {\r\n        throw new CommandError('Story prompt is too long. Maximum 500 characters allowed.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const story = generateStory(prompt, genre);\r\n\r\n      if (!story || !story.story) {\r\n        throw new CommandError('Failed to generate story. Please try again.', 'ENTERTAINMENT_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üìñ ${genre.charAt(0).toUpperCase() + genre.slice(1)} Story`)\r\n        .setColor(0x9932CC)\r\n        .setDescription(story.story)\r\n        .addFields({\r\n          name: 'üéØ Prompt',\r\n          value: prompt,\r\n          inline: false\r\n        });\r\n\r\n      // Track entertainment stats\r\n      try {\r\n        updateEntertainmentStats(interaction.user.id, 'storiesGenerated');\r\n      } catch (error) {\r\n        console.warn('Failed to update story stats:', error.message);\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_story:${genre}:${interaction.user.id}`).setLabel('üìñ Another Story').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_share:${story.id}:${interaction.user.id}`).setLabel('üì§ Share Story').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'riddle': {\r\n    const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n    const riddle = getRiddle(difficulty);\r\n\r\n    if (!riddle || !riddle.riddle) {\r\n      throw new CommandError('Failed to retrieve riddle. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üß© ${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} Riddle`)\r\n      .setColor(0xFF8C00)\r\n      .setDescription(riddle.riddle)\r\n      .setFooter({ text: 'Think hard and reply with your answer!' });\r\n\r\n    // Track entertainment stats\r\n    try {\r\n      updateEntertainmentStats(interaction.user.id, 'riddlesAttempted');\r\n    } catch (error) {\r\n      console.warn('Failed to update riddle stats:', error.message);\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_riddle:${difficulty}:${riddle.id}:${interaction.user.id}`).setLabel('üí° Show Answer').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_riddle_new:${difficulty}:${interaction.user.id}`).setLabel('üß© Another Riddle').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'fact': {\r\n    const category = interaction.options.getString('category') || 'random';\r\n    const fact = getFunFact(category);\r\n\r\n    if (!fact || !fact.fact) {\r\n      throw new CommandError('Failed to retrieve fun fact. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üß† ${category === 'random' ? 'Random' : category.charAt(0).toUpperCase() + category.slice(1)} Fun Fact`)\r\n      .setColor(0x4CAF50)\r\n      .setDescription(fact.fact)\r\n      .setFooter({ text: `${fact.category} Facts` });\r\n\r\n    // Track entertainment stats\r\n    try {\r\n      updateEntertainmentStats(interaction.user.id, 'factsLearned');\r\n    } catch (error) {\r\n      console.warn('Failed to update fact stats:', error.message);\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_fact:${category}:${interaction.user.id}`).setLabel('üß† Another Fact').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_share:${fact.id}:${interaction.user.id}`).setLabel('üì§ Share Fact').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'quote': {\r\n    const category = interaction.options.getString('category') || 'inspirational';\r\n    const quote = getRandomQuote(category);\r\n\r\n    if (!quote || !quote.quote || !quote.author) {\r\n      throw new CommandError('Failed to retrieve quote. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üí¨ ${category.charAt(0).toUpperCase() + category.slice(1)} Quote`)\r\n      .setColor(0xE91E63)\r\n      .addFields(\r\n        { name: 'Quote', value: `\"${quote.quote}\"`, inline: false },\r\n        { name: 'Author', value: quote.author, inline: true },\r\n        { name: 'Category', value: category, inline: true }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_quote:${category}:${interaction.user.id}`).setLabel('üí¨ Another Quote').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_share:${quote.id}:${interaction.user.id}`).setLabel('üì§ Share Quote').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case '8ball': {\r\n    const question = interaction.options.getString('question');\r\n\r\n    if (!question || question.trim().length === 0) {\r\n      throw new CommandError('8-ball question cannot be empty.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (question.length > 200) {\r\n      throw new CommandError('8-ball question is too long. Maximum 200 characters allowed.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const result = magic8Ball(question);\r\n\r\n    if (!result || !result.answer) {\r\n      throw new CommandError('Failed to get 8-ball response. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üîÆ Magic 8-Ball')\r\n      .setColor(0x9C27B0)\r\n      .addFields(\r\n        { name: 'Question', value: question, inline: false },\r\n        { name: 'Answer', value: result.answer, inline: false }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_8ball:${interaction.user.id}`).setLabel('üîÆ Ask Again').setStyle(ButtonStyle.Primary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'name': {\r\n    const type = interaction.options.getString('type') || 'superhero';\r\n    const name = generateFunName(type);\r\n\r\n    if (!name || !name.name) {\r\n      throw new CommandError('Failed to generate fun name. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üé≠ ${type.charAt(0).toUpperCase() + type.slice(1)} Name Generator`)\r\n      .setColor(0xFF5722)\r\n      .setDescription(`**Your ${type} name:** ${name.name}`)\r\n      .addFields({\r\n        name: 'Type',\r\n        value: type,\r\n        inline: true\r\n      });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_name:${type}:${interaction.user.id}`).setLabel('üé≠ Another Name').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_name_random:${interaction.user.id}`).setLabel('üé≤ Random Type').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'challenge': {\r\n    const type = interaction.options.getString('type') || 'daily';\r\n    const challenge = createFunChallenge(type);\r\n\r\n    if (!challenge || !challenge.challenge) {\r\n      throw new CommandError('Failed to generate challenge. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üéØ ${type.charAt(0).toUpperCase() + type.slice(1)} Challenge`)\r\n      .setColor(0xFFC107)\r\n      .setDescription(challenge.challenge)\r\n      .addFields({\r\n        name: 'Reward',\r\n        value: challenge.reward,\r\n        inline: false\r\n      });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_challenge:${type}:${interaction.user.id}`).setLabel('üéØ Accept Challenge').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_challenge_new:${type}:${interaction.user.id}`).setLabel('üîÑ New Challenge').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  \n    break;\n    }\n    case 'leaderboard': {\r\n    const category = interaction.options.getString('category') || 'jokes';\r\n\r\n    const leaderboard = getFunLeaderboard(category, 10);\r\n\r\n    if (!Array.isArray(leaderboard)) {\r\n      throw new CommandError('Failed to retrieve leaderboard data.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    if (leaderboard.length === 0) {\r\n      return await safeInteractionReply(interaction, {\r\n        content: 'üèÜ No data available for this leaderboard yet. Be the first to participate!',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üèÜ Fun Leaderboard - ${category.charAt(0).toUpperCase() + category.slice(1)}`)\r\n      .setColor(0xFFD700);\r\n\r\n    leaderboard.forEach((entry, index) => {\r\n      if (!entry || typeof entry.score !== 'number') {\r\n        console.warn('Invalid leaderboard entry:', entry);\r\n        return;\r\n      }\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank}`,\r\n        value: `**${entry.score}** ${category}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed] });\r\n  \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":84,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":84,"endColumn":27,"fix":{"range":[4483,4491],"text":"0xFF_D7_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":91,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":91,"endColumn":8,"fix":{"range":[4754,4754],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":92,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":92,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[4780,4840],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":102,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":102,"endColumn":6,"fix":{"range":[5312,5312],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":122,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":122,"endColumn":27,"fix":{"range":[6132,6140],"text":"0x99_32_CC"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":133,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":133,"endColumn":8,"fix":{"range":[6431,6431],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":134,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":134,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[6457,6518],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":144,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":144,"endColumn":3,"fix":{"range":[6984,6986],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":144,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":144,"endColumn":4,"fix":{"range":[6987,6987],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":145,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":145,"endColumn":5,"fix":{"range":[7018,7022],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":146,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":146,"endColumn":5,"fix":{"range":[7099,7103],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":148,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":148,"endColumn":5,"fix":{"range":[7144,7148],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":149,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":149,"endColumn":7,"fix":{"range":[7182,7188],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":150,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":150,"endColumn":5,"fix":{"range":[7284,7288],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":5,"fix":{"range":[7293,7297],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":153,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":153,"endColumn":7,"fix":{"range":[7331,7337],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":154,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":154,"endColumn":7,"fix":{"range":[7421,7427],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":154,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":154,"endColumn":25,"fix":{"range":[7437,7445],"text":"0xFF_8C_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":155,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":155,"endColumn":7,"fix":{"range":[7448,7454],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":156,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":156,"endColumn":7,"fix":{"range":[7486,7492],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":158,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":158,"endColumn":5,"fix":{"range":[7559,7563],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":159,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":159,"endColumn":5,"fix":{"range":[7593,7597],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":160,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":160,"endColumn":7,"fix":{"range":[7604,7610],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":161,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":161,"endColumn":5,"fix":{"range":[7678,7682],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":161,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":161,"endColumn":6,"fix":{"range":[7683,7683],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":162,"endColumn":7,"fix":{"range":[7701,7707],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":162,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":162,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[7707,7769],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":163,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":163,"endColumn":5,"fix":{"range":[7771,7775],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":165,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":165,"endColumn":5,"fix":{"range":[7780,7784],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[7835,7841],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":167,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":167,"endColumn":7,"fix":{"range":[7996,8002],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":168,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":168,"endColumn":5,"fix":{"range":[8152,8156],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":5,"fix":{"range":[8162,8166],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":172,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":172,"endColumn":3,"fix":{"range":[8250,8252],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":172,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":172,"endColumn":4,"fix":{"range":[8253,8253],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":173,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":173,"endColumn":5,"fix":{"range":[8282,8286],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":174,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":174,"endColumn":5,"fix":{"range":[8359,8363],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":176,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":176,"endColumn":5,"fix":{"range":[8401,8405],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":177,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":177,"endColumn":7,"fix":{"range":[8433,8439],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":178,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":178,"endColumn":5,"fix":{"range":[8537,8541],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":180,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":180,"endColumn":5,"fix":{"range":[8546,8550],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[8584,8590],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":182,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":182,"endColumn":7,"fix":{"range":[8707,8713],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":182,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":182,"endColumn":25,"fix":{"range":[8723,8731],"text":"0x4C_AF_50"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":183,"endColumn":7,"fix":{"range":[8734,8740],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":184,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":184,"endColumn":7,"fix":{"range":[8768,8774],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":186,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":186,"endColumn":5,"fix":{"range":[8825,8829],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":187,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":187,"endColumn":5,"fix":{"range":[8859,8863],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":188,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":188,"endColumn":7,"fix":{"range":[8870,8876],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":189,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":189,"endColumn":5,"fix":{"range":[8940,8944],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":189,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":189,"endColumn":6,"fix":{"range":[8945,8945],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":190,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":190,"endColumn":7,"fix":{"range":[8963,8969],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":190,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":190,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[8969,9029],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":191,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":191,"endColumn":5,"fix":{"range":[9031,9035],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":193,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":193,"endColumn":5,"fix":{"range":[9040,9044],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":194,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":194,"endColumn":7,"fix":{"range":[9095,9101],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":195,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":195,"endColumn":7,"fix":{"range":[9240,9246],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":196,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":196,"endColumn":5,"fix":{"range":[9384,9388],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":198,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":198,"endColumn":5,"fix":{"range":[9394,9398],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":200,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":200,"endColumn":3,"fix":{"range":[9482,9484],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":200,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":200,"endColumn":4,"fix":{"range":[9485,9485],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":201,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":201,"endColumn":5,"fix":{"range":[9515,9519],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":202,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":202,"endColumn":5,"fix":{"range":[9599,9603],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":204,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":204,"endColumn":5,"fix":{"range":[9646,9650],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":205,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":205,"endColumn":7,"fix":{"range":[9698,9704],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":206,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":206,"endColumn":5,"fix":{"range":[9799,9803],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":208,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":208,"endColumn":5,"fix":{"range":[9808,9812],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":209,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":209,"endColumn":7,"fix":{"range":[9846,9852],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":210,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":210,"endColumn":7,"fix":{"range":[9931,9937],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":210,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":210,"endColumn":25,"fix":{"range":[9947,9955],"text":"0xE9_1E_63"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":211,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":211,"endColumn":7,"fix":{"range":[9958,9964],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":212,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":212,"endColumn":9,"fix":{"range":[9977,9985],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":213,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":213,"endColumn":9,"fix":{"range":[10047,10055],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":214,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":214,"endColumn":9,"fix":{"range":[10111,10119],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":215,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":215,"endColumn":7,"fix":{"range":[10172,10178],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":217,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":217,"endColumn":5,"fix":{"range":[10184,10188],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":218,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":218,"endColumn":7,"fix":{"range":[10239,10245],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":219,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":219,"endColumn":7,"fix":{"range":[10386,10392],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":220,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":220,"endColumn":5,"fix":{"range":[10532,10536],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":222,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":222,"endColumn":5,"fix":{"range":[10542,10546],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":224,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":224,"endColumn":3,"fix":{"range":[10630,10632],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":224,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":224,"endColumn":4,"fix":{"range":[10633,10633],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":225,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":225,"endColumn":5,"fix":{"range":[10663,10667],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":227,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":227,"endColumn":5,"fix":{"range":[10730,10734],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":228,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":228,"endColumn":7,"fix":{"range":[10784,10790],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":229,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":229,"endColumn":5,"fix":{"range":[10871,10875],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":231,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":231,"endColumn":5,"fix":{"range":[10880,10884],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":232,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":232,"endColumn":7,"fix":{"range":[10914,10920],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":233,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":233,"endColumn":5,"fix":{"range":[11029,11033],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":235,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":235,"endColumn":5,"fix":{"range":[11038,11042],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":237,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":237,"endColumn":5,"fix":{"range":[11082,11086],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":238,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":238,"endColumn":7,"fix":{"range":[11120,11126],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":239,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":239,"endColumn":5,"fix":{"range":[11226,11230],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":241,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":241,"endColumn":5,"fix":{"range":[11235,11239],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":242,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":242,"endColumn":7,"fix":{"range":[11273,11279],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":243,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":243,"endColumn":7,"fix":{"range":[11309,11315],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":243,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":243,"endColumn":25,"fix":{"range":[11325,11333],"text":"0x9C_27_B0"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":244,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":244,"endColumn":7,"fix":{"range":[11336,11342],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":245,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":245,"endColumn":9,"fix":{"range":[11355,11363],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":246,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":246,"endColumn":9,"fix":{"range":[11418,11426],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":247,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":247,"endColumn":7,"fix":{"range":[11483,11489],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":249,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":249,"endColumn":5,"fix":{"range":[11495,11499],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":250,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":250,"endColumn":7,"fix":{"range":[11550,11556],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":251,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":251,"endColumn":5,"fix":{"range":[11680,11684],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":253,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":253,"endColumn":5,"fix":{"range":[11690,11694],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":255,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":255,"endColumn":3,"fix":{"range":[11778,11780],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":255,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":255,"endColumn":4,"fix":{"range":[11781,11781],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":256,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":256,"endColumn":5,"fix":{"range":[11810,11814],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":257,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":257,"endColumn":5,"fix":{"range":[11882,11886],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":259,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":259,"endColumn":5,"fix":{"range":[11925,11929],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":260,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":260,"endColumn":7,"fix":{"range":[11957,11963],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":261,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":261,"endColumn":5,"fix":{"range":[12061,12065],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":263,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":263,"endColumn":5,"fix":{"range":[12070,12074],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":264,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":264,"endColumn":7,"fix":{"range":[12108,12114],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":265,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":265,"endColumn":7,"fix":{"range":[12194,12200],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":265,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":265,"endColumn":25,"fix":{"range":[12210,12218],"text":"0xFF_57_22"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":266,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":266,"endColumn":7,"fix":{"range":[12221,12227],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":267,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":267,"endColumn":7,"fix":{"range":[12283,12289],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":268,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":268,"endColumn":9,"fix":{"range":[12303,12311],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":269,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":269,"endColumn":9,"fix":{"range":[12326,12334],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":270,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":270,"endColumn":9,"fix":{"range":[12348,12356],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":271,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":271,"endColumn":7,"fix":{"range":[12370,12376],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":273,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":273,"endColumn":5,"fix":{"range":[12383,12387],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":274,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":274,"endColumn":7,"fix":{"range":[12438,12444],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":275,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":275,"endColumn":7,"fix":{"range":[12579,12585],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":276,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":276,"endColumn":5,"fix":{"range":[12719,12723],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":278,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":278,"endColumn":5,"fix":{"range":[12729,12733],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":280,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":280,"endColumn":3,"fix":{"range":[12817,12819],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":280,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":280,"endColumn":4,"fix":{"range":[12820,12820],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":281,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":281,"endColumn":5,"fix":{"range":[12854,12858],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":282,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":282,"endColumn":5,"fix":{"range":[12922,12926],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":284,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":284,"endColumn":5,"fix":{"range":[12973,12977],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":285,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":285,"endColumn":7,"fix":{"range":[13020,13026],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":286,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":286,"endColumn":5,"fix":{"range":[13125,13129],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":288,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":288,"endColumn":5,"fix":{"range":[13134,13138],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":289,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":289,"endColumn":7,"fix":{"range":[13172,13178],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":290,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":290,"endColumn":7,"fix":{"range":[13253,13259],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":290,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":290,"endColumn":25,"fix":{"range":[13269,13277],"text":"0xFF_C1_07"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":291,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":291,"endColumn":7,"fix":{"range":[13280,13286],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":292,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":292,"endColumn":7,"fix":{"range":[13324,13330],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":293,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":293,"endColumn":9,"fix":{"range":[13344,13352],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":294,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":294,"endColumn":9,"fix":{"range":[13369,13377],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":295,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":295,"endColumn":9,"fix":{"range":[13403,13411],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":296,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":296,"endColumn":7,"fix":{"range":[13426,13432],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":298,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":298,"endColumn":5,"fix":{"range":[13439,13443],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":299,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":299,"endColumn":7,"fix":{"range":[13494,13500],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":300,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":300,"endColumn":7,"fix":{"range":[13644,13650],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":301,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":301,"endColumn":5,"fix":{"range":[13796,13800],"text":"      "}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (346). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":346,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":303,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":303,"endColumn":5,"fix":{"range":[13806,13810],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":305,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":305,"endColumn":3,"fix":{"range":[13894,13896],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":305,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":305,"endColumn":4,"fix":{"range":[13897,13897],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":306,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":306,"endColumn":5,"fix":{"range":[13933,13937],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":308,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":308,"endColumn":5,"fix":{"range":[14011,14015],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":310,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":310,"endColumn":5,"fix":{"range":[14071,14075],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":311,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":311,"endColumn":7,"fix":{"range":[14111,14117],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":312,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":312,"endColumn":5,"fix":{"range":[14205,14209],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":314,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":314,"endColumn":5,"fix":{"range":[14214,14218],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":315,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":315,"endColumn":7,"fix":{"range":[14251,14257],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":316,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":316,"endColumn":9,"fix":{"range":[14307,14315],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":317,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":317,"endColumn":9,"fix":{"range":[14404,14412],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":318,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":318,"endColumn":7,"fix":{"range":[14443,14449],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":319,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":319,"endColumn":5,"fix":{"range":[14454,14458],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":321,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":321,"endColumn":5,"fix":{"range":[14463,14467],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":322,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":322,"endColumn":7,"fix":{"range":[14501,14507],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":323,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":323,"endColumn":7,"fix":{"range":[14598,14604],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":323,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":323,"endColumn":25,"fix":{"range":[14614,14622],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":325,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":325,"endColumn":5,"fix":{"range":[14628,14632],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":325,"column":17,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":325,"endColumn":24,"fix":{"range":[14632,15084],"text":"for (const [index, entry] of leaderboard.entries()) {\r\n      if (!entry || typeof entry.score !== 'number') {\r\n        console.warn('Invalid leaderboard entry:', entry);\r\n        continue;\r\n      }\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank}`,\r\n        value: `**${entry.score}** ${category}`,\r\n        inline: true\r\n      });\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":326,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":326,"endColumn":7,"fix":{"range":[14673,14679],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":327,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":327,"endColumn":9,"fix":{"range":[14729,14737],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":327,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":327,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[14737,14787],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":328,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":328,"endColumn":9,"fix":{"range":[14789,14797],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":329,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":329,"endColumn":7,"fix":{"range":[14806,14812],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":330,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":330,"endColumn":7,"fix":{"range":[14815,14821],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":331,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":331,"endColumn":7,"fix":{"range":[14846,14852],"text":"        "}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Do not nest ternary expressions.","line":331,"column":61,"nodeType":"ConditionalExpression","messageId":"too-deep","endLine":331,"endColumn":85},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":332,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":332,"endColumn":7,"fix":{"range":[14933,14939],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":333,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":333,"endColumn":9,"fix":{"range":[14958,14966],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":334,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":334,"endColumn":9,"fix":{"range":[14994,15002],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":335,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":335,"endColumn":9,"fix":{"range":[15044,15052],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":336,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":336,"endColumn":7,"fix":{"range":[15066,15072],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":337,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":337,"endColumn":5,"fix":{"range":[15077,15081],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":339,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":339,"endColumn":5,"fix":{"range":[15088,15092],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":340,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":340,"endColumn":3,"fix":{"range":[15155,15157],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":341,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":341,"endColumn":4,"fix":{"range":[15163,15163],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":342,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":342,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15185,15241],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":187,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":181,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\nimport { safeInteractionReply, safeInteractionUpdate } from '../interactionHandlers.js';\r\nimport {\r\n  getRandomJoke,\r\n  generateStory,\r\n  getRiddle,\r\n  getFunFact,\r\n  getRandomQuote,\r\n  magic8Ball,\r\n  generateFunName,\r\n  getPersonalityQuestion,\r\n  updateEntertainmentStats,\r\n  createFunChallenge,\r\n  getFunLeaderboard\r\n} from '../entertainment.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('fun')\r\n  .setDescription('Entertainment and fun commands - jokes, stories, riddles, and more')\r\n  .addSubcommand(sub => sub.setName('joke').setDescription('Get a random joke').addStringOption(opt => opt.setName('category').setDescription('Joke category').addChoices(\r\n    { name: 'General', value: 'general' },\r\n    { name: 'Programming', value: 'programming' },\r\n    { name: 'Dad Jokes', value: 'dad' },\r\n    { name: 'Math', value: 'math' },\r\n    { name: 'Science', value: 'science' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('story').setDescription('Generate a creative story').addStringOption(opt => opt.setName('prompt').setDescription('Story prompt').setRequired(true)).addStringOption(opt => opt.setName('genre').setDescription('Story genre').addChoices(\r\n    { name: 'Fantasy', value: 'fantasy' },\r\n    { name: 'Adventure', value: 'adventure' },\r\n    { name: 'Mystery', value: 'mystery' },\r\n    { name: 'Sci-Fi', value: 'sciFi' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('riddle').setDescription('Get a riddle to solve').addStringOption(opt => opt.setName('difficulty').setDescription('Riddle difficulty').addChoices(\r\n    { name: 'Easy', value: 'easy' },\r\n    { name: 'Medium', value: 'medium' },\r\n    { name: 'Hard', value: 'hard' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('fact').setDescription('Get a fun fact').addStringOption(opt => opt.setName('category').setDescription('Fact category').addChoices(\r\n    { name: 'Random', value: 'random' },\r\n    { name: 'Animals', value: 'animals' },\r\n    { name: 'Space', value: 'space' },\r\n    { name: 'Science', value: 'science' },\r\n    { name: 'History', value: 'history' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('quote').setDescription('Get an inspirational quote').addStringOption(opt => opt.setName('category').setDescription('Quote category').addChoices(\r\n    { name: 'Inspirational', value: 'inspirational' },\r\n    { name: 'Motivational', value: 'motivational' },\r\n    { name: 'Wisdom', value: 'wisdom' },\r\n    { name: 'Humor', value: 'humor' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('8ball').setDescription('Ask the magic 8-ball').addStringOption(opt => opt.setName('question').setDescription('Your question').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('name').setDescription('Generate a fun name').addStringOption(opt => opt.setName('type').setDescription('Name type').addChoices(\r\n    { name: 'Superhero', value: 'superhero' },\r\n    { name: 'Villain', value: 'villain' },\r\n    { name: 'Fantasy', value: 'fantasy' },\r\n    { name: 'Sci-Fi', value: 'sciFi' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('challenge').setDescription('Get a fun challenge').addStringOption(opt => opt.setName('type').setDescription('Challenge type').addChoices(\r\n    { name: 'Daily', value: 'daily' },\r\n    { name: 'Weekly', value: 'weekly' },\r\n    { name: 'Monthly', value: 'monthly' }\r\n  ).setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('leaderboard').setDescription('View fun leaderboards').addStringOption(opt => opt.setName('category').setDescription('Leaderboard category').addChoices(\r\n    { name: 'Jokes Told', value: 'jokes' },\r\n    { name: 'Riddles Solved', value: 'riddles' },\r\n    { name: 'Stories Generated', value: 'stories' }\r\n  ).setRequired(false)));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    const sub = interaction.options.getSubcommand();\r\n\r\n    if (sub === 'joke') {\r\n      const category = interaction.options.getString('category') || 'general';\r\n      const joke = getRandomJoke(category);\r\n\r\n      if (!joke || !joke.joke) {\r\n        throw new CommandError('Failed to retrieve joke. Please try again.', 'ENTERTAINMENT_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üòÇ Random Joke')\r\n        .setColor(0xFFD700)\r\n        .setDescription(joke.joke)\r\n        .setFooter({ text: `${category.charAt(0).toUpperCase() + category.slice(1)} Jokes` });\r\n\r\n      // Track entertainment stats\r\n      try {\r\n        updateEntertainmentStats(interaction.user.id, 'jokesHeard');\r\n      } catch (error) {\r\n        console.warn('Failed to update joke stats:', error.message);\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_joke:${category}:${interaction.user.id}`).setLabel('üòÇ Another Joke').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_rate:${joke.id}:5:${interaction.user.id}`).setLabel('‚≠ê Rate 5 Stars').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n    } else if (sub === 'story') {\r\n      const prompt = interaction.options.getString('prompt');\r\n      const genre = interaction.options.getString('genre') || 'fantasy';\r\n\r\n      if (!prompt || prompt.trim().length === 0) {\r\n        throw new CommandError('Story prompt cannot be empty.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (prompt.length > 500) {\r\n        throw new CommandError('Story prompt is too long. Maximum 500 characters allowed.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const story = generateStory(prompt, genre);\r\n\r\n      if (!story || !story.story) {\r\n        throw new CommandError('Failed to generate story. Please try again.', 'ENTERTAINMENT_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üìñ ${genre.charAt(0).toUpperCase() + genre.slice(1)} Story`)\r\n        .setColor(0x9932CC)\r\n        .setDescription(story.story)\r\n        .addFields({\r\n          name: 'üéØ Prompt',\r\n          value: prompt,\r\n          inline: false\r\n        });\r\n\r\n      // Track entertainment stats\r\n      try {\r\n        updateEntertainmentStats(interaction.user.id, 'storiesGenerated');\r\n      } catch (error) {\r\n        console.warn('Failed to update story stats:', error.message);\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_story:${genre}:${interaction.user.id}`).setLabel('üìñ Another Story').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_share:${story.id}:${interaction.user.id}`).setLabel('üì§ Share Story').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'riddle') {\r\n    const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n    const riddle = getRiddle(difficulty);\r\n\r\n    if (!riddle || !riddle.riddle) {\r\n      throw new CommandError('Failed to retrieve riddle. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üß© ${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} Riddle`)\r\n      .setColor(0xFF8C00)\r\n      .setDescription(riddle.riddle)\r\n      .setFooter({ text: 'Think hard and reply with your answer!' });\r\n\r\n    // Track entertainment stats\r\n    try {\r\n      updateEntertainmentStats(interaction.user.id, 'riddlesAttempted');\r\n    } catch (error) {\r\n      console.warn('Failed to update riddle stats:', error.message);\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_riddle:${difficulty}:${riddle.id}:${interaction.user.id}`).setLabel('üí° Show Answer').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_riddle_new:${difficulty}:${interaction.user.id}`).setLabel('üß© Another Riddle').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'fact') {\r\n    const category = interaction.options.getString('category') || 'random';\r\n    const fact = getFunFact(category);\r\n\r\n    if (!fact || !fact.fact) {\r\n      throw new CommandError('Failed to retrieve fun fact. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üß† ${category === 'random' ? 'Random' : category.charAt(0).toUpperCase() + category.slice(1)} Fun Fact`)\r\n      .setColor(0x4CAF50)\r\n      .setDescription(fact.fact)\r\n      .setFooter({ text: `${fact.category} Facts` });\r\n\r\n    // Track entertainment stats\r\n    try {\r\n      updateEntertainmentStats(interaction.user.id, 'factsLearned');\r\n    } catch (error) {\r\n      console.warn('Failed to update fact stats:', error.message);\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_fact:${category}:${interaction.user.id}`).setLabel('üß† Another Fact').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_share:${fact.id}:${interaction.user.id}`).setLabel('üì§ Share Fact').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'quote') {\r\n    const category = interaction.options.getString('category') || 'inspirational';\r\n    const quote = getRandomQuote(category);\r\n\r\n    if (!quote || !quote.quote || !quote.author) {\r\n      throw new CommandError('Failed to retrieve quote. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üí¨ ${category.charAt(0).toUpperCase() + category.slice(1)} Quote`)\r\n      .setColor(0xE91E63)\r\n      .addFields(\r\n        { name: 'Quote', value: `\"${quote.quote}\"`, inline: false },\r\n        { name: 'Author', value: quote.author, inline: true },\r\n        { name: 'Category', value: category, inline: true }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_quote:${category}:${interaction.user.id}`).setLabel('üí¨ Another Quote').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_share:${quote.id}:${interaction.user.id}`).setLabel('üì§ Share Quote').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === '8ball') {\r\n    const question = interaction.options.getString('question');\r\n\r\n    if (!question || question.trim().length === 0) {\r\n      throw new CommandError('8-ball question cannot be empty.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (question.length > 200) {\r\n      throw new CommandError('8-ball question is too long. Maximum 200 characters allowed.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const result = magic8Ball(question);\r\n\r\n    if (!result || !result.answer) {\r\n      throw new CommandError('Failed to get 8-ball response. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üîÆ Magic 8-Ball')\r\n      .setColor(0x9C27B0)\r\n      .addFields(\r\n        { name: 'Question', value: question, inline: false },\r\n        { name: 'Answer', value: result.answer, inline: false }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_8ball:${interaction.user.id}`).setLabel('üîÆ Ask Again').setStyle(ButtonStyle.Primary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'name') {\r\n    const type = interaction.options.getString('type') || 'superhero';\r\n    const name = generateFunName(type);\r\n\r\n    if (!name || !name.name) {\r\n      throw new CommandError('Failed to generate fun name. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üé≠ ${type.charAt(0).toUpperCase() + type.slice(1)} Name Generator`)\r\n      .setColor(0xFF5722)\r\n      .setDescription(`**Your ${type} name:** ${name.name}`)\r\n      .addFields({\r\n        name: 'Type',\r\n        value: type,\r\n        inline: true\r\n      });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_name:${type}:${interaction.user.id}`).setLabel('üé≠ Another Name').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_name_random:${interaction.user.id}`).setLabel('üé≤ Random Type').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'challenge') {\r\n    const type = interaction.options.getString('type') || 'daily';\r\n    const challenge = createFunChallenge(type);\r\n\r\n    if (!challenge || !challenge.challenge) {\r\n      throw new CommandError('Failed to generate challenge. Please try again.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üéØ ${type.charAt(0).toUpperCase() + type.slice(1)} Challenge`)\r\n      .setColor(0xFFC107)\r\n      .setDescription(challenge.challenge)\r\n      .addFields({\r\n        name: 'Reward',\r\n        value: challenge.reward,\r\n        inline: false\r\n      });\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`fun_challenge:${type}:${interaction.user.id}`).setLabel('üéØ Accept Challenge').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`fun_challenge_new:${type}:${interaction.user.id}`).setLabel('üîÑ New Challenge').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'leaderboard') {\r\n    const category = interaction.options.getString('category') || 'jokes';\r\n\r\n    const leaderboard = getFunLeaderboard(category, 10);\r\n\r\n    if (!Array.isArray(leaderboard)) {\r\n      throw new CommandError('Failed to retrieve leaderboard data.', 'ENTERTAINMENT_ERROR');\r\n    }\r\n\r\n    if (leaderboard.length === 0) {\r\n      return await safeInteractionReply(interaction, {\r\n        content: 'üèÜ No data available for this leaderboard yet. Be the first to participate!',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üèÜ Fun Leaderboard - ${category.charAt(0).toUpperCase() + category.slice(1)}`)\r\n      .setColor(0xFFD700);\r\n\r\n    leaderboard.forEach((entry, index) => {\r\n      if (!entry || typeof entry.score !== 'number') {\r\n        console.warn('Invalid leaderboard entry:', entry);\r\n        return;\r\n      }\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank}`,\r\n        value: `**${entry.score}** ${category}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await safeInteractionReply(interaction, { embeds: [embed] });\r\n  }\r\n  } catch (error) {\r\n    console.error('Error in fun command execution:', error);\r\n    await handleCommandError(interaction, error instanceof CommandError ? error :\r\n      new CommandError(error.message || 'An error occurred while processing the fun command.', 'UNKNOWN_ERROR'));\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\guess.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":172,"fix":{"range":[171,171],"text":"\n"}},{"ruleId":"import/namespace","severity":2,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":5,"column":61,"nodeType":"Literal","endLine":5,"endColumn":88},{"ruleId":"import/no-deprecated","severity":1,"message":"Parse errors in imported module '../interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":5,"column":61,"nodeType":"Literal","endLine":5,"endColumn":88},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":31,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":31,"endColumn":4,"fix":{"range":[1405,1408],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":32,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":32,"endColumn":6,"fix":{"range":[1415,1420],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":33,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":33,"endColumn":6,"fix":{"range":[1434,1439],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":34,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":34,"endColumn":6,"fix":{"range":[1455,1460],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":35,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":35,"endColumn":6,"fix":{"range":[1480,1485],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":37,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":37,"endColumn":6,"fix":{"range":[1564,1569],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":38,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":38,"endColumn":6,"fix":{"range":[1599,1604],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":39,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":39,"endColumn":8,"fix":{"range":[1627,1634],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":39,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":39,"endColumn":20,"fix":{"range":[1646,1707],"text":" {\r\n         min = 1; max = 50; attempts = 10;\r\n         break;\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":40,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":40,"endColumn":10,"fix":{"range":[1648,1657],"text":"        "}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":40,"column":29,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":40,"endColumn":43},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":41,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":41,"endColumn":10,"fix":{"range":[1692,1701],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":42,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":42,"endColumn":8,"fix":{"range":[1709,1716],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":42,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":42,"endColumn":22,"fix":{"range":[1730,1791],"text":" {\r\n         min = 1; max = 100; attempts = 8;\r\n         break;\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":43,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":43,"endColumn":10,"fix":{"range":[1732,1741],"text":"        "}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":43,"column":30,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":43,"endColumn":43},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":10,"fix":{"range":[1776,1785],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":45,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":45,"endColumn":8,"fix":{"range":[1793,1800],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":45,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":45,"endColumn":20,"fix":{"range":[1812,1873],"text":" {\r\n         min = 1; max = 200; attempts = 6;\r\n         break;\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":46,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":46,"endColumn":10,"fix":{"range":[1814,1823],"text":"        "}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":46,"column":30,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":46,"endColumn":43},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":47,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":47,"endColumn":10,"fix":{"range":[1858,1867],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":48,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":48,"endColumn":8,"fix":{"range":[1875,1882],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":48,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":48,"endColumn":22,"fix":{"range":[1896,1957],"text":" {\r\n         min = 1; max = 500; attempts = 5;\r\n         break;\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":49,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":49,"endColumn":10,"fix":{"range":[1898,1907],"text":"        "}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":49,"column":30,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":49,"endColumn":43},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":50,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":50,"endColumn":10,"fix":{"range":[1942,1951],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":51,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":51,"endColumn":8,"fix":{"range":[1959,1966],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":51,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":51,"endColumn":22,"fix":{"range":[1980,2042],"text":" {\r\n         min = 1; max = 1000; attempts = 4;\r\n         break;\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":52,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":52,"endColumn":10,"fix":{"range":[1982,1991],"text":"        "}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":52,"column":31,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":52,"endColumn":44},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":53,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":53,"endColumn":10,"fix":{"range":[2027,2036],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":8,"fix":{"range":[2044,2051],"text":"      "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":54,"column":8,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":54,"endColumn":16,"fix":{"range":[2059,2142],"text":" {\r\n         throw new CommandError('Invalid difficulty level.', 'INVALID_ARGUMENT');\n       }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":55,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":55,"endColumn":10,"fix":{"range":[2061,2070],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":56,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":56,"endColumn":6,"fix":{"range":[2144,2149],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":58,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":58,"endColumn":6,"fix":{"range":[2154,2159],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":59,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":59,"endColumn":6,"fix":{"range":[2201,2206],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":60,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":60,"endColumn":6,"fix":{"range":[2271,2276],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":62,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":62,"endColumn":6,"fix":{"range":[2343,2348],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":63,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":63,"endColumn":8,"fix":{"range":[2397,2404],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":64,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":64,"endColumn":10,"fix":{"range":[2453,2462],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":65,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":65,"endColumn":8,"fix":{"range":[2569,2576],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":66,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":66,"endColumn":8,"fix":{"range":[2579,2586],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":10,"fix":{"range":[2617,2626],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":68,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":68,"endColumn":8,"fix":{"range":[2709,2716],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":69,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":69,"endColumn":8,"fix":{"range":[2719,2726],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":69,"column":36,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":69,"endColumn":41,"fix":{"range":[2754,2759],"text":"10_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":70,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":70,"endColumn":10,"fix":{"range":[2764,2773],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":71,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":71,"endColumn":8,"fix":{"range":[2863,2870],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":72,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":72,"endColumn":8,"fix":{"range":[2873,2880],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":72,"column":41,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":72,"endColumn":48,"fix":{"range":[2913,2920],"text":"1_000_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":73,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":73,"endColumn":10,"fix":{"range":[2925,2934],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":74,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":74,"endColumn":8,"fix":{"range":[3028,3035],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":75,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":75,"endColumn":8,"fix":{"range":[3038,3045],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":76,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":76,"endColumn":8,"fix":{"range":[3063,3070],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":77,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":77,"endColumn":8,"fix":{"range":[3088,3095],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":78,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":78,"endColumn":8,"fix":{"range":[3143,3150],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":79,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":79,"endColumn":6,"fix":{"range":[3237,3242],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":81,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":81,"endColumn":6,"fix":{"range":[3247,3252],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":82,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":82,"endColumn":6,"fix":{"range":[3279,3284],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":83,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":83,"endColumn":6,"fix":{"range":[3357,3362],"text":"    "}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":83,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":83,"endColumn":83,"fix":{"range":[3427,3438],"text":"slice(2, 11"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":85,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":85,"endColumn":6,"fix":{"range":[3446,3451],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":86,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":86,"endColumn":8,"fix":{"range":[3472,3479],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":87,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":87,"endColumn":8,"fix":{"range":[3492,3499],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":88,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":88,"endColumn":8,"fix":{"range":[3514,3521],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":89,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":89,"endColumn":8,"fix":{"range":[3527,3534],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":90,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":90,"endColumn":8,"fix":{"range":[3540,3547],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":91,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":91,"endColumn":8,"fix":{"range":[3558,3565],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":92,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":92,"endColumn":8,"fix":{"range":[3583,3590],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":93,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":93,"endColumn":8,"fix":{"range":[3604,3611],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":94,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":94,"endColumn":8,"fix":{"range":[3630,3637],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":95,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":95,"endColumn":8,"fix":{"range":[3650,3657],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":96,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":96,"endColumn":6,"fix":{"range":[3680,3685],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":98,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":98,"endColumn":6,"fix":{"range":[3691,3696],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":99,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":99,"endColumn":6,"fix":{"range":[3717,3722],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":101,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":101,"endColumn":6,"fix":{"range":[3760,3765],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":102,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":102,"endColumn":4,"fix":{"range":[3813,3816],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":102,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":102,"endColumn":5,"fix":{"range":[3817,3817],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":103,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":103,"endColumn":6,"fix":{"range":[3835,3840],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":104,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":104,"endColumn":4,"fix":{"range":[3887,3890],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":108,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":108,"endColumn":4,"fix":{"range":[3956,3959],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":6,"fix":{"range":[3966,3971],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":111,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":111,"endColumn":6,"fix":{"range":[4039,4044],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":112,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":112,"endColumn":6,"fix":{"range":[4077,4082],"text":"    "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":112,"column":21,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":112,"endColumn":33,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[4020,4109],"text":", id } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":114,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":114,"endColumn":6,"fix":{"range":[4126,4131],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":115,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":115,"endColumn":8,"fix":{"range":[4164,4171],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":116,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":116,"endColumn":8,"fix":{"range":[4202,4209],"text":"      "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":116,"column":26,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":116,"endColumn":38,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[4020,4239],"text":", id } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(gameState.id, gameState);\r\n\r\n     if (attemptsUsed >= attempts) {\r\n       gameState.gameActive = false;\r\n       guessGames.delete(id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":117,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":117,"endColumn":8,"fix":{"range":[4270,4277],"text":"      "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":117,"column":53,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":117,"endColumn":72,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.startTime","property":"startTime"},"fix":{"range":[4020,4341],"text":", startTime } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(gameState.id, gameState);\r\n\r\n     if (attemptsUsed >= attempts) {\r\n       gameState.gameActive = false;\r\n       guessGames.delete(gameState.id); // Clean up completed game\r\n       const timeElapsed = Math.round((Date.now() - startTime"},"desc":"Replace `gameState.startTime` with destructured property `startTime`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":119,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":119,"endColumn":8,"fix":{"range":[4355,4362],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":120,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":120,"endColumn":10,"fix":{"range":[4400,4409],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":121,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":121,"endColumn":10,"fix":{"range":[4436,4445],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":121,"column":20,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":121,"endColumn":28,"fix":{"range":[4455,4463],"text":"0xFF_00_00"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":122,"column":1,"nodeType":"Program","messageId":"max","endLine":122,"endColumn":145},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":122,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":122,"endColumn":10,"fix":{"range":[4466,4475],"text":"        "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":122,"column":53,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":122,"endColumn":75,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.secretNumber","property":"secretNumber"},"fix":{"range":[4020,4540],"text":", secretNumber } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(gameState.id, gameState);\r\n\r\n     if (attemptsUsed >= attempts) {\r\n       gameState.gameActive = false;\r\n       guessGames.delete(gameState.id); // Clean up completed game\r\n       const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n       const loseEmbed = new EmbedBuilder()\r\n         .setTitle('‚ùå Game Over!')\r\n         .setColor(0xFF0000)\r\n         .setDescription(`The secret number was **${secretNumber"},"desc":"Replace `gameState.secretNumber` with destructured property `secretNumber`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":123,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":123,"endColumn":10,"fix":{"range":[4612,4621],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":124,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":124,"endColumn":12,"fix":{"range":[4635,4646],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":125,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":125,"endColumn":12,"fix":{"range":[4669,4680],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":126,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":126,"endColumn":12,"fix":{"range":[4808,4819],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":127,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":127,"endColumn":10,"fix":{"range":[4834,4843],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":129,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":129,"endColumn":8,"fix":{"range":[4850,4857],"text":"      "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":129,"column":8,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":133,"endColumn":9,"fix":{"range":[4857,5103],"text":"await (interaction.replied || interaction.deferred ? safeInteractionUpdate(interaction, { embeds: [loseEmbed], components: [] }) : safeInteractionReply(interaction, { embeds: [loseEmbed] }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":130,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":130,"endColumn":10,"fix":{"range":[4909,4918],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":131,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":131,"endColumn":8,"fix":{"range":[5002,5009],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":131,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":131,"endColumn":9,"fix":{"range":[5010,5010],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":132,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":132,"endColumn":10,"fix":{"range":[5019,5028],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":133,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":133,"endColumn":8,"fix":{"range":[5095,5102],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":134,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":134,"endColumn":8,"fix":{"range":[5105,5112],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":135,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":135,"endColumn":6,"fix":{"range":[5121,5126],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":137,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":137,"endColumn":6,"fix":{"range":[5131,5136],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":138,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":138,"endColumn":8,"fix":{"range":[5170,5177],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":139,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":139,"endColumn":8,"fix":{"range":[5215,5222],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":139,"column":18,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":139,"endColumn":26,"fix":{"range":[5232,5240],"text":"0x00_99_FF"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 148. Maximum allowed is 120.","line":140,"column":1,"nodeType":"Program","messageId":"max","endLine":140,"endColumn":149},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":140,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":140,"endColumn":8,"fix":{"range":[5243,5250],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":141,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":141,"endColumn":8,"fix":{"range":[5393,5400],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":142,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":142,"endColumn":10,"fix":{"range":[5414,5423],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":143,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":143,"endColumn":10,"fix":{"range":[5450,5459],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":144,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":144,"endColumn":12,"fix":{"range":[5488,5499],"text":"          "}},{"ruleId":"no-unused-vars","severity":1,"message":"'i' is defined but never used.","line":144,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":144,"endColumn":39},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":145,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":145,"endColumn":12,"fix":{"range":[5580,5591],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":146,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":146,"endColumn":10,"fix":{"range":[5610,5619],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":147,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":147,"endColumn":8,"fix":{"range":[5634,5641],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":149,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":149,"endColumn":6,"fix":{"range":[5648,5653],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":150,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":150,"endColumn":6,"fix":{"range":[5677,5682],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":151,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":151,"endColumn":8,"fix":{"range":[5733,5740],"text":"      "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":151,"column":55,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":151,"endColumn":67,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[4020,5799],"text":", id } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(gameState.id, gameState);\r\n\r\n     if (attemptsUsed >= attempts) {\r\n       gameState.gameActive = false;\r\n       guessGames.delete(gameState.id); // Clean up completed game\r\n       const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n       const loseEmbed = new EmbedBuilder()\r\n         .setTitle('‚ùå Game Over!')\r\n         .setColor(0xFF0000)\r\n         .setDescription(`The secret number was **${gameState.secretNumber}**!\\n\\nYou used all ${attempts} attempts in ${timeElapsed} seconds.`)\r\n         .addFields({\r\n           name: 'Your Guesses',\r\n           value: guesses.length > 0 ? guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n') : 'No guesses made',\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [loseEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [loseEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     const embed = new EmbedBuilder()\r\n       .setTitle('üî¢ Number Guessing Game')\r\n       .setColor(0x0099FF)\r\n       .setDescription(`I'm thinking of a number between **${min}** and **${max}**.\\n\\nYou have **${attempts - attemptsUsed}** attempts remaining.`)\r\n       .addFields({\r\n         name: 'Previous Guesses',\r\n         value: guesses.length > 0 ?\r\n           guesses.slice(-5).map((g, i) => `**${g.number}** - ${g.feedback}`).join('\\n') :\r\n           'No guesses yet',\r\n         inline: false\r\n       });\r\n\r\n     // Create guess button\r\n     const row = new ActionRowBuilder().addComponents(\r\n       new ButtonBuilder().setCustomId(`guess_modal:${id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":152,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":152,"endColumn":6,"fix":{"range":[5874,5879],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":154,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":154,"endColumn":6,"fix":{"range":[5885,5890],"text":"    "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":154,"column":6,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":158,"endColumn":7,"fix":{"range":[5890,6142],"text":"await (interaction.replied || interaction.deferred ? safeInteractionUpdate(interaction, { embeds: [embed], components: [row] }) : safeInteractionReply(interaction, { embeds: [embed], components: [row] }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":155,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":155,"endColumn":8,"fix":{"range":[5942,5949],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":156,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":156,"endColumn":6,"fix":{"range":[6032,6037],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":156,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":156,"endColumn":7,"fix":{"range":[6038,6038],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":157,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":157,"endColumn":8,"fix":{"range":[6047,6054],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":6,"fix":{"range":[6136,6141],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":4,"fix":{"range":[6144,6147],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":159,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":159,"endColumn":5,"fix":{"range":[6148,6148],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":160,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":160,"endColumn":6,"fix":{"range":[6166,6171],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":160,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":160,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6171,6218],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":161,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":161,"endColumn":6,"fix":{"range":[6220,6225],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":162,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":162,"endColumn":4,"fix":{"range":[6367,6370],"text":"  "}},{"ruleId":"no-unused-vars","severity":1,"message":"'sendGuessModal' is defined but never used.","line":165,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":30},{"ruleId":"max-statements","severity":1,"message":"Async function 'processGuess' has too many statements (35). Maximum allowed is 30.","line":178,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":273,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 21 to the 15 allowed.","line":178,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":178,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'processGuess' is defined but never used.","line":178,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":178,"endColumn":28},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":179,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":179,"endColumn":4,"fix":{"range":[7002,7005],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":180,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":180,"endColumn":6,"fix":{"range":[7012,7017],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":181,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":181,"endColumn":6,"fix":{"range":[7036,7041],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":182,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":182,"endColumn":8,"fix":{"range":[7085,7092],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":183,"endColumn":6,"fix":{"range":[7161,7166],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":185,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":185,"endColumn":6,"fix":{"range":[7171,7176],"text":"    "}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":185,"column":23,"nodeType":"Identifier","messageId":"error","endLine":185,"endColumn":31,"fix":{"range":[7193,7201],"text":"Number.parseInt"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":187,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":187,"endColumn":6,"fix":{"range":[7220,7225],"text":"    "}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.isNaN` over `isNaN`.","line":187,"column":10,"nodeType":"Identifier","messageId":"error","endLine":187,"endColumn":15,"suggestions":[{"messageId":"suggestion","fix":{"range":[7229,7234],"text":"Number.isNaN"},"data":{"description":"isNaN","property":"isNaN"},"desc":"Replace `isNaN` with `Number.isNaN`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":188,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":188,"endColumn":8,"fix":{"range":[7249,7256],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":189,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":189,"endColumn":6,"fix":{"range":[7333,7338],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":191,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":191,"endColumn":6,"fix":{"range":[7343,7348],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":192,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":192,"endColumn":8,"fix":{"range":[7409,7416],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":193,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":193,"endColumn":6,"fix":{"range":[7526,7531],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":195,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":195,"endColumn":6,"fix":{"range":[7536,7541],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":197,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":197,"endColumn":6,"fix":{"range":[7570,7575],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":198,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":198,"endColumn":6,"fix":{"range":[7590,7595],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":200,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":200,"endColumn":6,"fix":{"range":[7621,7626],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":201,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":201,"endColumn":8,"fix":{"range":[7670,7677],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":202,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":202,"endColumn":8,"fix":{"range":[7713,7720],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":8,"fix":{"range":[7739,7746],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":205,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":205,"endColumn":8,"fix":{"range":[7779,7786],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":206,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":206,"endColumn":8,"fix":{"range":[7820,7827],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":207,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":207,"endColumn":10,"fix":{"range":[7834,7843],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":208,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":208,"endColumn":8,"fix":{"range":[7901,7908],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":208,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":208,"endColumn":9,"fix":{"range":[7909,7909],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":209,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":209,"endColumn":10,"fix":{"range":[7932,7941],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":209,"column":10,"nodeType":"MemberExpression","messageId":"unexpected","endLine":209,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7941,7999],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":210,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":210,"endColumn":8,"fix":{"range":[8001,8008],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":211,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":211,"endColumn":6,"fix":{"range":[8011,8016],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":211,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":211,"endColumn":7,"fix":{"range":[8017,8017],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":212,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":212,"endColumn":8,"fix":{"range":[8065,8072],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":213,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":213,"endColumn":6,"fix":{"range":[8120,8125],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":213,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":213,"endColumn":7,"fix":{"range":[8126,8126],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":214,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":214,"endColumn":8,"fix":{"range":[8135,8142],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":215,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":215,"endColumn":6,"fix":{"range":[8190,8195],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":217,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":217,"endColumn":6,"fix":{"range":[8200,8205],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":218,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":218,"endColumn":6,"fix":{"range":[8235,8240],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":219,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":219,"endColumn":8,"fix":{"range":[8266,8273],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":220,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":220,"endColumn":8,"fix":{"range":[8292,8299],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":221,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":221,"endColumn":8,"fix":{"range":[8310,8317],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":222,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":222,"endColumn":6,"fix":{"range":[8350,8355],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":224,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":224,"endColumn":6,"fix":{"range":[8362,8367],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":225,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":225,"endColumn":8,"fix":{"range":[8385,8392],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":226,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":226,"endColumn":8,"fix":{"range":[8453,8460],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":227,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":227,"endColumn":8,"fix":{"range":[8536,8543],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":229,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":229,"endColumn":8,"fix":{"range":[8591,8598],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":230,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":230,"endColumn":8,"fix":{"range":[8622,8629],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":231,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":231,"endColumn":8,"fix":{"range":[8700,8707],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":232,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":232,"endColumn":8,"fix":{"range":[8773,8780],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":233,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":233,"endColumn":8,"fix":{"range":[8845,8852],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":234,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":234,"endColumn":8,"fix":{"range":[8916,8923],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":236,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":236,"endColumn":8,"fix":{"range":[8969,8976],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":237,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":237,"endColumn":10,"fix":{"range":[9013,9022],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":238,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":238,"endColumn":10,"fix":{"range":[9056,9065],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":238,"column":20,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":238,"endColumn":28,"fix":{"range":[9075,9083],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":239,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":239,"endColumn":10,"fix":{"range":[9086,9095],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":240,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":240,"endColumn":10,"fix":{"range":[9192,9201],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":241,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":241,"endColumn":12,"fix":{"range":[9214,9225],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":242,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":242,"endColumn":14,"fix":{"range":[9228,9241],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 156. Maximum allowed is 120.","line":243,"column":1,"nodeType":"Program","messageId":"max","endLine":243,"endColumn":157},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":243,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":243,"endColumn":14,"fix":{"range":[9265,9278],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":244,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":244,"endColumn":14,"fix":{"range":[9423,9436],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":245,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":245,"endColumn":12,"fix":{"range":[9450,9461],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":246,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":246,"endColumn":12,"fix":{"range":[9465,9476],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":247,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":247,"endColumn":14,"fix":{"range":[9479,9492],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 152. Maximum allowed is 120.","line":248,"column":1,"nodeType":"Program","messageId":"max","endLine":248,"endColumn":153},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":248,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":248,"endColumn":14,"fix":{"range":[9517,9530],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":249,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":249,"endColumn":14,"fix":{"range":[9671,9684],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":250,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":250,"endColumn":12,"fix":{"range":[9698,9709],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":251,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":251,"endColumn":10,"fix":{"range":[9712,9721],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":253,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":253,"endColumn":8,"fix":{"range":[9727,9734],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":254,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":254,"endColumn":10,"fix":{"range":[9771,9780],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":255,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":255,"endColumn":12,"fix":{"range":[9802,9813],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":256,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":256,"endColumn":12,"fix":{"range":[9840,9851],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":257,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":257,"endColumn":12,"fix":{"range":[9948,9959],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":258,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":258,"endColumn":10,"fix":{"range":[9974,9983],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":259,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":259,"endColumn":8,"fix":{"range":[9988,9995],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":261,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":261,"endColumn":8,"fix":{"range":[10000,10007],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":263,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":263,"endColumn":6,"fix":{"range":[10092,10097],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":263,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":263,"endColumn":7,"fix":{"range":[10098,10098],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":264,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":264,"endColumn":8,"fix":{"range":[10107,10114],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":265,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":265,"endColumn":8,"fix":{"range":[10132,10139],"text":"      "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 124. Maximum allowed is 120.","line":266,"column":1,"nodeType":"Program","messageId":"max","endLine":266,"endColumn":125},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":266,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":266,"endColumn":8,"fix":{"range":[10187,10194],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":267,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":267,"endColumn":6,"fix":{"range":[10313,10318],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":268,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":268,"endColumn":4,"fix":{"range":[10321,10324],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":268,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":268,"endColumn":5,"fix":{"range":[10325,10325],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":269,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":269,"endColumn":6,"fix":{"range":[10343,10348],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":269,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":269,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10348,10392],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":270,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":270,"endColumn":6,"fix":{"range":[10394,10399],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":271,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":271,"endColumn":8,"fix":{"range":[10478,10485],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":272,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":272,"endColumn":4,"fix":{"range":[10584,10587],"text":"  "}}],"suppressedMessages":[],"errorCount":240,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":220,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, ModalBuilder, TextInputBuilder, TextInputStyle, MessageFlags } from 'discord.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { guessGames } from '../game-states.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\nimport { safeInteractionReply, safeInteractionUpdate } from '../interactionHandlers.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('guess')\r\n  .setDescription('Play number guessing game with multiple difficulty levels')\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('Game difficulty')\r\n      .addChoices(\r\n        { name: 'Easy (1-50, 10 attempts)', value: 'easy' },\r\n        { name: 'Medium (1-100, 8 attempts)', value: 'medium' },\r\n        { name: 'Hard (1-200, 6 attempts)', value: 'hard' },\r\n        { name: 'Expert (1-500, 5 attempts)', value: 'expert' },\r\n        { name: 'Master (1-1000, 4 attempts)', value: 'master' }\r\n      )\r\n      .setRequired(false))\r\n  .addIntegerOption(option =>\r\n    option.setName('custom_min')\r\n      .setDescription('Custom minimum number')\r\n      .setRequired(false))\r\n  .addIntegerOption(option =>\r\n    option.setName('custom_max')\r\n      .setDescription('Custom maximum number')\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n   try {\r\n     let min = 1;\r\n     let max = 100;\r\n     let attempts = 10;\r\n     const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n\r\n     // Set difficulty parameters\r\n     switch (difficulty) {\r\n       case 'easy':\r\n         min = 1; max = 50; attempts = 10;\r\n         break;\r\n       case 'medium':\r\n         min = 1; max = 100; attempts = 8;\r\n         break;\r\n       case 'hard':\r\n         min = 1; max = 200; attempts = 6;\r\n         break;\r\n       case 'expert':\r\n         min = 1; max = 500; attempts = 5;\r\n         break;\r\n       case 'master':\r\n         min = 1; max = 1000; attempts = 4;\r\n         break;\r\n       default:\r\n         throw new CommandError('Invalid difficulty level.', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     // Custom range override with validation\r\n     const customMin = interaction.options.getInteger('custom_min');\r\n     const customMax = interaction.options.getInteger('custom_max');\r\n\r\n     if (customMin !== null || customMax !== null) {\r\n       if (customMin === null || customMax === null) {\r\n         throw new CommandError('Both custom minimum and maximum must be provided together.', 'INVALID_ARGUMENT');\r\n       }\r\n       if (customMin >= customMax) {\r\n         throw new CommandError('Minimum must be less than maximum!', 'INVALID_ARGUMENT');\r\n       }\r\n       if (customMax - customMin > 10000) {\r\n         throw new CommandError('Range too large! Maximum range is 10,000.', 'INVALID_ARGUMENT');\r\n       }\r\n       if (customMin < 1 || customMax > 1000000) {\r\n         throw new CommandError('Custom range must be between 1 and 1,000,000.', 'INVALID_ARGUMENT');\r\n       }\r\n       min = customMin;\r\n       max = customMax;\r\n       // Calculate optimal attempts for custom range\r\n       attempts = Math.min(attempts, Math.max(3, Math.floor(Math.log2(max - min + 1)) + 2));\r\n     }\r\n\r\n     // Generate secret number\r\n     const secretNumber = Math.floor(Math.random() * (max - min + 1)) + min;\r\n     const gameId = `guess_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n     const gameState = {\r\n       id: gameId,\r\n       secretNumber,\r\n       min,\r\n       max,\r\n       attempts,\r\n       attemptsUsed: 0,\r\n       guesses: [],\r\n       gameActive: true,\r\n       difficulty,\r\n       startTime: Date.now()\r\n     };\r\n\r\n     // Store game state\r\n     guessGames.set(gameId, gameState);\r\n\r\n     await sendGuessPrompt(interaction, gameState);\r\n   } catch (error) {\r\n     await handleCommandError(interaction, error);\r\n   }\r\n}\r\n\r\nasync function sendGuessPrompt(interaction, gameState) {\r\n   try {\r\n     const { attempts, attemptsUsed, min, max, guesses } = gameState;\r\n\r\n     // Update game state in storage\r\n     guessGames.set(gameState.id, gameState);\r\n\r\n     if (attemptsUsed >= attempts) {\r\n       gameState.gameActive = false;\r\n       guessGames.delete(gameState.id); // Clean up completed game\r\n       const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n       const loseEmbed = new EmbedBuilder()\r\n         .setTitle('‚ùå Game Over!')\r\n         .setColor(0xFF0000)\r\n         .setDescription(`The secret number was **${gameState.secretNumber}**!\\n\\nYou used all ${attempts} attempts in ${timeElapsed} seconds.`)\r\n         .addFields({\r\n           name: 'Your Guesses',\r\n           value: guesses.length > 0 ? guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n') : 'No guesses made',\r\n           inline: false\r\n         });\r\n\r\n       if (interaction.replied || interaction.deferred) {\r\n         await safeInteractionUpdate(interaction, { embeds: [loseEmbed], components: [] });\r\n       } else {\r\n         await safeInteractionReply(interaction, { embeds: [loseEmbed] });\r\n       }\r\n       return;\r\n     }\r\n\r\n     const embed = new EmbedBuilder()\r\n       .setTitle('üî¢ Number Guessing Game')\r\n       .setColor(0x0099FF)\r\n       .setDescription(`I'm thinking of a number between **${min}** and **${max}**.\\n\\nYou have **${attempts - attemptsUsed}** attempts remaining.`)\r\n       .addFields({\r\n         name: 'Previous Guesses',\r\n         value: guesses.length > 0 ?\r\n           guesses.slice(-5).map((g, i) => `**${g.number}** - ${g.feedback}`).join('\\n') :\r\n           'No guesses yet',\r\n         inline: false\r\n       });\r\n\r\n     // Create guess button\r\n     const row = new ActionRowBuilder().addComponents(\r\n       new ButtonBuilder().setCustomId(`guess_modal:${gameState.id}:${min}:${max}`).setLabel('üî¢ Make Guess').setStyle(ButtonStyle.Primary)\r\n     );\r\n\r\n     if (interaction.replied || interaction.deferred) {\r\n       await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n     } else {\r\n       await safeInteractionReply(interaction, { embeds: [embed], components: [row] });\r\n     }\r\n   } catch (error) {\r\n     console.error('sendGuessPrompt error:', error);\r\n     await handleCommandError(interaction, new CommandError('Failed to update game prompt.', 'UNKNOWN_ERROR', { originalError: error.message }));\r\n   }\r\n}\r\n\r\nasync function sendGuessModal(interaction, gameState) {\r\n  const modal = new ModalBuilder().setCustomId(`guess_submit:${gameState.id}`).setTitle('Make Your Guess');\r\n  const guessInput = new TextInputBuilder()\r\n    .setCustomId('guess_number')\r\n    .setLabel(`Number between ${gameState.min} and ${gameState.max}`)\r\n    .setStyle(TextInputStyle.Short)\r\n    .setRequired(true)\r\n    .setPlaceholder(`${Math.floor((gameState.min + gameState.max) / 2)}`);\r\n\r\n  modal.addComponents({ type: 1, components: [guessInput] });\r\n  await interaction.showModal(modal);\r\n}\r\n\r\nasync function processGuess(interaction, gameState, guess) {\r\n   try {\r\n     // Validate input\r\n     if (!guess || typeof guess !== 'string') {\r\n       throw new CommandError('Invalid guess input.', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     const guessNum = parseInt(guess.trim());\r\n\r\n     if (isNaN(guessNum)) {\r\n       throw new CommandError('Please enter a valid number!', 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     if (guessNum < gameState.min || guessNum > gameState.max) {\r\n       throw new CommandError(`Number must be between ${gameState.min} and ${gameState.max}!`, 'INVALID_ARGUMENT');\r\n     }\r\n\r\n     gameState.attemptsUsed++;\r\n\r\n     let feedback;\r\n     let isCorrect = false;\r\n\r\n     if (guessNum === gameState.secretNumber) {\r\n       feedback = 'üéâ Correct! You win!';\r\n       isCorrect = true;\r\n       gameState.gameActive = false;\r\n\r\n       // Track win with error handling\r\n       try {\r\n         updateUserStats(interaction.user.id, { guess_wins: 1 });\r\n       } catch (statsError) {\r\n         console.error('Failed to update user stats:', statsError);\r\n       }\r\n     } else if (guessNum < gameState.secretNumber) {\r\n       feedback = 'üìà Too low! Try a higher number.';\r\n     } else {\r\n       feedback = 'üìâ Too high! Try a lower number.';\r\n     }\r\n\r\n     // Store guess with feedback\r\n     gameState.guesses.push({\r\n       number: guessNum,\r\n       feedback,\r\n       attempt: gameState.attemptsUsed\r\n     });\r\n\r\n     if (isCorrect) {\r\n       guessGames.delete(gameState.id); // Clean up completed game\r\n       const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n       const attemptsUsed = gameState.attemptsUsed;\r\n\r\n       let performanceRating;\r\n       if (attemptsUsed === 1) performanceRating = 'üåü PERFECT! First try!';\r\n       else if (attemptsUsed <= 3) performanceRating = 'ü•á Excellent!';\r\n       else if (attemptsUsed <= 5) performanceRating = 'ü•à Good job!';\r\n       else if (attemptsUsed <= 7) performanceRating = 'ü•â Not bad!';\r\n       else performanceRating = 'üéØ You got it!';\r\n\r\n       const winEmbed = new EmbedBuilder()\r\n         .setTitle('üéâ Congratulations!')\r\n         .setColor(0x00FF00)\r\n         .setDescription(`You guessed **${gameState.secretNumber}** correctly!\\n\\n${performanceRating}`)\r\n         .addFields(\r\n           {\r\n             name: 'üìä Game Stats',\r\n             value: `**Attempts:** ${attemptsUsed}/${gameState.attempts}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n             inline: true\r\n           },\r\n           {\r\n             name: 'üèÜ Performance',\r\n             value: `**Range:** ${gameState.min}-${gameState.max}\\n**Efficiency:** ${Math.round((1 - (attemptsUsed - 1) / gameState.attempts) * 100)}%`,\r\n             inline: true\r\n           }\r\n         );\r\n\r\n       if (gameState.guesses.length > 0) {\r\n         winEmbed.addFields({\r\n           name: 'üìù Guess History',\r\n           value: gameState.guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n'),\r\n           inline: false\r\n         });\r\n       }\r\n\r\n       await safeInteractionUpdate(interaction, { embeds: [winEmbed], components: [] });\r\n\r\n     } else {\r\n       // Continue game\r\n       await sendGuessPrompt(interaction, gameState);\r\n       await safeInteractionReply(interaction, { content: `**${guessNum}** - ${feedback}`, flags: MessageFlags.Ephemeral });\r\n     }\r\n   } catch (error) {\r\n     console.error('processGuess error:', error);\r\n     await handleCommandError(interaction, error instanceof CommandError ? error :\r\n       new CommandError('Failed to process guess.', 'UNKNOWN_ERROR', { originalError: error.message }));\r\n   }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\guild.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'contributeToGuild' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":20},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (201). Maximum allowed is 100.","line":26,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":226,"endColumn":2},{"ruleId":"max-lines-per-function","severity":1,"message":"Async arrow function has too many lines (197). Maximum allowed is 100.","line":27,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":223,"endColumn":4},{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (68). Maximum allowed is 30.","line":27,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":223,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async arrow function has a complexity of 26. Maximum allowed is 20.","line":27,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":223,"endColumn":4},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":27,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":27,"endColumn":48,"fix":{"range":[1559,1560],"text":""}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 43 to the 15 allowed.","line":27,"column":51,"nodeType":null,"messageId":"refactorFunction","endLine":27,"endColumn":53},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":32,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":32,"endColumn":27,"fix":{"range":[1719,9633],"text":"switch (sub) {\n    case 'create': {\r\n      const guildName = interaction.options.getString('name');\r\n\r\n      // Validate guild name\r\n      validateNotEmpty(guildName, 'guild name');\r\n      validateRange(guildName.length, 3, 20, 'guild name length');\r\n\r\n      if (!/^[a-zA-Z0-9\\s]+$/.test(guildName)) {\r\n        throw new CommandError('Guild name can only contain letters, numbers, and spaces.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const result = createGuild(guildName, userId, userName);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèõÔ∏è Guild Created!')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`**${guildName}** has been founded!`)\r\n        .addFields(\r\n          { name: 'üëë Leader', value: userName, inline: true },\r\n          { name: 'üèÜ Level', value: '1', inline: true },\r\n          { name: 'üë• Members', value: '1', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    \n    break;\n    }\n    case 'join': {\r\n      const guildName = interaction.options.getString('name');\r\n\r\n      validateNotEmpty(guildName, 'guild name');\r\n\r\n      const result = joinGuild(guildName, userId, userName);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('ü§ù Welcome to the Guild!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You have joined **${guildName}**!`)\r\n        .addFields(\r\n          { name: 'üë• Members', value: Object.keys(result.guild.members).length, inline: true },\r\n          { name: 'üèÜ Level', value: result.guild.level, inline: true },\r\n          { name: 'üí∞ Guild Gold', value: result.guild.gold, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    \n    break;\n    }\n    case 'leave': {\r\n      const userGuild = getUserGuild(userId);\r\n      if (!userGuild) {\r\n        return interaction.reply({ content: '‚ùå You are not in a guild.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const result = leaveGuild(userGuild.name, userId);\r\n      if (!result.success) {\r\n        return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      await interaction.reply({ content: `üëã You have left **${userGuild.name}**.`, flags: MessageFlags.Ephemeral });\r\n\r\n    \n    break;\n    }\n    case 'info': {\r\n      const userGuild = getUserGuild(userId);\r\n      if (!userGuild) {\r\n        return interaction.reply({ content: '‚ùå You are not in a guild. Use `/guild create` or `/guild join`!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üèõÔ∏è ${userGuild.name}`)\r\n        .setColor(0xFFD700)\r\n        .setDescription(userGuild.description || 'No description set.')\r\n        .addFields(\r\n          { name: 'üëë Leader', value: userGuild.members[userGuild.leader]?.name || 'Unknown', inline: true },\r\n          { name: 'üèÜ Level', value: userGuild.level, inline: true },\r\n          { name: 'üë• Members', value: `${Object.keys(userGuild.members).length}/${userGuild.maxMembers}`, inline: true },\r\n          { name: 'üí∞ Guild Gold', value: userGuild.gold, inline: true },\r\n          { name: '‚≠ê Experience', value: userGuild.experience, inline: true }\r\n        );\r\n\r\n      // Add member list\r\n      const memberList = Object.entries(userGuild.members)\r\n        .map(([id, member]) => `${member.role === 'leader' ? 'üëë' : 'üë§'} ${member.name} (Level ${member.level})`)\r\n        .join('\\n');\r\n\r\n      embed.addFields({\r\n        name: 'üë• Members',\r\n        value: memberList,\r\n        inline: false\r\n      });\r\n\r\n      // Add guild action buttons\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`guild_contribute:${userGuild.name}:${userId}`).setLabel('üí∞ Contribute Gold').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`guild_refresh:${userGuild.name}:${userId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    \n    break;\n    }\n    case 'leaderboard': {\r\n      const leaderboard = getGuildLeaderboard(10);\r\n\r\n      if (leaderboard.length === 0) {\r\n        return interaction.reply({ content: 'üèÜ No guilds yet. Be the first to create one!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const userGuild = getUserGuild(userId);\r\n      const userRank = userGuild ? leaderboard.findIndex(g => g.name === userGuild.name) + 1 : 0;\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÜ Guild Leaderboard')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`**Your Rank:** ${userRank > 0 ? `#${userRank}` : 'Not in a guild'}`);\r\n\r\n      const leaderboardText = leaderboard.map((guild, index) => {\r\n        const rank = index + 1;\r\n        const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n        return `${medal} **${guild.name}** - Level ${guild.level} (${guild.memberCount} members)`;\r\n      }).join('\\n');\r\n\r\n      embed.addFields({\r\n        name: 'üèõÔ∏è Top Guilds',\r\n        value: leaderboardText,\r\n        inline: false\r\n      });\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    \n    break;\n    }\n    case 'party': {\r\n      const action = interaction.options.getString('action');\r\n\r\n      if (action === 'create') {\r\n        const result = createParty(userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé≠ Party Created!')\r\n          .setColor(0x9932CC)\r\n          .setDescription(`**Party ID:** \\`${result.party.id}\\`\\nShare this ID with friends to join!`)\r\n          .addFields(\r\n            { name: 'üëë Leader', value: userName, inline: true },\r\n            { name: 'üë• Members', value: '1', inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`party_invite:${result.party.id}:${userId}`).setLabel('üîó Generate Invite').setStyle(ButtonStyle.Primary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } else if (action === 'join') {\r\n        const partyId = interaction.options.getString('party_id');\r\n\r\n        if (!partyId.startsWith('party_')) {\r\n          return interaction.reply({ content: '‚ùå Invalid party ID format.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = joinParty(partyId, userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('ü§ù Joined Party!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You have joined the party!`)\r\n          .addFields(\r\n            { name: 'üë• Members', value: Object.keys(result.party.members).length, inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } else if (action === 'leave') {\r\n        const userParty = getUserParty(userId);\r\n        if (!userParty) {\r\n          return interaction.reply({ content: '‚ùå You are not in a party.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = leaveParty(userParty.id, userId);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        await interaction.reply({ content: 'üëã You have left the party.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/^[a-zA-Z0-9\\s]+$/ can be optimized to /^[\\d\\sA-Za-z]+$/.","line":39,"column":12,"nodeType":"Literal","messageId":"better-regex","endLine":39,"endColumn":30,"fix":{"range":[1971,1989],"text":"/^[\\d\\sA-Za-z]+$/"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":50,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":50,"endColumn":27,"fix":{"range":[2404,2412],"text":"0xFF_D7_00"}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 6 times.","line":55,"column":19,"nodeType":"Literal","endLine":55,"endColumn":31},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":60,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":60,"endColumn":6,"fix":{"range":[2757,2757],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":72,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":72,"endColumn":27,"fix":{"range":[3177,3185],"text":"0x00_FF_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":82,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":82,"endColumn":6,"fix":{"range":[3594,3594],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":95,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":95,"endColumn":6,"fix":{"range":[4141,4141],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":103,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":103,"endColumn":27,"fix":{"range":[4501,4509],"text":"0xFF_D7_00"}},{"ruleId":"no-unused-vars","severity":1,"message":"'id' is defined but never used.","line":115,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":115,"endColumn":18},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":132,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":132,"endColumn":6,"fix":{"range":[5899,5899],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":144,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":144,"endColumn":27,"fix":{"range":[6416,6424],"text":"0xFF_D7_00"}},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":145,"column":58,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":145,"endColumn":72},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Do not nest ternary expressions.","line":149,"column":63,"nodeType":"ConditionalExpression","messageId":"too-deep","endLine":149,"endColumn":87},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":161,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":161,"endColumn":6,"fix":{"range":[7025,7025],"text":"\n"}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":164,"column":7,"nodeType":null,"messageId":"prefer-switch","endLine":164,"endColumn":32,"fix":{"range":[7126,9626],"text":"switch (action) {\n      case 'create': {\r\n        const result = createParty(userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé≠ Party Created!')\r\n          .setColor(0x9932CC)\r\n          .setDescription(`**Party ID:** \\`${result.party.id}\\`\\nShare this ID with friends to join!`)\r\n          .addFields(\r\n            { name: 'üëë Leader', value: userName, inline: true },\r\n            { name: 'üë• Members', value: '1', inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`party_invite:${result.party.id}:${userId}`).setLabel('üîó Generate Invite').setStyle(ButtonStyle.Primary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      \n      break;\n      }\n      case 'join': {\r\n        const partyId = interaction.options.getString('party_id');\r\n\r\n        if (!partyId.startsWith('party_')) {\r\n          return interaction.reply({ content: '‚ùå Invalid party ID format.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = joinParty(partyId, userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('ü§ù Joined Party!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You have joined the party!`)\r\n          .addFields(\r\n            { name: 'üë• Members', value: Object.keys(result.party.members).length, inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      \n      break;\n      }\n      case 'leave': {\r\n        const userParty = getUserParty(userId);\r\n        if (!userParty) {\r\n          return interaction.reply({ content: '‚ùå You are not in a party.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = leaveParty(userParty.id, userId);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        await interaction.reply({ content: 'üëã You have left the party.', flags: MessageFlags.Ephemeral });\r\n      \n      break;\n      }\n      // No default\n      }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":172,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":172,"endColumn":29,"fix":{"range":[7461,7469],"text":"0x99_32_CC"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":186,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":186,"endColumn":8,"fix":{"range":[8133,8133],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":200,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":200,"endColumn":29,"fix":{"range":[8718,8726],"text":"0x00_FF_00"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":201,"column":27,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":201,"endColumn":55,"fix":{"range":[8755,8783],"text":"'You have joined the party!'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":209,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":209,"endColumn":8,"fix":{"range":[9072,9072],"text":"\n"}}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":19,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport {\r\n  createGuild,\r\n  joinGuild,\r\n  leaveGuild,\r\n  createParty,\r\n  joinParty,\r\n  leaveParty,\r\n  getUserGuild,\r\n  getUserParty,\r\n  getGuildLeaderboard,\r\n  contributeToGuild\r\n} from '../guilds.js';\r\nimport { safeExecuteCommand, CommandError, validateNotEmpty, validateRange } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('guild')\r\n  .setDescription('Manage guilds and parties for multiplayer RPG')\r\n  .addSubcommand(sub => sub.setName('create').setDescription('Create a new guild').addStringOption(opt => opt.setName('name').setDescription('Guild name').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('join').setDescription('Join an existing guild').addStringOption(opt => opt.setName('name').setDescription('Guild name').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('leave').setDescription('Leave your current guild'))\r\n  .addSubcommand(sub => sub.setName('info').setDescription('View guild information'))\r\n  .addSubcommand(sub => sub.setName('leaderboard').setDescription('View guild leaderboard'))\r\n  .addSubcommand(sub => sub.setName('party').setDescription('Party management').addStringOption(opt => opt.setName('action').setDescription('create|join|leave').setRequired(true)).addStringOption(opt => opt.setName('party_id').setDescription('Party ID (for join)')));\r\n\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    const sub = interaction.options.getSubcommand();\r\n    const userId = interaction.user.id;\r\n    const userName = interaction.user.username;\r\n\r\n    if (sub === 'create') {\r\n      const guildName = interaction.options.getString('name');\r\n\r\n      // Validate guild name\r\n      validateNotEmpty(guildName, 'guild name');\r\n      validateRange(guildName.length, 3, 20, 'guild name length');\r\n\r\n      if (!/^[a-zA-Z0-9\\s]+$/.test(guildName)) {\r\n        throw new CommandError('Guild name can only contain letters, numbers, and spaces.', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const result = createGuild(guildName, userId, userName);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèõÔ∏è Guild Created!')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`**${guildName}** has been founded!`)\r\n        .addFields(\r\n          { name: 'üëë Leader', value: userName, inline: true },\r\n          { name: 'üèÜ Level', value: '1', inline: true },\r\n          { name: 'üë• Members', value: '1', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } else if (sub === 'join') {\r\n      const guildName = interaction.options.getString('name');\r\n\r\n      validateNotEmpty(guildName, 'guild name');\r\n\r\n      const result = joinGuild(guildName, userId, userName);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason, 'COMMAND_ERROR');\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('ü§ù Welcome to the Guild!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You have joined **${guildName}**!`)\r\n        .addFields(\r\n          { name: 'üë• Members', value: Object.keys(result.guild.members).length, inline: true },\r\n          { name: 'üèÜ Level', value: result.guild.level, inline: true },\r\n          { name: 'üí∞ Guild Gold', value: result.guild.gold, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } else if (sub === 'leave') {\r\n      const userGuild = getUserGuild(userId);\r\n      if (!userGuild) {\r\n        return interaction.reply({ content: '‚ùå You are not in a guild.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const result = leaveGuild(userGuild.name, userId);\r\n      if (!result.success) {\r\n        return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      await interaction.reply({ content: `üëã You have left **${userGuild.name}**.`, flags: MessageFlags.Ephemeral });\r\n\r\n    } else if (sub === 'info') {\r\n      const userGuild = getUserGuild(userId);\r\n      if (!userGuild) {\r\n        return interaction.reply({ content: '‚ùå You are not in a guild. Use `/guild create` or `/guild join`!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üèõÔ∏è ${userGuild.name}`)\r\n        .setColor(0xFFD700)\r\n        .setDescription(userGuild.description || 'No description set.')\r\n        .addFields(\r\n          { name: 'üëë Leader', value: userGuild.members[userGuild.leader]?.name || 'Unknown', inline: true },\r\n          { name: 'üèÜ Level', value: userGuild.level, inline: true },\r\n          { name: 'üë• Members', value: `${Object.keys(userGuild.members).length}/${userGuild.maxMembers}`, inline: true },\r\n          { name: 'üí∞ Guild Gold', value: userGuild.gold, inline: true },\r\n          { name: '‚≠ê Experience', value: userGuild.experience, inline: true }\r\n        );\r\n\r\n      // Add member list\r\n      const memberList = Object.entries(userGuild.members)\r\n        .map(([id, member]) => `${member.role === 'leader' ? 'üëë' : 'üë§'} ${member.name} (Level ${member.level})`)\r\n        .join('\\n');\r\n\r\n      embed.addFields({\r\n        name: 'üë• Members',\r\n        value: memberList,\r\n        inline: false\r\n      });\r\n\r\n      // Add guild action buttons\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`guild_contribute:${userGuild.name}:${userId}`).setLabel('üí∞ Contribute Gold').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`guild_refresh:${userGuild.name}:${userId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } else if (sub === 'leaderboard') {\r\n      const leaderboard = getGuildLeaderboard(10);\r\n\r\n      if (leaderboard.length === 0) {\r\n        return interaction.reply({ content: 'üèÜ No guilds yet. Be the first to create one!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const userGuild = getUserGuild(userId);\r\n      const userRank = userGuild ? leaderboard.findIndex(g => g.name === userGuild.name) + 1 : 0;\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÜ Guild Leaderboard')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`**Your Rank:** ${userRank > 0 ? `#${userRank}` : 'Not in a guild'}`);\r\n\r\n      const leaderboardText = leaderboard.map((guild, index) => {\r\n        const rank = index + 1;\r\n        const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n        return `${medal} **${guild.name}** - Level ${guild.level} (${guild.memberCount} members)`;\r\n      }).join('\\n');\r\n\r\n      embed.addFields({\r\n        name: 'üèõÔ∏è Top Guilds',\r\n        value: leaderboardText,\r\n        inline: false\r\n      });\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } else if (sub === 'party') {\r\n      const action = interaction.options.getString('action');\r\n\r\n      if (action === 'create') {\r\n        const result = createParty(userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üé≠ Party Created!')\r\n          .setColor(0x9932CC)\r\n          .setDescription(`**Party ID:** \\`${result.party.id}\\`\\nShare this ID with friends to join!`)\r\n          .addFields(\r\n            { name: 'üëë Leader', value: userName, inline: true },\r\n            { name: 'üë• Members', value: '1', inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`party_invite:${result.party.id}:${userId}`).setLabel('üîó Generate Invite').setStyle(ButtonStyle.Primary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n      } else if (action === 'join') {\r\n        const partyId = interaction.options.getString('party_id');\r\n\r\n        if (!partyId.startsWith('party_')) {\r\n          return interaction.reply({ content: '‚ùå Invalid party ID format.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = joinParty(partyId, userId, userName);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('ü§ù Joined Party!')\r\n          .setColor(0x00FF00)\r\n          .setDescription(`You have joined the party!`)\r\n          .addFields(\r\n            { name: 'üë• Members', value: Object.keys(result.party.members).length, inline: true },\r\n            { name: '‚öîÔ∏è Max Size', value: result.party.maxMembers, inline: true }\r\n          );\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n      } else if (action === 'leave') {\r\n        const userParty = getUserParty(userId);\r\n        if (!userParty) {\r\n          return interaction.reply({ content: '‚ùå You are not in a party.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const result = leaveParty(userParty.id, userId);\r\n        if (!result.success) {\r\n          return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        await interaction.reply({ content: 'üëã You have left the party.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    }\r\n  }, {\r\n    command: 'guild'\r\n  });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\hangman.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":78,"fix":{"range":[77,77],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`discord.js` import should occur after import of `url`","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":78,"fix":{"range":[0,179],"text":"import { readFileSync } from 'fs';\r\nimport path from 'path';\r\nimport { fileURLToPath } from 'url';\r\nimport { SlashCommandBuilder, EmbedBuilder, MessageFlags } from 'discord.js';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":2,"column":30,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":34,"fix":{"range":[109,109],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":3,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":24,"fix":{"range":[133,133],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":4,"column":1,"nodeType":"ImportDeclaration","endLine":4,"endColumn":37,"fix":{"range":[177,177],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:url` over `url`.","line":4,"column":31,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":4,"endColumn":36,"fix":{"range":[172,172],"text":"node:"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":11,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":11,"endColumn":5,"fix":{"range":[432,436],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":12,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":12,"endColumn":5,"fix":{"range":[457,461],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":13,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":13,"endColumn":5,"fix":{"range":[505,509],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":14,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":14,"endColumn":9,"fix":{"range":[539,547],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":15,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":15,"endColumn":13,"fix":{"range":[559,571],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":16,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":16,"endColumn":13,"fix":{"range":[590,602],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":17,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":17,"endColumn":5,"fix":{"range":[648,652],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":18,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":18,"endColumn":9,"fix":{"range":[682,690],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":19,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":19,"endColumn":13,"fix":{"range":[702,714],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":20,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":20,"endColumn":13,"fix":{"range":[733,745],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":21,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":21,"endColumn":13,"fix":{"range":[800,812],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":22,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":22,"endColumn":17,"fix":{"range":[840,856],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":23,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":23,"endColumn":21,"fix":{"range":[864,884],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":24,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":24,"endColumn":21,"fix":{"range":[904,924],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 20.","line":25,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":25,"endColumn":21,"fix":{"range":[964,984],"text":"          "}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (106). Maximum allowed is 100.","line":27,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":132,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":28,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":28,"endColumn":5,"fix":{"range":[1055,1059],"text":"  "}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async arrow function has too many lines (101). Maximum allowed is 100.","line":28,"column":44,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":128,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (36). Maximum allowed is 30.","line":28,"column":44,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":128,"endColumn":6},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":28,"column":49,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":28,"endColumn":50,"fix":{"range":[1103,1104],"text":""}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 26 to the 15 allowed.","line":28,"column":53,"nodeType":null,"messageId":"refactorFunction","endLine":28,"endColumn":55},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":29,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":29,"endColumn":9,"fix":{"range":[1113,1121],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":31,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":31,"endColumn":9,"fix":{"range":[1180,1188],"text":"    "}},{"ruleId":"unicorn/consistent-function-scoping","severity":2,"message":"Move arrow function 'drawHangman' to the outer scope.","line":31,"column":44,"nodeType":"ArrowFunctionExpression","messageId":"consistent-function-scoping","endLine":31,"endColumn":46},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":32,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":32,"endColumn":13,"fix":{"range":[1229,1241],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":33,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":33,"endColumn":17,"fix":{"range":[1259,1275],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":34,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":34,"endColumn":17,"fix":{"range":[1351,1367],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":35,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":35,"endColumn":17,"fix":{"range":[1443,1459],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":36,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":36,"endColumn":17,"fix":{"range":[1535,1551],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":37,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":37,"endColumn":17,"fix":{"range":[1627,1643],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":38,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":38,"endColumn":17,"fix":{"range":[1720,1736],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 16.","line":39,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":39,"endColumn":17,"fix":{"range":[1813,1829],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":40,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":40,"endColumn":13,"fix":{"range":[1906,1918],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":41,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":41,"endColumn":13,"fix":{"range":[1922,1934],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":41,"column":20,"nodeType":"MemberExpression","endLine":41,"endColumn":40},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":42,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":42,"endColumn":9,"fix":{"range":[1964,1972],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":9,"fix":{"range":[1978,1986],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 12.","line":45,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":45,"endColumn":13,"fix":{"range":[2017,2029],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":46,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":46,"endColumn":13,"fix":{"range":[2111,2123],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":47,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":47,"endColumn":13,"fix":{"range":[2137,2149],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":49,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":49,"endColumn":9,"fix":{"range":[2193,2201],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":50,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":50,"endColumn":13,"fix":{"range":[2228,2240],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":51,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":51,"endColumn":9,"fix":{"range":[2352,2360],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":53,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":53,"endColumn":9,"fix":{"range":[2365,2373],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":9,"fix":{"range":[2442,2450],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":55,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":55,"endColumn":13,"fix":{"range":[2471,2483],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":56,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":56,"endColumn":13,"fix":{"range":[2516,2528],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":57,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":57,"endColumn":13,"fix":{"range":[2556,2568],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":13,"fix":{"range":[2586,2598],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":59,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":59,"endColumn":13,"fix":{"range":[2619,2631],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":60,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":60,"endColumn":13,"fix":{"range":[2651,2663],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":61,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":61,"endColumn":9,"fix":{"range":[2677,2685],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":63,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":63,"endColumn":9,"fix":{"range":[2691,2699],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":64,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":64,"endColumn":13,"fix":{"range":[2728,2740],"text":"        "}},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `String#split('')`.","line":64,"column":35,"nodeType":"Identifier","messageId":"string-split","endLine":64,"endColumn":40,"suggestions":[{"messageId":"use-spread","fix":{"range":[2747,2771],"text":"[...gameState.word]"},"data":{},"desc":"Use `...` operator."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":65,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":65,"endColumn":9,"fix":{"range":[2851,2859],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":9,"fix":{"range":[2865,2873],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":68,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":68,"endColumn":13,"fix":{"range":[2907,2919],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":69,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":69,"endColumn":13,"fix":{"range":[2941,2953],"text":"        "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 172. Maximum allowed is 120.","line":70,"column":1,"nodeType":"Program","messageId":"max","endLine":70,"endColumn":173},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":70,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":70,"endColumn":13,"fix":{"range":[2980,2992],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":71,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":71,"endColumn":13,"fix":{"range":[3154,3166],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":73,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":73,"endColumn":9,"fix":{"range":[3239,3247],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":75,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":75,"endColumn":9,"fix":{"range":[3296,3304],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":76,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":76,"endColumn":9,"fix":{"range":[3325,3333],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":77,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":77,"endColumn":13,"fix":{"range":[3367,3379],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":78,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":78,"endColumn":9,"fix":{"range":[3418,3426],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":79,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":79,"endColumn":9,"fix":{"range":[3429,3437],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":80,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":80,"endColumn":9,"fix":{"range":[3500,3508],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":82,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":82,"endColumn":9,"fix":{"range":[3513,3521],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":83,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":83,"endColumn":9,"fix":{"range":[3557,3565],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":85,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":85,"endColumn":9,"fix":{"range":[3637,3645],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":86,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":86,"endColumn":9,"fix":{"range":[3664,3672],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":87,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":87,"endColumn":9,"fix":{"range":[3708,3716],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":88,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":88,"endColumn":9,"fix":{"range":[3769,3777],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":89,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":89,"endColumn":13,"fix":{"range":[3808,3820],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":90,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":90,"endColumn":9,"fix":{"range":[3904,3912],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":92,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":92,"endColumn":9,"fix":{"range":[3917,3925],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":93,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":93,"endColumn":9,"fix":{"range":[3995,4003],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":94,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":94,"endColumn":13,"fix":{"range":[4046,4058],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":95,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":95,"endColumn":9,"fix":{"range":[4159,4167],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":97,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":97,"endColumn":9,"fix":{"range":[4172,4180],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":98,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":98,"endColumn":13,"fix":{"range":[4224,4236],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":99,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":99,"endColumn":9,"fix":{"range":[4322,4330],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":101,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":101,"endColumn":9,"fix":{"range":[4335,4343],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":103,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":103,"endColumn":9,"fix":{"range":[4383,4391],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":104,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":104,"endColumn":13,"fix":{"range":[4431,4443],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":105,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":105,"endColumn":9,"fix":{"range":[4470,4478],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":107,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":107,"endColumn":9,"fix":{"range":[4483,4491],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":108,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":108,"endColumn":9,"fix":{"range":[4517,4525],"text":"      "}},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `String#split('')`.","line":108,"column":47,"nodeType":"Identifier","messageId":"string-split","endLine":108,"endColumn":52,"suggestions":[{"messageId":"use-spread","fix":{"range":[4548,4572],"text":"[...gameState.word]"},"data":{},"desc":"Use `...` operator."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":9,"fix":{"range":[4652,4660],"text":"      "}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":109,"column":28,"nodeType":"Identifier","messageId":"method","endLine":109,"endColumn":35,"fix":{"range":[4686,4686],"text":"All"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":110,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":110,"endColumn":13,"fix":{"range":[4721,4733],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":111,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":111,"endColumn":13,"fix":{"range":[4758,4770],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":112,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":112,"endColumn":9,"fix":{"range":[4800,4808],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":112,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":112,"endColumn":10,"fix":{"range":[4809,4809],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":113,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":113,"endColumn":13,"fix":{"range":[4875,4887],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":114,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":114,"endColumn":9,"fix":{"range":[4917,4925],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":116,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":116,"endColumn":9,"fix":{"range":[4930,4938],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":13,"fix":{"range":[4979,4991],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":118,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":118,"endColumn":13,"fix":{"range":[5013,5025],"text":"        "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 173. Maximum allowed is 120.","line":119,"column":1,"nodeType":"Program","messageId":"max","endLine":119,"endColumn":174},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":119,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":119,"endColumn":13,"fix":{"range":[5122,5134],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":120,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":120,"endColumn":13,"fix":{"range":[5297,5309],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":122,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":122,"endColumn":9,"fix":{"range":[5419,5427],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":124,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":124,"endColumn":9,"fix":{"range":[5483,5491],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 12.","line":125,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":125,"endColumn":13,"fix":{"range":[5520,5532],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":126,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":126,"endColumn":9,"fix":{"range":[5587,5595],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":127,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":127,"endColumn":9,"fix":{"range":[5598,5606],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":128,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":128,"endColumn":5,"fix":{"range":[5609,5613],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":129,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":129,"endColumn":5,"fix":{"range":[5617,5621],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 8.","line":130,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":130,"endColumn":9,"fix":{"range":[5624,5632],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":131,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":131,"endColumn":5,"fix":{"range":[5652,5656],"text":"  "}}],"suppressedMessages":[],"errorCount":118,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":110,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, MessageFlags } from 'discord.js';\r\nimport { readFileSync } from 'fs';\r\nimport path from 'path';\r\nimport { fileURLToPath } from 'url';\r\nimport { safeExecuteCommand, CommandError, validateNotEmpty, validateRange } from '../errorHandler.js';\r\n\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\nexport const data = new SlashCommandBuilder()\r\n    .setName('hangman')\r\n    .setDescription('Play a game of Hangman!')\r\n    .addSubcommand(subcommand =>\r\n        subcommand\r\n            .setName('start')\r\n            .setDescription('Start a new Hangman game'))\r\n    .addSubcommand(subcommand =>\r\n        subcommand\r\n            .setName('guess')\r\n            .setDescription('Guess a letter in the Hangman game')\r\n            .addStringOption(option =>\r\n                option\r\n                    .setName('letter')\r\n                    .setDescription('The letter to guess')\r\n                    .setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n    return safeExecuteCommand(interaction, async () => {\r\n        const subcommand = interaction.options.getSubcommand();\r\n\r\n        const drawHangman = (wrongGuesses) => {\r\n            const stages = [\r\n                '```\\n  +---+\\n  |   |\\n      |\\n      |\\n      |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n      |\\n      |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n  |   |\\n      |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n /|   |\\n      |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n /|\\\\  |\\n      |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n /|\\\\  |\\n /    |\\n      |\\n=========```',\r\n                '```\\n  +---+\\n  |   |\\n  O   |\\n /|\\\\  |\\n / \\\\  |\\n      |\\n=========```'\r\n            ];\r\n            return stages[wrongGuesses];\r\n        };\r\n\r\n        if (subcommand === 'start') {\r\n            const words = readFileSync(path.join(__dirname, '../../data/words.txt'), 'utf8')\r\n            .split('\\n')\r\n            .filter(word => word.trim().length > 0);\r\n\r\n        if (words.length === 0) {\r\n            return await interaction.reply({ content: 'No words available for Hangman.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const randomWord = words[Math.floor(Math.random() * words.length)];\r\n        const gameState = {\r\n            word: randomWord.toLowerCase(),\r\n            guessedLetters: new Set(),\r\n            wrongGuesses: 0,\r\n            maxWrongGuesses: 6,\r\n            isGameOver: false,\r\n            isWon: false\r\n        };\r\n\r\n        const displayWord = () => {\r\n            return gameState.word.split('').map(letter => gameState.guessedLetters.has(letter) ? letter : '_').join(' ');\r\n        };\r\n\r\n        const embed = new EmbedBuilder()\r\n            .setColor('#0099ff')\r\n            .setTitle('Hangman Game')\r\n            .setDescription(`**Word:** ${displayWord()}\\n**Wrong Guesses:** ${gameState.wrongGuesses}/${gameState.maxWrongGuesses}\\n${drawHangman(gameState.wrongGuesses)}`)\r\n            .setFooter({ text: 'Guess a letter using /hangman guess <letter>' });\r\n\r\n        await interaction.reply({ embeds: [embed] });\r\n\r\n        // Store game state\r\n        if (!interaction.client.games) {\r\n            interaction.client.games = new Map();\r\n        }\r\n        interaction.client.games.set(interaction.user.id, gameState);\r\n        }\r\n\r\n        else if (subcommand === 'guess') {\r\n        const guess = interaction.options.getString('letter').toLowerCase();\r\n\r\n        // Validate input\r\n        validateNotEmpty(guess, 'letter');\r\n        validateRange(guess.length, 1, 1, 'letter length');\r\n        if (!/^[a-z]$/.test(guess)) {\r\n            throw new CommandError('Please guess a single letter (a-z).', 'INVALID_ARGUMENT');\r\n        }\r\n\r\n        const gameState = interaction.client.games.get(interaction.user.id);\r\n        if (!gameState || gameState.isGameOver) {\r\n            throw new CommandError('No active game found. Start a new game with /hangman start.', 'NOT_FOUND');\r\n        }\r\n\r\n        if (gameState.guessedLetters.has(guess)) {\r\n            throw new CommandError('You have already guessed that letter.', 'INVALID_ARGUMENT');\r\n        }\r\n\r\n        gameState.guessedLetters.add(guess);\r\n\r\n        if (!gameState.word.includes(guess)) {\r\n            gameState.wrongGuesses++;\r\n        }\r\n\r\n        // Check for win or loss\r\n        const currentDisplay = gameState.word.split('').map(letter => gameState.guessedLetters.has(letter) ? letter : '_').join(' ');\r\n        if (currentDisplay.replace(/\\s/g, '') === gameState.word) {\r\n            gameState.isWon = true;\r\n            gameState.isGameOver = true;\r\n        } else if (gameState.wrongGuesses >= gameState.maxWrongGuesses) {\r\n            gameState.isGameOver = true;\r\n        }\r\n\r\n        const updatedEmbed = new EmbedBuilder()\r\n            .setColor('#0099ff')\r\n            .setTitle(gameState.isGameOver ? (gameState.isWon ? 'You Won!' : 'You Lost!') : 'Hangman Game')\r\n            .setDescription(`**Word:** ${currentDisplay}\\n**Wrong Guesses:** ${gameState.wrongGuesses}/${gameState.maxWrongGuesses}\\n${drawHangman(gameState.wrongGuesses)}`)\r\n            .setFooter({ text: gameState.isGameOver ? 'Game Over' : 'Guess a letter using /hangman guess <letter>' });\r\n\r\n        await interaction.reply({ embeds: [updatedEmbed] });\r\n\r\n        if (gameState.isGameOver) {\r\n            interaction.client.games.delete(interaction.user.id);\r\n        }\r\n        }\r\n    },\r\n    {\r\n        command: 'hangman'\r\n    });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\help.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[63,63],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`discord.js` import should occur after import of `url`","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[0,151],"text":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { pathToFileURL } from 'url';\r\nimport { SlashCommandBuilder, EmbedBuilder } from 'discord.js';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":2,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":20,"fix":{"range":[81,81],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":3,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":24,"fix":{"range":[105,105],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:url` over `url`.","line":4,"column":31,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":4,"endColumn":36,"fix":{"range":[144,144],"text":"node:"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":17,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":19,"endColumn":12},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":20,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":20,"endColumn":10,"fix":{"range":[713,713],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":21,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":21,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[741,797],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":72,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":72,"endColumn":23,"fix":{"range":[2882,2890],"text":"0x00_99_FF"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":76,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":76,"endColumn":16,"fix":{"range":[2955,3344],"text":" {\r\n      embed.setDescription('**RPG System Commands**\\n\\n' + commandCategories.rpg.join('\\n'));\r\n      embed.addFields({\r\n        name: 'RPG Features',\r\n        value: '‚Ä¢ Character creation and leveling\\n‚Ä¢ Combat system with monsters\\n‚Ä¢ Exploration and random events\\n‚Ä¢ Quest system\\n‚Ä¢ Skill point allocation\\n‚Ä¢ Leaderboards and statistics',\r\n        inline: false\r\n      });\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":85,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":85,"endColumn":18,"fix":{"range":[3365,3791],"text":" {\r\n      embed.setDescription('**Minigame Commands**\\n\\n' + commandCategories.games.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Available Games',\r\n        value: '‚Ä¢ **8ball**: Magic 8-ball for questions\\n‚Ä¢ **roll**: Dice rolling (e.g., 2d6, 1d20)\\n‚Ä¢ **rps**: Rock Paper Scissors\\n‚Ä¢ **minigame**: Interactive typing challenges\\n‚Ä¢ **novel**: AI-generated story creation',\r\n        inline: false\r\n      });\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":94,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":94,"endColumn":20,"fix":{"range":[3814,4245],"text":" {\r\n      embed.setDescription('**Utility Commands**\\n\\n' + commandCategories.utility.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Utility Features',\r\n        value: '‚Ä¢ **ping**: Check bot latency\\n‚Ä¢ **echo**: Repeat messages\\n‚Ä¢ **setmodel**: Configure AI models per server\\n‚Ä¢ **togglechat**: Enable/disable chat responses\\n‚Ä¢ **toggleplay**: Enable/disable playful responses',\r\n        inline: false\r\n      });\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":103,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":103,"endColumn":17,"fix":{"range":[4265,4709],"text":" {\r\n      embed.setDescription('**Chat & AI Features**\\n\\n' + commandCategories.chat.join('\\n'));\r\n      embed.addFields({\r\n        name: 'AI Integration',\r\n        value: '‚Ä¢ DM the bot or mention it to start chatting\\n‚Ä¢ Supports OpenAI GPT models\\n‚Ä¢ Compatible with local AI models\\n‚Ä¢ Conversation history and context\\n‚Ä¢ Type `!clear` to reset conversation\\n‚Ä¢ Configurable per-server AI settings',\r\n        inline: false\r\n      });\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":112,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":112,"endColumn":18,"fix":{"range":[4730,5206],"text":" {\r\n      embed.setDescription('**Admin & Moderation Commands**\\n\\n' + commandCategories.admin.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Admin Features',\r\n        value: '‚Ä¢ **admin**: Server administration tools\\n‚Ä¢ **guild**: Guild management\\n‚Ä¢ **achievements**: Achievement system\\n‚Ä¢ **economy**: Currency and trading\\n‚Ä¢ **inventory**: Player items\\n‚Ä¢ **trade**: Marketplace system\\n‚Ä¢ **explore**: Adventure system',\r\n        inline: false\r\n      });\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":121,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":121,"endColumn":13,"fix":{"range":[5222,6026],"text":" {\r\n      embed.setDescription('**All Available Commands**\\n\\n' +\r\n        'üèÜ **RPG System**\\n' + commandCategories.rpg.join('\\n') + '\\n\\n' +\r\n        'üõ°Ô∏è **Admin & Moderation**\\n' + commandCategories.admin.join('\\n') + '\\n\\n' +\r\n        'üéÆ **Games & Fun**\\n' + commandCategories.games.join('\\n') + '\\n\\n' +\r\n        'üîß **Utilities**\\n' + commandCategories.utility.join('\\n'));\r\n\r\n      embed.addFields(\r\n        {\r\n          name: 'üí¨ Chat & AI',\r\n          value: 'DM the bot or mention it to chat!\\nSupports OpenAI and local models.',\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üìö More Info',\r\n          value: 'Use `/help category:rpg`, `/help category:admin`, `/help category:games`, or `/help category:utility` for more details',\r\n          inline: true\r\n        }\r\n      );\n    }"}}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":13,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder } from 'discord.js';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { pathToFileURL } from 'url';\r\n\r\nasync function getAllCommands() {\r\n  const commandsPath = path.join(process.cwd(), 'src', 'commands');\r\n  const commands = [];\r\n\r\n  if (fs.existsSync(commandsPath)) {\r\n    for (const file of fs.readdirSync(commandsPath)) {\r\n      if (file.endsWith('.js')) {\r\n        try {\r\n          const filePath = path.join(commandsPath, file);\r\n          const moduleUrl = pathToFileURL(filePath).href;\r\n          const command = await import(moduleUrl);\r\n          if (command.data && command.data.name) {\r\n            commands.push(command.data);\r\n          }\r\n        } catch (error) {\r\n          console.error(`Failed to load command ${file}:`, error);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return commands;\r\n}\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('help')\r\n  .setDescription('Shows comprehensive help about all bot features')\r\n  .addStringOption(option =>\r\n    option.setName('category')\r\n      .setDescription('Specific category to show help for')\r\n      .addChoices(\r\n        { name: 'All Commands', value: 'all' },\r\n        { name: 'RPG System', value: 'rpg' },\r\n        { name: 'Minigames', value: 'games' },\r\n        { name: 'Utility', value: 'utility' },\r\n        { name: 'Chat & AI', value: 'chat' },\r\n        { name: 'Admin & Moderation', value: 'admin' }\r\n      ));\r\n\r\nexport async function execute(interaction) {\r\n  const category = interaction.options.getString('category') || 'all';\r\n  const commands = await getAllCommands();\r\n\r\n  // Organize commands by category\r\n  const commandCategories = {\r\n    rpg: [],\r\n    games: [],\r\n    utility: [],\r\n    chat: [],\r\n    admin: []\r\n  };\r\n\r\n  for (const cmd of commands) {\r\n    const name = cmd.name;\r\n    const description = cmd.description || 'No description available';\r\n\r\n    if (name === 'rpg') commandCategories.rpg.push(`\\`/${name}\\` - ${description}`);\r\n    else if (['8ball', 'roll', 'rps', 'minigame', 'novel', 'connect4', 'guess', 'hangman', 'memory', 'tictactoe', 'trivia', 'wordle', 'fun', 'coinflip'].includes(name)) commandCategories.games.push(`\\`/${name}\\` - ${description}`);\r\n    else if (['ping', 'echo', 'help', 'setmodel', 'togglechat', 'toggleplay', 'remind', 'poll', 'weather', 'music', 'profile'].includes(name)) commandCategories.utility.push(`\\`/${name}\\` - ${description}`);\r\n    else if (['chat', 'ai', 'api'].includes(name)) commandCategories.chat.push(`\\`/${name}\\` - ${description}`);\r\n    else if (['admin', 'guild', 'achievements', 'economy', 'inventory', 'trade', 'explore'].includes(name)) commandCategories.admin.push(`\\`/${name}\\` - ${description}`);\r\n    else commandCategories.utility.push(`\\`/${name}\\` - ${description}`);\r\n  }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle('ü§ñ Discord Bot Help')\r\n    .setColor(0x0099FF)\r\n    .setTimestamp();\r\n\r\n  switch (category) {\r\n    case 'rpg':\r\n      embed.setDescription('**RPG System Commands**\\n\\n' + commandCategories.rpg.join('\\n'));\r\n      embed.addFields({\r\n        name: 'RPG Features',\r\n        value: '‚Ä¢ Character creation and leveling\\n‚Ä¢ Combat system with monsters\\n‚Ä¢ Exploration and random events\\n‚Ä¢ Quest system\\n‚Ä¢ Skill point allocation\\n‚Ä¢ Leaderboards and statistics',\r\n        inline: false\r\n      });\r\n      break;\r\n\r\n    case 'games':\r\n      embed.setDescription('**Minigame Commands**\\n\\n' + commandCategories.games.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Available Games',\r\n        value: '‚Ä¢ **8ball**: Magic 8-ball for questions\\n‚Ä¢ **roll**: Dice rolling (e.g., 2d6, 1d20)\\n‚Ä¢ **rps**: Rock Paper Scissors\\n‚Ä¢ **minigame**: Interactive typing challenges\\n‚Ä¢ **novel**: AI-generated story creation',\r\n        inline: false\r\n      });\r\n      break;\r\n\r\n    case 'utility':\r\n      embed.setDescription('**Utility Commands**\\n\\n' + commandCategories.utility.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Utility Features',\r\n        value: '‚Ä¢ **ping**: Check bot latency\\n‚Ä¢ **echo**: Repeat messages\\n‚Ä¢ **setmodel**: Configure AI models per server\\n‚Ä¢ **togglechat**: Enable/disable chat responses\\n‚Ä¢ **toggleplay**: Enable/disable playful responses',\r\n        inline: false\r\n      });\r\n      break;\r\n\r\n    case 'chat':\r\n      embed.setDescription('**Chat & AI Features**\\n\\n' + commandCategories.chat.join('\\n'));\r\n      embed.addFields({\r\n        name: 'AI Integration',\r\n        value: '‚Ä¢ DM the bot or mention it to start chatting\\n‚Ä¢ Supports OpenAI GPT models\\n‚Ä¢ Compatible with local AI models\\n‚Ä¢ Conversation history and context\\n‚Ä¢ Type `!clear` to reset conversation\\n‚Ä¢ Configurable per-server AI settings',\r\n        inline: false\r\n      });\r\n      break;\r\n\r\n    case 'admin':\r\n      embed.setDescription('**Admin & Moderation Commands**\\n\\n' + commandCategories.admin.join('\\n'));\r\n      embed.addFields({\r\n        name: 'Admin Features',\r\n        value: '‚Ä¢ **admin**: Server administration tools\\n‚Ä¢ **guild**: Guild management\\n‚Ä¢ **achievements**: Achievement system\\n‚Ä¢ **economy**: Currency and trading\\n‚Ä¢ **inventory**: Player items\\n‚Ä¢ **trade**: Marketplace system\\n‚Ä¢ **explore**: Adventure system',\r\n        inline: false\r\n      });\r\n      break;\r\n\r\n    default:\r\n      embed.setDescription('**All Available Commands**\\n\\n' +\r\n        'üèÜ **RPG System**\\n' + commandCategories.rpg.join('\\n') + '\\n\\n' +\r\n        'üõ°Ô∏è **Admin & Moderation**\\n' + commandCategories.admin.join('\\n') + '\\n\\n' +\r\n        'üéÆ **Games & Fun**\\n' + commandCategories.games.join('\\n') + '\\n\\n' +\r\n        'üîß **Utilities**\\n' + commandCategories.utility.join('\\n'));\r\n\r\n      embed.addFields(\r\n        {\r\n          name: 'üí¨ Chat & AI',\r\n          value: 'DM the bot or mention it to chat!\\nSupports OpenAI and local models.',\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üìö More Info',\r\n          value: 'Use `/help category:rpg`, `/help category:admin`, `/help category:games`, or `/help category:utility` for more details',\r\n          inline: true\r\n        }\r\n      );\r\n  }\r\n\r\n  await interaction.reply({ embeds: [embed], ephemeral: true });\r\n}\r\n\r\nexport { getAllCommands };\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\inventory.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'equipItem' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'unequipItem' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'generateRandomItem' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":21},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (185). Maximum allowed is 100.","line":26,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":210,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (96). Maximum allowed is 30.","line":26,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":210,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 48. Maximum allowed is 20.","line":26,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":210,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 83 to the 15 allowed.","line":26,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":26,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":36,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":36,"endColumn":25,"fix":{"range":[1526,8274],"text":"switch (sub) {\n    case 'view': {\r\n      const inventory = getInventory(userId);\r\n      const inventoryValue = getInventoryValue(userId);\r\n\r\n      if (!inventory || Object.keys(inventory).length === 0) {\r\n        return interaction.reply({ content: 'üõÑ Your inventory is empty. Go explore to find items!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    // Group items by type\r\n    const itemsByType = {};\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item) {\r\n        if (!itemsByType[item.type]) itemsByType[item.type] = [];\r\n        itemsByType[item.type].push({ itemId, ...item, quantity });\r\n      }\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üõÑ ${interaction.user.username}'s Inventory`)\r\n      .setColor(0x0099FF)\r\n      .setDescription(`üí∞ Total Value: ${inventoryValue} gold`);\r\n\r\n    // Add equipped items section\r\n    const character = getCharacter(userId);\r\n    if (character && (character.equipped?.weapon || character.equipped?.armor)) {\r\n      const equippedItems = [];\r\n      if (character.equipped.weapon) {\r\n        const weapon = getItemInfo(character.equipped.weapon);\r\n        if (weapon) equippedItems.push(`‚öîÔ∏è ${weapon.name}`);\r\n      }\r\n      if (character.equipped.armor) {\r\n        const armor = getItemInfo(character.equipped.armor);\r\n        if (armor) equippedItems.push(`üõ°Ô∏è ${armor.name}`);\r\n      }\r\n      embed.addFields({\r\n        name: '‚ö° Equipped',\r\n        value: equippedItems.join('\\n') || 'None',\r\n        inline: true\r\n      });\r\n    }\r\n\r\n    // Add buttons for inventory actions\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`inventory_refresh:${userId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`inventory_random:${userId}`).setLabel('üé≤ Get Random Item').setStyle(ButtonStyle.Secondary),\r\n      new ButtonBuilder().setCustomId(`inventory_sell_all:${userId}`).setLabel('üí∞ Sell All Junk').setStyle(ButtonStyle.Success)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    // Update embed with actual inventory data\r\n    await updateInventoryEmbed(interaction, itemsByType, inventoryValue);\r\n\r\n  \n    break;\n    }\n    case 'use': {\r\n    const itemName = interaction.options.getString('item');\r\n    const inventory = getInventory(userId);\r\n\r\n    // Find item by name\r\n    let targetItemId = null;\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item && item.name.toLowerCase() === itemName.toLowerCase()) {\r\n        targetItemId = itemId;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!targetItemId) {\r\n      return interaction.reply({ content: `‚ùå You don't have \"${itemName}\" in your inventory.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Validate item is consumable\r\n    const item = getItemInfo(targetItemId);\r\n    if (!item || item.type !== 'consumable') {\r\n      return interaction.reply({ content: `‚ùå \"${itemName}\" is not a consumable item.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const result = useConsumableItem(userId, targetItemId);\r\n    if (!result.success) {\r\n      return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    let response = `‚úÖ Used ${getItemInfo(targetItemId).name}!`;\r\n    if (result.effects.hp_restored) {\r\n      response += `\\n‚ù§Ô∏è Restored ${result.effects.hp_restored} HP`;\r\n    }\r\n    if (result.effects.revive) {\r\n      response += `\\nüîÆ You have been revived!`;\r\n    }\r\n\r\n    await interaction.reply({ content: response });\r\n  \n    break;\n    }\n    case 'equip': {\r\n    const itemName = interaction.options.getString('item');\r\n    const inventory = getInventory(userId);\r\n\r\n    // Find item by name\r\n    let targetItemId = null;\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item && item.name.toLowerCase() === itemName.toLowerCase()) {\r\n        targetItemId = itemId;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!targetItemId) {\r\n      return interaction.reply({ content: `‚ùå You don't have \"${itemName}\" in your inventory.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const item = getItemInfo(targetItemId);\r\n    if (item.type !== 'weapon' && item.type !== 'armor') {\r\n      return interaction.reply({ content: `‚ùå You can only equip weapons and armor, not ${item.type}s.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const character = getCharacter(userId);\r\n    if (!character) {\r\n      return interaction.reply({ content: '‚ùå You need a character first. Use `/rpg start` to create one.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const slot = item.type === 'weapon' ? 'weapon' : 'armor';\r\n\r\n    // Check if item is already equipped\r\n    if (character.equipped && character.equipped[slot] === targetItemId) {\r\n      return interaction.reply({ content: `‚ùå **${item.name}** is already equipped in the ${slot} slot.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Unequip current item in that slot if any\r\n    if (character.equipped && character.equipped[slot]) {\r\n      const currentItemId = character.equipped[slot];\r\n      const currentItem = getItemInfo(currentItemId);\r\n      if (currentItem) {\r\n        addItemToInventory(userId, currentItemId, 1);\r\n      }\r\n    }\r\n\r\n    // Equip new item\r\n    if (!character.equipped) character.equipped = {};\r\n    character.equipped[slot] = targetItemId;\r\n    removeItemFromInventory(userId, targetItemId, 1);\r\n    saveCharacter(userId, character);\r\n\r\n    await interaction.reply({ content: `‚úÖ Equipped **${item.name}** in ${slot} slot!` });\r\n  \n    break;\n    }\n    case 'unequip': {\r\n    const slot = interaction.options.getString('slot');\r\n\r\n    if (slot !== 'weapon' && slot !== 'armor') {\r\n      return interaction.reply({ content: '‚ùå Invalid slot. Use weapon or armor.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const character = getCharacter(userId);\r\n    if (!character) {\r\n      return interaction.reply({ content: '‚ùå You need a character first. Use `/rpg start` to create one.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    if (!character.equipped || !character.equipped[slot]) {\r\n      return interaction.reply({ content: `‚ùå You don't have anything equipped in the ${slot} slot.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const itemId = character.equipped[slot];\r\n    const item = getItemInfo(itemId);\r\n\r\n    // Add item back to inventory\r\n    addItemToInventory(userId, itemId, 1);\r\n\r\n    // Unequip item\r\n    character.equipped[slot] = null;\r\n    saveCharacter(userId, character);\r\n\r\n    await interaction.reply({ content: `‚úÖ Unequipped **${item.name}** from ${slot} slot!` });\r\n  \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":44,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":44,"endColumn":5,"fix":{"range":[1866,1870],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":45,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":45,"endColumn":5,"fix":{"range":[1894,1898],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":46,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":46,"endColumn":5,"fix":{"range":[1923,1927],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":47,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":47,"endColumn":7,"fix":{"range":[1990,1996],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":48,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":48,"endColumn":7,"fix":{"range":[2031,2037],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":49,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":49,"endColumn":9,"fix":{"range":[2050,2058],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":49,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":49,"endColumn":66},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":50,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":50,"endColumn":9,"fix":{"range":[2117,2125],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":51,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":51,"endColumn":7,"fix":{"range":[2186,2192],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":52,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":52,"endColumn":5,"fix":{"range":[2195,2199],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":5,"fix":{"range":[2204,2208],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":55,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":55,"endColumn":7,"fix":{"range":[2242,2248],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":56,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":56,"endColumn":7,"fix":{"range":[2306,2312],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":56,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":56,"endColumn":25,"fix":{"range":[2322,2330],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":57,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":57,"endColumn":7,"fix":{"range":[2333,2339],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":59,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[2401,2405],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":60,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":60,"endColumn":5,"fix":{"range":[2436,2440],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":61,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":61,"endColumn":5,"fix":{"range":[2481,2485],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":62,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":62,"endColumn":7,"fix":{"range":[2564,2570],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":63,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":63,"endColumn":7,"fix":{"range":[2597,2603],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":64,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":64,"endColumn":9,"fix":{"range":[2637,2645],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":65,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":65,"endColumn":9,"fix":{"range":[2701,2709],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":65,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":65,"endColumn":61},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":66,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":66,"endColumn":7,"fix":{"range":[2763,2769],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":67,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":67,"endColumn":7,"fix":{"range":[2772,2778],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":68,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":68,"endColumn":9,"fix":{"range":[2811,2819],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":69,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":69,"endColumn":9,"fix":{"range":[2873,2881],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":69,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":69,"endColumn":60},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":70,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":70,"endColumn":7,"fix":{"range":[2934,2940],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":71,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":71,"endColumn":7,"fix":{"range":[2943,2949],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":72,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":72,"endColumn":9,"fix":{"range":[2968,2976],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":73,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":73,"endColumn":9,"fix":{"range":[2997,3005],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":9,"fix":{"range":[3049,3057],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":75,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":75,"endColumn":7,"fix":{"range":[3071,3077],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":76,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":76,"endColumn":5,"fix":{"range":[3082,3086],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":78,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":78,"endColumn":5,"fix":{"range":[3091,3095],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":79,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":79,"endColumn":5,"fix":{"range":[3133,3137],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":80,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":80,"endColumn":7,"fix":{"range":[3188,3194],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":81,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":81,"endColumn":7,"fix":{"range":[3312,3318],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":82,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":82,"endColumn":7,"fix":{"range":[3445,3451],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":83,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":83,"endColumn":5,"fix":{"range":[3575,3579],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":85,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":85,"endColumn":5,"fix":{"range":[3585,3589],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":87,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":87,"endColumn":5,"fix":{"range":[3657,3661],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":88,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":88,"endColumn":5,"fix":{"range":[3705,3709],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":90,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":90,"endColumn":3,"fix":{"range":[3782,3784],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":90,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":90,"endColumn":4,"fix":{"range":[3785,3785],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":91,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":91,"endColumn":5,"fix":{"range":[3813,3817],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":92,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":92,"endColumn":5,"fix":{"range":[3874,3878],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":94,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":94,"endColumn":5,"fix":{"range":[3921,3925],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":95,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":95,"endColumn":5,"fix":{"range":[3947,3951],"text":"      "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":95,"column":24,"nodeType":"Literal","messageId":"error","endLine":95,"endColumn":28,"suggestions":[{"messageId":"remove","fix":{"range":[3967,3974],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[3970,3974],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":96,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":96,"endColumn":5,"fix":{"range":[3977,3981],"text":"      "}},{"ruleId":"no-unused-vars","severity":1,"message":"'quantity' is assigned a value but never used.","line":96,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":33},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":97,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":97,"endColumn":7,"fix":{"range":[4044,4050],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":98,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":98,"endColumn":7,"fix":{"range":[4085,4091],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":99,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":99,"endColumn":9,"fix":{"range":[4158,4166],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":100,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":100,"endColumn":9,"fix":{"range":[4190,4198],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":101,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":101,"endColumn":7,"fix":{"range":[4206,4212],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":102,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":102,"endColumn":5,"fix":{"range":[4215,4219],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":104,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":104,"endColumn":5,"fix":{"range":[4224,4228],"text":"      "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":105,"column":1,"nodeType":"Program","messageId":"max","endLine":105,"endColumn":129},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":105,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":105,"endColumn":7,"fix":{"range":[4250,4256],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":106,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":106,"endColumn":5,"fix":{"range":[4380,4384],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":108,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":108,"endColumn":5,"fix":{"range":[4389,4393],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":5,"fix":{"range":[4425,4429],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":110,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":110,"endColumn":5,"fix":{"range":[4470,4474],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":111,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":111,"endColumn":7,"fix":{"range":[4518,4524],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":112,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":112,"endColumn":5,"fix":{"range":[4640,4644],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":114,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":114,"endColumn":5,"fix":{"range":[4649,4653],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":115,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":115,"endColumn":5,"fix":{"range":[4710,4714],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":116,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":116,"endColumn":7,"fix":{"range":[4738,4744],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":5,"fix":{"range":[4837,4841],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":119,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":119,"endColumn":5,"fix":{"range":[4846,4850],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":120,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":120,"endColumn":5,"fix":{"range":[4911,4915],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":121,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":121,"endColumn":7,"fix":{"range":[4950,4956],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":122,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":122,"endColumn":5,"fix":{"range":[5019,5023],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":123,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":123,"endColumn":5,"fix":{"range":[5026,5030],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":124,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":124,"endColumn":7,"fix":{"range":[5060,5066],"text":"        "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":124,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":124,"endColumn":48,"fix":{"range":[5078,5107],"text":"'\\nüîÆ You have been revived!'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":125,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":125,"endColumn":5,"fix":{"range":[5110,5114],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":127,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":127,"endColumn":5,"fix":{"range":[5119,5123],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":128,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":128,"endColumn":3,"fix":{"range":[5172,5174],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":128,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":128,"endColumn":4,"fix":{"range":[5175,5175],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":129,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":129,"endColumn":5,"fix":{"range":[5205,5209],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":130,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":130,"endColumn":5,"fix":{"range":[5266,5270],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":132,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":132,"endColumn":5,"fix":{"range":[5313,5317],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":133,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":133,"endColumn":5,"fix":{"range":[5339,5343],"text":"      "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":133,"column":24,"nodeType":"Literal","messageId":"error","endLine":133,"endColumn":28,"suggestions":[{"messageId":"remove","fix":{"range":[5359,5366],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[5362,5366],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":134,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":134,"endColumn":5,"fix":{"range":[5369,5373],"text":"      "}},{"ruleId":"no-unused-vars","severity":1,"message":"'quantity' is assigned a value but never used.","line":134,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":134,"endColumn":33},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":135,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":135,"endColumn":7,"fix":{"range":[5436,5442],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":136,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":136,"endColumn":7,"fix":{"range":[5477,5483],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":137,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":137,"endColumn":9,"fix":{"range":[5550,5558],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":138,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":138,"endColumn":9,"fix":{"range":[5582,5590],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":139,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":139,"endColumn":7,"fix":{"range":[5598,5604],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":140,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":140,"endColumn":5,"fix":{"range":[5607,5611],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":142,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":142,"endColumn":5,"fix":{"range":[5616,5620],"text":"      "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":143,"column":1,"nodeType":"Program","messageId":"max","endLine":143,"endColumn":129},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":143,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":143,"endColumn":7,"fix":{"range":[5642,5648],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":144,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":144,"endColumn":5,"fix":{"range":[5772,5776],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":146,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":146,"endColumn":5,"fix":{"range":[5781,5785],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":147,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":147,"endColumn":5,"fix":{"range":[5826,5830],"text":"      "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 137. Maximum allowed is 120.","line":148,"column":1,"nodeType":"Program","messageId":"max","endLine":148,"endColumn":138},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":148,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":148,"endColumn":7,"fix":{"range":[5886,5892],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":149,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":149,"endColumn":5,"fix":{"range":[6025,6029],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":151,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":151,"endColumn":5,"fix":{"range":[6034,6038],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":5,"fix":{"range":[6079,6083],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":153,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":153,"endColumn":7,"fix":{"range":[6102,6108],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":154,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":154,"endColumn":5,"fix":{"range":[6244,6248],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":156,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":156,"endColumn":5,"fix":{"range":[6253,6257],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":158,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":158,"endColumn":5,"fix":{"range":[6318,6322],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":159,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":159,"endColumn":5,"fix":{"range":[6360,6364],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":159,"column":31,"nodeType":"MemberExpression","endLine":159,"endColumn":55},{"ruleId":"max-len","severity":2,"message":"This line has a length of 138. Maximum allowed is 120.","line":160,"column":1,"nodeType":"Program","messageId":"max","endLine":160,"endColumn":139},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":160,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":160,"endColumn":7,"fix":{"range":[6436,6442],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":161,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":161,"endColumn":5,"fix":{"range":[6576,6580],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":163,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":163,"endColumn":5,"fix":{"range":[6585,6589],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":164,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":164,"endColumn":5,"fix":{"range":[6634,6638],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":164,"column":31,"nodeType":"MemberExpression","endLine":164,"endColumn":55},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":165,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":165,"endColumn":7,"fix":{"range":[6693,6699],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":165,"column":29,"nodeType":"MemberExpression","endLine":165,"endColumn":53},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[6748,6754],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":167,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":167,"endColumn":7,"fix":{"range":[6803,6809],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":168,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":168,"endColumn":9,"fix":{"range":[6829,6837],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":169,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":169,"endColumn":7,"fix":{"range":[6884,6890],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":170,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":170,"endColumn":5,"fix":{"range":[6893,6897],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":172,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":172,"endColumn":5,"fix":{"range":[6902,6906],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":173,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":173,"endColumn":5,"fix":{"range":[6925,6929],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":174,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":174,"endColumn":5,"fix":{"range":[6980,6984],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":174,"column":5,"nodeType":"MemberExpression","endLine":174,"endColumn":29},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":175,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":175,"endColumn":5,"fix":{"range":[7026,7030],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":176,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":176,"endColumn":5,"fix":{"range":[7081,7085],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":178,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":178,"endColumn":5,"fix":{"range":[7122,7126],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":179,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":179,"endColumn":3,"fix":{"range":[7213,7215],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":179,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":179,"endColumn":4,"fix":{"range":[7216,7216],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":180,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":180,"endColumn":5,"fix":{"range":[7248,7252],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":182,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":182,"endColumn":5,"fix":{"range":[7307,7311],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":183,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":183,"endColumn":7,"fix":{"range":[7357,7363],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":184,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":184,"endColumn":5,"fix":{"range":[7474,7478],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":186,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":186,"endColumn":5,"fix":{"range":[7483,7487],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":187,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":187,"endColumn":5,"fix":{"range":[7528,7532],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":188,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":188,"endColumn":7,"fix":{"range":[7551,7557],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":189,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":189,"endColumn":5,"fix":{"range":[7693,7697],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":191,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":191,"endColumn":5,"fix":{"range":[7702,7706],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":33,"nodeType":"MemberExpression","endLine":191,"endColumn":57},{"ruleId":"max-len","severity":2,"message":"This line has a length of 134. Maximum allowed is 120.","line":192,"column":1,"nodeType":"Program","messageId":"max","endLine":192,"endColumn":135},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":192,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":192,"endColumn":7,"fix":{"range":[7763,7769],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":193,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":193,"endColumn":5,"fix":{"range":[7899,7903],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":195,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":195,"endColumn":5,"fix":{"range":[7908,7912],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":195,"column":20,"nodeType":"MemberExpression","endLine":195,"endColumn":44},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":196,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":196,"endColumn":5,"fix":{"range":[7954,7958],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":198,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":198,"endColumn":5,"fix":{"range":[7995,7999],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":199,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":199,"endColumn":5,"fix":{"range":[8030,8034],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":201,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":201,"endColumn":5,"fix":{"range":[8076,8080],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":202,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":202,"endColumn":5,"fix":{"range":[8097,8101],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":202,"column":5,"nodeType":"MemberExpression","endLine":202,"endColumn":29},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":202,"column":32,"nodeType":"Literal","messageId":"error","endLine":202,"endColumn":36,"suggestions":[{"messageId":"replace","fix":{"range":[8128,8132],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":5,"fix":{"range":[8135,8139],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":205,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":205,"endColumn":5,"fix":{"range":[8176,8180],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":206,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":206,"endColumn":3,"fix":{"range":[8271,8273],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":207,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":207,"endColumn":4,"fix":{"range":[8279,8279],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":220,"column":23,"nodeType":"MemberExpression","endLine":225,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'rarityInfo' is assigned a value but never used.","line":228,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":23}],"suppressedMessages":[],"errorCount":158,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":143,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport {\r\n  getInventory,\r\n  getItemInfo,\r\n  getItemRarityInfo,\r\n  useConsumableItem,\r\n  equipItem,\r\n  unequipItem,\r\n  getInventoryValue,\r\n  addItemToInventory,\r\n  generateRandomItem,\r\n  getCharacter,\r\n  saveCharacter,\r\n  removeItemFromInventory\r\n} from '../rpg.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('inventory')\r\n  .setDescription('Manage your RPG inventory and equipment')\r\n  .addSubcommand(sub => sub.setName('view').setDescription('View your inventory and equipment'))\r\n  .addSubcommand(sub => sub.setName('use').setDescription('Use a consumable item').addStringOption(opt => opt.setName('item').setDescription('Item to use').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('equip').setDescription('Equip a weapon or armor').addStringOption(opt => opt.setName('item').setDescription('Item to equip').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('unequip').setDescription('Unequip weapon or armor').addStringOption(opt => opt.setName('slot').setDescription('weapon|armor').setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    const sub = interaction.options.getSubcommand();\r\n    const userId = interaction.user.id;\r\n\r\n    // Input validation\r\n    if (!userId) {\r\n      throw new CommandError('Invalid user ID', 'VALIDATION_ERROR');\r\n    }\r\n\r\n    if (sub === 'view') {\r\n      const inventory = getInventory(userId);\r\n      const inventoryValue = getInventoryValue(userId);\r\n\r\n      if (!inventory || Object.keys(inventory).length === 0) {\r\n        return interaction.reply({ content: 'üõÑ Your inventory is empty. Go explore to find items!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    // Group items by type\r\n    const itemsByType = {};\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item) {\r\n        if (!itemsByType[item.type]) itemsByType[item.type] = [];\r\n        itemsByType[item.type].push({ itemId, ...item, quantity });\r\n      }\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üõÑ ${interaction.user.username}'s Inventory`)\r\n      .setColor(0x0099FF)\r\n      .setDescription(`üí∞ Total Value: ${inventoryValue} gold`);\r\n\r\n    // Add equipped items section\r\n    const character = getCharacter(userId);\r\n    if (character && (character.equipped?.weapon || character.equipped?.armor)) {\r\n      const equippedItems = [];\r\n      if (character.equipped.weapon) {\r\n        const weapon = getItemInfo(character.equipped.weapon);\r\n        if (weapon) equippedItems.push(`‚öîÔ∏è ${weapon.name}`);\r\n      }\r\n      if (character.equipped.armor) {\r\n        const armor = getItemInfo(character.equipped.armor);\r\n        if (armor) equippedItems.push(`üõ°Ô∏è ${armor.name}`);\r\n      }\r\n      embed.addFields({\r\n        name: '‚ö° Equipped',\r\n        value: equippedItems.join('\\n') || 'None',\r\n        inline: true\r\n      });\r\n    }\r\n\r\n    // Add buttons for inventory actions\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`inventory_refresh:${userId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`inventory_random:${userId}`).setLabel('üé≤ Get Random Item').setStyle(ButtonStyle.Secondary),\r\n      new ButtonBuilder().setCustomId(`inventory_sell_all:${userId}`).setLabel('üí∞ Sell All Junk').setStyle(ButtonStyle.Success)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    // Update embed with actual inventory data\r\n    await updateInventoryEmbed(interaction, itemsByType, inventoryValue);\r\n\r\n  } else if (sub === 'use') {\r\n    const itemName = interaction.options.getString('item');\r\n    const inventory = getInventory(userId);\r\n\r\n    // Find item by name\r\n    let targetItemId = null;\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item && item.name.toLowerCase() === itemName.toLowerCase()) {\r\n        targetItemId = itemId;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!targetItemId) {\r\n      return interaction.reply({ content: `‚ùå You don't have \"${itemName}\" in your inventory.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Validate item is consumable\r\n    const item = getItemInfo(targetItemId);\r\n    if (!item || item.type !== 'consumable') {\r\n      return interaction.reply({ content: `‚ùå \"${itemName}\" is not a consumable item.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const result = useConsumableItem(userId, targetItemId);\r\n    if (!result.success) {\r\n      return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    let response = `‚úÖ Used ${getItemInfo(targetItemId).name}!`;\r\n    if (result.effects.hp_restored) {\r\n      response += `\\n‚ù§Ô∏è Restored ${result.effects.hp_restored} HP`;\r\n    }\r\n    if (result.effects.revive) {\r\n      response += `\\nüîÆ You have been revived!`;\r\n    }\r\n\r\n    await interaction.reply({ content: response });\r\n  } else if (sub === 'equip') {\r\n    const itemName = interaction.options.getString('item');\r\n    const inventory = getInventory(userId);\r\n\r\n    // Find item by name\r\n    let targetItemId = null;\r\n    for (const [itemId, quantity] of Object.entries(inventory)) {\r\n      const item = getItemInfo(itemId);\r\n      if (item && item.name.toLowerCase() === itemName.toLowerCase()) {\r\n        targetItemId = itemId;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!targetItemId) {\r\n      return interaction.reply({ content: `‚ùå You don't have \"${itemName}\" in your inventory.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const item = getItemInfo(targetItemId);\r\n    if (item.type !== 'weapon' && item.type !== 'armor') {\r\n      return interaction.reply({ content: `‚ùå You can only equip weapons and armor, not ${item.type}s.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const character = getCharacter(userId);\r\n    if (!character) {\r\n      return interaction.reply({ content: '‚ùå You need a character first. Use `/rpg start` to create one.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const slot = item.type === 'weapon' ? 'weapon' : 'armor';\r\n\r\n    // Check if item is already equipped\r\n    if (character.equipped && character.equipped[slot] === targetItemId) {\r\n      return interaction.reply({ content: `‚ùå **${item.name}** is already equipped in the ${slot} slot.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Unequip current item in that slot if any\r\n    if (character.equipped && character.equipped[slot]) {\r\n      const currentItemId = character.equipped[slot];\r\n      const currentItem = getItemInfo(currentItemId);\r\n      if (currentItem) {\r\n        addItemToInventory(userId, currentItemId, 1);\r\n      }\r\n    }\r\n\r\n    // Equip new item\r\n    if (!character.equipped) character.equipped = {};\r\n    character.equipped[slot] = targetItemId;\r\n    removeItemFromInventory(userId, targetItemId, 1);\r\n    saveCharacter(userId, character);\r\n\r\n    await interaction.reply({ content: `‚úÖ Equipped **${item.name}** in ${slot} slot!` });\r\n  } else if (sub === 'unequip') {\r\n    const slot = interaction.options.getString('slot');\r\n\r\n    if (slot !== 'weapon' && slot !== 'armor') {\r\n      return interaction.reply({ content: '‚ùå Invalid slot. Use weapon or armor.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const character = getCharacter(userId);\r\n    if (!character) {\r\n      return interaction.reply({ content: '‚ùå You need a character first. Use `/rpg start` to create one.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    if (!character.equipped || !character.equipped[slot]) {\r\n      return interaction.reply({ content: `‚ùå You don't have anything equipped in the ${slot} slot.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const itemId = character.equipped[slot];\r\n    const item = getItemInfo(itemId);\r\n\r\n    // Add item back to inventory\r\n    addItemToInventory(userId, itemId, 1);\r\n\r\n    // Unequip item\r\n    character.equipped[slot] = null;\r\n    saveCharacter(userId, character);\r\n\r\n    await interaction.reply({ content: `‚úÖ Unequipped **${item.name}** from ${slot} slot!` });\r\n  }\r\n  } catch (error) {\r\n    return handleCommandError(interaction, error);\r\n  }\r\n}\r\n\r\n// Helper function to update inventory embed\r\nasync function updateInventoryEmbed(interaction, itemsByType, inventoryValue) {\r\n  const embed = EmbedBuilder.from(interaction.message.embeds[0])\r\n    .setDescription(`üí∞ Total Value: ${inventoryValue} gold`);\r\n\r\n  const fields = [];\r\n\r\n  for (const [type, items] of Object.entries(itemsByType)) {\r\n    const typeEmoji = {\r\n      weapon: '‚öîÔ∏è',\r\n      armor: 'üõ°Ô∏è',\r\n      consumable: 'üß™',\r\n      material: 'üî©'\r\n    }[type] || 'üì¶';\r\n\r\n    const itemList = items.map(item => {\r\n      const rarityInfo = getItemRarityInfo(item.rarity);\r\n      return `${typeEmoji} **${item.name}** (${item.quantity}x)`;\r\n    }).join('\\n');\r\n\r\n    fields.push({\r\n      name: `${typeEmoji} ${type.charAt(0).toUpperCase() + type.slice(1)}s`,\r\n      value: itemList || 'None',\r\n      inline: true\r\n    });\r\n  }\r\n\r\n  // Clear existing fields and add new ones\r\n  embed.setFields(fields);\r\n  await interaction.editReply({ embeds: [embed] });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\memory.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":25,"column":18,"nodeType":"MemberExpression","endLine":25,"endColumn":42},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'sendMemoryBoard' has too many lines (104). Maximum allowed is 100.","line":50,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":153,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'sendMemoryBoard' has too many statements (35). Maximum allowed is 30.","line":50,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":153,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'sendMemoryBoard' has a complexity of 21. Maximum allowed is 20.","line":50,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":153,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 25 to the 15 allowed.","line":50,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":50,"endColumn":31},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":58,"column":50,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":58,"endColumn":69,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.startTime","property":"startTime"},"fix":{"range":[1683,1869],"text":", startTime } = gameState;\r\n\r\n  // Check win condition\r\n  if (matchedPairs === totalPairs) {\r\n    gameState.gameActive = false;\r\n    const timeElapsed = Math.round((Date.now() - startTime"},"desc":"Replace `gameState.startTime` with destructured property `startTime`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 125. Maximum allowed is 120.","line":62,"column":1,"nodeType":"Program","messageId":"max","endLine":62,"endColumn":127},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":63,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":63,"endColumn":25,"fix":{"range":[2106,2114],"text":"0x00_FF_00"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 127. Maximum allowed is 120.","line":67,"column":1,"nodeType":"Program","messageId":"max","endLine":67,"endColumn":128},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":77,"column":5,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":81,"endColumn":6,"fix":{"range":[2505,2708],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [winEmbed], components: [] }) : interaction.reply({ embeds: [winEmbed] }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":79,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":79,"endColumn":6,"fix":{"range":[2638,2638],"text":"\n"}},{"ruleId":"no-trailing-spaces","severity":2,"message":"Trailing spaces not allowed.","line":82,"column":1,"nodeType":"Program","messageId":"trailingSpace","endLine":82,"endColumn":3,"fix":{"range":[2710,2712],"text":""}},{"ruleId":"no-trailing-spaces","severity":2,"message":"Trailing spaces not allowed.","line":86,"column":1,"nodeType":"Program","messageId":"trailingSpace","endLine":86,"endColumn":3,"fix":{"range":[2874,2876],"text":""}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":92,"column":62,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":92,"endColumn":82},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":93,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":93,"endColumn":23,"fix":{"range":[3125,3133],"text":"0x00_99_FF"}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":96,"column":20,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":96,"endColumn":40,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.totalPairs","property":"totalPairs"},"fix":{"range":[3217,3237],"text":"totalPairs"},"desc":"Replace `gameState.totalPairs` with destructured property `totalPairs`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":119,"column":20,"nodeType":"MemberExpression","endLine":119,"endColumn":28},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":123,"column":44,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":123,"endColumn":78,"fix":{"range":[4094,4128],"text":"(card.isFlipped ? card.emoji : 'üÇ†')"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":140,"column":3,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":144,"endColumn":4,"fix":{"range":[4641,4856],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [embed], components: buttons }) : interaction.reply({ embeds: [embed], components: buttons }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":142,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":142,"endColumn":4,"fix":{"range":[4772,4772],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'timeBonus' is assigned a value but never used.","line":157,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":157,"endColumn":18}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle } from 'discord.js';\r\n\r\nconst CARD_EMOJIS = ['üéÆ', 'üéØ', 'üé≤', 'üé™', 'üé®', 'üé≠', 'üé™', 'üé®', 'üé≠', 'üéØ', 'üé≤', 'üéÆ'];\r\nconst DIFFICULTIES = {\r\n  easy: { pairs: 6, timeLimit: 60 },\r\n  medium: { pairs: 8, timeLimit: 90 },\r\n  hard: { pairs: 12, timeLimit: 120 }\r\n};\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('memory')\r\n  .setDescription('Play a memory matching card game')\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('Game difficulty')\r\n      .addChoices(\r\n        { name: 'Easy (6 pairs)', value: 'easy' },\r\n        { name: 'Medium (8 pairs)', value: 'medium' },\r\n        { name: 'Hard (12 pairs)', value: 'hard' }\r\n      )\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n  const difficulty = interaction.options.getString('difficulty') || 'easy';\r\n  const config = DIFFICULTIES[difficulty];\r\n\r\n  // Create shuffled card deck\r\n  const gameCards = CARD_EMOJIS.slice(0, config.pairs * 2);\r\n  const shuffledCards = gameCards.sort(() => Math.random() - 0.5);\r\n\r\n  const gameState = {\r\n    cards: shuffledCards.map((emoji, index) => ({\r\n      id: index,\r\n      emoji,\r\n      isFlipped: false,\r\n      isMatched: false\r\n    })),\r\n    flippedCards: [],\r\n    matchedPairs: 0,\r\n    totalPairs: config.pairs,\r\n    moves: 0,\r\n    gameActive: true,\r\n    difficulty,\r\n    startTime: Date.now()\r\n  };\r\n\r\n  await sendMemoryBoard(interaction, gameState);\r\n}\r\n\r\nasync function sendMemoryBoard(interaction, gameState) {\r\n  if (!gameState.gameActive) return;\r\n\r\n  const { cards, flippedCards, matchedPairs, totalPairs, moves } = gameState;\r\n\r\n  // Check win condition\r\n  if (matchedPairs === totalPairs) {\r\n    gameState.gameActive = false;\r\n    const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n    const winEmbed = new EmbedBuilder()\r\n      .setTitle('üéâ Memory Master!')\r\n      .setDescription(`Congratulations! You matched all ${totalPairs} pairs in ${moves} moves and ${timeElapsed} seconds! üèÜ`)\r\n      .setColor(0x00FF00)\r\n      .addFields(\r\n        {\r\n          name: 'üìä Stats',\r\n          value: `**Moves:** ${moves}\\n**Time:** ${timeElapsed}s\\n**Efficiency:** ${((totalPairs / moves) * 100).toFixed(1)}%`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üèÜ Rating',\r\n          value: getPerformanceRating(moves, totalPairs, timeElapsed),\r\n          inline: true\r\n        }\r\n      );\r\n\r\n    if (interaction.replied || interaction.deferred) {\r\n      await interaction.editReply({ embeds: [winEmbed], components: [] });\r\n    } else {\r\n      await interaction.reply({ embeds: [winEmbed] });\r\n    }\r\n  \r\n    // Clean up game state\r\n    const { memoryGames } = await import('../game-states.js');\r\n    memoryGames.delete(interaction.message?.id || interaction.id);\r\n  \r\n    return;\r\n  }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle(`üß† Memory Game - ${matchedPairs}/${totalPairs} Pairs Found`)\r\n    .setDescription(`**Moves:** ${moves} | **Difficulty:** ${gameState.difficulty.toUpperCase()}`)\r\n    .setColor(0x0099FF);\r\n\r\n  // Create card grid (4x3 for easy, 4x4 for medium/hard)\r\n  const gridSize = gameState.totalPairs <= 6 ? 3 : 4;\r\n  let cardGrid = '';\r\n\r\n  for (let i = 0; i < cards.length; i += gridSize) {\r\n    const row = cards.slice(i, i + gridSize).map(card => {\r\n      if (card.isMatched) return '‚úÖ';\r\n      if (card.isFlipped || flippedCards.includes(card.id)) return card.emoji;\r\n      return 'üÇ†'; // Face down card\r\n    }).join(' ');\r\n    cardGrid += row + '\\n';\r\n  }\r\n\r\n  embed.addFields({\r\n    name: 'Cards',\r\n    value: cardGrid || 'No cards',\r\n    inline: false\r\n  });\r\n\r\n  // Create buttons for card grid\r\n  const buttons = [];\r\n  for (let i = 0; i < cards.length; i += gridSize) {\r\n    const row = new ActionRowBuilder();\r\n    for (let j = i; j < i + gridSize && j < cards.length; j++) {\r\n      const card = cards[j];\r\n      row.addComponents(\r\n        new ButtonBuilder()\r\n          .setCustomId(`memory_${j}`)\r\n          .setLabel(card.isMatched ? '‚úÖ' : card.isFlipped ? card.emoji : 'üÇ†')\r\n          .setStyle(card.isMatched ? ButtonStyle.Success : ButtonStyle.Primary)\r\n          .setDisabled(card.isMatched || flippedCards.includes(j))\r\n      );\r\n    }\r\n    buttons.push(row);\r\n  }\r\n\r\n  // Add reset button if there are flipped cards\r\n  if (flippedCards.length > 0) {\r\n    buttons.push(\r\n      new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`memory_reset:${interaction.user.id}`).setLabel('üîÑ Reset Flips').setStyle(ButtonStyle.Secondary)\r\n      )\r\n    );\r\n  }\r\n\r\n  if (interaction.replied || interaction.deferred) {\r\n    await interaction.editReply({ embeds: [embed], components: buttons });\r\n  } else {\r\n    await interaction.reply({ embeds: [embed], components: buttons });\r\n  }\r\n\r\n  // Store game state after reply (if not already stored)\r\n  const messageId = interaction.message?.id || interaction.id;\r\n  const { memoryGames } = await import('../game-states.js');\r\n\r\n  if (!memoryGames.has(messageId)) {\r\n    memoryGames.set(messageId, gameState);\r\n  }\r\n}\r\n\r\nfunction getPerformanceRating(moves, pairs, time) {\r\n  const efficiency = (pairs / moves) * 100;\r\n  const timeBonus = Math.max(0, 100 - time);\r\n\r\n  if (efficiency >= 70 && time <= 60) return 'üåü Perfect!';\r\n  if (efficiency >= 60 && time <= 90) return '‚≠ê Excellent!';\r\n  if (efficiency >= 50) return 'ü•á Good Job!';\r\n  if (efficiency >= 40) return 'ü•à Not Bad!';\r\n  return 'üìà Keep Practicing!';\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\minigame.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[63,63],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'checkTypingAttempt' is defined but never used.","line":2,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":45},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (102). Maximum allowed is 100.","line":17,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":118,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (45). Maximum allowed is 30.","line":17,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":118,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 22. Maximum allowed is 20.","line":17,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":118,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 37 to the 15 allowed.","line":17,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":17,"endColumn":30},{"ruleId":"max-len","severity":2,"message":"This line has a length of 124. Maximum allowed is 120.","line":36,"column":1,"nodeType":"Program","messageId":"max","endLine":36,"endColumn":125},{"ruleId":"max-len","severity":2,"message":"This line has a length of 150. Maximum allowed is 120.","line":39,"column":1,"nodeType":"Program","messageId":"max","endLine":39,"endColumn":152},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":83,"column":11,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":94,"endColumn":12},{"ruleId":"unicorn/prefer-at","severity":2,"message":"Prefer `.at(‚Ä¶)` over `[‚Ä¶.length - index]`.","line":84,"column":41,"nodeType":"BinaryExpression","messageId":"negative-index","endLine":84,"endColumn":66,"fix":{"range":[3355,3382],"text":".at(-1)"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/[.?!]\\s+/ can be optimized to /[!.?]\\s+/.","line":85,"column":42,"nodeType":"Literal","messageId":"better-regex","endLine":85,"endColumn":52,"fix":{"range":[3431,3441],"text":"/[!.?]\\s+/"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":86,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":88,"endColumn":14},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":89,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":89,"endColumn":12,"fix":{"range":[3618,3618],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":95,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":95,"endColumn":10,"fix":{"range":[3816,3816],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":95,"column":18,"nodeType":"Identifier","messageId":"catch-error-name","endLine":95,"endColumn":21,"fix":{"range":[3824,3895],"text":"error) {\r\n          console.error('Failed to load novel for typing:', error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":96,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":96,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3842,3897],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":115,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":115,"endColumn":4,"fix":{"range":[4580,4580],"text":"\n"}}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, MessageFlags } from 'discord.js';\r\nimport { startTypingGame, checkTypingAttempt } from '../minigames/typing.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\n\r\nconst sessions = new Map(); // In-memory storage for game sessions\r\n\r\n// Constants for game configuration\r\nconst GUESS_GAME_RANGE = { min: 1, max: 100 };\r\nconst TYPING_GAME_DURATION = 6000; // 6 seconds in milliseconds\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('minigame')\r\n  .setDescription('Play a quick minigame')\r\n  .addSubcommand(sub => sub.setName('guess').setDescription('Start or guess the number').addIntegerOption(opt => opt.setName('number').setDescription('Your guess').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('type').setDescription('Start a typing challenge').addStringOption(opt => opt.setName('novel').setDescription('Novel ID to source sentence from')));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    const sub = interaction.options.getSubcommand();\r\n    const user = interaction.user.id;\r\n\r\n    // Input validation\r\n    if (!user) {\r\n      throw new CommandError('Invalid user ID', 'VALIDATION_ERROR');\r\n    }\r\n\r\n    if (sub === 'guess') {\r\n      const guess = interaction.options.getInteger('number');\r\n\r\n      // Check if user has an active game\r\n      const hasActiveGame = sessions.has(user) && typeof sessions.get(user) === 'number';\r\n      const isFirstGuess = !sessions.has(user) || typeof sessions.get(user) === 'object';\r\n\r\n      if (isFirstGuess) {\r\n        // Start new game\r\n        const target = Math.floor(Math.random() * (GUESS_GAME_RANGE.max - GUESS_GAME_RANGE.min + 1)) + GUESS_GAME_RANGE.min;\r\n        sessions.set(user, target);\r\n        return interaction.reply({\r\n          content: `üéØ I have picked a number between ${GUESS_GAME_RANGE.min} and ${GUESS_GAME_RANGE.max}. Try \\`/minigame guess <number>\\` to guess!`,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (hasActiveGame) {\r\n        const target = sessions.get(user);\r\n\r\n        if (!guess) {\r\n          return interaction.reply({\r\n            content: '‚ùå You need to provide a number to guess.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        // Validate guess range\r\n        if (guess < GUESS_GAME_RANGE.min || guess > GUESS_GAME_RANGE.max) {\r\n          return interaction.reply({\r\n            content: `‚ùå Please guess a number between ${GUESS_GAME_RANGE.min} and ${GUESS_GAME_RANGE.max}.`,\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n\r\n        if (guess === target) {\r\n          sessions.delete(user);\r\n          return interaction.reply(`üéâ ${interaction.user.username}, correct! You guessed ${target}!`);\r\n        }\r\n\r\n        const hint = guess < target ? 'higher' : 'lower';\r\n        return interaction.reply({\r\n          content: `‚ùå Nope ‚Äî try ${hint}.`,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n    if (sub === 'type') {\r\n      const novelId = interaction.options.getString('novel');\r\n      let sentence;\r\n\r\n      if (novelId) {\r\n        try {\r\n          const { getNovel } = await import('../novel.js');\r\n          const novel = getNovel(novelId);\r\n          if (novel && novel.chapters && novel.chapters.length > 0) {\r\n            const text = novel.chapters[novel.chapters.length - 1].text;\r\n            const sentences = text.split(/[.?!]\\s+/).filter(Boolean);\r\n            if (sentences.length > 0) {\r\n              sentence = sentences[Math.floor(Math.random() * sentences.length)].trim();\r\n            }\r\n          } else {\r\n            return interaction.reply({\r\n              content: '‚ùå Novel not found or has no chapters.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n        } catch (err) {\r\n          console.error('Failed to load novel for typing:', err);\r\n          return interaction.reply({\r\n            content: '‚ùå Failed to load novel data.',\r\n            flags: MessageFlags.Ephemeral\r\n          });\r\n        }\r\n      }\r\n\r\n      const gameData = startTypingGame(user, 6, sentence);\r\n      if (!gameData || !gameData.sentence) {\r\n        throw new CommandError('Failed to start typing game', 'GAME_ERROR');\r\n      }\r\n\r\n      sessions.set(user, { type: 'typing', sentence: gameData.sentence, endAt: Date.now() + TYPING_GAME_DURATION });\r\n      return interaction.reply({\r\n        content: `‚å®Ô∏è Type this exactly within ${TYPING_GAME_DURATION / 1000} seconds:\\n\\`${gameData.sentence}\\``,\r\n        ephemeral: false\r\n      });\r\n    }\r\n  } catch (error) {\r\n    return handleCommandError(interaction, error);\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\music.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'clearQueue' is defined but never used.","line":2,"column":135,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":145},{"ruleId":"no-unused-vars","severity":1,"message":"'getLoop' is defined but never used.","line":2,"column":162,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":169},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (594). Maximum allowed is 100.","line":33,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":626,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (201). Maximum allowed is 30.","line":33,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":626,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 93. Maximum allowed is 20.","line":33,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":626,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 135 to the 15 allowed.","line":33,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":33,"endColumn":30},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":35,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":35,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2800,2950],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":50,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":50,"endColumn":3,"fix":{"range":[3358,3360],"text":"    "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":50,"column":3,"nodeType":null,"messageId":"prefer-switch","endLine":50,"endColumn":23,"fix":{"range":[3360,29052],"text":"switch (sub) {\n  case 'play': {\r\n    const query = interaction.options.getString('query');\r\n\r\n    // Voice channel validation\r\n    const voiceChannel = interaction.member.voice?.channel;\r\n    if (!voiceChannel) {\r\n      return interaction.reply({\r\n        content: 'üéµ **You must be in a voice channel to play music!**',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Bot permissions\r\n    const botPermissions = voiceChannel.permissionsFor(interaction.guild.members.me);\r\n    if (!botPermissions.has('Connect') || !botPermissions.has('Speak')) {\r\n      return interaction.reply({\r\n        content: '‚ùå **I need \"Connect\" and \"Speak\" permissions in your voice channel.**',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Defer reply to prevent timeout (fixes \"Unknown interaction\" errors)\r\n    await interaction.deferReply();\r\n    logger.info('Deferred music play interaction', {\r\n      guildId: interaction.guild.id,\r\n      userId: interaction.user.id,\r\n      query: query.substring(0, 100), // Log first 100 chars for privacy\r\n      timestamp: new Date().toISOString()\r\n    });\r\n\r\n    try {\r\n      // Search for the song\r\n      const songs = await searchSongs(query, 1);\r\n      if (songs.length === 0) {\r\n        let noResultsMessage = '‚ùå **No results found for that query.**';\r\n\r\n        // Provide more specific messaging for URL queries\r\n        if (query.includes('spotify.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Spotify**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else if (query.includes('youtube.com') || query.includes('youtu.be')) {\r\n          noResultsMessage = '‚ùå **Video unavailable**\\n\\nüìπ The requested video is not available, private, or has been deleted.\\nüîç Try searching for the song title instead of using the direct URL.';\r\n        } else if (query.includes('deezer.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Deezer**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else {\r\n          noResultsMessage = '‚ùå **No results found**\\n\\nüîç No tracks found for your search query.\\nüí° Try different keywords or check the spelling.';\r\n        }\r\n\r\n        return interaction.reply({\r\n          content: noResultsMessage,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const song = songs[0];\r\n\r\n      // Play the song\r\n      const result = await play(interaction.guild.id, voiceChannel, song);\r\n      if (!result.success) {\r\n        let errorMessage = `‚ùå **Failed to play music**`;\r\n\r\n        // Provide specific error messages based on error type\r\n        switch (result.errorType) {\r\n          case 'validation_failed':\r\n            if (song.source === 'spotify') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Spotify**\\nThe requested track is no longer available or has no preview.`;\r\n            } else if (song.source === 'deezer') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Deezer**\\nThe requested track is no longer available or has no preview.`;\r\n            } else {\r\n              errorMessage += `\\n\\nüìπ **Video unavailable or deleted**\\nThe requested video is no longer available on YouTube.`;\r\n            }\r\n            break;\r\n          case 'stream_creation':\r\n            errorMessage += `\\n\\nüîä **Audio stream error**\\nThere was an issue creating the audio stream for this track.`;\r\n            break;\r\n          case 'connection_failed':\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\r\n          case 'skipped_to_next':\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Skipped to next song**\\nThe current song failed and has been skipped.`;\r\n            // Don't reply with error for this case, let the next song play\r\n            return;\r\n          case 'stopped':\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Playback stopped**\\nNo more songs in the queue.`;\r\n            break;\r\n          case 'no_preview':\r\n            errorMessage += `\\n\\nüéµ **No preview available**\\nThis Spotify track does not have a preview clip.`;\r\n            break;\r\n          case 'spotify_stream':\r\n            errorMessage += `\\n\\nüéµ **Spotify stream error**\\nFailed to play the preview clip.`;\r\n            break;\r\n          case 'deezer_stream':\r\n            errorMessage += `\\n\\nüéµ **Deezer stream error**\\nFailed to play the preview clip.`;\r\n            break;\r\n          default:\r\n            errorMessage += `: ${result.error}`;\r\n        }\r\n\r\n        return interaction.reply({\r\n          content: errorMessage,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Create success embed with detailed info\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéµ Now Playing')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${song.title}** by **${song.artist}**`)\r\n        .addFields(\r\n          { name: '‚è±Ô∏è Duration', value: song.duration, inline: true },\r\n          { name: 'üîä Volume', value: `${getMusicStats(interaction.guild.id).volume}%`, inline: true },\r\n          { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n        )\r\n        .setThumbnail(song.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n      if (song.source === 'spotify') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Spotify', inline: false });\r\n      } else if (song.source === 'deezer') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Deezer (Legacy)', inline: false });\r\n      } else if (song.source === 'youtube') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing full track from YouTube', inline: false });\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n        new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      console.log(`[MUSIC] Editing deferred reply for interaction: ${interaction.id} with success embed`);\r\n      logger.info('Music play command successful', {\r\n        guildId: interaction.guild.id,\r\n        userId: interaction.user.id,\r\n        songTitle: song.title,\r\n        songSource: song.source,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      await interaction.editReply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Play command error:', error);\r\n      logger.error('Music play command failed', {\r\n        guildId: interaction.guild.id,\r\n        userId: interaction.user.id,\r\n        query: query.substring(0, 100),\r\n        error: error.message,\r\n        stack: error.stack,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      // Check if interaction was already deferred\r\n      if (interaction.deferred) {\r\n        await interaction.editReply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          embeds: [],\r\n          components: []\r\n        });\r\n      } else {\r\n        await interaction.reply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'search': {\r\n    const query = interaction.options.getString('query');\r\n\r\n    try {\r\n      const results = await searchSongs(query, 5);\r\n      if (results.length === 0) {\r\n        let noResultsMessage = '‚ùå **No search results found**';\r\n\r\n        // Provide more specific messaging for URL queries\r\n        if (query.includes('spotify.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Spotify**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else if (query.includes('youtube.com') || query.includes('youtu.be')) {\r\n          noResultsMessage = '‚ùå **Video unavailable**\\n\\nüìπ The requested video is not available, private, or has been deleted.\\nüîç Try searching for the song title instead of using the direct URL.';\r\n        } else if (query.includes('deezer.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Deezer**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else {\r\n          noResultsMessage = '‚ùå **No search results found**\\n\\nüîç No tracks found for your search query.\\nüí° Try different keywords or check the spelling.';\r\n        }\r\n\r\n        return interaction.reply({ content: noResultsMessage, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üîç Search Results for \"${query}\"`)\r\n        .setColor(0x0099FF)\r\n        .setDescription('Click the buttons below to play songs!');\r\n\r\n      results.forEach((song, index) => {\r\n        embed.addFields({\r\n          name: `${index + 1}. ${song.title}`,\r\n          value: `üë§ ${song.artist} ‚Ä¢ ‚è±Ô∏è ${song.duration}`,\r\n          inline: false\r\n        });\r\n      });\r\n\r\n      // Create play buttons for each result\r\n      const rows = [];\r\n      for (let i = 0; i < results.length; i += 2) {\r\n        const row = new ActionRowBuilder();\r\n        for (let j = i; j < i + 2 && j < results.length; j++) {\r\n          row.addComponents(\r\n            new ButtonBuilder()\r\n              .setCustomId(`music_play:${j}:${query}`)\r\n              .setLabel(`Play ${j + 1}`)\r\n              .setStyle(ButtonStyle.Primary)\r\n          );\r\n        }\r\n        rows.push(row);\r\n      }\r\n\r\n      await interaction.reply({ embeds: [embed], components: rows });\r\n    } catch (error) {\r\n      console.error('Search command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to search songs.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'back': {\r\n    try {\r\n      const previousSong = back(interaction.guild.id);\r\n      if (previousSong) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚¨ÖÔ∏è Back to Previous Song')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`**Now Playing:** ${previousSong.title} by ${previousSong.artist}`)\r\n          .addFields(\r\n            { name: '‚è±Ô∏è Duration', value: previousSong.duration, inline: true },\r\n            { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n          )\r\n          .setThumbnail(previousSong.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_back:${interaction.guild.id}`).setLabel('‚¨ÖÔ∏è Back').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n          new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No previous song in history.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Back command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to go back.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'loop': {\r\n    const mode = interaction.options.getString('mode');\r\n\r\n    try {\r\n      setLoop(interaction.guild.id, mode);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ Loop Mode Set')\r\n        .setColor(0x9932CC)\r\n        .setDescription(`Loop mode set to **${mode.charAt(0).toUpperCase() + mode.slice(1)}**`);\r\n      await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      console.error('Loop command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to set loop mode.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'skip': {\r\n    try {\r\n      const nextSong = skip(interaction.guild.id);\r\n      if (nextSong) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚è≠Ô∏è Song Skipped')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`**Now Playing:** ${nextSong.title} by ${nextSong.artist}`)\r\n          .addFields(\r\n            { name: '‚è±Ô∏è Duration', value: nextSong.duration, inline: true },\r\n            { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n          )\r\n          .setThumbnail(nextSong.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n          new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No songs in queue to skip.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Skip command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to skip song.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'pause': {\r\n    try {\r\n      const success = pause(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚è∏Ô∏è Music Paused')\r\n          .setColor(0xFFFF00)\r\n          .setDescription('Music has been paused. Use `/music resume` to continue.');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Pause command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to pause music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'resume': {\r\n    try {\r\n      const success = resume(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚ñ∂Ô∏è Music Resumed')\r\n          .setColor(0x00FF00)\r\n          .setDescription('Music is now playing!');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No paused music to resume.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Resume command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to resume music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'stop': {\r\n    try {\r\n      const success = stop(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚èπÔ∏è Music Stopped')\r\n          .setColor(0xFF0000)\r\n          .setDescription('Music stopped and left voice channel.');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Stop command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to stop music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'queue': {\r\n    try {\r\n      const queue = getQueue(interaction.guild.id);\r\n      const stats = getMusicStats(interaction.guild.id);\r\n      const current = stats.currentlyPlaying;\r\n\r\n      let description = '';\r\n      if (current) {\r\n        description += `**Currently Playing:** ${current.title} by ${current.artist}\\n\\n`;\r\n      }\r\n      if (queue.length > 0) {\r\n        description += '**Queue:**\\n';\r\n        queue.slice(0, 10).forEach((song, index) => {\r\n          description += `${index + 1}. ${song.title} by ${song.artist}\\n`;\r\n        });\r\n        if (queue.length > 10) {\r\n          description += `... and ${queue.length - 10} more songs`;\r\n        }\r\n      } else {\r\n        description += 'Queue is empty.';\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìã Music Queue')\r\n        .setColor(0x0099FF)\r\n        .setDescription(description)\r\n        .addFields({\r\n          name: 'üìä Queue Info',\r\n          value: `**Total Songs:** ${stats.queueLength}\\n**Volume:** ${stats.volume}%`,\r\n          inline: true\r\n        });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_shuffle:${interaction.guild.id}`).setLabel('üîÄ Shuffle').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_clear:${interaction.guild.id}`).setLabel('üóëÔ∏è Clear Queue').setStyle(ButtonStyle.Danger)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Queue command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get queue.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'nowplaying': {\r\n    try {\r\n      const stats = getMusicStats(interaction.guild.id);\r\n      if (!stats.currentlyPlaying) {\r\n        return interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const current = stats.currentlyPlaying;\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéµ Now Playing')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${current.title}** by **${current.artist}**`)\r\n        .addFields(\r\n          { name: '‚è±Ô∏è Progress', value: `${Math.floor(current.progress / 1000)}s / ${current.duration}`, inline: true },\r\n          { name: 'üîä Volume', value: `${stats.volume}%`, inline: true },\r\n          { name: 'üë§ Status', value: current.status, inline: true }\r\n        )\r\n        .setThumbnail(current.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n        new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Nowplaying command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get now playing info.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'shuffle': {\r\n    try {\r\n      const success = shuffleQueue(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîÄ Queue Shuffled')\r\n          .setColor(0x9932CC)\r\n          .setDescription('Music queue has been shuffled!');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå Queue is empty or too small to shuffle.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Shuffle command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to shuffle queue.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'volume': {\r\n    const volume = interaction.options.getInteger('level');\r\n\r\n    // Input validation\r\n    if (typeof volume !== 'number' || volume < 0 || volume > 200) {\r\n      return interaction.reply({\r\n        content: '‚ùå Volume must be a number between 0 and 200.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    try {\r\n      const success = setVolume(interaction.guild.id, volume);\r\n      if (!success) {\r\n        return interaction.reply({\r\n          content: '‚ùå No active music session to adjust volume.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîä Volume Changed')\r\n        .setColor(0x0099FF)\r\n        .setDescription(`Volume set to **${volume}%**`);\r\n      await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      console.error('Volume command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to set volume.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'lyrics': {\r\n    const songQuery = interaction.options.getString('song');\r\n\r\n    try {\r\n      // Split song and artist\r\n      const parts = songQuery.split(' by ');\r\n      const title = parts[0];\r\n      const artist = parts[1] || '';\r\n\r\n      const lyrics = await getLyrics(title, artist);\r\n      if (lyrics) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üìù Lyrics: ${lyrics.title}`)\r\n          .setColor(0x9932CC)\r\n          .setDescription(lyrics.lyrics.slice(0, 4000)) // Discord embed limit\r\n          .setFooter({ text: `Powered by ${lyrics.source}` });\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå Lyrics not found for that song.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Lyrics command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get lyrics.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'radio': {\r\n    const stationKey = interaction.options.getString('station');\r\n\r\n    try {\r\n      const stations = getRadioStations();\r\n      const station = stations[stationKey];\r\n\r\n      if (!station) {\r\n        return interaction.reply({ content: '‚ùå Invalid radio station.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Voice channel check\r\n      const voiceChannel = interaction.member.voice?.channel;\r\n      if (!voiceChannel) {\r\n        return interaction.reply({ content: 'üéµ You must be in a voice channel to play radio!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Create song object for radio\r\n      const song = {\r\n        title: station.name,\r\n        artist: station.genre,\r\n        duration: 'Live Stream',\r\n        url: station.url,\r\n        thumbnail: 'https://i.imgur.com/SjIgjlE.png',\r\n        requestedBy: interaction.user.username\r\n      };\r\n\r\n      // Play the radio\r\n      const result = await play(interaction.guild.id, voiceChannel, song);\r\n      if (!result.success) {\r\n        let errorMessage = `‚ùå **Failed to play radio**`;\r\n\r\n        // Provide specific error messages based on error type\r\n        switch (result.errorType) {\r\n          case 'validation_failed':\r\n            errorMessage += `\\n\\nüìª **Radio station unavailable**\\nThe radio station URL is not accessible.`;\r\n            break;\r\n          case 'stream_creation':\r\n            errorMessage += `\\n\\nüîä **Stream error**\\nThere was an issue connecting to the radio stream.`;\r\n            break;\r\n          case 'connection_failed':\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\r\n          case 'skipped_to_next':\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Stream failed**\\nThe radio station failed and playback has been stopped.`;\r\n            break;\r\n          case 'stopped':\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Radio stopped**\\nThe radio station is no longer available.`;\r\n            break;\r\n          default:\r\n            errorMessage += `: ${result.error}`;\r\n        }\r\n\r\n        return interaction.reply({ content: errorMessage, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üìª Now Playing: ${station.name}`)\r\n        .setColor(0xFF9800)\r\n        .setDescription(`**${station.name}** radio is now playing!\\n\\nüéµ *Live streaming activated*`)\r\n        .addFields(\r\n          { name: 'üìª Station', value: station.name, inline: true },\r\n          { name: 'üéµ Genre', value: station.genre, inline: true },\r\n          { name: 'üîä Quality', value: 'Live Stream', inline: true }\r\n        );\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_radio_change:${stationKey}`).setLabel('üîÑ Change Station').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop Radio').setStyle(ButtonStyle.Danger)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Radio command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to play radio.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  \n  break;\n  }\n  // No default\n  }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":51,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":51,"endColumn":5,"fix":{"range":[3383,3387],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":53,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":53,"endColumn":5,"fix":{"range":[3444,3448],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":5,"fix":{"range":[3477,3481],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":55,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":55,"endColumn":5,"fix":{"range":[3538,3542],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":56,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":56,"endColumn":7,"fix":{"range":[3564,3570],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":57,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":57,"endColumn":9,"fix":{"range":[3598,3606],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":58,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":58,"endColumn":9,"fix":{"range":[3672,3680],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":59,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":59,"endColumn":7,"fix":{"range":[3711,3717],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":60,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":60,"endColumn":5,"fix":{"range":[3722,3726],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":62,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":62,"endColumn":5,"fix":{"range":[3731,3735],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":63,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":63,"endColumn":5,"fix":{"range":[3755,3759],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":64,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":64,"endColumn":5,"fix":{"range":[3842,3846],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":65,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":65,"endColumn":7,"fix":{"range":[3917,3923],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":66,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":66,"endColumn":9,"fix":{"range":[3951,3959],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":67,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":67,"endColumn":9,"fix":{"range":[4042,4050],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":68,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":68,"endColumn":7,"fix":{"range":[4081,4087],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":69,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":69,"endColumn":5,"fix":{"range":[4092,4096],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":71,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":71,"endColumn":5,"fix":{"range":[4101,4105],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":72,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":72,"endColumn":5,"fix":{"range":[4177,4181],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":73,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":73,"endColumn":5,"fix":{"range":[4214,4218],"text":"      "}},{"ruleId":"no-undef","severity":2,"message":"'logger' is not defined.","line":73,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":73,"endColumn":11},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":7,"fix":{"range":[4268,4274],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":75,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":75,"endColumn":7,"fix":{"range":[4306,4312],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":76,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":76,"endColumn":7,"fix":{"range":[4342,4348],"text":"        "}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":76,"column":14,"nodeType":"CallExpression","messageId":"substring","endLine":76,"endColumn":37,"fix":{"range":[4361,4370],"text":"slice"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":77,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":77,"endColumn":7,"fix":{"range":[4416,4422],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":78,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":78,"endColumn":5,"fix":{"range":[4459,4463],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":80,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":80,"endColumn":5,"fix":{"range":[4470,4474],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":82,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":82,"endColumn":7,"fix":{"range":[4511,4517],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":83,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":83,"endColumn":7,"fix":{"range":[4561,4567],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":84,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":84,"endColumn":9,"fix":{"range":[4594,4602],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":86,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":86,"endColumn":9,"fix":{"range":[4670,4678],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":87,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":87,"endColumn":9,"fix":{"range":[4730,4738],"text":"          "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":87,"column":9,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":95,"endColumn":10},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":88,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":88,"endColumn":11,"fix":{"range":[4776,4786],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":89,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":89,"endColumn":9,"fix":{"range":[4952,4960],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":89,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":89,"endColumn":10,"fix":{"range":[4961,4961],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":90,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":90,"endColumn":11,"fix":{"range":[5035,5045],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":91,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":91,"endColumn":9,"fix":{"range":[5236,5244],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":91,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":91,"endColumn":10,"fix":{"range":[5245,5245],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":92,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":92,"endColumn":11,"fix":{"range":[5288,5298],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":93,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":93,"endColumn":9,"fix":{"range":[5463,5471],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":93,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":93,"endColumn":10,"fix":{"range":[5472,5472],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":94,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":94,"endColumn":11,"fix":{"range":[5481,5491],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":95,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":95,"endColumn":9,"fix":{"range":[5632,5640],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":97,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":97,"endColumn":9,"fix":{"range":[5645,5653],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":98,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":98,"endColumn":11,"fix":{"range":[5681,5691],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":99,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":99,"endColumn":11,"fix":{"range":[5719,5729],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":100,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":100,"endColumn":9,"fix":{"range":[5760,5768],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":101,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":101,"endColumn":7,"fix":{"range":[5773,5779],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":103,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":103,"endColumn":7,"fix":{"range":[5784,5790],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":105,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":105,"endColumn":7,"fix":{"range":[5816,5822],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":106,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":106,"endColumn":7,"fix":{"range":[5840,5846],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":107,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":107,"endColumn":7,"fix":{"range":[5916,5922],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":108,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":108,"endColumn":9,"fix":{"range":[5946,5954],"text":"          "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":108,"column":28,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":108,"endColumn":56,"fix":{"range":[5973,6001],"text":"'‚ùå **Failed to play music**'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":110,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":110,"endColumn":9,"fix":{"range":[6006,6014],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":111,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":111,"endColumn":9,"fix":{"range":[6070,6078],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":112,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":112,"endColumn":11,"fix":{"range":[6107,6117],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":112,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":112,"endColumn":36,"fix":{"range":[6142,6700],"text":" {\r\n            if (song.source === 'spotify') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Spotify**\\nThe requested track is no longer available or has no preview.`;\r\n            } else if (song.source === 'deezer') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Deezer**\\nThe requested track is no longer available or has no preview.`;\r\n            } else {\r\n              errorMessage += `\\n\\nüìπ **Video unavailable or deleted**\\nThe requested video is no longer available on YouTube.`;\r\n            }\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":113,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":113,"endColumn":13,"fix":{"range":[6144,6156],"text":"              "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 134. Maximum allowed is 120.","line":114,"column":1,"nodeType":"Program","messageId":"max","endLine":114,"endColumn":136},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":114,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":114,"endColumn":15,"fix":{"range":[6190,6204],"text":"                "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":114,"column":31,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":114,"endColumn":135,"fix":{"range":[6220,6324],"text":"'\\n\\nüéµ **Track unavailable on Spotify**\\nThe requested track is no longer available or has no preview.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":115,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":115,"endColumn":13,"fix":{"range":[6327,6339],"text":"              "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":115,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":115,"endColumn":14,"fix":{"range":[6340,6340],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 133. Maximum allowed is 120.","line":116,"column":1,"nodeType":"Program","messageId":"max","endLine":116,"endColumn":135},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":116,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":116,"endColumn":15,"fix":{"range":[6379,6393],"text":"                "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":116,"column":31,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":116,"endColumn":134,"fix":{"range":[6409,6512],"text":"'\\n\\nüéµ **Track unavailable on Deezer**\\nThe requested track is no longer available or has no preview.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":13,"fix":{"range":[6515,6527],"text":"              "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":117,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":117,"endColumn":14,"fix":{"range":[6528,6528],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 127. Maximum allowed is 120.","line":118,"column":1,"nodeType":"Program","messageId":"max","endLine":118,"endColumn":129},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":118,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":118,"endColumn":15,"fix":{"range":[6537,6551],"text":"                "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":118,"column":31,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":118,"endColumn":128,"fix":{"range":[6567,6664],"text":"'\\n\\nüìπ **Video unavailable or deleted**\\nThe requested video is no longer available on YouTube.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":119,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":119,"endColumn":13,"fix":{"range":[6667,6679],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":120,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":120,"endColumn":13,"fix":{"range":[6682,6694],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":121,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":121,"endColumn":11,"fix":{"range":[6702,6712],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":121,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":121,"endColumn":34,"fix":{"range":[6735,6879],"text":" {\r\n            errorMessage += `\\n\\nüîä **Audio stream error**\\nThere was an issue creating the audio stream for this track.`;\r\n            break;\n          }"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 121. Maximum allowed is 120.","line":122,"column":1,"nodeType":"Program","messageId":"max","endLine":122,"endColumn":123},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":122,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":122,"endColumn":13,"fix":{"range":[6737,6749],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":122,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":122,"endColumn":122,"fix":{"range":[6765,6858],"text":"'\\n\\nüîä **Audio stream error**\\nThere was an issue creating the audio stream for this track.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":123,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":123,"endColumn":13,"fix":{"range":[6861,6873],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":124,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":124,"endColumn":11,"fix":{"range":[6881,6891],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":124,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":124,"endColumn":36,"fix":{"range":[6916,7065],"text":" {\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\n          }"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 126. Maximum allowed is 120.","line":125,"column":1,"nodeType":"Program","messageId":"max","endLine":125,"endColumn":128},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":125,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":125,"endColumn":13,"fix":{"range":[6918,6930],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":125,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":125,"endColumn":127,"fix":{"range":[6946,7044],"text":"'\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":126,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":126,"endColumn":13,"fix":{"range":[7047,7059],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":127,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":127,"endColumn":11,"fix":{"range":[7067,7077],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":127,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":127,"endColumn":34,"fix":{"range":[7100,7309],"text":" {\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Skipped to next song**\\nThe current song failed and has been skipped.`;\r\n            // Don't reply with error for this case, let the next song play\r\n            return;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":128,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":128,"endColumn":13,"fix":{"range":[7102,7114],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":128,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":128,"endColumn":109,"fix":{"range":[7130,7210],"text":"'\\n\\n‚è≠Ô∏è **Skipped to next song**\\nThe current song failed and has been skipped.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":129,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":129,"endColumn":13,"fix":{"range":[7213,7225],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":130,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":130,"endColumn":13,"fix":{"range":[7290,7302],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":131,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":131,"endColumn":11,"fix":{"range":[7311,7321],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":131,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":131,"endColumn":26,"fix":{"range":[7336,7445],"text":" {\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Playback stopped**\\nNo more songs in the queue.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":132,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":132,"endColumn":13,"fix":{"range":[7338,7350],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":132,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":132,"endColumn":87,"fix":{"range":[7366,7424],"text":"'\\n\\n‚èπÔ∏è **Playback stopped**\\nNo more songs in the queue.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":133,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":133,"endColumn":13,"fix":{"range":[7427,7439],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":134,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":134,"endColumn":11,"fix":{"range":[7447,7457],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":134,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":134,"endColumn":29,"fix":{"range":[7475,7609],"text":" {\r\n            errorMessage += `\\n\\nüéµ **No preview available**\\nThis Spotify track does not have a preview clip.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":135,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":135,"endColumn":13,"fix":{"range":[7477,7489],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":135,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":135,"endColumn":112,"fix":{"range":[7505,7588],"text":"'\\n\\nüéµ **No preview available**\\nThis Spotify track does not have a preview clip.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":136,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":136,"endColumn":13,"fix":{"range":[7591,7603],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":137,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":137,"endColumn":11,"fix":{"range":[7611,7621],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":137,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":137,"endColumn":33,"fix":{"range":[7643,7761],"text":" {\r\n            errorMessage += `\\n\\nüéµ **Spotify stream error**\\nFailed to play the preview clip.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":138,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":138,"endColumn":13,"fix":{"range":[7645,7657],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":138,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":138,"endColumn":96,"fix":{"range":[7673,7740],"text":"'\\n\\nüéµ **Spotify stream error**\\nFailed to play the preview clip.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":139,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":139,"endColumn":13,"fix":{"range":[7743,7755],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":140,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":140,"endColumn":11,"fix":{"range":[7763,7773],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":140,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":140,"endColumn":32,"fix":{"range":[7794,7911],"text":" {\r\n            errorMessage += `\\n\\nüéµ **Deezer stream error**\\nFailed to play the preview clip.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":141,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":141,"endColumn":13,"fix":{"range":[7796,7808],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":141,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":141,"endColumn":95,"fix":{"range":[7824,7890],"text":"'\\n\\nüéµ **Deezer stream error**\\nFailed to play the preview clip.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":142,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":142,"endColumn":13,"fix":{"range":[7893,7905],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":143,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":143,"endColumn":11,"fix":{"range":[7913,7923],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":143,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":143,"endColumn":19,"fix":{"range":[7931,7981],"text":" {\r\n            errorMessage += `: ${result.error}`;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":144,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":144,"endColumn":13,"fix":{"range":[7933,7945],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":145,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":145,"endColumn":9,"fix":{"range":[7983,7991],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":147,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":147,"endColumn":9,"fix":{"range":[7996,8004],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":148,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":148,"endColumn":11,"fix":{"range":[8032,8042],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":149,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":149,"endColumn":11,"fix":{"range":[8066,8076],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":150,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":150,"endColumn":9,"fix":{"range":[8107,8115],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":151,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":151,"endColumn":7,"fix":{"range":[8120,8126],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":153,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":153,"endColumn":7,"fix":{"range":[8131,8137],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":154,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":154,"endColumn":7,"fix":{"range":[8181,8187],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":155,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":155,"endColumn":9,"fix":{"range":[8221,8229],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":156,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":156,"endColumn":9,"fix":{"range":[8258,8266],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":156,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":156,"endColumn":27,"fix":{"range":[8276,8284],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":157,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":157,"endColumn":9,"fix":{"range":[8287,8295],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":9,"fix":{"range":[8355,8363],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":11,"fix":{"range":[8376,8386],"text":"            "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":159,"column":19,"nodeType":"Literal","endLine":159,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":11,"fix":{"range":[8448,8458],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":161,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":161,"endColumn":11,"fix":{"range":[8553,8563],"text":"            "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":161,"column":19,"nodeType":"Literal","endLine":161,"endColumn":36},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":162,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":162,"endColumn":9,"fix":{"range":[8640,8648],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":163,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":163,"endColumn":9,"fix":{"range":[8651,8659],"text":"          "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 5 times.","line":163,"column":41,"nodeType":"Literal","endLine":163,"endColumn":74},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":165,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":165,"endColumn":7,"fix":{"range":[8730,8736],"text":"        "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":165,"column":7,"nodeType":null,"messageId":"prefer-switch","endLine":165,"endColumn":38,"fix":{"range":[8736,9204],"text":"switch (song.source) {\n      case 'spotify': {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Spotify', inline: false });\r\n      \n      break;\n      }\n      case 'deezer': {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Deezer (Legacy)', inline: false });\r\n      \n      break;\n      }\n      case 'youtube': {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing full track from YouTube', inline: false });\r\n      \n      break;\n      }\n      // No default\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":166,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":166,"endColumn":9,"fix":{"range":[8770,8778],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":167,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":167,"endColumn":7,"fix":{"range":[8881,8887],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":167,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":167,"endColumn":8,"fix":{"range":[8888,8888],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":168,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":168,"endColumn":9,"fix":{"range":[8927,8935],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":169,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":169,"endColumn":7,"fix":{"range":[9046,9052],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":169,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":169,"endColumn":8,"fix":{"range":[9053,9053],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":9,"fix":{"range":[9093,9101],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":171,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":171,"endColumn":7,"fix":{"range":[9197,9203],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":173,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":173,"endColumn":7,"fix":{"range":[9208,9214],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":174,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":174,"endColumn":9,"fix":{"range":[9265,9273],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":175,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":175,"endColumn":9,"fix":{"range":[9397,9405],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":176,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":176,"endColumn":9,"fix":{"range":[9529,9537],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":177,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":177,"endColumn":9,"fix":{"range":[9658,9666],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":178,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":178,"endColumn":7,"fix":{"range":[9791,9797],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":180,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":180,"endColumn":7,"fix":{"range":[9803,9809],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":180,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":180,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[9809,9909],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[9911,9917],"text":"        "}},{"ruleId":"no-undef","severity":2,"message":"'logger' is not defined.","line":181,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":181,"endColumn":13},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":9,"fix":{"range":[9965,9973],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":183,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":183,"endColumn":9,"fix":{"range":[10005,10013],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":184,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":184,"endColumn":9,"fix":{"range":[10043,10051],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":185,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":185,"endColumn":9,"fix":{"range":[10075,10083],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":186,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":186,"endColumn":9,"fix":{"range":[10109,10117],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":187,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":187,"endColumn":7,"fix":{"range":[10154,10160],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":189,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":189,"endColumn":7,"fix":{"range":[10167,10173],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":190,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":190,"endColumn":5,"fix":{"range":[10243,10247],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":190,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":190,"endColumn":6,"fix":{"range":[10248,10248],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":191,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":191,"endColumn":7,"fix":{"range":[10266,10272],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":191,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":191,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10272,10316],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":192,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":192,"endColumn":7,"fix":{"range":[10318,10324],"text":"        "}},{"ruleId":"no-undef","severity":2,"message":"'logger' is not defined.","line":192,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":192,"endColumn":13},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":193,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":193,"endColumn":9,"fix":{"range":[10369,10377],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":194,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":194,"endColumn":9,"fix":{"range":[10409,10417],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":195,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":195,"endColumn":9,"fix":{"range":[10447,10455],"text":"          "}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":195,"column":16,"nodeType":"CallExpression","messageId":"substring","endLine":195,"endColumn":39,"fix":{"range":[10468,10477],"text":"slice"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":196,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":196,"endColumn":9,"fix":{"range":[10488,10496],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":197,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":197,"endColumn":9,"fix":{"range":[10519,10527],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":198,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":198,"endColumn":9,"fix":{"range":[10548,10556],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":199,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":199,"endColumn":7,"fix":{"range":[10593,10599],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":201,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":201,"endColumn":7,"fix":{"range":[10606,10612],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":202,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":202,"endColumn":7,"fix":{"range":[10658,10664],"text":"        "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":202,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":213,"endColumn":8,"fix":{"range":[10664,11042],"text":"await (interaction.deferred ? interaction.editReply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          embeds: [],\r\n          components: []\r\n        }) : interaction.reply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          flags: MessageFlags.Ephemeral\r\n        }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":9,"fix":{"range":[10693,10701],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":204,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":204,"endColumn":11,"fix":{"range":[10732,10742],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":205,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":205,"endColumn":11,"fix":{"range":[10800,10810],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":206,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":206,"endColumn":11,"fix":{"range":[10823,10833],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":207,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":207,"endColumn":9,"fix":{"range":[10849,10857],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":208,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":208,"endColumn":7,"fix":{"range":[10862,10868],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":208,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":208,"endColumn":8,"fix":{"range":[10869,10869],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":209,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":209,"endColumn":9,"fix":{"range":[10878,10886],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":210,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":210,"endColumn":11,"fix":{"range":[10913,10923],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":211,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":211,"endColumn":11,"fix":{"range":[10981,10991],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":212,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":212,"endColumn":9,"fix":{"range":[11022,11030],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":213,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":213,"endColumn":7,"fix":{"range":[11035,11041],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":214,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":214,"endColumn":5,"fix":{"range":[11044,11048],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":216,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":216,"endColumn":3,"fix":{"range":[11053,11055],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":216,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":216,"endColumn":4,"fix":{"range":[11056,11056],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":217,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":217,"endColumn":5,"fix":{"range":[11087,11091],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":219,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":219,"endColumn":5,"fix":{"range":[11148,11152],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":220,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":220,"endColumn":7,"fix":{"range":[11159,11165],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":221,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":221,"endColumn":7,"fix":{"range":[11211,11217],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":222,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":222,"endColumn":9,"fix":{"range":[11246,11254],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":224,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":224,"endColumn":9,"fix":{"range":[11313,11321],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":225,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":225,"endColumn":9,"fix":{"range":[11373,11381],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":226,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":226,"endColumn":11,"fix":{"range":[11419,11429],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":227,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":227,"endColumn":9,"fix":{"range":[11595,11603],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":227,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":227,"endColumn":10,"fix":{"range":[11604,11604],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":228,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":228,"endColumn":11,"fix":{"range":[11678,11688],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":229,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":229,"endColumn":9,"fix":{"range":[11879,11887],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":229,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":229,"endColumn":10,"fix":{"range":[11888,11888],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":230,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":230,"endColumn":11,"fix":{"range":[11931,11941],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":231,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":231,"endColumn":9,"fix":{"range":[12106,12114],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":231,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":231,"endColumn":10,"fix":{"range":[12115,12115],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":232,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":232,"endColumn":11,"fix":{"range":[12124,12134],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":233,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":233,"endColumn":9,"fix":{"range":[12282,12290],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":235,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":235,"endColumn":9,"fix":{"range":[12295,12303],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":236,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":236,"endColumn":7,"fix":{"range":[12392,12398],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":238,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":238,"endColumn":7,"fix":{"range":[12403,12409],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":239,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":239,"endColumn":9,"fix":{"range":[12443,12451],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":240,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":240,"endColumn":9,"fix":{"range":[12498,12506],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":240,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":240,"endColumn":27,"fix":{"range":[12516,12524],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":241,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":241,"endColumn":9,"fix":{"range":[12527,12535],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":243,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":243,"endColumn":7,"fix":{"range":[12597,12603],"text":"        "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":243,"column":15,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":243,"endColumn":22,"fix":{"range":[12603,12822],"text":"for (const [index, song] of results.entries()) {\r\n        embed.addFields({\r\n          name: `${index + 1}. ${song.title}`,\r\n          value: `üë§ ${song.artist} ‚Ä¢ ‚è±Ô∏è ${song.duration}`,\r\n          inline: false\r\n        });\r\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":244,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":244,"endColumn":9,"fix":{"range":[12639,12647],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":245,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":245,"endColumn":11,"fix":{"range":[12666,12676],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":246,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":246,"endColumn":11,"fix":{"range":[12714,12724],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":247,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":247,"endColumn":11,"fix":{"range":[12775,12785],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":248,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":248,"endColumn":9,"fix":{"range":[12800,12808],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":249,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":249,"endColumn":7,"fix":{"range":[12813,12819],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":251,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":251,"endColumn":7,"fix":{"range":[12826,12832],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":252,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":252,"endColumn":7,"fix":{"range":[12872,12878],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":253,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":253,"endColumn":7,"fix":{"range":[12896,12902],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":254,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":254,"endColumn":9,"fix":{"range":[12949,12957],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":255,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":255,"endColumn":9,"fix":{"range":[12994,13002],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":256,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":256,"endColumn":11,"fix":{"range":[13059,13069],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":257,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":257,"endColumn":13,"fix":{"range":[13089,13101],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":258,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":258,"endColumn":15,"fix":{"range":[13122,13136],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":259,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":259,"endColumn":15,"fix":{"range":[13178,13192],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":260,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":260,"endColumn":15,"fix":{"range":[13220,13234],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":261,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":261,"endColumn":11,"fix":{"range":[13266,13276],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":262,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":262,"endColumn":9,"fix":{"range":[13280,13288],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":263,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":263,"endColumn":9,"fix":{"range":[13291,13299],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":264,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":264,"endColumn":7,"fix":{"range":[13316,13322],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":266,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":266,"endColumn":7,"fix":{"range":[13327,13333],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":267,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":267,"endColumn":5,"fix":{"range":[13398,13402],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":267,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":267,"endColumn":6,"fix":{"range":[13403,13403],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":268,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":268,"endColumn":7,"fix":{"range":[13421,13427],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":268,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":268,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[13427,13473],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":269,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":269,"endColumn":7,"fix":{"range":[13475,13481],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":270,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":270,"endColumn":5,"fix":{"range":[13580,13584],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":272,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":272,"endColumn":3,"fix":{"range":[13589,13591],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":272,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":272,"endColumn":4,"fix":{"range":[13592,13592],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":273,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":273,"endColumn":5,"fix":{"range":[13621,13625],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":274,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":274,"endColumn":7,"fix":{"range":[13632,13638],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":275,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":275,"endColumn":7,"fix":{"range":[13688,13694],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":276,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":276,"endColumn":9,"fix":{"range":[13715,13723],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":277,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":277,"endColumn":11,"fix":{"range":[13757,13767],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":278,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":278,"endColumn":11,"fix":{"range":[13806,13816],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":278,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":278,"endColumn":29,"fix":{"range":[13826,13834],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":279,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":279,"endColumn":11,"fix":{"range":[13837,13847],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":280,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":280,"endColumn":11,"fix":{"range":[13932,13942],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":281,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":281,"endColumn":13,"fix":{"range":[13955,13967],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":282,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":282,"endColumn":13,"fix":{"range":[14037,14049],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":283,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":283,"endColumn":11,"fix":{"range":[14126,14136],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":284,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":284,"endColumn":11,"fix":{"range":[14139,14149],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":286,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":286,"endColumn":9,"fix":{"range":[14228,14236],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":287,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":287,"endColumn":11,"fix":{"range":[14287,14297],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":288,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":288,"endColumn":11,"fix":{"range":[14421,14431],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":289,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":289,"endColumn":11,"fix":{"range":[14555,14565],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":290,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":290,"endColumn":11,"fix":{"range":[14689,14699],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":291,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":291,"endColumn":11,"fix":{"range":[14820,14830],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":292,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":292,"endColumn":9,"fix":{"range":[14955,14963],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":294,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":294,"endColumn":9,"fix":{"range":[14969,14977],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":295,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":295,"endColumn":7,"fix":{"range":[15043,15049],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":295,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":295,"endColumn":8,"fix":{"range":[15050,15050],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":296,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":296,"endColumn":9,"fix":{"range":[15059,15067],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":297,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":297,"endColumn":7,"fix":{"range":[15171,15177],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":298,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":298,"endColumn":5,"fix":{"range":[15180,15184],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":298,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":298,"endColumn":6,"fix":{"range":[15185,15185],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":299,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":299,"endColumn":7,"fix":{"range":[15203,15209],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":299,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":299,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15209,15253],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":300,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":300,"endColumn":7,"fix":{"range":[15255,15261],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":301,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":301,"endColumn":5,"fix":{"range":[15355,15359],"text":"      "}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (626). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":626,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":303,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":303,"endColumn":3,"fix":{"range":[15364,15366],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":303,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":303,"endColumn":4,"fix":{"range":[15367,15367],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":304,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":304,"endColumn":5,"fix":{"range":[15396,15400],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":306,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":306,"endColumn":5,"fix":{"range":[15455,15459],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":307,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":307,"endColumn":7,"fix":{"range":[15466,15472],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":308,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":308,"endColumn":7,"fix":{"range":[15510,15516],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":309,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":309,"endColumn":9,"fix":{"range":[15550,15558],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":310,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":310,"endColumn":9,"fix":{"range":[15589,15597],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":310,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":310,"endColumn":27,"fix":{"range":[15607,15615],"text":"0x99_32_CC"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":311,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":311,"endColumn":9,"fix":{"range":[15618,15626],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":312,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":312,"endColumn":7,"fix":{"range":[15716,15722],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":313,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":313,"endColumn":5,"fix":{"range":[15769,15773],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":313,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":313,"endColumn":6,"fix":{"range":[15774,15774],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":314,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":314,"endColumn":7,"fix":{"range":[15792,15798],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":314,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":314,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[15798,15842],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":315,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":315,"endColumn":7,"fix":{"range":[15844,15850],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":316,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":316,"endColumn":5,"fix":{"range":[15950,15954],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":318,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":318,"endColumn":3,"fix":{"range":[15959,15961],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":318,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":318,"endColumn":4,"fix":{"range":[15962,15962],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":319,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":319,"endColumn":5,"fix":{"range":[15991,15995],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":320,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":320,"endColumn":7,"fix":{"range":[16002,16008],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":321,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":321,"endColumn":7,"fix":{"range":[16054,16060],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":322,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":322,"endColumn":9,"fix":{"range":[16077,16085],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":323,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":323,"endColumn":11,"fix":{"range":[16119,16129],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":324,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":324,"endColumn":11,"fix":{"range":[16159,16169],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":324,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":324,"endColumn":29,"fix":{"range":[16179,16187],"text":"0xFF_A5_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":325,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":325,"endColumn":11,"fix":{"range":[16190,16200],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":326,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":326,"endColumn":11,"fix":{"range":[16277,16287],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":327,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":327,"endColumn":13,"fix":{"range":[16300,16312],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":328,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":328,"endColumn":13,"fix":{"range":[16378,16390],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":329,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":329,"endColumn":11,"fix":{"range":[16467,16477],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":330,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":330,"endColumn":11,"fix":{"range":[16480,16490],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":332,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":332,"endColumn":9,"fix":{"range":[16565,16573],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":333,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":333,"endColumn":11,"fix":{"range":[16624,16634],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":334,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":334,"endColumn":11,"fix":{"range":[16758,16768],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":335,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":335,"endColumn":11,"fix":{"range":[16892,16902],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":336,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":336,"endColumn":11,"fix":{"range":[17023,17033],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":337,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":337,"endColumn":9,"fix":{"range":[17158,17166],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":339,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":339,"endColumn":9,"fix":{"range":[17172,17180],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":340,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":340,"endColumn":7,"fix":{"range":[17246,17252],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":340,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":340,"endColumn":8,"fix":{"range":[17253,17253],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":341,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":341,"endColumn":9,"fix":{"range":[17262,17270],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":342,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":342,"endColumn":7,"fix":{"range":[17372,17378],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":343,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":343,"endColumn":5,"fix":{"range":[17381,17385],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":343,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":343,"endColumn":6,"fix":{"range":[17386,17386],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":344,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":344,"endColumn":7,"fix":{"range":[17404,17410],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":344,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":344,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[17410,17454],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":345,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":345,"endColumn":7,"fix":{"range":[17456,17462],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":346,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":346,"endColumn":5,"fix":{"range":[17558,17562],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":348,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":348,"endColumn":3,"fix":{"range":[17567,17569],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":348,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":348,"endColumn":4,"fix":{"range":[17570,17570],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":349,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":349,"endColumn":5,"fix":{"range":[17600,17604],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":350,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":350,"endColumn":7,"fix":{"range":[17611,17617],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":351,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":351,"endColumn":7,"fix":{"range":[17663,17669],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":352,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":352,"endColumn":9,"fix":{"range":[17685,17693],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":353,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":353,"endColumn":11,"fix":{"range":[17727,17737],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":354,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":354,"endColumn":11,"fix":{"range":[17767,17777],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":354,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":354,"endColumn":29,"fix":{"range":[17787,17795],"text":"0xFF_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":355,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":355,"endColumn":11,"fix":{"range":[17798,17808],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":356,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":356,"endColumn":9,"fix":{"range":[17885,17893],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":357,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":357,"endColumn":7,"fix":{"range":[17940,17946],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":357,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":357,"endColumn":8,"fix":{"range":[17947,17947],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":358,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":358,"endColumn":9,"fix":{"range":[17956,17964],"text":"          "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":358,"column":44,"nodeType":"Literal","endLine":358,"endColumn":78},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":359,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":359,"endColumn":7,"fix":{"range":[18070,18076],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":360,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":360,"endColumn":5,"fix":{"range":[18079,18083],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":360,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":360,"endColumn":6,"fix":{"range":[18084,18084],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":361,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":361,"endColumn":7,"fix":{"range":[18102,18108],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":361,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":361,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18108,18153],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":362,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":362,"endColumn":7,"fix":{"range":[18155,18161],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":363,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":363,"endColumn":5,"fix":{"range":[18259,18263],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":365,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":365,"endColumn":3,"fix":{"range":[18268,18270],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":365,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":365,"endColumn":4,"fix":{"range":[18271,18271],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":366,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":366,"endColumn":5,"fix":{"range":[18302,18306],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":367,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":367,"endColumn":7,"fix":{"range":[18313,18319],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":368,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":368,"endColumn":7,"fix":{"range":[18366,18372],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":369,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":369,"endColumn":9,"fix":{"range":[18388,18396],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":370,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":370,"endColumn":11,"fix":{"range":[18430,18440],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":371,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":371,"endColumn":11,"fix":{"range":[18471,18481],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":371,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":371,"endColumn":29,"fix":{"range":[18491,18499],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":372,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":372,"endColumn":11,"fix":{"range":[18502,18512],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":373,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":373,"endColumn":9,"fix":{"range":[18555,18563],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":374,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":374,"endColumn":7,"fix":{"range":[18610,18616],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":374,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":374,"endColumn":8,"fix":{"range":[18617,18617],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":375,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":375,"endColumn":9,"fix":{"range":[18626,18634],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":376,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":376,"endColumn":7,"fix":{"range":[18736,18742],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":377,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":377,"endColumn":5,"fix":{"range":[18745,18749],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":377,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":377,"endColumn":6,"fix":{"range":[18750,18750],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":378,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":378,"endColumn":7,"fix":{"range":[18768,18774],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":378,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":378,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18774,18820],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":379,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":379,"endColumn":7,"fix":{"range":[18822,18828],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":380,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":380,"endColumn":5,"fix":{"range":[18927,18931],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":382,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":382,"endColumn":3,"fix":{"range":[18936,18938],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":382,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":382,"endColumn":4,"fix":{"range":[18939,18939],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":383,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":383,"endColumn":5,"fix":{"range":[18968,18972],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":384,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":384,"endColumn":7,"fix":{"range":[18979,18985],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":385,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":385,"endColumn":7,"fix":{"range":[19030,19036],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":386,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":386,"endColumn":9,"fix":{"range":[19052,19060],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":387,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":387,"endColumn":11,"fix":{"range":[19094,19104],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":388,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":388,"endColumn":11,"fix":{"range":[19135,19145],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":388,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":388,"endColumn":29,"fix":{"range":[19155,19163],"text":"0xFF_00_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":389,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":389,"endColumn":11,"fix":{"range":[19166,19176],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":390,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":390,"endColumn":9,"fix":{"range":[19235,19243],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":391,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":391,"endColumn":7,"fix":{"range":[19290,19296],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":391,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":391,"endColumn":8,"fix":{"range":[19297,19297],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":392,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":392,"endColumn":9,"fix":{"range":[19306,19314],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":393,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":393,"endColumn":7,"fix":{"range":[19420,19426],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":394,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":394,"endColumn":5,"fix":{"range":[19429,19433],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":394,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":394,"endColumn":6,"fix":{"range":[19434,19434],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":395,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":395,"endColumn":7,"fix":{"range":[19452,19458],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":395,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":395,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[19458,19502],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":396,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":396,"endColumn":7,"fix":{"range":[19504,19510],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":397,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":397,"endColumn":5,"fix":{"range":[19607,19611],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":399,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":399,"endColumn":3,"fix":{"range":[19616,19618],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":399,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":399,"endColumn":4,"fix":{"range":[19619,19619],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":400,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":400,"endColumn":5,"fix":{"range":[19649,19653],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":401,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":401,"endColumn":7,"fix":{"range":[19660,19666],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":402,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":402,"endColumn":7,"fix":{"range":[19713,19719],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":403,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":403,"endColumn":7,"fix":{"range":[19771,19777],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":405,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":405,"endColumn":7,"fix":{"range":[19820,19826],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":406,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":406,"endColumn":7,"fix":{"range":[19849,19855],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":407,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":407,"endColumn":9,"fix":{"range":[19871,19879],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":408,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":408,"endColumn":7,"fix":{"range":[19963,19969],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":409,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":409,"endColumn":7,"fix":{"range":[19972,19978],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":410,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":410,"endColumn":9,"fix":{"range":[20003,20011],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":411,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":411,"endColumn":9,"fix":{"range":[20043,20051],"text":"          "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":411,"column":28,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":411,"endColumn":35,"fix":{"range":[20051,20186],"text":"for (const [index, song] of queue.slice(0, 10).entries()) {\r\n          description += `${index + 1}. ${song.title} by ${song.artist}\\n`;\r\n        }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":412,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":412,"endColumn":11,"fix":{"range":[20098,20108],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":413,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":413,"endColumn":9,"fix":{"range":[20175,20183],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":414,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":414,"endColumn":9,"fix":{"range":[20188,20196],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":415,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":415,"endColumn":11,"fix":{"range":[20222,20232],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":416,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":416,"endColumn":9,"fix":{"range":[20291,20299],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":417,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":417,"endColumn":7,"fix":{"range":[20302,20308],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":417,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":417,"endColumn":8,"fix":{"range":[20309,20309],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":418,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":418,"endColumn":9,"fix":{"range":[20318,20326],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":419,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":419,"endColumn":7,"fix":{"range":[20361,20367],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":421,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":421,"endColumn":7,"fix":{"range":[20372,20378],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":422,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":422,"endColumn":9,"fix":{"range":[20412,20420],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":423,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":423,"endColumn":9,"fix":{"range":[20449,20457],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":423,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":423,"endColumn":27,"fix":{"range":[20467,20475],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":424,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":424,"endColumn":9,"fix":{"range":[20478,20486],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":425,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":425,"endColumn":9,"fix":{"range":[20516,20524],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":426,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":426,"endColumn":11,"fix":{"range":[20538,20548],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":427,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":427,"endColumn":11,"fix":{"range":[20572,20582],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":428,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":428,"endColumn":11,"fix":{"range":[20661,20671],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":429,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":429,"endColumn":9,"fix":{"range":[20685,20693],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":431,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":431,"endColumn":7,"fix":{"range":[20700,20706],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":432,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":432,"endColumn":9,"fix":{"range":[20757,20765],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":433,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":433,"endColumn":9,"fix":{"range":[20895,20903],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":434,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":434,"endColumn":7,"fix":{"range":[21032,21038],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":436,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":436,"endColumn":7,"fix":{"range":[21044,21050],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":437,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":437,"endColumn":5,"fix":{"range":[21116,21120],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":437,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":437,"endColumn":6,"fix":{"range":[21121,21121],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":438,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":438,"endColumn":7,"fix":{"range":[21139,21145],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":438,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":438,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[21145,21190],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":439,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":439,"endColumn":7,"fix":{"range":[21192,21198],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":440,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":440,"endColumn":5,"fix":{"range":[21294,21298],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":442,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":442,"endColumn":3,"fix":{"range":[21303,21305],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":442,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":442,"endColumn":4,"fix":{"range":[21306,21306],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":443,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":443,"endColumn":5,"fix":{"range":[21341,21345],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":444,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":444,"endColumn":7,"fix":{"range":[21352,21358],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":445,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":445,"endColumn":7,"fix":{"range":[21410,21416],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":446,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":446,"endColumn":9,"fix":{"range":[21448,21456],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":447,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":447,"endColumn":7,"fix":{"range":[21563,21569],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":449,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":449,"endColumn":7,"fix":{"range":[21574,21580],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":450,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":450,"endColumn":7,"fix":{"range":[21621,21627],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":451,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":451,"endColumn":9,"fix":{"range":[21661,21669],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":452,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":452,"endColumn":9,"fix":{"range":[21698,21706],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":452,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":452,"endColumn":27,"fix":{"range":[21716,21724],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":453,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":453,"endColumn":9,"fix":{"range":[21727,21735],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":454,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":454,"endColumn":9,"fix":{"range":[21801,21809],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":455,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":455,"endColumn":11,"fix":{"range":[21822,21832],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":456,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":456,"endColumn":11,"fix":{"range":[21944,21954],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":457,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":457,"endColumn":11,"fix":{"range":[22019,22029],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":458,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":458,"endColumn":9,"fix":{"range":[22089,22097],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":459,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":459,"endColumn":9,"fix":{"range":[22100,22108],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":461,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":461,"endColumn":7,"fix":{"range":[22182,22188],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":462,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":462,"endColumn":9,"fix":{"range":[22239,22247],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":463,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":463,"endColumn":9,"fix":{"range":[22371,22379],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":464,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":464,"endColumn":9,"fix":{"range":[22503,22511],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":465,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":465,"endColumn":9,"fix":{"range":[22632,22640],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":466,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":466,"endColumn":7,"fix":{"range":[22765,22771],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":468,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":468,"endColumn":7,"fix":{"range":[22777,22783],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":469,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":469,"endColumn":5,"fix":{"range":[22849,22853],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":469,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":469,"endColumn":6,"fix":{"range":[22854,22854],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":470,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":470,"endColumn":7,"fix":{"range":[22872,22878],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":470,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":470,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[22878,22928],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":471,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":471,"endColumn":7,"fix":{"range":[22930,22936],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":472,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":472,"endColumn":5,"fix":{"range":[23043,23047],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":474,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":474,"endColumn":3,"fix":{"range":[23052,23054],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":474,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":474,"endColumn":4,"fix":{"range":[23055,23055],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":475,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":475,"endColumn":5,"fix":{"range":[23087,23091],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":476,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":476,"endColumn":7,"fix":{"range":[23098,23104],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":477,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":477,"endColumn":7,"fix":{"range":[23157,23163],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":478,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":478,"endColumn":9,"fix":{"range":[23179,23187],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":479,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":479,"endColumn":11,"fix":{"range":[23221,23231],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":480,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":480,"endColumn":11,"fix":{"range":[23263,23273],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":480,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":480,"endColumn":29,"fix":{"range":[23283,23291],"text":"0x99_32_CC"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":481,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":481,"endColumn":11,"fix":{"range":[23294,23304],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":482,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":482,"endColumn":9,"fix":{"range":[23356,23364],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":483,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":483,"endColumn":7,"fix":{"range":[23411,23417],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":483,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":483,"endColumn":8,"fix":{"range":[23418,23418],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":484,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":484,"endColumn":9,"fix":{"range":[23427,23435],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":485,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":485,"endColumn":7,"fix":{"range":[23550,23556],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":486,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":486,"endColumn":5,"fix":{"range":[23559,23563],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":486,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":486,"endColumn":6,"fix":{"range":[23564,23564],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":487,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":487,"endColumn":7,"fix":{"range":[23582,23588],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":487,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":487,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[23588,23635],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":488,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":488,"endColumn":7,"fix":{"range":[23637,23643],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":489,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":489,"endColumn":5,"fix":{"range":[23743,23747],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":491,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":491,"endColumn":3,"fix":{"range":[23752,23754],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":491,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":491,"endColumn":4,"fix":{"range":[23755,23755],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":492,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":492,"endColumn":5,"fix":{"range":[23786,23790],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":494,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":494,"endColumn":5,"fix":{"range":[23849,23853],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":495,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":495,"endColumn":5,"fix":{"range":[23874,23878],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":496,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":496,"endColumn":7,"fix":{"range":[23943,23949],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":497,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":497,"endColumn":9,"fix":{"range":[23977,23985],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":498,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":498,"endColumn":9,"fix":{"range":[24043,24051],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":499,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":499,"endColumn":7,"fix":{"range":[24082,24088],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":500,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":500,"endColumn":5,"fix":{"range":[24093,24097],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":502,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":502,"endColumn":5,"fix":{"range":[24102,24106],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":503,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":503,"endColumn":7,"fix":{"range":[24113,24119],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":504,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":504,"endColumn":7,"fix":{"range":[24177,24183],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":505,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":505,"endColumn":9,"fix":{"range":[24200,24208],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":506,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":506,"endColumn":11,"fix":{"range":[24236,24246],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":507,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":507,"endColumn":11,"fix":{"range":[24303,24313],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":508,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":508,"endColumn":9,"fix":{"range":[24344,24352],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":509,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":509,"endColumn":7,"fix":{"range":[24357,24363],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":511,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":511,"endColumn":7,"fix":{"range":[24368,24374],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":512,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":512,"endColumn":9,"fix":{"range":[24408,24416],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":513,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":513,"endColumn":9,"fix":{"range":[24448,24456],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":513,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":513,"endColumn":27,"fix":{"range":[24466,24474],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":514,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":514,"endColumn":9,"fix":{"range":[24477,24485],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":515,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":515,"endColumn":7,"fix":{"range":[24535,24541],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":516,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":516,"endColumn":5,"fix":{"range":[24588,24592],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":516,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":516,"endColumn":6,"fix":{"range":[24593,24593],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":517,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":517,"endColumn":7,"fix":{"range":[24611,24617],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":517,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":517,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[24617,24663],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":518,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":518,"endColumn":7,"fix":{"range":[24665,24671],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":519,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":519,"endColumn":5,"fix":{"range":[24768,24772],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":521,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":521,"endColumn":3,"fix":{"range":[24777,24779],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":521,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":521,"endColumn":4,"fix":{"range":[24780,24780],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":522,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":522,"endColumn":5,"fix":{"range":[24811,24815],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":524,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":524,"endColumn":5,"fix":{"range":[24875,24879],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":526,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":526,"endColumn":7,"fix":{"range":[24918,24924],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":527,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":527,"endColumn":7,"fix":{"range":[24964,24970],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":528,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":528,"endColumn":7,"fix":{"range":[24995,25001],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":530,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":530,"endColumn":7,"fix":{"range":[25035,25041],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":531,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":531,"endColumn":7,"fix":{"range":[25089,25095],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":532,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":532,"endColumn":9,"fix":{"range":[25110,25118],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":533,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":533,"endColumn":11,"fix":{"range":[25152,25162],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":534,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":534,"endColumn":11,"fix":{"range":[25203,25213],"text":"            "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":534,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":534,"endColumn":29,"fix":{"range":[25223,25231],"text":"0x99_32_CC"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":535,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":535,"endColumn":11,"fix":{"range":[25234,25244],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":536,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":536,"endColumn":11,"fix":{"range":[25314,25324],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":537,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":537,"endColumn":9,"fix":{"range":[25378,25386],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":538,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":538,"endColumn":7,"fix":{"range":[25433,25439],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":538,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":538,"endColumn":8,"fix":{"range":[25440,25440],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":539,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":539,"endColumn":9,"fix":{"range":[25449,25457],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":540,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":540,"endColumn":7,"fix":{"range":[25564,25570],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":541,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":541,"endColumn":5,"fix":{"range":[25573,25577],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":541,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":541,"endColumn":6,"fix":{"range":[25578,25578],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":542,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":542,"endColumn":7,"fix":{"range":[25596,25602],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":542,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":542,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[25602,25648],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":543,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":543,"endColumn":7,"fix":{"range":[25650,25656],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":544,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":544,"endColumn":5,"fix":{"range":[25753,25757],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":546,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":546,"endColumn":3,"fix":{"range":[25762,25764],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":546,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":546,"endColumn":4,"fix":{"range":[25765,25765],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":547,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":547,"endColumn":5,"fix":{"range":[25795,25799],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":549,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":549,"endColumn":5,"fix":{"range":[25863,25867],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":550,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":550,"endColumn":7,"fix":{"range":[25874,25880],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":551,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":551,"endColumn":7,"fix":{"range":[25918,25924],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":551,"column":23,"nodeType":"MemberExpression","endLine":551,"endColumn":43},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":553,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":553,"endColumn":7,"fix":{"range":[25965,25971],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":554,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":554,"endColumn":9,"fix":{"range":[25988,25996],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":555,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":555,"endColumn":7,"fix":{"range":[26095,26101],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":557,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":557,"endColumn":7,"fix":{"range":[26106,26112],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":558,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":558,"endColumn":7,"fix":{"range":[26136,26142],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":559,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":559,"endColumn":7,"fix":{"range":[26199,26205],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":560,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":560,"endColumn":9,"fix":{"range":[26227,26235],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":561,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":561,"endColumn":7,"fix":{"range":[26358,26364],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":563,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":563,"endColumn":7,"fix":{"range":[26369,26375],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":564,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":564,"endColumn":7,"fix":{"range":[26408,26414],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":565,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":565,"endColumn":9,"fix":{"range":[26430,26438],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":566,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":566,"endColumn":9,"fix":{"range":[26460,26468],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":567,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":567,"endColumn":9,"fix":{"range":[26492,26500],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":568,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":568,"endColumn":9,"fix":{"range":[26526,26534],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":569,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":569,"endColumn":9,"fix":{"range":[26553,26561],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":570,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":570,"endColumn":9,"fix":{"range":[26608,26616],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":571,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":571,"endColumn":7,"fix":{"range":[26656,26662],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":573,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":573,"endColumn":7,"fix":{"range":[26668,26674],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":574,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":574,"endColumn":7,"fix":{"range":[26693,26699],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":575,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":575,"endColumn":7,"fix":{"range":[26769,26775],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":576,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":576,"endColumn":9,"fix":{"range":[26799,26807],"text":"          "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":576,"column":28,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":576,"endColumn":56,"fix":{"range":[26826,26854],"text":"'‚ùå **Failed to play radio**'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":578,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":578,"endColumn":9,"fix":{"range":[26859,26867],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":579,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":579,"endColumn":9,"fix":{"range":[26923,26931],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":580,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":580,"endColumn":11,"fix":{"range":[26960,26970],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":580,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":580,"endColumn":36,"fix":{"range":[26995,27126],"text":" {\r\n            errorMessage += `\\n\\nüìª **Radio station unavailable**\\nThe radio station URL is not accessible.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":581,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":581,"endColumn":13,"fix":{"range":[26997,27009],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":581,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":581,"endColumn":109,"fix":{"range":[27025,27105],"text":"'\\n\\nüìª **Radio station unavailable**\\nThe radio station URL is not accessible.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":582,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":582,"endColumn":13,"fix":{"range":[27108,27120],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":583,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":583,"endColumn":11,"fix":{"range":[27128,27138],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":583,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":583,"endColumn":34,"fix":{"range":[27161,27289],"text":" {\r\n            errorMessage += `\\n\\nüîä **Stream error**\\nThere was an issue connecting to the radio stream.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":584,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":584,"endColumn":13,"fix":{"range":[27163,27175],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":584,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":584,"endColumn":106,"fix":{"range":[27191,27268],"text":"'\\n\\nüîä **Stream error**\\nThere was an issue connecting to the radio stream.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":585,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":585,"endColumn":13,"fix":{"range":[27271,27283],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":586,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":586,"endColumn":11,"fix":{"range":[27291,27301],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":586,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":586,"endColumn":36,"fix":{"range":[27326,27475],"text":" {\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\n          }"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 126. Maximum allowed is 120.","line":587,"column":1,"nodeType":"Program","messageId":"max","endLine":587,"endColumn":128},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":587,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":587,"endColumn":13,"fix":{"range":[27328,27340],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":587,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":587,"endColumn":127,"fix":{"range":[27356,27454],"text":"'\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":588,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":588,"endColumn":13,"fix":{"range":[27457,27469],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":589,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":589,"endColumn":11,"fix":{"range":[27477,27487],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":589,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":589,"endColumn":34,"fix":{"range":[27510,27644],"text":" {\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Stream failed**\\nThe radio station failed and playback has been stopped.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":590,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":590,"endColumn":13,"fix":{"range":[27512,27524],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":590,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":590,"endColumn":112,"fix":{"range":[27540,27623],"text":"'\\n\\n‚è≠Ô∏è **Stream failed**\\nThe radio station failed and playback has been stopped.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":591,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":591,"endColumn":13,"fix":{"range":[27626,27638],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":592,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":592,"endColumn":11,"fix":{"range":[27646,27656],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":592,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":592,"endColumn":26,"fix":{"range":[27671,27791],"text":" {\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Radio stopped**\\nThe radio station is no longer available.`;\r\n            break;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":593,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":593,"endColumn":13,"fix":{"range":[27673,27685],"text":"              "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":593,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":593,"endColumn":98,"fix":{"range":[27701,27770],"text":"'\\n\\n‚èπÔ∏è **Radio stopped**\\nThe radio station is no longer available.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":594,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":594,"endColumn":13,"fix":{"range":[27773,27785],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":595,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":595,"endColumn":11,"fix":{"range":[27793,27803],"text":"            "}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":595,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":595,"endColumn":19,"fix":{"range":[27811,27861],"text":" {\r\n            errorMessage += `: ${result.error}`;\n          }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":596,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":596,"endColumn":13,"fix":{"range":[27813,27825],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":597,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":597,"endColumn":9,"fix":{"range":[27863,27871],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":599,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":599,"endColumn":9,"fix":{"range":[27876,27884],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":600,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":600,"endColumn":7,"fix":{"range":[27969,27975],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":602,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":602,"endColumn":7,"fix":{"range":[27980,27986],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":603,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":603,"endColumn":9,"fix":{"range":[28020,28028],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":604,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":604,"endColumn":9,"fix":{"range":[28074,28082],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":604,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":604,"endColumn":27,"fix":{"range":[28092,28100],"text":"0xFF_98_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":605,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":605,"endColumn":9,"fix":{"range":[28103,28111],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":606,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":606,"endColumn":9,"fix":{"range":[28206,28214],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":607,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":607,"endColumn":11,"fix":{"range":[28227,28237],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":608,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":608,"endColumn":11,"fix":{"range":[28297,28307],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":609,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":609,"endColumn":11,"fix":{"range":[28366,28376],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":610,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":610,"endColumn":9,"fix":{"range":[28436,28444],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":612,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":612,"endColumn":7,"fix":{"range":[28450,28456],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":613,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":613,"endColumn":9,"fix":{"range":[28507,28515],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":614,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":614,"endColumn":9,"fix":{"range":[28645,28653],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":615,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":615,"endColumn":7,"fix":{"range":[28779,28785],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":617,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":617,"endColumn":7,"fix":{"range":[28791,28797],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":618,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":618,"endColumn":5,"fix":{"range":[28863,28867],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":618,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":618,"endColumn":6,"fix":{"range":[28868,28868],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":619,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":619,"endColumn":7,"fix":{"range":[28886,28892],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":619,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":619,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[28892,28937],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":620,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":620,"endColumn":7,"fix":{"range":[28939,28945],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":621,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":621,"endColumn":5,"fix":{"range":[29042,29046],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":622,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":622,"endColumn":3,"fix":{"range":[29049,29051],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":623,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":623,"endColumn":4,"fix":{"range":[29057,29057],"text":"\n"}}],"suppressedMessages":[],"errorCount":623,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":609,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { searchSongs, play, pause, resume, skip, stop, getQueue, getMusicStats, getLyrics, getRadioStations, setVolume, shuffleQueue, clearQueue, back, setLoop, getLoop } from '../music.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('music')\r\n  .setDescription('üéµ ULTRA Music System - YouTube & Spotify Priority!')\r\n  .addSubcommand(sub => sub.setName('play').setDescription('üéµ Play any song instantly').addStringOption(opt => opt.setName('query').setDescription('Song name or URL').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('search').setDescription('üîç Search millions of songs').addStringOption(opt => opt.setName('query').setDescription('Search term').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('back').setDescription('‚¨ÖÔ∏è Go back to previous song'))\r\n  .addSubcommand(sub => sub.setName('loop').setDescription('üîÑ Set loop mode').addStringOption(opt => opt.setName('mode').setDescription('Loop mode').addChoices(\r\n    { name: 'None', value: 'none' },\r\n    { name: 'Single', value: 'single' },\r\n    { name: 'Queue', value: 'queue' }\r\n  ).setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('skip').setDescription('‚è≠Ô∏è Skip to next song'))\r\n  .addSubcommand(sub => sub.setName('pause').setDescription('‚è∏Ô∏è Pause current song'))\r\n  .addSubcommand(sub => sub.setName('resume').setDescription('‚ñ∂Ô∏è Resume paused song'))\r\n  .addSubcommand(sub => sub.setName('stop').setDescription('‚èπÔ∏è Stop music and leave voice'))\r\n  .addSubcommand(sub => sub.setName('queue').setDescription('üìã View music queue'))\r\n  .addSubcommand(sub => sub.setName('nowplaying').setDescription('üéµ Show currently playing'))\r\n  .addSubcommand(sub => sub.setName('shuffle').setDescription('üîÄ Shuffle queue'))\r\n  .addSubcommand(sub => sub.setName('volume').setDescription('üîä Set volume (0-200)').addIntegerOption(opt => opt.setName('level').setDescription('Volume level').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('lyrics').setDescription('üìù Get song lyrics').addStringOption(opt => opt.setName('song').setDescription('Song name').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('radio').setDescription('üìª Play radio stations').addStringOption(opt => opt.setName('station').setDescription('Radio station').addChoices(\r\n    { name: 'üéµ Lo-fi Hip Hop', value: 'lofi' },\r\n    { name: 'üé∏ Rock Classics', value: 'rock' },\r\n    { name: 'üé∂ Electronic', value: 'electronic' },\r\n    { name: 'üé∑ Smooth Jazz', value: 'jazz' },\r\n    { name: 'üéº Classical', value: 'classical' }\r\n  ).setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    console.log(`[MUSIC] Command executed: ${interaction.options.getSubcommand()} by ${interaction.user.username} in ${interaction.guild?.name || 'DM'}`);\r\n    const sub = interaction.options.getSubcommand();\r\n\r\n    // Input validation\r\n    if (!interaction.user?.id) {\r\n      throw new CommandError('Invalid user', 'VALIDATION_ERROR');\r\n    }\r\n\r\n    if (!interaction.guild?.id && sub !== 'lyrics') {\r\n      return interaction.reply({\r\n        content: '‚ùå Music commands can only be used in servers.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n  if (sub === 'play') {\r\n    const query = interaction.options.getString('query');\r\n\r\n    // Voice channel validation\r\n    const voiceChannel = interaction.member.voice?.channel;\r\n    if (!voiceChannel) {\r\n      return interaction.reply({\r\n        content: 'üéµ **You must be in a voice channel to play music!**',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Bot permissions\r\n    const botPermissions = voiceChannel.permissionsFor(interaction.guild.members.me);\r\n    if (!botPermissions.has('Connect') || !botPermissions.has('Speak')) {\r\n      return interaction.reply({\r\n        content: '‚ùå **I need \"Connect\" and \"Speak\" permissions in your voice channel.**',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Defer reply to prevent timeout (fixes \"Unknown interaction\" errors)\r\n    await interaction.deferReply();\r\n    logger.info('Deferred music play interaction', {\r\n      guildId: interaction.guild.id,\r\n      userId: interaction.user.id,\r\n      query: query.substring(0, 100), // Log first 100 chars for privacy\r\n      timestamp: new Date().toISOString()\r\n    });\r\n\r\n    try {\r\n      // Search for the song\r\n      const songs = await searchSongs(query, 1);\r\n      if (songs.length === 0) {\r\n        let noResultsMessage = '‚ùå **No results found for that query.**';\r\n\r\n        // Provide more specific messaging for URL queries\r\n        if (query.includes('spotify.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Spotify**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else if (query.includes('youtube.com') || query.includes('youtu.be')) {\r\n          noResultsMessage = '‚ùå **Video unavailable**\\n\\nüìπ The requested video is not available, private, or has been deleted.\\nüîç Try searching for the song title instead of using the direct URL.';\r\n        } else if (query.includes('deezer.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Deezer**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else {\r\n          noResultsMessage = '‚ùå **No results found**\\n\\nüîç No tracks found for your search query.\\nüí° Try different keywords or check the spelling.';\r\n        }\r\n\r\n        return interaction.reply({\r\n          content: noResultsMessage,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const song = songs[0];\r\n\r\n      // Play the song\r\n      const result = await play(interaction.guild.id, voiceChannel, song);\r\n      if (!result.success) {\r\n        let errorMessage = `‚ùå **Failed to play music**`;\r\n\r\n        // Provide specific error messages based on error type\r\n        switch (result.errorType) {\r\n          case 'validation_failed':\r\n            if (song.source === 'spotify') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Spotify**\\nThe requested track is no longer available or has no preview.`;\r\n            } else if (song.source === 'deezer') {\r\n              errorMessage += `\\n\\nüéµ **Track unavailable on Deezer**\\nThe requested track is no longer available or has no preview.`;\r\n            } else {\r\n              errorMessage += `\\n\\nüìπ **Video unavailable or deleted**\\nThe requested video is no longer available on YouTube.`;\r\n            }\r\n            break;\r\n          case 'stream_creation':\r\n            errorMessage += `\\n\\nüîä **Audio stream error**\\nThere was an issue creating the audio stream for this track.`;\r\n            break;\r\n          case 'connection_failed':\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\r\n          case 'skipped_to_next':\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Skipped to next song**\\nThe current song failed and has been skipped.`;\r\n            // Don't reply with error for this case, let the next song play\r\n            return;\r\n          case 'stopped':\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Playback stopped**\\nNo more songs in the queue.`;\r\n            break;\r\n          case 'no_preview':\r\n            errorMessage += `\\n\\nüéµ **No preview available**\\nThis Spotify track does not have a preview clip.`;\r\n            break;\r\n          case 'spotify_stream':\r\n            errorMessage += `\\n\\nüéµ **Spotify stream error**\\nFailed to play the preview clip.`;\r\n            break;\r\n          case 'deezer_stream':\r\n            errorMessage += `\\n\\nüéµ **Deezer stream error**\\nFailed to play the preview clip.`;\r\n            break;\r\n          default:\r\n            errorMessage += `: ${result.error}`;\r\n        }\r\n\r\n        return interaction.reply({\r\n          content: errorMessage,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Create success embed with detailed info\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéµ Now Playing')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${song.title}** by **${song.artist}**`)\r\n        .addFields(\r\n          { name: '‚è±Ô∏è Duration', value: song.duration, inline: true },\r\n          { name: 'üîä Volume', value: `${getMusicStats(interaction.guild.id).volume}%`, inline: true },\r\n          { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n        )\r\n        .setThumbnail(song.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n      if (song.source === 'spotify') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Spotify', inline: false });\r\n      } else if (song.source === 'deezer') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Deezer (Legacy)', inline: false });\r\n      } else if (song.source === 'youtube') {\r\n        embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing full track from YouTube', inline: false });\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n        new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      console.log(`[MUSIC] Editing deferred reply for interaction: ${interaction.id} with success embed`);\r\n      logger.info('Music play command successful', {\r\n        guildId: interaction.guild.id,\r\n        userId: interaction.user.id,\r\n        songTitle: song.title,\r\n        songSource: song.source,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      await interaction.editReply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Play command error:', error);\r\n      logger.error('Music play command failed', {\r\n        guildId: interaction.guild.id,\r\n        userId: interaction.user.id,\r\n        query: query.substring(0, 100),\r\n        error: error.message,\r\n        stack: error.stack,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      // Check if interaction was already deferred\r\n      if (interaction.deferred) {\r\n        await interaction.editReply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          embeds: [],\r\n          components: []\r\n        });\r\n      } else {\r\n        await interaction.reply({\r\n          content: '‚ùå **An error occurred while playing music.**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n    }\r\n\r\n  } else if (sub === 'search') {\r\n    const query = interaction.options.getString('query');\r\n\r\n    try {\r\n      const results = await searchSongs(query, 5);\r\n      if (results.length === 0) {\r\n        let noResultsMessage = '‚ùå **No search results found**';\r\n\r\n        // Provide more specific messaging for URL queries\r\n        if (query.includes('spotify.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Spotify**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else if (query.includes('youtube.com') || query.includes('youtu.be')) {\r\n          noResultsMessage = '‚ùå **Video unavailable**\\n\\nüìπ The requested video is not available, private, or has been deleted.\\nüîç Try searching for the song title instead of using the direct URL.';\r\n        } else if (query.includes('deezer.com')) {\r\n          noResultsMessage = '‚ùå **Track unavailable on Deezer**\\n\\nüéµ The requested track is not available or has no preview.\\nüîç Try searching for the song title instead.';\r\n        } else {\r\n          noResultsMessage = '‚ùå **No search results found**\\n\\nüîç No tracks found for your search query.\\nüí° Try different keywords or check the spelling.';\r\n        }\r\n\r\n        return interaction.reply({ content: noResultsMessage, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üîç Search Results for \"${query}\"`)\r\n        .setColor(0x0099FF)\r\n        .setDescription('Click the buttons below to play songs!');\r\n\r\n      results.forEach((song, index) => {\r\n        embed.addFields({\r\n          name: `${index + 1}. ${song.title}`,\r\n          value: `üë§ ${song.artist} ‚Ä¢ ‚è±Ô∏è ${song.duration}`,\r\n          inline: false\r\n        });\r\n      });\r\n\r\n      // Create play buttons for each result\r\n      const rows = [];\r\n      for (let i = 0; i < results.length; i += 2) {\r\n        const row = new ActionRowBuilder();\r\n        for (let j = i; j < i + 2 && j < results.length; j++) {\r\n          row.addComponents(\r\n            new ButtonBuilder()\r\n              .setCustomId(`music_play:${j}:${query}`)\r\n              .setLabel(`Play ${j + 1}`)\r\n              .setStyle(ButtonStyle.Primary)\r\n          );\r\n        }\r\n        rows.push(row);\r\n      }\r\n\r\n      await interaction.reply({ embeds: [embed], components: rows });\r\n    } catch (error) {\r\n      console.error('Search command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to search songs.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'back') {\r\n    try {\r\n      const previousSong = back(interaction.guild.id);\r\n      if (previousSong) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚¨ÖÔ∏è Back to Previous Song')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`**Now Playing:** ${previousSong.title} by ${previousSong.artist}`)\r\n          .addFields(\r\n            { name: '‚è±Ô∏è Duration', value: previousSong.duration, inline: true },\r\n            { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n          )\r\n          .setThumbnail(previousSong.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_back:${interaction.guild.id}`).setLabel('‚¨ÖÔ∏è Back').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n          new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No previous song in history.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Back command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to go back.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'loop') {\r\n    const mode = interaction.options.getString('mode');\r\n\r\n    try {\r\n      setLoop(interaction.guild.id, mode);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ Loop Mode Set')\r\n        .setColor(0x9932CC)\r\n        .setDescription(`Loop mode set to **${mode.charAt(0).toUpperCase() + mode.slice(1)}**`);\r\n      await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      console.error('Loop command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to set loop mode.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'skip') {\r\n    try {\r\n      const nextSong = skip(interaction.guild.id);\r\n      if (nextSong) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚è≠Ô∏è Song Skipped')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`**Now Playing:** ${nextSong.title} by ${nextSong.artist}`)\r\n          .addFields(\r\n            { name: '‚è±Ô∏è Duration', value: nextSong.duration, inline: true },\r\n            { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n          )\r\n          .setThumbnail(nextSong.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n        const row = new ActionRowBuilder().addComponents(\r\n          new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n          new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n          new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n          new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n        );\r\n\r\n        await interaction.reply({ embeds: [embed], components: [row] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No songs in queue to skip.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Skip command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to skip song.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'pause') {\r\n    try {\r\n      const success = pause(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚è∏Ô∏è Music Paused')\r\n          .setColor(0xFFFF00)\r\n          .setDescription('Music has been paused. Use `/music resume` to continue.');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Pause command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to pause music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'resume') {\r\n    try {\r\n      const success = resume(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚ñ∂Ô∏è Music Resumed')\r\n          .setColor(0x00FF00)\r\n          .setDescription('Music is now playing!');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No paused music to resume.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Resume command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to resume music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'stop') {\r\n    try {\r\n      const success = stop(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚èπÔ∏è Music Stopped')\r\n          .setColor(0xFF0000)\r\n          .setDescription('Music stopped and left voice channel.');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Stop command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to stop music.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'queue') {\r\n    try {\r\n      const queue = getQueue(interaction.guild.id);\r\n      const stats = getMusicStats(interaction.guild.id);\r\n      const current = stats.currentlyPlaying;\r\n\r\n      let description = '';\r\n      if (current) {\r\n        description += `**Currently Playing:** ${current.title} by ${current.artist}\\n\\n`;\r\n      }\r\n      if (queue.length > 0) {\r\n        description += '**Queue:**\\n';\r\n        queue.slice(0, 10).forEach((song, index) => {\r\n          description += `${index + 1}. ${song.title} by ${song.artist}\\n`;\r\n        });\r\n        if (queue.length > 10) {\r\n          description += `... and ${queue.length - 10} more songs`;\r\n        }\r\n      } else {\r\n        description += 'Queue is empty.';\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìã Music Queue')\r\n        .setColor(0x0099FF)\r\n        .setDescription(description)\r\n        .addFields({\r\n          name: 'üìä Queue Info',\r\n          value: `**Total Songs:** ${stats.queueLength}\\n**Volume:** ${stats.volume}%`,\r\n          inline: true\r\n        });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_shuffle:${interaction.guild.id}`).setLabel('üîÄ Shuffle').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_clear:${interaction.guild.id}`).setLabel('üóëÔ∏è Clear Queue').setStyle(ButtonStyle.Danger)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Queue command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get queue.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'nowplaying') {\r\n    try {\r\n      const stats = getMusicStats(interaction.guild.id);\r\n      if (!stats.currentlyPlaying) {\r\n        return interaction.reply({ content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const current = stats.currentlyPlaying;\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéµ Now Playing')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${current.title}** by **${current.artist}**`)\r\n        .addFields(\r\n          { name: '‚è±Ô∏è Progress', value: `${Math.floor(current.progress / 1000)}s / ${current.duration}`, inline: true },\r\n          { name: 'üîä Volume', value: `${stats.volume}%`, inline: true },\r\n          { name: 'üë§ Status', value: current.status, inline: true }\r\n        )\r\n        .setThumbnail(current.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n        new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Nowplaying command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get now playing info.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'shuffle') {\r\n    try {\r\n      const success = shuffleQueue(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîÄ Queue Shuffled')\r\n          .setColor(0x9932CC)\r\n          .setDescription('Music queue has been shuffled!');\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå Queue is empty or too small to shuffle.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Shuffle command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to shuffle queue.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'volume') {\r\n    const volume = interaction.options.getInteger('level');\r\n\r\n    // Input validation\r\n    if (typeof volume !== 'number' || volume < 0 || volume > 200) {\r\n      return interaction.reply({\r\n        content: '‚ùå Volume must be a number between 0 and 200.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    try {\r\n      const success = setVolume(interaction.guild.id, volume);\r\n      if (!success) {\r\n        return interaction.reply({\r\n          content: '‚ùå No active music session to adjust volume.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîä Volume Changed')\r\n        .setColor(0x0099FF)\r\n        .setDescription(`Volume set to **${volume}%**`);\r\n      await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      console.error('Volume command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to set volume.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'lyrics') {\r\n    const songQuery = interaction.options.getString('song');\r\n\r\n    try {\r\n      // Split song and artist\r\n      const parts = songQuery.split(' by ');\r\n      const title = parts[0];\r\n      const artist = parts[1] || '';\r\n\r\n      const lyrics = await getLyrics(title, artist);\r\n      if (lyrics) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üìù Lyrics: ${lyrics.title}`)\r\n          .setColor(0x9932CC)\r\n          .setDescription(lyrics.lyrics.slice(0, 4000)) // Discord embed limit\r\n          .setFooter({ text: `Powered by ${lyrics.source}` });\r\n        await interaction.reply({ embeds: [embed] });\r\n      } else {\r\n        await interaction.reply({ content: '‚ùå Lyrics not found for that song.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    } catch (error) {\r\n      console.error('Lyrics command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to get lyrics.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n  } else if (sub === 'radio') {\r\n    const stationKey = interaction.options.getString('station');\r\n\r\n    try {\r\n      const stations = getRadioStations();\r\n      const station = stations[stationKey];\r\n\r\n      if (!station) {\r\n        return interaction.reply({ content: '‚ùå Invalid radio station.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Voice channel check\r\n      const voiceChannel = interaction.member.voice?.channel;\r\n      if (!voiceChannel) {\r\n        return interaction.reply({ content: 'üéµ You must be in a voice channel to play radio!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Create song object for radio\r\n      const song = {\r\n        title: station.name,\r\n        artist: station.genre,\r\n        duration: 'Live Stream',\r\n        url: station.url,\r\n        thumbnail: 'https://i.imgur.com/SjIgjlE.png',\r\n        requestedBy: interaction.user.username\r\n      };\r\n\r\n      // Play the radio\r\n      const result = await play(interaction.guild.id, voiceChannel, song);\r\n      if (!result.success) {\r\n        let errorMessage = `‚ùå **Failed to play radio**`;\r\n\r\n        // Provide specific error messages based on error type\r\n        switch (result.errorType) {\r\n          case 'validation_failed':\r\n            errorMessage += `\\n\\nüìª **Radio station unavailable**\\nThe radio station URL is not accessible.`;\r\n            break;\r\n          case 'stream_creation':\r\n            errorMessage += `\\n\\nüîä **Stream error**\\nThere was an issue connecting to the radio stream.`;\r\n            break;\r\n          case 'connection_failed':\r\n            errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish a stable connection to the voice channel.`;\r\n            break;\r\n          case 'skipped_to_next':\r\n            errorMessage += `\\n\\n‚è≠Ô∏è **Stream failed**\\nThe radio station failed and playback has been stopped.`;\r\n            break;\r\n          case 'stopped':\r\n            errorMessage += `\\n\\n‚èπÔ∏è **Radio stopped**\\nThe radio station is no longer available.`;\r\n            break;\r\n          default:\r\n            errorMessage += `: ${result.error}`;\r\n        }\r\n\r\n        return interaction.reply({ content: errorMessage, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üìª Now Playing: ${station.name}`)\r\n        .setColor(0xFF9800)\r\n        .setDescription(`**${station.name}** radio is now playing!\\n\\nüéµ *Live streaming activated*`)\r\n        .addFields(\r\n          { name: 'üìª Station', value: station.name, inline: true },\r\n          { name: 'üéµ Genre', value: station.genre, inline: true },\r\n          { name: 'üîä Quality', value: 'Live Stream', inline: true }\r\n        );\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_radio_change:${stationKey}`).setLabel('üîÑ Change Station').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop Radio').setStyle(ButtonStyle.Danger)\r\n      );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      console.error('Radio command error:', error);\r\n      await interaction.reply({ content: '‚ùå Failed to play radio.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n  } catch (error) {\r\n    return handleCommandError(interaction, error);\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\novel.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":78,"fix":{"range":[77,77],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (157). Maximum allowed is 100.","line":13,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":169,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (55). Maximum allowed is 30.","line":13,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":169,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 26. Maximum allowed is 20.","line":13,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":169,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 31 to the 15 allowed.","line":13,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":13,"endColumn":30},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":52,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":52,"endColumn":27,"fix":{"range":[2342,2350],"text":"0x00_FF_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":73,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":73,"endColumn":27,"fix":{"range":[3060,3068],"text":"0x00_99_FF"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 153. Maximum allowed is 120.","line":109,"column":1,"nodeType":"Program","messageId":"max","endLine":109,"endColumn":154},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":116,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":116,"endColumn":27,"fix":{"range":[4402,4410],"text":"0x99_32_CC"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":154,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":154,"endColumn":29,"fix":{"range":[5614,5622],"text":"0x00_FF_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":159,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":159,"endColumn":8,"fix":{"range":[5859,5859],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":160,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":160,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5885,5935],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":166,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":166,"endColumn":4,"fix":{"range":[6099,6099],"text":"\n"}}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, MessageFlags, EmbedBuilder } from 'discord.js';\r\nimport { createNovel, listNovels, getNovel, generateChapter } from '../novel.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('novel')\r\n  .setDescription('Light novel features')\r\n  .addSubcommand(sub => sub.setName('create').setDescription('Create a new novel').addStringOption(opt => opt.setName('title').setDescription('Title')).addStringOption(opt => opt.setName('prompt').setDescription('Initial prompt/context')))\r\n  .addSubcommand(sub => sub.setName('list').setDescription('List novels'))\r\n  .addSubcommand(sub => sub.setName('read').setDescription('Read a novel').addStringOption(opt => opt.setName('id').setDescription('Novel ID').setRequired(true)).addIntegerOption(opt => opt.setName('chapter').setDescription('Chapter number')))\r\n  .addSubcommand(sub => sub.setName('next').setDescription('Generate next chapter').addStringOption(opt => opt.setName('id').setDescription('Novel ID').setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    const sub = interaction.options.getSubcommand();\r\n    const userId = interaction.user.id;\r\n\r\n    // Input validation\r\n    if (!userId) {\r\n      throw new CommandError('Invalid user ID', 'VALIDATION_ERROR');\r\n    }\r\n\r\n    if (sub === 'create') {\r\n      const title = interaction.options.getString('title');\r\n      const prompt = interaction.options.getString('prompt');\r\n\r\n      // Validate inputs\r\n      if (!title || title.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel title cannot be empty.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (title.length > 100) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel title must be 100 characters or less.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (prompt && prompt.length > 500) {\r\n        return interaction.reply({\r\n          content: '‚ùå Initial prompt must be 500 characters or less.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const novel = createNovel(userId, title.trim(), prompt?.trim() || '');\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìñ Novel Created')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${novel.title}**\\n\\nID: \\`${novel.id}\\`\\nAuthor: ${interaction.user.username}`)\r\n        .addFields({\r\n          name: 'Next Steps',\r\n          value: 'Use `/novel next` to generate the first chapter!'\r\n        });\r\n\r\n      return interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    if (sub === 'list') {\r\n      const novels = listNovels();\r\n      if (!novels || novels.length === 0) {\r\n        return interaction.reply({\r\n          content: 'üìö No novels have been created yet.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìö Available Novels')\r\n        .setColor(0x0099FF)\r\n        .setDescription(novels.join('\\n\\n'));\r\n\r\n      return interaction.reply({ embeds: [embed] });\r\n    }\r\n\r\n    if (sub === 'read') {\r\n      const id = interaction.options.getString('id');\r\n      const chapter = interaction.options.getInteger('chapter') || 1;\r\n\r\n      // Validate inputs\r\n      if (!id || id.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel ID is required.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (chapter < 1) {\r\n        return interaction.reply({\r\n          content: '‚ùå Chapter number must be 1 or greater.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const novel = getNovel(id.trim());\r\n      if (!novel) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel not found. Check the ID and try again.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const chap = novel.chapters[chapter - 1];\r\n      if (!chap) {\r\n        return interaction.reply({\r\n          content: `‚ùå Chapter ${chapter} not found. This novel has ${novel.chapters.length} chapters.\\n\\nUse \\`/novel next\\` to generate more chapters!`,\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle(`üìñ ${novel.title}`)\r\n        .setColor(0x9932CC)\r\n        .setDescription(`**Chapter ${chap.index}**\\n\\n${chap.text}`)\r\n        .setFooter({ text: `Novel ID: ${novel.id} ‚Ä¢ Total Chapters: ${novel.chapters.length}` });\r\n\r\n      return interaction.reply({ embeds: [embed] });\r\n    }\r\n\r\n    if (sub === 'next') {\r\n      const id = interaction.options.getString('id');\r\n\r\n      // Validate inputs\r\n      if (!id || id.trim().length === 0) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel ID is required.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const novel = getNovel(id.trim());\r\n      if (!novel) {\r\n        return interaction.reply({\r\n          content: '‚ùå Novel not found. Check the ID and try again.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      await interaction.deferReply();\r\n\r\n      try {\r\n        const chapter = await generateChapter(interaction.guildId, id.trim());\r\n        if (!chapter) {\r\n          return interaction.editReply({\r\n            content: '‚ùå Failed to generate chapter. Please try again later.'\r\n          });\r\n        }\r\n\r\n        const embed = new EmbedBuilder()\r\n          .setTitle(`üìù Chapter ${chapter.index} Generated`)\r\n          .setColor(0x00FF00)\r\n          .setDescription(`**${novel.title}**\\n\\n${chapter.text}`)\r\n          .setFooter({ text: `Novel ID: ${novel.id} ‚Ä¢ Use /novel read to view full context` });\r\n\r\n        return interaction.editReply({ embeds: [embed] });\r\n      } catch (error) {\r\n        console.error('Chapter generation error:', error);\r\n        return interaction.editReply({\r\n          content: '‚ùå An error occurred while generating the chapter. Please try again.'\r\n        });\r\n      }\r\n    }\r\n  } catch (error) {\r\n    return handleCommandError(interaction, error);\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\ping.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":50,"fix":{"range":[49,49],"text":"\n"}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":17,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":17,"endColumn":48,"fix":{"range":[541,542],"text":""}}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\nimport { safeExecuteCommand, validateNotEmpty } from '../errorHandler.js';\r\n\r\n/**\r\n * Ping command data structure.\r\n */\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('ping')\r\n  .setDescription('Replies with Pong! and latency');\r\n\r\n/**\r\n * Executes the ping command to measure bot latency.\r\n * @param {object} interaction - Discord interaction object\r\n * @returns {Promise<void>}\r\n */\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    // Validate interaction object\r\n    validateNotEmpty(interaction, 'interaction');\r\n    validateNotEmpty(interaction.client, 'client');\r\n    validateNotEmpty(interaction.client.ws, 'websocket');\r\n\r\n    // Send initial ping message and fetch reply for timing\r\n    const sent = await interaction.reply({\r\n      content: 'Pinging...',\r\n      fetchReply: true\r\n    });\r\n\r\n    // Calculate latencies\r\n    const latency = sent.createdTimestamp - interaction.createdTimestamp;\r\n    const apiLatency = Math.round(interaction.client.ws.ping);\r\n\r\n    // Validate latency values are reasonable\r\n    if (latency < 0 || apiLatency < 0) {\r\n      throw new Error('Invalid latency calculation');\r\n    }\r\n\r\n    // Format response message with proper spacing\r\n    const response = `Pong! Latency: ${latency}ms | API: ${apiLatency}ms`;\r\n\r\n    // Edit the original message with results\r\n    await interaction.editReply(response);\r\n  });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\poll.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":139,"fix":{"range":[138,138],"text":"\n"}},{"ruleId":"object-curly-spacing","severity":2,"message":"A space is required before '}'.","line":1,"column":119,"nodeType":"ImportDeclaration","messageId":"requireSpaceBefore","endLine":1,"endColumn":120,"fix":{"range":[118,118],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'CommandError' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":22},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (173). Maximum allowed is 100.","line":35,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":207,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (38). Maximum allowed is 30.","line":35,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":207,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":96,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":96,"endColumn":3,"fix":{"range":[3292,3294],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":97,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":97,"endColumn":5,"fix":{"range":[3328,3332],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":98,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":98,"endColumn":5,"fix":{"range":[3361,3365],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":98,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":98,"endColumn":23,"fix":{"range":[3375,3383],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":99,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":99,"endColumn":5,"fix":{"range":[3386,3390],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":99,"column":60,"nodeType":"MemberExpression","endLine":99,"endColumn":73},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":100,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":100,"endColumn":5,"fix":{"range":[3487,3491],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":101,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":101,"endColumn":7,"fix":{"range":[3505,3511],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":102,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":102,"endColumn":7,"fix":{"range":[3534,3540],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":103,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":103,"endColumn":7,"fix":{"range":[3622,3628],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":104,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":104,"endColumn":5,"fix":{"range":[3643,3647],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":105,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":105,"endColumn":5,"fix":{"range":[3651,3655],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":106,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":106,"endColumn":5,"fix":{"range":[3762,3766],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":106,"column":50,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":106,"endColumn":55,"fix":{"range":[3811,3816],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":108,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":108,"endColumn":3,"fix":{"range":[3822,3824],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":3,"fix":{"range":[3859,3861],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":110,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":110,"endColumn":5,"fix":{"range":[3914,3918],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":111,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":111,"endColumn":7,"fix":{"range":[3939,3945],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":112,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":112,"endColumn":7,"fix":{"range":[3976,3982],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":112,"column":20,"nodeType":"MemberExpression","endLine":112,"endColumn":33},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substring()`.","line":112,"column":58,"nodeType":"CallExpression","messageId":"substring","endLine":112,"endColumn":81,"fix":{"range":[4040,4049],"text":"slice"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":113,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":113,"endColumn":7,"fix":{"range":[4078,4084],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":114,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":114,"endColumn":3,"fix":{"range":[4116,4118],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":116,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":116,"endColumn":3,"fix":{"range":[4124,4126],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":117,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":117,"endColumn":3,"fix":{"range":[4144,4146],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":118,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":118,"endColumn":5,"fix":{"range":[4193,4197],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":119,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":119,"endColumn":5,"fix":{"range":[4273,4277],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":120,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":120,"endColumn":3,"fix":{"range":[4294,4296],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":122,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":122,"endColumn":3,"fix":{"range":[4301,4303],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":124,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":124,"endColumn":3,"fix":{"range":[4386,4388],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":125,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":125,"endColumn":3,"fix":{"range":[4436,4438],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":126,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":126,"endColumn":5,"fix":{"range":[4458,4462],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":127,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":127,"endColumn":5,"fix":{"range":[4473,4477],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":128,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":128,"endColumn":5,"fix":{"range":[4501,4505],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":129,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":129,"endColumn":5,"fix":{"range":[4549,4553],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":130,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":130,"endColumn":5,"fix":{"range":[4569,4573],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":130,"column":45,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":130,"endColumn":50,"fix":{"range":[4613,4618],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":131,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":131,"endColumn":5,"fix":{"range":[4621,4625],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":132,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":132,"endColumn":5,"fix":{"range":[4649,4653],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":133,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":133,"endColumn":3,"fix":{"range":[4723,4725],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":135,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":135,"endColumn":3,"fix":{"range":[4731,4733],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":136,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":136,"endColumn":3,"fix":{"range":[4768,4770],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":138,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":138,"endColumn":3,"fix":{"range":[4810,4812],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":139,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":139,"endColumn":3,"fix":{"range":[4857,4859],"text":"    "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 140. Maximum allowed is 120.","line":140,"column":1,"nodeType":"Program","messageId":"max","endLine":140,"endColumn":141},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":140,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":140,"endColumn":3,"fix":{"range":[4945,4947],"text":"    "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":140,"column":132,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":140,"endColumn":137,"fix":{"range":[5076,5081],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":142,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":142,"endColumn":3,"fix":{"range":[5089,5091],"text":"    "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":142,"column":32,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":142,"endColumn":33,"fix":{"range":[5120,5121],"text":""}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":143,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":143,"endColumn":5,"fix":{"range":[5131,5135],"text":"      "}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":143,"column":25,"nodeType":"Identifier","messageId":"error","endLine":143,"endColumn":33,"fix":{"range":[5155,5163],"text":"Number.parseInt"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":144,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":144,"endColumn":5,"fix":{"range":[5192,5196],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":146,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":146,"endColumn":5,"fix":{"range":[5225,5229],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":147,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":147,"endColumn":5,"fix":{"range":[5264,5268],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":148,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":148,"endColumn":5,"fix":{"range":[5318,5322],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":149,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":149,"endColumn":7,"fix":{"range":[5357,5363],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":150,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":150,"endColumn":5,"fix":{"range":[5387,5391],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":152,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":152,"endColumn":5,"fix":{"range":[5396,5400],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":153,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":153,"endColumn":5,"fix":{"range":[5417,5421],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":154,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":154,"endColumn":5,"fix":{"range":[5463,5467],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":156,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":156,"endColumn":5,"fix":{"range":[5493,5497],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":5,"fix":{"range":[5535,5539],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":7,"fix":{"range":[5580,5586],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":7,"fix":{"range":[5615,5621],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":159,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":159,"endColumn":25,"fix":{"range":[5631,5639],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":7,"fix":{"range":[5642,5648],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":161,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":161,"endColumn":9,"fix":{"range":[5666,5674],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":162,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":162,"endColumn":11,"fix":{"range":[5708,5718],"text":"            "}},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":162,"column":29,"nodeType":"CallExpression","messageId":"array-from","endLine":162,"endColumn":64,"fix":{"range":[5736,5771],"text":"[...pollData.votes.values()]"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":163,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":163,"endColumn":11,"fix":{"range":[5806,5816],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":164,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":164,"endColumn":11,"fix":{"range":[5919,5929],"text":"            "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":164,"column":21,"nodeType":"MemberExpression","endLine":164,"endColumn":34},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":164,"column":107,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":164,"endColumn":143},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":165,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":165,"endColumn":9,"fix":{"range":[6071,6079],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[6096,6102],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":167,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":167,"endColumn":7,"fix":{"range":[6105,6111],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":168,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":168,"endColumn":7,"fix":{"range":[6184,6190],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":5,"fix":{"range":[6226,6230],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":171,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":171,"endColumn":3,"fix":{"range":[6293,6295],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":173,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":173,"endColumn":3,"fix":{"range":[6302,6304],"text":"    "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":173,"column":28,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":173,"endColumn":29,"fix":{"range":[6329,6330],"text":""}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":175,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":175,"endColumn":5,"fix":{"range":[6382,6386],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":177,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":177,"endColumn":5,"fix":{"range":[6419,6423],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":178,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":178,"endColumn":5,"fix":{"range":[6455,6459],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":179,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":179,"endColumn":7,"fix":{"range":[6498,6504],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":180,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":180,"endColumn":7,"fix":{"range":[6541,6547],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":180,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":180,"endColumn":25,"fix":{"range":[6557,6565],"text":"0x66_66_66"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[6568,6574],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":9,"fix":{"range":[6592,6600],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":183,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":183,"endColumn":11,"fix":{"range":[6634,6644],"text":"            "}},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":183,"column":29,"nodeType":"CallExpression","messageId":"array-from","endLine":183,"endColumn":64,"fix":{"range":[6662,6697],"text":"[...pollData.votes.values()]"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":184,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":184,"endColumn":11,"fix":{"range":[6732,6742],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":185,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":185,"endColumn":11,"fix":{"range":[6845,6855],"text":"            "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":185,"column":21,"nodeType":"MemberExpression","endLine":185,"endColumn":34},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":185,"column":107,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":185,"endColumn":143},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":186,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":186,"endColumn":9,"fix":{"range":[6997,7005],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":187,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":187,"endColumn":7,"fix":{"range":[7022,7028],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":188,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":188,"endColumn":7,"fix":{"range":[7031,7037],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":189,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":189,"endColumn":7,"fix":{"range":[7114,7120],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":191,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":191,"endColumn":5,"fix":{"range":[7140,7144],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":192,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":192,"endColumn":5,"fix":{"range":[7168,7172],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":193,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":193,"endColumn":7,"fix":{"range":[7212,7218],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":194,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":194,"endColumn":7,"fix":{"range":[7263,7269],"text":"        "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":194,"column":22,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":194,"endColumn":29,"fix":{"range":[7269,7418],"text":"for (const button of row.components) {\r\n        disabledRow.addComponents(\r\n          ButtonBuilder.from(button).setDisabled(true)\r\n        );\r\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":195,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":195,"endColumn":9,"fix":{"range":[7305,7313],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":196,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":196,"endColumn":11,"fix":{"range":[7341,7351],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":197,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":197,"endColumn":9,"fix":{"range":[7397,7405],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":198,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":198,"endColumn":7,"fix":{"range":[7409,7415],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":199,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":199,"endColumn":7,"fix":{"range":[7420,7426],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":200,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":200,"endColumn":5,"fix":{"range":[7447,7451],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":202,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":202,"endColumn":5,"fix":{"range":[7458,7462],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":203,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":203,"endColumn":3,"fix":{"range":[7544,7546],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":204,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":204,"endColumn":4,"fix":{"range":[7554,7554],"text":"\n"}}],"suppressedMessages":[],"errorCount":113,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":108,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, ComponentType , MessageFlags} from 'discord.js';\r\nimport { CommandError, handleCommandError } from '../errorHandler.js';\r\nimport { pollGames } from '../game-states.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('poll')\r\n  .setDescription('Create an interactive poll with up to 4 options')\r\n  .addStringOption(option =>\r\n    option.setName('question')\r\n      .setDescription('The poll question')\r\n      .setRequired(true))\r\n  .addStringOption(option =>\r\n    option.setName('option1')\r\n      .setDescription('First option')\r\n      .setRequired(true))\r\n  .addStringOption(option =>\r\n    option.setName('option2')\r\n      .setDescription('Second option')\r\n      .setRequired(true))\r\n  .addStringOption(option =>\r\n    option.setName('option3')\r\n      .setDescription('Third option (optional)')\r\n      .setRequired(false))\r\n  .addStringOption(option =>\r\n    option.setName('option4')\r\n      .setDescription('Fourth option (optional)')\r\n      .setRequired(false))\r\n  .addIntegerOption(option =>\r\n    option.setName('duration')\r\n      .setDescription('Duration in minutes (1-60, default: 10)')\r\n      .setMinValue(1)\r\n      .setMaxValue(60)\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n  try {\r\n    const question = interaction.options.getString('question');\r\n    const option1 = interaction.options.getString('option1');\r\n    const option2 = interaction.options.getString('option2');\r\n    const option3 = interaction.options.getString('option3');\r\n    const option4 = interaction.options.getString('option4');\r\n    const durationMinutes = interaction.options.getInteger('duration') || 10;\r\n\r\n    // Input validation\r\n    if (!question || question.trim().length === 0) {\r\n      return interaction.reply({\r\n        content: '‚ùå Question cannot be empty.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    if (question.length > 256) {\r\n      return interaction.reply({\r\n        content: '‚ùå Question must be 256 characters or less.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const options = [option1, option2, option3, option4].filter(Boolean);\r\n\r\n    // Validate options\r\n    if (options.length < 2) {\r\n      return interaction.reply({\r\n        content: '‚ùå You need at least 2 options for a poll.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Check for empty or duplicate options\r\n    const trimmedOptions = options.map(opt => opt.trim());\r\n    if (trimmedOptions.some(opt => opt.length === 0)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Options cannot be empty.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    if (trimmedOptions.some(opt => opt.length > 80)) {\r\n      return interaction.reply({\r\n        content: '‚ùå Each option must be 80 characters or less.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const uniqueOptions = new Set(trimmedOptions);\r\n    if (uniqueOptions.size !== trimmedOptions.length) {\r\n      return interaction.reply({\r\n        content: '‚ùå All options must be unique.',\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    const emojis = ['1Ô∏è‚É£', '2Ô∏è‚É£', '3Ô∏è‚É£', '4Ô∏è‚É£'];\r\n    const validOptions = trimmedOptions;\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle(`üìä ${question}`)\r\n    .setColor(0x0099FF)\r\n    .setDescription(validOptions.map((option, index) => `${emojis[index]} ${option}`).join('\\n\\n'))\r\n    .addFields({\r\n      name: 'Instructions',\r\n      value: 'Click the buttons below to vote! You can change your vote at any time.',\r\n      inline: false\r\n    })\r\n    .setFooter({ text: `Poll created by ${interaction.user.username} ‚Ä¢ Ends in ${durationMinutes} minutes` })\r\n    .setTimestamp(Date.now() + durationMinutes * 60000);\r\n\r\n  // Create buttons for each option\r\n  const buttons = validOptions.map((option, index) =>\r\n    new ButtonBuilder()\r\n      .setCustomId(`poll_${index}`)\r\n      .setLabel(`${emojis[index]} ${option.length > 15 ? option.substring(0, 15) + '...' : option}`)\r\n      .setStyle(ButtonStyle.Primary)\r\n  );\r\n\r\n  const rows = [];\r\n  for (let i = 0; i < buttons.length; i += 2) {\r\n    const row = new ActionRowBuilder().addComponents(buttons.slice(i, i + 2));\r\n    rows.push(row);\r\n  }\r\n\r\n  const message = await interaction.reply({ embeds: [embed], components: rows });\r\n\r\n  // Store poll data for tracking votes globally\r\n  const pollData = {\r\n    question,\r\n    options: validOptions,\r\n    votes: new Map(), // userId -> optionIndex\r\n    totalVotes: 0,\r\n    endTime: Date.now() + durationMinutes * 60000,\r\n    messageId: message.id,\r\n    pollType: 'single' // Currently single choice, can be extended later\r\n  };\r\n\r\n  // Store in global poll games map\r\n  pollGames.set(message.id, pollData);\r\n\r\n  // Set up collector for button interactions\r\n  const filter = (i) => i.customId.startsWith('poll_') && i.message.id === message.id;\r\n  const collector = message.createMessageComponentCollector({ componentType: ComponentType.Button, filter, time: durationMinutes * 60000 });\r\n\r\n  collector.on('collect', async (i) => {\r\n    const optionIndex = parseInt(i.customId.split('_')[1]);\r\n    const userId = i.user.id;\r\n\r\n    // Remove previous vote if exists\r\n    const previousVote = pollData.votes.get(userId);\r\n    if (previousVote !== undefined) {\r\n      pollData.totalVotes--;\r\n    }\r\n\r\n    // Add new vote\r\n    pollData.votes.set(userId, optionIndex);\r\n    pollData.totalVotes++;\r\n\r\n    // Update embed with current results\r\n    const updatedEmbed = new EmbedBuilder()\r\n      .setTitle(`üìä ${question}`)\r\n      .setColor(0x0099FF)\r\n      .setDescription(\r\n        options.map((option, index) => {\r\n          const voteCount = Array.from(pollData.votes.values()).filter(v => v === index).length;\r\n          const percentage = pollData.totalVotes > 0 ? Math.round((voteCount / pollData.totalVotes) * 100) : 0;\r\n          return `${emojis[index]} ${option}\\n${'‚ñà'.repeat(Math.max(1, percentage / 5))}${voteCount > 0 ? ` **${voteCount}** (${percentage}%)` : ''}`;\r\n        }).join('\\n\\n')\r\n      )\r\n      .setFooter({ text: `Total votes: ${pollData.totalVotes} ‚Ä¢ Poll ends` })\r\n      .setTimestamp(pollData.endTime);\r\n\r\n    await i.update({ embeds: [updatedEmbed], components: rows });\r\n  });\r\n\r\n  collector.on('end', async () => {\r\n    // Clean up poll data from global map\r\n    pollGames.delete(message.id);\r\n\r\n    // Final update when poll ends\r\n    const finalEmbed = new EmbedBuilder()\r\n      .setTitle(`üìä ${question} [ENDED]`)\r\n      .setColor(0x666666)\r\n      .setDescription(\r\n        options.map((option, index) => {\r\n          const voteCount = Array.from(pollData.votes.values()).filter(v => v === index).length;\r\n          const percentage = pollData.totalVotes > 0 ? Math.round((voteCount / pollData.totalVotes) * 100) : 0;\r\n          return `${emojis[index]} ${option}\\n${'‚ñà'.repeat(Math.max(1, percentage / 5))}${voteCount > 0 ? ` **${voteCount}** (${percentage}%)` : ''}`;\r\n        }).join('\\n\\n')\r\n      )\r\n      .setFooter({ text: `Final results ‚Ä¢ Total votes: ${pollData.totalVotes}` })\r\n      .setTimestamp();\r\n\r\n    // Disable all buttons\r\n    const disabledRows = rows.map(row => {\r\n      const disabledRow = new ActionRowBuilder();\r\n      row.components.forEach(button => {\r\n        disabledRow.addComponents(\r\n          ButtonBuilder.from(button).setDisabled(true)\r\n        );\r\n      });\r\n      return disabledRow;\r\n    });\r\n\r\n    await interaction.editReply({ embeds: [finalEmbed], components: disabledRows });\r\n  });\r\n  } catch (error) {\r\n    return handleCommandError(interaction, error);\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\profile.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":172,"fix":{"range":[171,171],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'updateProfile' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'checkMilestones' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (274). Maximum allowed is 100.","line":24,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":297,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (96). Maximum allowed is 30.","line":24,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":297,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 36. Maximum allowed is 20.","line":24,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":297,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 56 to the 15 allowed.","line":24,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":24,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":28,"column":3,"nodeType":null,"messageId":"prefer-switch","endLine":28,"endColumn":23,"fix":{"range":[1810,12526],"text":"switch (sub) {\n  case 'view': {\r\n    const targetUser = interaction.options.getUser('user');\r\n    const viewUserId = targetUser?.id || userId;\r\n\r\n    // Validate target user if specified\r\n    if (targetUser) {\r\n      validateUser(interaction, targetUser.id);\r\n    }\r\n\r\n    const viewUsername = targetUser?.username || interaction.user.username;\r\n\r\n    try {\r\n      const profile = getOrCreateProfile(viewUserId, viewUsername);\r\n      if (!profile) {\r\n        throw new CommandError('Failed to retrieve profile data.', 'NOT_FOUND');\r\n      }\r\n    const analytics = getProfileAnalytics(viewUserId);\r\n    const insights = generateProfileInsights(viewUserId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üë§ ${profile.displayName}'s Profile`)\r\n      .setColor(profile.customization.border_color)\r\n      .setDescription(profile.bio || 'No bio set.')\r\n      .setThumbnail(interaction.user.displayAvatarURL());\r\n\r\n    // Add profile customization\r\n    if (profile.customization.profile_banner) {\r\n      embed.setImage(profile.customization.profile_banner);\r\n    }\r\n\r\n    // Add title if set\r\n    if (profile.customization.title) {\r\n      embed.setAuthor({ name: profile.customization.title });\r\n    }\r\n\r\n    // Add statistics based on privacy settings\r\n    if (profile.customization.show_statistics) {\r\n      embed.addFields(\r\n        {\r\n          name: 'üèÜ Level & Engagement',\r\n          value: `**Level:** ${analytics.totalLevel || 1}\\n**Engagement:** ${analytics.engagementLevel}\\n**Activity Score:** ${Math.round(analytics.activityScore)}/100`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üéØ Most Active',\r\n          value: `**Category:** ${analytics.mostActiveCategory.toUpperCase()}\\n**Playtime:** ${analytics.totalPlayTime}h\\n**Account Age:** ${analytics.accountAge} days`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üìà Key Stats',\r\n          value: `**Commands:** ${profile.statistics.activity.commands_used}\\n**Messages:** ${profile.statistics.activity.messages_sent}\\n**Achievements:** ${profile.achievements.length}`,\r\n          inline: true\r\n        }\r\n      );\r\n    }\r\n\r\n    // Add badges if enabled\r\n    if (profile.customization.show_badges && profile.badges.length > 0) {\r\n      const badgeText = profile.badges.slice(0, 5).map(badge => badge.icon || 'üèÜ').join(' ');\r\n      embed.addFields({\r\n        name: 'üèÖ Recent Badges',\r\n        value: badgeText,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    // Add insights\r\n    if (insights.length > 0) {\r\n      embed.addFields({\r\n        name: 'üí° Profile Insights',\r\n        value: insights.slice(0, 3).join('\\n'),\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    // Add profile action buttons\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`profile_edit:${viewUserId}`).setLabel('‚úèÔ∏è Edit Profile').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`profile_refresh:${viewUserId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Secondary),\r\n      new ButtonBuilder().setCustomId(`profile_compare:${viewUserId}:${userId}`).setLabel('‚öñÔ∏è Compare').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to display profile: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'edit': {\r\n    // Show profile editing interface\r\n    const modal = new ModalBuilder().setCustomId(`profile_edit_modal:${userId}`).setTitle('Edit Profile');\r\n    const displayNameInput = new TextInputBuilder().setCustomId('display_name').setLabel('Display Name').setStyle(TextInputStyle.Short).setRequired(false).setPlaceholder('Your display name');\r\n    const bioInput = new TextInputBuilder().setCustomId('bio').setLabel('Bio').setStyle(TextInputStyle.Paragraph).setRequired(false).setPlaceholder('Tell us about yourself...');\r\n    const titleInput = new TextInputBuilder().setCustomId('title').setLabel('Profile Title').setStyle(TextInputStyle.Short).setRequired(false).setPlaceholder('Adventurer Extraordinaire');\r\n\r\n    modal.addComponents({ type: 1, components: [displayNameInput] });\r\n    modal.addComponents({ type: 1, components: [bioInput] });\r\n    modal.addComponents({ type: 1, components: [titleInput] });\r\n\r\n    await interaction.showModal(modal);\r\n    return;\r\n\r\n  }\n  case 'compare': {\r\n    const otherUser = interaction.options.getUser('user');\r\n\r\n    if (!otherUser) {\r\n      throw new CommandError('You must specify a user to compare with.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    validateUser(interaction, otherUser.id);\r\n\r\n    if (otherUser.id === userId) {\r\n      return interaction.reply({ content: '‚ùå You cannot compare your profile with yourself!', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    try {\r\n      const comparison = compareProfiles(userId, otherUser.id);\r\n      if (!comparison) {\r\n        throw new CommandError('Failed to compare profiles.', 'COMMAND_ERROR');\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('‚öñÔ∏è Profile Comparison')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Comparing **${interaction.user.username}** vs **${otherUser.username}**`);\r\n\r\n    // Add comparison results\r\n    const categories = ['rpg', 'games', 'social', 'activity'];\r\n    categories.forEach(category => {\r\n      const categoryComparison = comparison.comparison[category];\r\n      const leadingStats = [];\r\n\r\n      for (const [stat, data] of Object.entries(categoryComparison)) {\r\n        if (data.difference !== 0) {\r\n          const leader = data.difference > 0 ? 'You' : otherUser.username;\r\n          leadingStats.push(`${stat}: ${leader} (+${Math.abs(data.difference)})`);\r\n        }\r\n      }\r\n\r\n      if (leadingStats.length > 0) {\r\n        embed.addFields({\r\n          name: category.toUpperCase(),\r\n          value: leadingStats.slice(0, 3).join('\\n'),\r\n          inline: true\r\n        });\r\n      }\r\n    });\r\n\r\n    const winner = comparison.winner === 'user1' ? 'You' : comparison.winner === 'user2' ? otherUser.username : 'Tie';\r\n    embed.addFields({\r\n      name: 'üèÜ Overall Winner',\r\n      value: winner,\r\n      inline: false\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to compare profiles: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'search': {\r\n    const query = interaction.options.getString('query');\r\n\r\n    validateNotEmpty(query, 'search query');\r\n    validateRange(query.length, 2, 100, 'query length');\r\n\r\n    try {\r\n      const results = searchProfiles(query, 5);\r\n      if (!Array.isArray(results)) {\r\n        throw new CommandError('Failed to search profiles.', 'COMMAND_ERROR');\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üîç Search Results for \"${query}\"`)\r\n      .setColor(0x0099FF);\r\n\r\n    results.forEach((profile, index) => {\r\n      embed.addFields({\r\n        name: `${index + 1}. ${profile.displayName}`,\r\n        value: `**Level:** ${getUserLevel(profile)}\\n**Achievements:** ${profile.achievements.length}\\n**Bio:** ${profile.bio || 'No bio'}`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to search profiles: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'leaderboard': {\r\n    const category = interaction.options.getString('category');\r\n    const stat = interaction.options.getString('stat');\r\n\r\n    validateNotEmpty(category, 'category');\r\n    validateNotEmpty(stat, 'stat');\r\n\r\n    const validCategories = ['rpg', 'games', 'social', 'activity'];\r\n    const validStats = {\r\n      rpg: ['total_level', 'bosses_defeated', 'items_collected'],\r\n      games: ['trivia_correct', 'hangman_wins', 'memory_games_completed'],\r\n      social: ['guilds_created', 'trades_completed', 'reputation'],\r\n      activity: ['commands_used', 'messages_sent', 'streak_days']\r\n    };\r\n\r\n    if (!validCategories.includes(category)) {\r\n      throw new CommandError('Invalid category. Use: rpg, games, social, activity', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (!validStats[category]?.includes(stat)) {\r\n      throw new CommandError(`Invalid stat for ${category}. Available: ${validStats[category].join(', ')}`, 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    try {\r\n      const leaderboard = getLeaderboard(category, stat, 10);\r\n      if (!Array.isArray(leaderboard)) {\r\n        throw new CommandError('Failed to retrieve leaderboard data.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (leaderboard.length === 0) {\r\n        return interaction.reply({ content: 'üìä No data available for this leaderboard yet.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üèÜ ${category.toUpperCase()} Leaderboard - ${stat.replace('_', ' ').toUpperCase()}`)\r\n      .setColor(0xFFD700);\r\n\r\n    leaderboard.forEach((entry, index) => {\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank} - ${entry.displayName}`,\r\n        value: `**Value:** ${entry.value}\\n**Level:** ${entry.level}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to retrieve leaderboard: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'insights': {\r\n    try {\r\n      const insights = generateProfileInsights(userId);\r\n      if (!Array.isArray(insights)) {\r\n        throw new CommandError('Failed to generate profile insights.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (insights.length === 0) {\r\n        return interaction.reply({ content: 'üí° Start using more bot features to get personalized insights!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí° Profile Insights')\r\n        .setColor(0x9932CC)\r\n        .setDescription('AI-powered analysis of your bot usage patterns:');\r\n\r\n      insights.forEach((insight, index) => {\r\n        embed.addFields({\r\n          name: `Insight #${index + 1}`,\r\n          value: insight,\r\n          inline: false\r\n        });\r\n      });\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to generate insights: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n  \n  break;\n  }\n  // No default\n  }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":44,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":44,"endColumn":5,"fix":{"range":[2342,2346],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":45,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":45,"endColumn":5,"fix":{"range":[2398,2402],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":47,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":47,"endColumn":5,"fix":{"range":[2459,2463],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":48,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":48,"endColumn":7,"fix":{"range":[2497,2503],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":49,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":49,"endColumn":7,"fix":{"range":[2553,2559],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":50,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":50,"endColumn":7,"fix":{"range":[2606,2612],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":51,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":51,"endColumn":7,"fix":{"range":[2659,2665],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":53,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":53,"endColumn":5,"fix":{"range":[2720,2724],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":54,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":54,"endColumn":5,"fix":{"range":[2754,2758],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":55,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":55,"endColumn":7,"fix":{"range":[2803,2809],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":56,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":56,"endColumn":5,"fix":{"range":[2864,2868],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":58,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":58,"endColumn":5,"fix":{"range":[2873,2877],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":59,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[2898,2902],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":60,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":60,"endColumn":7,"fix":{"range":[2938,2944],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":61,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":61,"endColumn":5,"fix":{"range":[3001,3005],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":63,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":63,"endColumn":5,"fix":{"range":[3010,3014],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":64,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":64,"endColumn":5,"fix":{"range":[3059,3063],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":65,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":65,"endColumn":7,"fix":{"range":[3109,3115],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":66,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":66,"endColumn":9,"fix":{"range":[3133,3141],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":67,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":67,"endColumn":11,"fix":{"range":[3144,3154],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 169. Maximum allowed is 120.","line":68,"column":1,"nodeType":"Program","messageId":"max","endLine":68,"endColumn":170},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":68,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":68,"endColumn":11,"fix":{"range":[3186,3196],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":69,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":69,"endColumn":11,"fix":{"range":[3357,3367],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":70,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":70,"endColumn":9,"fix":{"range":[3381,3389],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":71,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":71,"endColumn":9,"fix":{"range":[3393,3401],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":72,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":72,"endColumn":11,"fix":{"range":[3404,3414],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 169. Maximum allowed is 120.","line":73,"column":1,"nodeType":"Program","messageId":"max","endLine":73,"endColumn":170},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":73,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":73,"endColumn":11,"fix":{"range":[3439,3449],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":74,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":74,"endColumn":11,"fix":{"range":[3610,3620],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":75,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":75,"endColumn":9,"fix":{"range":[3634,3642],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":76,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":76,"endColumn":9,"fix":{"range":[3646,3654],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":77,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":77,"endColumn":11,"fix":{"range":[3657,3667],"text":"            "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 188. Maximum allowed is 120.","line":78,"column":1,"nodeType":"Program","messageId":"max","endLine":78,"endColumn":189},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":78,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":78,"endColumn":11,"fix":{"range":[3690,3700],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":79,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":79,"endColumn":11,"fix":{"range":[3880,3890],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":80,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":80,"endColumn":9,"fix":{"range":[3904,3912],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":81,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":81,"endColumn":7,"fix":{"range":[3915,3921],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":82,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":82,"endColumn":5,"fix":{"range":[3925,3929],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":84,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":84,"endColumn":5,"fix":{"range":[3934,3938],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":85,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":85,"endColumn":5,"fix":{"range":[3964,3968],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":86,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":86,"endColumn":7,"fix":{"range":[4039,4045],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":87,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":87,"endColumn":7,"fix":{"range":[4135,4141],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":88,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":88,"endColumn":9,"fix":{"range":[4160,4168],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":89,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":89,"endColumn":9,"fix":{"range":[4195,4203],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":90,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":90,"endColumn":9,"fix":{"range":[4222,4230],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":91,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":91,"endColumn":7,"fix":{"range":[4245,4251],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":92,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":92,"endColumn":5,"fix":{"range":[4256,4260],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":94,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":94,"endColumn":5,"fix":{"range":[4265,4269],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":95,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":95,"endColumn":5,"fix":{"range":[4286,4290],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":96,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":96,"endColumn":7,"fix":{"range":[4318,4324],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":97,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":97,"endColumn":9,"fix":{"range":[4343,4351],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":98,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":98,"endColumn":9,"fix":{"range":[4381,4389],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":99,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":99,"endColumn":9,"fix":{"range":[4430,4438],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":100,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":100,"endColumn":7,"fix":{"range":[4453,4459],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":101,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":101,"endColumn":5,"fix":{"range":[4464,4468],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":103,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":103,"endColumn":5,"fix":{"range":[4473,4477],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":104,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":104,"endColumn":5,"fix":{"range":[4508,4512],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":105,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":105,"endColumn":7,"fix":{"range":[4563,4569],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":106,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":106,"endColumn":7,"fix":{"range":[4691,4697],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":107,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":107,"endColumn":7,"fix":{"range":[4819,4825],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":108,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":108,"endColumn":5,"fix":{"range":[4956,4960],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":111,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":111,"endColumn":6,"fix":{"range":[5043,5043],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":115,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":115,"endColumn":4,"fix":{"range":[5202,5202],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":129,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":129,"endColumn":4,"fix":{"range":[6201,6201],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":148,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":148,"endColumn":5,"fix":{"range":[6838,6842],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":149,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":149,"endColumn":7,"fix":{"range":[6876,6882],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":150,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":150,"endColumn":7,"fix":{"range":[6918,6924],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":150,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":150,"endColumn":25,"fix":{"range":[6934,6942],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":151,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":151,"endColumn":7,"fix":{"range":[6945,6951],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":153,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":153,"endColumn":5,"fix":{"range":[7046,7050],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":154,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":154,"endColumn":5,"fix":{"range":[7077,7081],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":155,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":155,"endColumn":5,"fix":{"range":[7141,7145],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":155,"column":16,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":155,"endColumn":23,"fix":{"range":[7145,7786],"text":"for (const category of categories) {\r\n      const categoryComparison = comparison.comparison[category];\r\n      const leadingStats = [];\r\n\r\n      for (const [stat, data] of Object.entries(categoryComparison)) {\r\n        if (data.difference !== 0) {\r\n          const leader = data.difference > 0 ? 'You' : otherUser.username;\r\n          leadingStats.push(`${stat}: ${leader} (+${Math.abs(data.difference)})`);\r\n        }\r\n      }\r\n\r\n      if (leadingStats.length > 0) {\r\n        embed.addFields({\r\n          name: category.toUpperCase(),\r\n          value: leadingStats.slice(0, 3).join('\\n'),\r\n          inline: true\r\n        });\r\n      }\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":156,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":156,"endColumn":7,"fix":{"range":[7179,7185],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":156,"column":34,"nodeType":"MemberExpression","endLine":156,"endColumn":65},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":7,"fix":{"range":[7246,7252],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":159,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":159,"endColumn":7,"fix":{"range":[7280,7286],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":160,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":160,"endColumn":9,"fix":{"range":[7352,7360],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":161,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":161,"endColumn":11,"fix":{"range":[7390,7400],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":162,"endColumn":11,"fix":{"range":[7466,7476],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":163,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":163,"endColumn":9,"fix":{"range":[7550,7558],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":164,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":164,"endColumn":7,"fix":{"range":[7561,7567],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[7572,7578],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":167,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":167,"endColumn":9,"fix":{"range":[7610,7618],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":168,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":168,"endColumn":11,"fix":{"range":[7637,7647],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":169,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":169,"endColumn":11,"fix":{"range":[7678,7688],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":11,"fix":{"range":[7733,7743],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":171,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":171,"endColumn":9,"fix":{"range":[7757,7765],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":172,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":172,"endColumn":7,"fix":{"range":[7770,7776],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":173,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":173,"endColumn":5,"fix":{"range":[7779,7783],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":175,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":175,"endColumn":5,"fix":{"range":[7790,7794],"text":"      "}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":175,"column":60,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":175,"endColumn":118,"fix":{"range":[7849,7907],"text":"(comparison.winner === 'user2' ? otherUser.username : 'Tie')"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":176,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":176,"endColumn":5,"fix":{"range":[7910,7914],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":177,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":177,"endColumn":7,"fix":{"range":[7933,7939],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":178,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":178,"endColumn":7,"fix":{"range":[7967,7973],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":179,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":179,"endColumn":7,"fix":{"range":[7989,7995],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":180,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":180,"endColumn":5,"fix":{"range":[8010,8014],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":5,"fix":{"range":[8021,8025],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":183,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":183,"endColumn":6,"fix":{"range":[8108,8108],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":187,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":187,"endColumn":4,"fix":{"range":[8268,8268],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":199,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":199,"endColumn":5,"fix":{"range":[8655,8659],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":200,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":200,"endColumn":7,"fix":{"range":[8693,8699],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":201,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":201,"endColumn":7,"fix":{"range":[8746,8752],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":201,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":201,"endColumn":25,"fix":{"range":[8762,8770],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":5,"fix":{"range":[8776,8780],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":203,"column":13,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":203,"endColumn":20,"fix":{"range":[8780,9082],"text":"for (const [index, profile] of results.entries()) {\r\n      embed.addFields({\r\n        name: `${index + 1}. ${profile.displayName}`,\r\n        value: `**Level:** ${getUserLevel(profile)}\\n**Achievements:** ${profile.achievements.length}\\n**Bio:** ${profile.bio || 'No bio'}`,\r\n        inline: false\r\n      });\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":204,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":204,"endColumn":7,"fix":{"range":[8819,8825],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":205,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":205,"endColumn":9,"fix":{"range":[8844,8852],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":206,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":206,"endColumn":9,"fix":{"range":[8899,8907],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":207,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":207,"endColumn":9,"fix":{"range":[9041,9049],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":208,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":208,"endColumn":7,"fix":{"range":[9064,9070],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":209,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":209,"endColumn":5,"fix":{"range":[9075,9079],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":211,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":211,"endColumn":5,"fix":{"range":[9086,9090],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":212,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":212,"endColumn":6,"fix":{"range":[9173,9173],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":216,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":216,"endColumn":4,"fix":{"range":[9332,9332],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":235,"column":10,"nodeType":"MemberExpression","endLine":235,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":74,"nodeType":"MemberExpression","endLine":236,"endColumn":94},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":249,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":249,"endColumn":5,"fix":{"range":[10708,10712],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":250,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":250,"endColumn":7,"fix":{"range":[10746,10752],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":251,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":251,"endColumn":7,"fix":{"range":[10849,10855],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":251,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":251,"endColumn":25,"fix":{"range":[10865,10873],"text":"0xFF_D7_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":253,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":253,"endColumn":5,"fix":{"range":[10879,10883],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":253,"column":17,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":253,"endColumn":24,"fix":{"range":[10883,11238],"text":"for (const [index, entry] of leaderboard.entries()) {\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank} - ${entry.displayName}`,\r\n        value: `**Value:** ${entry.value}\\n**Level:** ${entry.level}`,\r\n        inline: true\r\n      });\r\n    }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":254,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":254,"endColumn":7,"fix":{"range":[10924,10930],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":255,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":255,"endColumn":7,"fix":{"range":[10955,10961],"text":"        "}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Do not nest ternary expressions.","line":255,"column":61,"nodeType":"ConditionalExpression","messageId":"too-deep","endLine":255,"endColumn":85},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":256,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":256,"endColumn":7,"fix":{"range":[11042,11048],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":257,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":257,"endColumn":9,"fix":{"range":[11067,11075],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":258,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":258,"endColumn":9,"fix":{"range":[11126,11134],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":259,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":259,"endColumn":9,"fix":{"range":[11198,11206],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":260,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":260,"endColumn":7,"fix":{"range":[11220,11226],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":261,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":261,"endColumn":5,"fix":{"range":[11231,11235],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":263,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":263,"endColumn":5,"fix":{"range":[11242,11246],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":264,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":264,"endColumn":6,"fix":{"range":[11298,11298],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":268,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":268,"endColumn":4,"fix":{"range":[11462,11462],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":281,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":281,"endColumn":27,"fix":{"range":[11995,12003],"text":"0x99_32_CC"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":284,"column":16,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":284,"endColumn":23,"fix":{"range":[12091,12274],"text":"for (const [index, insight] of insights.entries()) {\r\n        embed.addFields({\r\n          name: `Insight #${index + 1}`,\r\n          value: insight,\r\n          inline: false\r\n        });\r\n      }"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":293,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":293,"endColumn":6,"fix":{"range":[12367,12367],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (316). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":316,"endColumn":2}],"suppressedMessages":[],"errorCount":141,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":133,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags, ModalBuilder, TextInputBuilder, TextInputStyle } from 'discord.js';\r\nimport {\r\n  getOrCreateProfile,\r\n  updateProfile,\r\n  getProfileAnalytics,\r\n  compareProfiles,\r\n  searchProfiles,\r\n  getLeaderboard,\r\n  generateProfileInsights,\r\n  checkMilestones\r\n} from '../profiles.js';\r\nimport { safeExecuteCommand, CommandError, validateUser, validateRange, validateNotEmpty } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('profile')\r\n  .setDescription('Advanced user profile management and statistics')\r\n  .addSubcommand(sub => sub.setName('view').setDescription('View your profile').addUserOption(opt => opt.setName('user').setDescription('User to view (defaults to yourself)')))\r\n  .addSubcommand(sub => sub.setName('edit').setDescription('Edit your profile settings'))\r\n  .addSubcommand(sub => sub.setName('compare').setDescription('Compare profiles with another user').addUserOption(opt => opt.setName('user').setDescription('User to compare with').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('search').setDescription('Search for user profiles').addStringOption(opt => opt.setName('query').setDescription('Search term').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('leaderboard').setDescription('View leaderboards').addStringOption(opt => opt.setName('category').setDescription('Category').setRequired(true)).addStringOption(opt => opt.setName('stat').setDescription('Statistic').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('insights').setDescription('Get AI-powered profile insights'));\r\n\r\nexport async function execute(interaction) {\r\n  const sub = interaction.options.getSubcommand();\r\n  const userId = interaction.user.id;\r\n\r\n  if (sub === 'view') {\r\n    const targetUser = interaction.options.getUser('user');\r\n    const viewUserId = targetUser?.id || userId;\r\n\r\n    // Validate target user if specified\r\n    if (targetUser) {\r\n      validateUser(interaction, targetUser.id);\r\n    }\r\n\r\n    const viewUsername = targetUser?.username || interaction.user.username;\r\n\r\n    try {\r\n      const profile = getOrCreateProfile(viewUserId, viewUsername);\r\n      if (!profile) {\r\n        throw new CommandError('Failed to retrieve profile data.', 'NOT_FOUND');\r\n      }\r\n    const analytics = getProfileAnalytics(viewUserId);\r\n    const insights = generateProfileInsights(viewUserId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üë§ ${profile.displayName}'s Profile`)\r\n      .setColor(profile.customization.border_color)\r\n      .setDescription(profile.bio || 'No bio set.')\r\n      .setThumbnail(interaction.user.displayAvatarURL());\r\n\r\n    // Add profile customization\r\n    if (profile.customization.profile_banner) {\r\n      embed.setImage(profile.customization.profile_banner);\r\n    }\r\n\r\n    // Add title if set\r\n    if (profile.customization.title) {\r\n      embed.setAuthor({ name: profile.customization.title });\r\n    }\r\n\r\n    // Add statistics based on privacy settings\r\n    if (profile.customization.show_statistics) {\r\n      embed.addFields(\r\n        {\r\n          name: 'üèÜ Level & Engagement',\r\n          value: `**Level:** ${analytics.totalLevel || 1}\\n**Engagement:** ${analytics.engagementLevel}\\n**Activity Score:** ${Math.round(analytics.activityScore)}/100`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üéØ Most Active',\r\n          value: `**Category:** ${analytics.mostActiveCategory.toUpperCase()}\\n**Playtime:** ${analytics.totalPlayTime}h\\n**Account Age:** ${analytics.accountAge} days`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üìà Key Stats',\r\n          value: `**Commands:** ${profile.statistics.activity.commands_used}\\n**Messages:** ${profile.statistics.activity.messages_sent}\\n**Achievements:** ${profile.achievements.length}`,\r\n          inline: true\r\n        }\r\n      );\r\n    }\r\n\r\n    // Add badges if enabled\r\n    if (profile.customization.show_badges && profile.badges.length > 0) {\r\n      const badgeText = profile.badges.slice(0, 5).map(badge => badge.icon || 'üèÜ').join(' ');\r\n      embed.addFields({\r\n        name: 'üèÖ Recent Badges',\r\n        value: badgeText,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    // Add insights\r\n    if (insights.length > 0) {\r\n      embed.addFields({\r\n        name: 'üí° Profile Insights',\r\n        value: insights.slice(0, 3).join('\\n'),\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    // Add profile action buttons\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`profile_edit:${viewUserId}`).setLabel('‚úèÔ∏è Edit Profile').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`profile_refresh:${viewUserId}`).setLabel('üîÑ Refresh').setStyle(ButtonStyle.Secondary),\r\n      new ButtonBuilder().setCustomId(`profile_compare:${viewUserId}:${userId}`).setLabel('‚öñÔ∏è Compare').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to display profile: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'edit') {\r\n    // Show profile editing interface\r\n    const modal = new ModalBuilder().setCustomId(`profile_edit_modal:${userId}`).setTitle('Edit Profile');\r\n    const displayNameInput = new TextInputBuilder().setCustomId('display_name').setLabel('Display Name').setStyle(TextInputStyle.Short).setRequired(false).setPlaceholder('Your display name');\r\n    const bioInput = new TextInputBuilder().setCustomId('bio').setLabel('Bio').setStyle(TextInputStyle.Paragraph).setRequired(false).setPlaceholder('Tell us about yourself...');\r\n    const titleInput = new TextInputBuilder().setCustomId('title').setLabel('Profile Title').setStyle(TextInputStyle.Short).setRequired(false).setPlaceholder('Adventurer Extraordinaire');\r\n\r\n    modal.addComponents({ type: 1, components: [displayNameInput] });\r\n    modal.addComponents({ type: 1, components: [bioInput] });\r\n    modal.addComponents({ type: 1, components: [titleInput] });\r\n\r\n    await interaction.showModal(modal);\r\n    return;\r\n\r\n  } else if (sub === 'compare') {\r\n    const otherUser = interaction.options.getUser('user');\r\n\r\n    if (!otherUser) {\r\n      throw new CommandError('You must specify a user to compare with.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    validateUser(interaction, otherUser.id);\r\n\r\n    if (otherUser.id === userId) {\r\n      return interaction.reply({ content: '‚ùå You cannot compare your profile with yourself!', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    try {\r\n      const comparison = compareProfiles(userId, otherUser.id);\r\n      if (!comparison) {\r\n        throw new CommandError('Failed to compare profiles.', 'COMMAND_ERROR');\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('‚öñÔ∏è Profile Comparison')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Comparing **${interaction.user.username}** vs **${otherUser.username}**`);\r\n\r\n    // Add comparison results\r\n    const categories = ['rpg', 'games', 'social', 'activity'];\r\n    categories.forEach(category => {\r\n      const categoryComparison = comparison.comparison[category];\r\n      const leadingStats = [];\r\n\r\n      for (const [stat, data] of Object.entries(categoryComparison)) {\r\n        if (data.difference !== 0) {\r\n          const leader = data.difference > 0 ? 'You' : otherUser.username;\r\n          leadingStats.push(`${stat}: ${leader} (+${Math.abs(data.difference)})`);\r\n        }\r\n      }\r\n\r\n      if (leadingStats.length > 0) {\r\n        embed.addFields({\r\n          name: category.toUpperCase(),\r\n          value: leadingStats.slice(0, 3).join('\\n'),\r\n          inline: true\r\n        });\r\n      }\r\n    });\r\n\r\n    const winner = comparison.winner === 'user1' ? 'You' : comparison.winner === 'user2' ? otherUser.username : 'Tie';\r\n    embed.addFields({\r\n      name: 'üèÜ Overall Winner',\r\n      value: winner,\r\n      inline: false\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to compare profiles: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'search') {\r\n    const query = interaction.options.getString('query');\r\n\r\n    validateNotEmpty(query, 'search query');\r\n    validateRange(query.length, 2, 100, 'query length');\r\n\r\n    try {\r\n      const results = searchProfiles(query, 5);\r\n      if (!Array.isArray(results)) {\r\n        throw new CommandError('Failed to search profiles.', 'COMMAND_ERROR');\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üîç Search Results for \"${query}\"`)\r\n      .setColor(0x0099FF);\r\n\r\n    results.forEach((profile, index) => {\r\n      embed.addFields({\r\n        name: `${index + 1}. ${profile.displayName}`,\r\n        value: `**Level:** ${getUserLevel(profile)}\\n**Achievements:** ${profile.achievements.length}\\n**Bio:** ${profile.bio || 'No bio'}`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to search profiles: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'leaderboard') {\r\n    const category = interaction.options.getString('category');\r\n    const stat = interaction.options.getString('stat');\r\n\r\n    validateNotEmpty(category, 'category');\r\n    validateNotEmpty(stat, 'stat');\r\n\r\n    const validCategories = ['rpg', 'games', 'social', 'activity'];\r\n    const validStats = {\r\n      rpg: ['total_level', 'bosses_defeated', 'items_collected'],\r\n      games: ['trivia_correct', 'hangman_wins', 'memory_games_completed'],\r\n      social: ['guilds_created', 'trades_completed', 'reputation'],\r\n      activity: ['commands_used', 'messages_sent', 'streak_days']\r\n    };\r\n\r\n    if (!validCategories.includes(category)) {\r\n      throw new CommandError('Invalid category. Use: rpg, games, social, activity', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (!validStats[category]?.includes(stat)) {\r\n      throw new CommandError(`Invalid stat for ${category}. Available: ${validStats[category].join(', ')}`, 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    try {\r\n      const leaderboard = getLeaderboard(category, stat, 10);\r\n      if (!Array.isArray(leaderboard)) {\r\n        throw new CommandError('Failed to retrieve leaderboard data.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (leaderboard.length === 0) {\r\n        return interaction.reply({ content: 'üìä No data available for this leaderboard yet.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üèÜ ${category.toUpperCase()} Leaderboard - ${stat.replace('_', ' ').toUpperCase()}`)\r\n      .setColor(0xFFD700);\r\n\r\n    leaderboard.forEach((entry, index) => {\r\n      const rank = index + 1;\r\n      const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÖ';\r\n      embed.addFields({\r\n        name: `${medal} #${rank} - ${entry.displayName}`,\r\n        value: `**Value:** ${entry.value}\\n**Level:** ${entry.level}`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed] });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to retrieve leaderboard: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'insights') {\r\n    try {\r\n      const insights = generateProfileInsights(userId);\r\n      if (!Array.isArray(insights)) {\r\n        throw new CommandError('Failed to generate profile insights.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (insights.length === 0) {\r\n        return interaction.reply({ content: 'üí° Start using more bot features to get personalized insights!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí° Profile Insights')\r\n        .setColor(0x9932CC)\r\n        .setDescription('AI-powered analysis of your bot usage patterns:');\r\n\r\n      insights.forEach((insight, index) => {\r\n        embed.addFields({\r\n          name: `Insight #${index + 1}`,\r\n          value: insight,\r\n          inline: false\r\n        });\r\n      });\r\n\r\n      await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to generate insights: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}\r\n\r\n// Helper function for user level calculation\r\nfunction getUserLevel(profile) {\r\n  if (!profile || !profile.achievements || !profile.statistics) {\r\n    return 1;\r\n  }\r\n\r\n  const achievementsPoints = (profile.achievements.length || 0) * 10;\r\n  const rpgPoints = profile.statistics.rpg?.total_level || 0;\r\n  const triviaPoints = profile.statistics.games?.trivia_correct || 0;\r\n  const reputationPoints = profile.statistics.social?.reputation || 0;\r\n\r\n  const totalPoints = achievementsPoints + rpgPoints + triviaPoints + reputationPoints;\r\n  return Math.max(1, Math.floor(totalPoints / 100) + 1);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\remind.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (247). Maximum allowed is 100.","line":25,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":271,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (96). Maximum allowed is 30.","line":25,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":271,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 37. Maximum allowed is 20.","line":25,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":271,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 55 to the 15 allowed.","line":25,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":25,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":28,"column":3,"nodeType":null,"messageId":"prefer-switch","endLine":28,"endColumn":21,"fix":{"range":[2366,11894],"text":"switch (sub) {\n  case 'me': {\r\n    const when = interaction.options.getString('when');\r\n    const what = interaction.options.getString('what');\r\n    const title = interaction.options.getString('title') || 'Reminder';\r\n\r\n    validateNotEmpty(when, 'time');\r\n    validateNotEmpty(what, 'reminder message');\r\n\r\n    try {\r\n      const scheduledTime = parseTime(when);\r\n\r\n      if (!scheduledTime) {\r\n        throw new CommandError('Invalid time format. Use formats like \"in 30 minutes\", \"tomorrow 3pm\", \"next friday 2pm\".', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (scheduledTime <= Date.now()) {\r\n        throw new CommandError('Cannot schedule reminders in the past!', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const maxReminderTime = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\r\n      if (scheduledTime > maxReminderTime) {\r\n        throw new CommandError('Cannot schedule reminders more than 1 year in advance.', 'OUT_OF_RANGE');\r\n      }\r\n\r\n      const reminderData = {\r\n        title,\r\n        message: what,\r\n        scheduledFor: scheduledTime,\r\n        channelId: interaction.channel.id,\r\n        guildId: interaction.guild?.id || null\r\n      };\r\n\r\n      const reminder = createReminder(interaction.user.id, reminderData);\r\n\r\n      const timeUntil = Math.round((scheduledTime - Date.now()) / 60000); // Convert to minutes\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚è∞ Reminder Set!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${title}**`)\r\n        .addFields(\r\n          { name: 'üìù Message', value: what, inline: false },\r\n          { name: '‚è±Ô∏è When', value: `In ${timeUntil} minutes (${new Date(scheduledTime).toLocaleString()})`, inline: true },\r\n          { name: 'üÜî Reminder ID', value: `\\`${reminder.id}\\``, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create reminder: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'event': {\r\n    validateGuild(interaction);\r\n\r\n    const title = interaction.options.getString('title');\r\n    const description = interaction.options.getString('description');\r\n    const when = interaction.options.getString('when');\r\n    const duration = interaction.options.getInteger('duration') || 60;\r\n    const maxParticipants = interaction.options.getInteger('max_participants') || 0;\r\n\r\n    validateNotEmpty(title, 'event title');\r\n    validateNotEmpty(description, 'event description');\r\n    validateNotEmpty(when, 'event time');\r\n    validateRange(duration, 1, 1440, 'duration (minutes)'); // Max 24 hours\r\n    validateRange(maxParticipants, 0, 1000, 'max participants');\r\n\r\n    try {\r\n      const startTime = parseTime(when);\r\n\r\n      if (!startTime) {\r\n        throw new CommandError('Invalid time format. Use formats like \"in 30 minutes\", \"tomorrow 3pm\", \"next friday 2pm\".', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (startTime <= Date.now()) {\r\n        throw new CommandError('Cannot schedule events in the past!', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const maxEventTime = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\r\n      if (startTime > maxEventTime) {\r\n        throw new CommandError('Cannot schedule events more than 1 year in advance.', 'OUT_OF_RANGE');\r\n      }\r\n\r\n      const eventData = {\r\n        title,\r\n        description,\r\n        scheduledFor: startTime,\r\n        duration: duration * 60000, // Convert minutes to milliseconds\r\n        channelId: interaction.channel.id,\r\n        guildId: interaction.guild.id,\r\n        creatorId: interaction.user.id,\r\n        maxParticipants,\r\n        reminders: [600000, 1800000] // 10 minutes and 30 minutes before\r\n      };\r\n\r\n      const event = createEvent(eventData);\r\n\r\n      const timeUntil = Math.round((startTime - Date.now()) / 60000);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìÖ Event Created!')\r\n        .setColor(0x0099FF)\r\n        .setDescription(`**${title}**`)\r\n        .addFields(\r\n          { name: 'üìù Description', value: description, inline: false },\r\n          { name: '‚è±Ô∏è Starts In', value: `${timeUntil} minutes (${new Date(startTime).toLocaleString()})`, inline: true },\r\n          { name: '‚è≥ Duration', value: `${duration} minutes`, inline: true },\r\n          { name: 'üë• Max Participants', value: maxParticipants || 'Unlimited', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create event: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'list': {\r\n    try {\r\n      const userReminders = getUserReminders(interaction.user.id, 10);\r\n      const userEvents = interaction.guild ? getUserEvents(interaction.guild.id, 10) : [];\r\n\r\n      if (!Array.isArray(userReminders) || !Array.isArray(userEvents)) {\r\n        throw new CommandError('Failed to retrieve schedule data.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (userReminders.length === 0 && userEvents.length === 0) {\r\n        return interaction.reply({ content: 'üìÖ No upcoming reminders or events. Use `/remind me` or `/remind event` to create some!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìÖ Your Schedule')\r\n      .setColor(0x0099FF)\r\n      .setDescription('Upcoming reminders and events');\r\n\r\n    if (userReminders.length > 0) {\r\n      const reminderList = userReminders.map(r => {\r\n        const timeUntil = Math.round((r.scheduledFor - Date.now()) / 60000);\r\n        return `‚è∞ **${r.title}** - In ${timeUntil}m\\n${r.message}`;\r\n      }).join('\\n\\n');\r\n\r\n      embed.addFields({\r\n        name: `‚è∞ Personal Reminders (${userReminders.length})`,\r\n        value: reminderList,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    if (userEvents.length > 0) {\r\n      const eventList = userEvents.map(e => {\r\n        const timeUntil = Math.round((e.scheduledFor - Date.now()) / 60000);\r\n        return `üìÖ **${e.title}** - In ${timeUntil}m\\n${e.description}`;\r\n      }).join('\\n\\n');\r\n\r\n      embed.addFields({\r\n        name: `üìÖ Server Events (${userEvents.length})`,\r\n        value: eventList,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`remind_upcoming:${interaction.user.id}`).setLabel('üìÖ View All').setStyle(ButtonStyle.Primary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to list schedule: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'upcoming': {\r\n    const days = interaction.options.getInteger('days') || 7;\r\n    validateRange(days, 1, 365, 'days ahead');\r\n\r\n    try {\r\n      const upcoming = getUpcomingEvents(interaction.user.id, interaction.guild?.id, days);\r\n\r\n      if (!Array.isArray(upcoming)) {\r\n        throw new CommandError('Failed to retrieve upcoming events.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (upcoming.length === 0) {\r\n        return interaction.reply({ content: `üìÖ No upcoming events or reminders in the next ${days} days.`, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üìÖ Upcoming (${days} days)`)\r\n      .setColor(0x0099FF)\r\n      .setDescription(`${upcoming.length} upcoming items`);\r\n\r\n    upcoming.slice(0, 10).forEach((item, index) => {\r\n      const timeUntil = Math.round((item.scheduledFor - Date.now()) / 60000);\r\n      const type = item.type === 'reminder' ? '‚è∞' : 'üìÖ';\r\n\r\n      embed.addFields({\r\n        name: `${type} ${item.title}`,\r\n        value: `**In:** ${timeUntil} minutes\\n**Description:** ${item.message || item.description}\\n**When:** ${new Date(item.scheduledFor).toLocaleString()}`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to get upcoming events: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  \n  break;\n  }\n  case 'cancel': {\r\n    const type = interaction.options.getString('type');\r\n    const id = interaction.options.getString('id');\r\n\r\n    validateNotEmpty(type, 'type');\r\n    validateNotEmpty(id, 'ID');\r\n\r\n    const validTypes = ['reminder', 'event'];\r\n    if (!validTypes.includes(type)) {\r\n      throw new CommandError('Invalid type. Use \"reminder\" or \"event\".', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    try {\r\n      if (type === 'reminder') {\r\n        const result = cancelReminder(interaction.user.id, id);\r\n\r\n        if (result) {\r\n          await interaction.reply({ content: '‚úÖ **Reminder cancelled successfully!**', flags: MessageFlags.Ephemeral });\r\n        } else {\r\n          throw new CommandError('Reminder not found or already executed.', 'NOT_FOUND');\r\n        }\r\n\r\n      } else if (type === 'event') {\r\n        validateGuild(interaction);\r\n        const result = cancelEvent(interaction.guild.id, id, interaction.user.id);\r\n\r\n        if (result) {\r\n          await interaction.reply({ content: '‚úÖ **Event cancelled successfully!**', flags: MessageFlags.Ephemeral });\r\n        } else {\r\n          throw new CommandError('Event not found or you are not the creator.', 'NOT_FOUND');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to cancel ${type}: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n  \n  break;\n  }\n  // No default\n  }"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":57,"column":43,"nodeType":"Literal","messageId":"error","endLine":57,"endColumn":47,"suggestions":[{"messageId":"replace","fix":{"range":[3498,3502],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":62,"column":67,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":62,"endColumn":72,"fix":{"range":[3659,3664],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":66,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":66,"endColumn":27,"fix":{"range":[3788,3796],"text":"0x00_FF_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":76,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":76,"endColumn":6,"fix":{"range":[4205,4205],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":80,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":80,"endColumn":4,"fix":{"range":[4364,4364],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":115,"column":30,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":115,"endColumn":35,"fix":{"range":[5806,5811],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":120,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":120,"endColumn":27,"fix":{"range":[6020,6026],"text":"600_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":120,"column":29,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":120,"endColumn":36,"fix":{"range":[6028,6035],"text":"1_800_000"}},{"ruleId":"no-unused-vars","severity":1,"message":"'event' is assigned a value but never used.","line":123,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":123,"endColumn":18},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":125,"column":63,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":125,"endColumn":68,"fix":{"range":[6195,6200],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":129,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":129,"endColumn":27,"fix":{"range":[6304,6312],"text":"0x00_99_FF"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":140,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":140,"endColumn":6,"fix":{"range":[6824,6824],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":144,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":144,"endColumn":4,"fix":{"range":[6980,6980],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":5,"fix":{"range":[7607,7611],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":158,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":158,"endColumn":7,"fix":{"range":[7645,7651],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":159,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":159,"endColumn":7,"fix":{"range":[7682,7688],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":159,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":159,"endColumn":25,"fix":{"range":[7698,7706],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":160,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":160,"endColumn":7,"fix":{"range":[7709,7715],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":162,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":162,"endColumn":5,"fix":{"range":[7768,7772],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":163,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":163,"endColumn":7,"fix":{"range":[7805,7811],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":164,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":164,"endColumn":9,"fix":{"range":[7858,7866],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":164,"column":70,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":164,"endColumn":75,"fix":{"range":[7927,7932],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":165,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":165,"endColumn":9,"fix":{"range":[7936,7944],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":166,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":166,"endColumn":7,"fix":{"range":[8005,8011],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":168,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":168,"endColumn":7,"fix":{"range":[8031,8037],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":169,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":169,"endColumn":9,"fix":{"range":[8056,8064],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":9,"fix":{"range":[8121,8129],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":171,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":171,"endColumn":9,"fix":{"range":[8151,8159],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":172,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":172,"endColumn":7,"fix":{"range":[8174,8180],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":173,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":173,"endColumn":5,"fix":{"range":[8185,8189],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":175,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":175,"endColumn":5,"fix":{"range":[8194,8198],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":176,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":176,"endColumn":7,"fix":{"range":[8228,8234],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":177,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":177,"endColumn":9,"fix":{"range":[8275,8283],"text":"          "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":177,"column":70,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":177,"endColumn":75,"fix":{"range":[8344,8349],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":178,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":178,"endColumn":9,"fix":{"range":[8353,8361],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":179,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":179,"endColumn":7,"fix":{"range":[8427,8433],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":181,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":181,"endColumn":7,"fix":{"range":[8453,8459],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":9,"fix":{"range":[8478,8486],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":183,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":183,"endColumn":9,"fix":{"range":[8536,8544],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":184,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":184,"endColumn":9,"fix":{"range":[8563,8571],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":185,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":185,"endColumn":7,"fix":{"range":[8586,8592],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":186,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":186,"endColumn":5,"fix":{"range":[8597,8601],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":188,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":188,"endColumn":5,"fix":{"range":[8606,8610],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":189,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":189,"endColumn":7,"fix":{"range":[8661,8667],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":190,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":190,"endColumn":5,"fix":{"range":[8796,8800],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":192,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":192,"endColumn":5,"fix":{"range":[8806,8810],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":194,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":194,"endColumn":6,"fix":{"range":[8883,8883],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":198,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":198,"endColumn":4,"fix":{"range":[9040,9040],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 140. Maximum allowed is 120.","line":210,"column":1,"nodeType":"Program","messageId":"max","endLine":210,"endColumn":142},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":213,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":213,"endColumn":5,"fix":{"range":[9621,9625],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":214,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":214,"endColumn":7,"fix":{"range":[9659,9665],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":215,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":215,"endColumn":7,"fix":{"range":[9706,9712],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":215,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":215,"endColumn":25,"fix":{"range":[9722,9730],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":216,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":216,"endColumn":7,"fix":{"range":[9733,9739],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":218,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":218,"endColumn":5,"fix":{"range":[9796,9800],"text":"      "}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":218,"column":27,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":218,"endColumn":34,"fix":{"range":[9800,10257],"text":"for (const [index, item] of upcoming.slice(0, 10).entries()) {\r\n      const timeUntil = Math.round((item.scheduledFor - Date.now()) / 60000);\r\n      const type = item.type === 'reminder' ? '‚è∞' : 'üìÖ';\r\n\r\n      embed.addFields({\r\n        name: `${type} ${item.title}`,\r\n        value: `**In:** ${timeUntil} minutes\\n**Description:** ${item.message || item.description}\\n**When:** ${new Date(item.scheduledFor).toLocaleString()}`,\r\n        inline: false\r\n      });\r\n    }"}},{"ruleId":"no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":218,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":218,"endColumn":47},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":219,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":219,"endColumn":7,"fix":{"range":[9850,9856],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":219,"column":71,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":219,"endColumn":76,"fix":{"range":[9920,9925],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":220,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":220,"endColumn":7,"fix":{"range":[9929,9935],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":222,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":222,"endColumn":7,"fix":{"range":[9990,9996],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":223,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":223,"endColumn":9,"fix":{"range":[10015,10023],"text":"          "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 159. Maximum allowed is 120.","line":224,"column":1,"nodeType":"Program","messageId":"max","endLine":224,"endColumn":160},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":224,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":224,"endColumn":9,"fix":{"range":[10055,10063],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":225,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":225,"endColumn":9,"fix":{"range":[10216,10224],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":226,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":226,"endColumn":7,"fix":{"range":[10239,10245],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":227,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":227,"endColumn":5,"fix":{"range":[10250,10254],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":229,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":229,"endColumn":5,"fix":{"range":[10261,10265],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":231,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":231,"endColumn":6,"fix":{"range":[10350,10350],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":235,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":235,"endColumn":4,"fix":{"range":[10513,10513],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":253,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":253,"endColumn":10,"fix":{"range":[11184,11184],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":257,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":257,"endColumn":8,"fix":{"range":[11304,11304],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":263,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":263,"endColumn":10,"fix":{"range":[11609,11609],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":267,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":267,"endColumn":6,"fix":{"range":[11738,11738],"text":"\n"}}],"suppressedMessages":[],"errorCount":78,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":71,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { createReminder, createEvent, parseTime, getUserReminders, getUserEvents, cancelReminder, cancelEvent, getUpcomingEvents } from '../scheduler.js';\r\nimport { safeExecuteCommand, CommandError, validateGuild, validateRange, validateNotEmpty } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('remind')\r\n  .setDescription('Advanced reminder and scheduling system')\r\n  .addSubcommand(sub => sub.setName('me').setDescription('Set a personal reminder')\r\n    .addStringOption(opt => opt.setName('when').setDescription('When to remind you (e.g., \"in 30 minutes\", \"tomorrow 3pm\")').setRequired(true))\r\n    .addStringOption(opt => opt.setName('what').setDescription('What to remind you about').setRequired(true))\r\n    .addStringOption(opt => opt.setName('title').setDescription('Reminder title').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('event').setDescription('Create a server event')\r\n    .addStringOption(opt => opt.setName('title').setDescription('Event title').setRequired(true))\r\n    .addStringOption(opt => opt.setName('description').setDescription('Event description').setRequired(true))\r\n    .addStringOption(opt => opt.setName('when').setDescription('When the event starts').setRequired(true))\r\n    .addIntegerOption(opt => opt.setName('duration').setDescription('Duration in minutes (default: 60)').setRequired(false))\r\n    .addIntegerOption(opt => opt.setName('max_participants').setDescription('Maximum participants (0 for unlimited)').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('list').setDescription('List your reminders and events'))\r\n  .addSubcommand(sub => sub.setName('upcoming').setDescription('View upcoming events and reminders')\r\n    .addIntegerOption(opt => opt.setName('days').setDescription('Days to look ahead (default: 7)').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('cancel').setDescription('Cancel a reminder or event')\r\n    .addStringOption(opt => opt.setName('type').setDescription('reminder or event').setRequired(true))\r\n    .addStringOption(opt => opt.setName('id').setDescription('ID to cancel').setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  const sub = interaction.options.getSubcommand();\r\n\r\n  if (sub === 'me') {\r\n    const when = interaction.options.getString('when');\r\n    const what = interaction.options.getString('what');\r\n    const title = interaction.options.getString('title') || 'Reminder';\r\n\r\n    validateNotEmpty(when, 'time');\r\n    validateNotEmpty(what, 'reminder message');\r\n\r\n    try {\r\n      const scheduledTime = parseTime(when);\r\n\r\n      if (!scheduledTime) {\r\n        throw new CommandError('Invalid time format. Use formats like \"in 30 minutes\", \"tomorrow 3pm\", \"next friday 2pm\".', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (scheduledTime <= Date.now()) {\r\n        throw new CommandError('Cannot schedule reminders in the past!', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const maxReminderTime = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\r\n      if (scheduledTime > maxReminderTime) {\r\n        throw new CommandError('Cannot schedule reminders more than 1 year in advance.', 'OUT_OF_RANGE');\r\n      }\r\n\r\n      const reminderData = {\r\n        title,\r\n        message: what,\r\n        scheduledFor: scheduledTime,\r\n        channelId: interaction.channel.id,\r\n        guildId: interaction.guild?.id || null\r\n      };\r\n\r\n      const reminder = createReminder(interaction.user.id, reminderData);\r\n\r\n      const timeUntil = Math.round((scheduledTime - Date.now()) / 60000); // Convert to minutes\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚è∞ Reminder Set!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${title}**`)\r\n        .addFields(\r\n          { name: 'üìù Message', value: what, inline: false },\r\n          { name: '‚è±Ô∏è When', value: `In ${timeUntil} minutes (${new Date(scheduledTime).toLocaleString()})`, inline: true },\r\n          { name: 'üÜî Reminder ID', value: `\\`${reminder.id}\\``, inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create reminder: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'event') {\r\n    validateGuild(interaction);\r\n\r\n    const title = interaction.options.getString('title');\r\n    const description = interaction.options.getString('description');\r\n    const when = interaction.options.getString('when');\r\n    const duration = interaction.options.getInteger('duration') || 60;\r\n    const maxParticipants = interaction.options.getInteger('max_participants') || 0;\r\n\r\n    validateNotEmpty(title, 'event title');\r\n    validateNotEmpty(description, 'event description');\r\n    validateNotEmpty(when, 'event time');\r\n    validateRange(duration, 1, 1440, 'duration (minutes)'); // Max 24 hours\r\n    validateRange(maxParticipants, 0, 1000, 'max participants');\r\n\r\n    try {\r\n      const startTime = parseTime(when);\r\n\r\n      if (!startTime) {\r\n        throw new CommandError('Invalid time format. Use formats like \"in 30 minutes\", \"tomorrow 3pm\", \"next friday 2pm\".', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      if (startTime <= Date.now()) {\r\n        throw new CommandError('Cannot schedule events in the past!', 'INVALID_ARGUMENT');\r\n      }\r\n\r\n      const maxEventTime = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\r\n      if (startTime > maxEventTime) {\r\n        throw new CommandError('Cannot schedule events more than 1 year in advance.', 'OUT_OF_RANGE');\r\n      }\r\n\r\n      const eventData = {\r\n        title,\r\n        description,\r\n        scheduledFor: startTime,\r\n        duration: duration * 60000, // Convert minutes to milliseconds\r\n        channelId: interaction.channel.id,\r\n        guildId: interaction.guild.id,\r\n        creatorId: interaction.user.id,\r\n        maxParticipants,\r\n        reminders: [600000, 1800000] // 10 minutes and 30 minutes before\r\n      };\r\n\r\n      const event = createEvent(eventData);\r\n\r\n      const timeUntil = Math.round((startTime - Date.now()) / 60000);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìÖ Event Created!')\r\n        .setColor(0x0099FF)\r\n        .setDescription(`**${title}**`)\r\n        .addFields(\r\n          { name: 'üìù Description', value: description, inline: false },\r\n          { name: '‚è±Ô∏è Starts In', value: `${timeUntil} minutes (${new Date(startTime).toLocaleString()})`, inline: true },\r\n          { name: '‚è≥ Duration', value: `${duration} minutes`, inline: true },\r\n          { name: 'üë• Max Participants', value: maxParticipants || 'Unlimited', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create event: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'list') {\r\n    try {\r\n      const userReminders = getUserReminders(interaction.user.id, 10);\r\n      const userEvents = interaction.guild ? getUserEvents(interaction.guild.id, 10) : [];\r\n\r\n      if (!Array.isArray(userReminders) || !Array.isArray(userEvents)) {\r\n        throw new CommandError('Failed to retrieve schedule data.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (userReminders.length === 0 && userEvents.length === 0) {\r\n        return interaction.reply({ content: 'üìÖ No upcoming reminders or events. Use `/remind me` or `/remind event` to create some!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìÖ Your Schedule')\r\n      .setColor(0x0099FF)\r\n      .setDescription('Upcoming reminders and events');\r\n\r\n    if (userReminders.length > 0) {\r\n      const reminderList = userReminders.map(r => {\r\n        const timeUntil = Math.round((r.scheduledFor - Date.now()) / 60000);\r\n        return `‚è∞ **${r.title}** - In ${timeUntil}m\\n${r.message}`;\r\n      }).join('\\n\\n');\r\n\r\n      embed.addFields({\r\n        name: `‚è∞ Personal Reminders (${userReminders.length})`,\r\n        value: reminderList,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    if (userEvents.length > 0) {\r\n      const eventList = userEvents.map(e => {\r\n        const timeUntil = Math.round((e.scheduledFor - Date.now()) / 60000);\r\n        return `üìÖ **${e.title}** - In ${timeUntil}m\\n${e.description}`;\r\n      }).join('\\n\\n');\r\n\r\n      embed.addFields({\r\n        name: `üìÖ Server Events (${userEvents.length})`,\r\n        value: eventList,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`remind_upcoming:${interaction.user.id}`).setLabel('üìÖ View All').setStyle(ButtonStyle.Primary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to list schedule: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'upcoming') {\r\n    const days = interaction.options.getInteger('days') || 7;\r\n    validateRange(days, 1, 365, 'days ahead');\r\n\r\n    try {\r\n      const upcoming = getUpcomingEvents(interaction.user.id, interaction.guild?.id, days);\r\n\r\n      if (!Array.isArray(upcoming)) {\r\n        throw new CommandError('Failed to retrieve upcoming events.', 'COMMAND_ERROR');\r\n      }\r\n\r\n      if (upcoming.length === 0) {\r\n        return interaction.reply({ content: `üìÖ No upcoming events or reminders in the next ${days} days.`, flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üìÖ Upcoming (${days} days)`)\r\n      .setColor(0x0099FF)\r\n      .setDescription(`${upcoming.length} upcoming items`);\r\n\r\n    upcoming.slice(0, 10).forEach((item, index) => {\r\n      const timeUntil = Math.round((item.scheduledFor - Date.now()) / 60000);\r\n      const type = item.type === 'reminder' ? '‚è∞' : 'üìÖ';\r\n\r\n      embed.addFields({\r\n        name: `${type} ${item.title}`,\r\n        value: `**In:** ${timeUntil} minutes\\n**Description:** ${item.message || item.description}\\n**When:** ${new Date(item.scheduledFor).toLocaleString()}`,\r\n        inline: false\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to get upcoming events: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n  } else if (sub === 'cancel') {\r\n    const type = interaction.options.getString('type');\r\n    const id = interaction.options.getString('id');\r\n\r\n    validateNotEmpty(type, 'type');\r\n    validateNotEmpty(id, 'ID');\r\n\r\n    const validTypes = ['reminder', 'event'];\r\n    if (!validTypes.includes(type)) {\r\n      throw new CommandError('Invalid type. Use \"reminder\" or \"event\".', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    try {\r\n      if (type === 'reminder') {\r\n        const result = cancelReminder(interaction.user.id, id);\r\n\r\n        if (result) {\r\n          await interaction.reply({ content: '‚úÖ **Reminder cancelled successfully!**', flags: MessageFlags.Ephemeral });\r\n        } else {\r\n          throw new CommandError('Reminder not found or already executed.', 'NOT_FOUND');\r\n        }\r\n\r\n      } else if (type === 'event') {\r\n        validateGuild(interaction);\r\n        const result = cancelEvent(interaction.guild.id, id, interaction.user.id);\r\n\r\n        if (result) {\r\n          await interaction.reply({ content: '‚úÖ **Event cancelled successfully!**', flags: MessageFlags.Ephemeral });\r\n        } else {\r\n          throw new CommandError('Event not found or you are not the creator.', 'NOT_FOUND');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to cancel ${type}: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\roll.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":50,"fix":{"range":[49,49],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":12,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":12,"endColumn":5,"fix":{"range":[377,381],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":13,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":13,"endColumn":5,"fix":{"range":[435,439],"text":"      "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":22,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":22,"endColumn":48,"fix":{"range":[714,715],"text":""}}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\nimport { safeExecuteCommand, CommandError, validateRange, validateNotEmpty } from '../errorHandler.js';\r\n\r\n/**\r\n * Roll command data structure.\r\n */\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('roll')\r\n  .setDescription('Roll dice in NdM format, e.g., 2d6')\r\n  .addStringOption(opt =>\r\n    opt.setName('dice')\r\n    .setDescription('Dice expression (e.g., 2d6, 1d20)')\r\n    .setRequired(false)\r\n  );\r\n\r\n/**\r\n * Executes the roll command to simulate dice rolls.\r\n * @param {object} interaction - Discord interaction object\r\n * @returns {Promise<void>}\r\n */\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    // Validate interaction and user\r\n    validateNotEmpty(interaction, 'interaction');\r\n    validateNotEmpty(interaction.user, 'user');\r\n\r\n    // Get dice expression, default to 1d6\r\n    const expr = interaction.options.getString('dice') || '1d6';\r\n\r\n    // Validate dice expression format using regex\r\n    const diceRegex = /^(\\d+)d(\\d+)$/i;\r\n    const match = expr.match(diceRegex);\r\n\r\n    if (!match) {\r\n      throw new CommandError(\r\n        'Invalid dice format. Please use NdM format (e.g., 2d6, 1d20).',\r\n        'INVALID_FORMAT'\r\n      );\r\n    }\r\n\r\n    // Extract and validate dice count and sides\r\n    const diceCount = Math.min(100, Number(match[1]));\r\n    const sides = Number(match[2]);\r\n\r\n    // Validate dice count range (1-100)\r\n    validateRange(diceCount, 1, 100, 'dice count');\r\n\r\n    // Validate sides range (2-1000 for practical dice)\r\n    validateRange(sides, 2, 1000, 'dice sides');\r\n\r\n    // Generate rolls with proper random distribution\r\n    const rolls = [];\r\n    for (let i = 0; i < diceCount; i++) {\r\n      // Math.random() is inclusive of 0, exclusive of 1, so +1 for 1-based dice\r\n      const roll = Math.floor(Math.random() * sides) + 1;\r\n      rolls.push(roll);\r\n    }\r\n\r\n    // Calculate sum\r\n    const sum = rolls.reduce((total, roll) => total + roll, 0);\r\n\r\n    // Format response message\r\n    const rollList = rolls.join(', ');\r\n    const response = `${interaction.user.username} rolled ${expr}: [${rollList}] = ${sum}`;\r\n\r\n    // Reply with results\r\n    await interaction.reply(response);\r\n  });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\rpg.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":172,"fix":{"range":[171,171],"text":"\n"}},{"ruleId":"object-curly-spacing","severity":2,"message":"A space is required before '}'.","line":1,"column":152,"nodeType":"ImportDeclaration","messageId":"requireSpaceBefore","endLine":1,"endColumn":153,"fix":{"range":[151,151],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'randomEventType' is defined but never used.","line":2,"column":94,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":109},{"ruleId":"no-unused-vars","severity":1,"message":"'resetCharacter' is defined but never used.","line":2,"column":157,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":171},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (289). Maximum allowed is 100.","line":34,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":322,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (141). Maximum allowed is 30.","line":34,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":322,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 54. Maximum allowed is 20.","line":34,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":322,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 82 to the 15 allowed.","line":34,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":34,"endColumn":30},{"ruleId":"max-len","severity":2,"message":"This line has a length of 188. Maximum allowed is 120.","line":53,"column":1,"nodeType":"Program","messageId":"max","endLine":53,"endColumn":191},{"ruleId":"max-len","severity":2,"message":"This line has a length of 121. Maximum allowed is 120.","line":59,"column":1,"nodeType":"Program","messageId":"max","endLine":59,"endColumn":122},{"ruleId":"no-unused-vars","severity":1,"message":"'classInfo' is assigned a value but never used.","line":82,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":82,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":131,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":131,"endColumn":6,"fix":{"range":[8033,8033],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 142. Maximum allowed is 120.","line":176,"column":1,"nodeType":"Program","messageId":"max","endLine":176,"endColumn":143},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":176,"column":115,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":176,"endColumn":141,"fix":{"range":[10078,10104],"text":"'A fearsome boss appears!'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":189,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":189,"endColumn":6,"fix":{"range":[10582,10582],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 153. Maximum allowed is 120.","line":212,"column":1,"nodeType":"Program","messageId":"max","endLine":212,"endColumn":154},{"ruleId":"unicorn/explicit-length-check","severity":2,"message":"Use `.length === 0` when checking length is zero.","line":220,"column":9,"nodeType":"UnaryExpression","messageId":"zero","endLine":220,"endColumn":21,"fix":{"range":[11744,11756],"text":"list.length === 0"}},{"ruleId":"unicorn/explicit-length-check","severity":2,"message":"Use `.length > 0` when checking length is not zero.","line":226,"column":204,"nodeType":"MemberExpression","messageId":"non-zero","endLine":226,"endColumn":225,"fix":{"range":[12566,12587],"text":"row.components.length > 0"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":244,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":244,"endColumn":25,"fix":{"range":[13418,13426],"text":"0x00_99_FF"}},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is assigned a value but never used.","line":247,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":247,"endColumn":20},{"ruleId":"unicorn/explicit-length-check","severity":2,"message":"Use `.length === 0` when checking length is zero.","line":268,"column":11,"nodeType":"UnaryExpression","messageId":"zero","endLine":268,"endColumn":21,"fix":{"range":[14552,14562],"text":"qs.length === 0"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":285,"column":10,"nodeType":"MemberExpression","endLine":285,"endColumn":25},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":293,"column":1,"nodeType":"Program","messageId":"max","endLine":293,"endColumn":145},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":294,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":294,"endColumn":8,"fix":{"range":[15944,15944],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 138. Maximum allowed is 120.","line":295,"column":1,"nodeType":"Program","messageId":"max","endLine":295,"endColumn":139},{"ruleId":"max-len","severity":2,"message":"This line has a length of 123. Maximum allowed is 120.","line":297,"column":1,"nodeType":"Program","messageId":"max","endLine":297,"endColumn":124},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (322). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":323,"endColumn":1},{"ruleId":"no-unused-vars","severity":1,"message":"'recipe' is assigned a value but never used.","line":303,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":303,"endColumn":19},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":303,"column":22,"nodeType":"MemberExpression","endLine":303,"endColumn":37},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":306,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":306,"endColumn":27,"fix":{"range":[16493,16501],"text":"0x00_FF_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":318,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":318,"endColumn":6,"fix":{"range":[17031,17031],"text":"\n"}}],"suppressedMessages":[],"errorCount":23,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":12,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, ModalBuilder, TextInputBuilder, TextInputStyle, EmbedBuilder , MessageFlags} from 'discord.js';\r\nimport { createCharacter, getCharacter, saveCharacter, encounterMonster, fightTurn, narrate, randomEventType, applyXp, getLeaderboard, getLeaderboardCount, resetCharacter, getCharacterClasses, getClassInfo, bossEncounter, getCraftingRecipes, canCraftItem, craftItem, createQuest, listQuests, completeQuest, spendSkillPoints } from '../rpg.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { exploreLocation } from '../locations.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('rpg')\r\n  .setDescription('Play an enhanced RPG with character classes')\r\n  .addSubcommand(sub => sub.setName('start').setDescription('Create your character')\r\n    .addStringOption(opt => opt.setName('name').setDescription('Character name'))\r\n    .addStringOption(opt => opt.setName('class').setDescription('Character class').addChoices(\r\n      { name: 'üõ°Ô∏è Warrior', value: 'warrior' },\r\n      { name: 'üîÆ Mage', value: 'mage' },\r\n      { name: 'üó°Ô∏è Rogue', value: 'rogue' },\r\n      { name: '‚öîÔ∏è Paladin', value: 'paladin' }\r\n    )))\r\n  .addSubcommand(sub => sub.setName('fight').setDescription('Fight a monster'))\r\n  .addSubcommand(sub => sub.setName('explore').setDescription('Explore and encounter random events'))\r\n  .addSubcommand(sub => sub.setName('quest').setDescription('Quest actions (create/list/complete)').addStringOption(opt => opt.setName('action').setDescription('create|list|complete').setRequired(true)).addStringOption(opt => opt.setName('title').setDescription('Quest title')).addStringOption(opt => opt.setName('id').setDescription('Quest id to complete')).addStringOption(opt => opt.setName('desc').setDescription('Quest description')))\r\n  .addSubcommand(sub => sub.setName('boss').setDescription('Face a boss (dangerous)'))\r\n  .addSubcommand(sub => sub.setName('levelup').setDescription('Spend skill points to increase stats').addStringOption(opt => opt.setName('stat').setDescription('hp|mp|maxhp|maxmp|atk|def|spd').setRequired(true)).addIntegerOption(opt => opt.setName('amount').setDescription('How many points to spend').setRequired(true)))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('Show your character stats'))\r\n  .addSubcommand(sub => sub.setName('leaderboard').setDescription('Show top players'))\r\n  .addSubcommand(sub => sub.setName('reset').setDescription('Reset your character to defaults').addStringOption(opt => opt.setName('class').setDescription('New character class').addChoices(\r\n    { name: 'üõ°Ô∏è Warrior', value: 'warrior' },\r\n    { name: 'üîÆ Mage', value: 'mage' },\r\n    { name: 'üó°Ô∏è Rogue', value: 'rogue' },\r\n    { name: '‚öîÔ∏è Paladin', value: 'paladin' }\r\n  )))\r\n  .addSubcommand(sub => sub.setName('class').setDescription('View information about character classes'))\r\n  .addSubcommand(sub => sub.setName('inventory').setDescription('View and manage your inventory'))\r\n  .addSubcommand(sub => sub.setName('craft').setDescription('Craft items using materials').addStringOption(opt => opt.setName('item').setDescription('Item to craft').setRequired(true)));\r\n\r\nexport async function execute(interaction) {\r\n  const sub = interaction.options.getSubcommand();\r\n  const userId = interaction.user.id;\r\n\r\n  if (sub === 'start') {\r\n    const name = interaction.options.getString('name');\r\n    const charClass = interaction.options.getString('class') || 'warrior';\r\n    const char = createCharacter(userId, name, charClass);\r\n    if (!char) return interaction.reply({ content: 'You already have a character.', flags: MessageFlags.Ephemeral });\r\n\r\n    // Track achievements\r\n    const achievementResult = updateUserStats(userId, {\r\n      characters_created: 1,\r\n      features_tried: 1\r\n    });\r\n\r\n    // Check if user earned \"Born to Adventure\" achievement\r\n    if (achievementResult.newAchievements.length > 0) {\r\n      const newAchievement = achievementResult.newAchievements[0];\r\n      await interaction.reply({ content: `üéâ **Achievement Unlocked!** ${newAchievement.icon} ${newAchievement.name}\\n${newAchievement.description}\\nüíé +${newAchievement.points} points!` });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üéÆ Character Created!')\r\n      .setColor(char.color)\r\n      .setDescription(`**${char.name}** - Level ${char.lvl} ${char.class.charAt(0).toUpperCase() + char.class.slice(1)}`)\r\n      .addFields(\r\n        { name: '‚ù§Ô∏è Health', value: `${char.hp}/${char.maxHp}`, inline: true },\r\n        { name: 'üîÆ Mana', value: `${char.mp}/${char.maxMp}`, inline: true },\r\n        { name: '‚öîÔ∏è Attack', value: `${char.atk}`, inline: true },\r\n        { name: 'üõ°Ô∏è Defense', value: `${char.def}`, inline: true },\r\n        { name: 'üí® Speed', value: `${char.spd}`, inline: true },\r\n        { name: '‚≠ê Abilities', value: char.abilities.join(', '), inline: false },\r\n        { name: 'üìà Available Stats', value: 'Use `/rpg levelup` to spend skill points on:\\n‚ù§Ô∏è HP, üîÆ MP, üõ°Ô∏è Max HP, üîÆ Max MP, ‚öîÔ∏è ATK, üõ°Ô∏è DEF, üí® SPD', inline: false }\r\n      );\r\n\r\n    return interaction.reply({ embeds: [embed] });\r\n  }\r\n\r\n  if (sub === 'inventory') {\r\n    // Redirect to inventory command for now\r\n    return interaction.reply({ content: 'Use `/inventory view` to manage your inventory!', flags: MessageFlags.Ephemeral });\r\n  }\r\n\r\n  let char = getCharacter(userId);\r\n  if (!char) return interaction.reply({ content: 'You have no character. Run /rpg start', flags: MessageFlags.Ephemeral });\r\n\r\n  if (sub === 'stats') {\r\n    const classInfo = getClassInfo(char.class);\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üìä ${char.name} - Level ${char.lvl} ${char.class.charAt(0).toUpperCase() + char.class.slice(1)}`)\r\n      .setColor(char.color)\r\n      .addFields(\r\n        { name: '‚ù§Ô∏è Health', value: `${char.hp}/${char.maxHp}`, inline: true },\r\n        { name: 'üîÆ Mana', value: `${char.mp}/${char.maxMp}`, inline: true },\r\n        { name: '‚öîÔ∏è Attack', value: `${char.atk}`, inline: true },\r\n        { name: 'üõ°Ô∏è Defense', value: `${char.def}`, inline: true },\r\n        { name: 'üí® Speed', value: `${char.spd}`, inline: true },\r\n        { name: '‚≠ê Experience', value: `${char.xp} XP`, inline: true },\r\n        { name: 'üíé Skill Points', value: `${char.skillPoints || 0}`, inline: true },\r\n        { name: 'üéØ Abilities', value: char.abilities.join(', '), inline: false }\r\n      );\r\n\r\n    // include buttons for quick actions\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`rpg_leaderboard:0:${userId}`).setLabel('Leaderboard').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`rpg_reset_modal:0:${userId}`).setLabel('Reset Character').setStyle(ButtonStyle.Danger),\r\n    );\r\n\r\n    return interaction.reply({ embeds: [embed], components: [row] });\r\n  }\r\n\r\n  if (sub === 'fight') {\r\n    const monster = encounterMonster(char.lvl);\r\n    // simple fight: user attacks, monster attacks until one dies (short)\r\n    let log = [];\r\n    while (char.hp > 0 && monster.hp > 0 && log.length < 10) {\r\n      const dmg = fightTurn(char, monster);\r\n      log.push(`You hit ${monster.name} for ${dmg} dmg (hp ${Math.max(0, monster.hp)})`);\r\n      if (monster.hp <= 0) break;\r\n      const mdmg = fightTurn(monster, char);\r\n      log.push(`${monster.name} hits you for ${mdmg} dmg (hp ${Math.max(0, char.hp)})`);\r\n    }\r\n\r\n    if (char.hp > 0 && monster.hp <= 0) {\r\n      const res = applyXp(userId, char, monster.lvl * 5);\r\n      char = res.char;\r\n      char.hp = Math.min(char.maxHp, char.hp + 2);\r\n      saveCharacter(userId, char);\r\n\r\n      // Track boss defeat achievements\r\n      if (monster.name.includes('Dragon') || monster.name.includes('Boss')) {\r\n        updateUserStats(userId, { bosses_defeated: 1 });\r\n      }\r\n\r\n      log.push(`You defeated ${monster.name}! Gained ${monster.lvl * 5} XP.`);\r\n      if (res.gained > 0) log.push(`Level up! ${res.oldLvl} ‚Üí ${res.newLvl}. You gained ${res.gained} skill point(s).`);\r\n    } else if (char.hp <= 0) {\r\n      char.hp = Math.max(1, Math.floor(char.maxHp / 2));\r\n      saveCharacter(userId, char);\r\n      log.push('You were defeated and recover to half HP.');\r\n    }\r\n\r\n    return interaction.reply(log.join('\\n'));\r\n  }\r\n\r\n  if (sub === 'explore') {\r\n    // Use new location-based exploration system\r\n    const result = exploreLocation(userId, 'whispering_woods'); // Default to starting location\r\n\r\n    if (!result.success) {\r\n      return interaction.reply({ content: `‚ùå ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const { location, encounter, narrative } = result;\r\n\r\n    const locationNarrative = await narrate(\r\n      interaction.guildId,\r\n      `${location.ai_prompt} An adventurer explores this mystical place.`,\r\n      `You explore ${location.name}. ${narrative.entry}`\r\n    );\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`${location.emoji} Exploring ${location.name}`)\r\n      .setColor(location.color)\r\n      .setDescription(locationNarrative)\r\n      .addFields(\r\n        { name: 'üéØ Discovery', value: encounter.type.replace('_', ' ').toUpperCase(), inline: true },\r\n        { name: 'üíé Potential Rewards', value: `${encounter.rewards.xp} XP, ${encounter.rewards.gold} gold`, inline: true }\r\n      );\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`explore_investigate:${location.id}:${userId}`).setLabel('üîç Investigate').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`explore_search:${location.id}:${userId}`).setLabel('‚öîÔ∏è Search for Danger').setStyle(ButtonStyle.Danger),\r\n      new ButtonBuilder().setCustomId(`explore_rest:${location.id}:${userId}`).setLabel('üõå Take a Break').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    return interaction.reply({ embeds: [embed], components: [row] });\r\n  }\r\n\r\n  if (sub === 'boss') {\r\n    const boss = bossEncounter(Math.max(3, char.lvl + 2));\r\n    const narr = await narrate(interaction.guildId, `A dire boss ${boss.name} appears. Give a short epic intro.`, `A fearsome boss appears!`);\r\n    let out = `${narr}`;\r\n    // exchange\r\n    const dmg = fightTurn(char, boss);\r\n    out += `\\nYou strike the ${boss.name} for ${dmg} damage.`;\r\n    if (boss.hp > 0) {\r\n      const mdmg = fightTurn(boss, char);\r\n      out += `\\n${boss.name} hits you for ${mdmg} damage.`;\r\n    }\r\n    if (char.hp <= 0) {\r\n      char.hp = Math.max(1, Math.floor(char.maxHp / 2));\r\n      saveCharacter(userId, char);\r\n      out += '\\nYou were defeated but live to fight another day.';\r\n    } else {\r\n      const res = applyXp(userId, char, boss.lvl * 20);\r\n      char = res.char;\r\n      saveCharacter(userId, char);\r\n\r\n      // Track boss defeat\r\n      updateUserStats(userId, { bosses_defeated: 1 });\r\n\r\n      out += `\\nYou survived and earned ${boss.lvl * 20} XP!`;\r\n      if (res.gained > 0) out += `\\nLevel up! ${res.oldLvl} ‚Üí ${res.newLvl}. You gained ${res.gained} skill point(s).`;\r\n    }\r\n    return interaction.reply(out);\r\n  }\r\n\r\n  if (sub === 'levelup') {\r\n    const stat = interaction.options.getString('stat');\r\n    const amount = interaction.options.getInteger('amount');\r\n\r\n    const result = spendSkillPoints(userId, stat, amount);\r\n    if (!result.success) {\r\n      return interaction.reply({ content: result.message || 'Failed to spend skill points.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    return interaction.reply({ content: `Leveled up: +${amount} ${stat}. Remaining points: ${result.char.skillPoints}`, flags: MessageFlags.Ephemeral });\r\n  }\r\n\r\n  if (sub === 'leaderboard') {\r\n    const limit = 10;\r\n    const offset = 0;\r\n    const list = getLeaderboard(limit, offset);\r\n    const total = getLeaderboardCount();\r\n    if (!list.length) return interaction.reply({ content: 'No players yet.', flags: MessageFlags.Ephemeral });\r\n    const page = Math.floor(offset / limit) + 1;\r\n    const totalPages = Math.max(1, Math.ceil(total / limit));\r\n    const row = new ActionRowBuilder();\r\n    if (offset > 0) row.addComponents(new ButtonBuilder().setCustomId(`rpg_leaderboard:${Math.max(0, offset - limit)}:${userId}`).setLabel('Prev').setStyle(ButtonStyle.Secondary));\r\n    if (offset + limit < total) row.addComponents(new ButtonBuilder().setCustomId(`rpg_leaderboard:${offset + limit}:${userId}`).setLabel('Next').setStyle(ButtonStyle.Primary));\r\n    return interaction.reply({ content: `Leaderboard ‚Äî Page ${page}/${totalPages}\\n` + list.map((p, i) => `${offset + i + 1}. ${p.name} ‚Äî Level ${p.lvl} XP ${p.xp} ATK ${p.atk}`).join('\\n'), components: row.components.length ? [row] : [] });\r\n  }\r\n\r\n  if (sub === 'reset') {\r\n    const newClass = interaction.options.getString('class') || char.class;\r\n    // show a confirmation modal before resetting\r\n    const modal = new ModalBuilder().setCustomId(`rpg_reset_confirm:cmd:${userId}:${newClass}`).setTitle('Confirm Reset');\r\n    const input = new TextInputBuilder().setCustomId('confirm_text').setLabel('Type RESET to confirm').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('RESET');\r\n    // modal requires ActionRow-like placement via components\r\n    modal.addComponents({ type: 1, components: [input] });\r\n    await interaction.showModal(modal);\r\n    return;\r\n  }\r\n\r\n  if (sub === 'class') {\r\n    const classes = getCharacterClasses();\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üèõÔ∏è Character Classes')\r\n      .setColor(0x0099FF)\r\n      .setDescription('Choose your class when creating a character with `/rpg start`');\r\n\r\n    for (const [key, classInfo] of Object.entries(classes)) {\r\n      embed.addFields({\r\n        name: `${classInfo.name}`,\r\n        value: `**Description:** ${classInfo.description}\\n**Base Stats:** ‚ù§Ô∏è ${classInfo.baseStats.hp} HP, ‚öîÔ∏è ${classInfo.baseStats.atk} ATK, üõ°Ô∏è ${classInfo.baseStats.def} DEF, üí® ${classInfo.baseStats.spd} SPD\\n**Abilities:** ${classInfo.abilities.join(', ')}`,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    return interaction.reply({ embeds: [embed] });\r\n  }\r\n\r\n  if (sub === 'quest') {\r\n    const action = interaction.options.getString('action');\r\n    if (action === 'create') {\r\n      const title = interaction.options.getString('title') || 'A simple quest';\r\n      const desc = interaction.options.getString('desc') || 'Do something heroic.';\r\n      const q = createQuest(userId, title, desc);\r\n      return interaction.reply({ content: `Quest created: ${q.title} (id=${q.id})`, flags: MessageFlags.Ephemeral });\r\n    }\r\n    if (action === 'list') {\r\n      const qs = listQuests(userId);\r\n      if (!qs.length) return interaction.reply({ content: 'No quests.', flags: MessageFlags.Ephemeral });\r\n      return interaction.reply(qs.map(q => `${q.id} - ${q.title} [${q.status}]`).join('\\n'));\r\n    }\r\n    if (action === 'complete') {\r\n      const id = interaction.options.getString('id');\r\n      const q = completeQuest(userId, id);\r\n      if (!q) return interaction.reply({ content: 'Quest not found.', flags: MessageFlags.Ephemeral });\r\n      const rewardText = q.xpReward && q.goldReward ? `\\nüéâ **Rewards:** ${q.xpReward} XP, ${q.goldReward} gold!` : '';\r\n      return interaction.reply({ content: `Quest completed: ${q.title}${rewardText}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n    return interaction.reply({ content: 'Unknown quest action. Use create|list|complete', flags: MessageFlags.Ephemeral });\r\n  }\r\n\r\n  if (sub === 'craft') {\r\n    const itemId = interaction.options.getString('item');\r\n    const recipes = getCraftingRecipes();\r\n\r\n    if (!recipes[itemId]) {\r\n      return interaction.reply({ content: `‚ùå \"${itemId}\" is not a craftable item.`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const canCraft = canCraftItem(userId, itemId);\r\n\r\n    if (!canCraft.success) {\r\n      if (canCraft.reason === 'level_too_low') {\r\n        return interaction.reply({ content: `‚ùå You need to be level ${canCraft.required} to craft this item.`, flags: MessageFlags.Ephemeral });\r\n      } else if (canCraft.reason === 'missing_materials') {\r\n        return interaction.reply({ content: `‚ùå You're missing materials. You need: ${canCraft.missing}`, flags: MessageFlags.Ephemeral });\r\n      }\r\n      return interaction.reply({ content: `‚ùå Cannot craft this item: ${canCraft.reason}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const result = craftItem(userId, itemId);\r\n\r\n    if (result.success) {\r\n      const recipe = recipes[itemId];\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üî® Item Crafted!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`Successfully crafted **${result.item.name}**!`)\r\n        .addFields(\r\n          { name: 'üì¶ Item', value: `${result.item.name} (${result.item.rarity})`, inline: true },\r\n          { name: '‚≠ê XP Gained', value: `${result.xpGained} XP`, inline: true },\r\n          { name: 'üìã Description', value: result.item.description, inline: false }\r\n        );\r\n\r\n      // Track crafting achievement\r\n      updateUserStats(userId, { items_crafted: 1 });\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n    } else {\r\n      await interaction.reply({ content: `‚ùå Failed to craft item: ${result.reason}`, flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\rps.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":50,"fix":{"range":[49,49],"text":"\n"}},{"ruleId":"unicorn/no-unused-properties","severity":2,"message":"Property `losesTo` is defined but never used.","line":7,"column":30,"nodeType":"Property","messageId":"no-unused-properties","endLine":7,"endColumn":46},{"ruleId":"unicorn/no-unused-properties","severity":2,"message":"Property `losesTo` is defined but never used.","line":8,"column":27,"nodeType":"Property","messageId":"no-unused-properties","endLine":8,"endColumn":46},{"ruleId":"unicorn/no-unused-properties","severity":2,"message":"Property `losesTo` is defined but never used.","line":9,"column":31,"nodeType":"Property","messageId":"no-unused-properties","endLine":9,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":23,"column":10,"nodeType":"MemberExpression","endLine":23,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":47,"column":71,"nodeType":"MemberExpression","endLine":47,"endColumn":91},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":47,"column":95,"nodeType":"MemberExpression","endLine":47,"endColumn":113},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":58,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":58,"endColumn":5,"fix":{"range":[1723,1727],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":59,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":59,"endColumn":5,"fix":{"range":[1759,1763],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":60,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":60,"endColumn":5,"fix":{"range":[1783,1787],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":61,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":61,"endColumn":7,"fix":{"range":[1801,1807],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":62,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":62,"endColumn":7,"fix":{"range":[1844,1850],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":63,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":63,"endColumn":7,"fix":{"range":[1889,1895],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":64,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":64,"endColumn":5,"fix":{"range":[1939,1943],"text":"      "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":73,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":73,"endColumn":48,"fix":{"range":[2192,2193],"text":""}}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import { SlashCommandBuilder } from 'discord.js';\r\nimport { safeExecuteCommand, CommandError, validateNotEmpty } from '../errorHandler.js';\r\n\r\n// Game constants\r\nconst RPS_CHOICES = ['rock', 'paper', 'scissors'];\r\nconst RPS_RULES = {\r\n  rock: { beats: 'scissors', losesTo: 'paper' },\r\n  paper: { beats: 'rock', losesTo: 'scissors' },\r\n  scissors: { beats: 'paper', losesTo: 'rock' }\r\n};\r\n\r\n/**\r\n * Determines the outcome of a rock-paper-scissors game.\r\n * @param {string} playerChoice - The player's choice\r\n * @param {string} botChoice - The bot's choice\r\n * @returns {string} The game result ('win', 'lose', or 'tie')\r\n */\r\nfunction determineWinner(playerChoice, botChoice) {\r\n  if (playerChoice === botChoice) {\r\n    return 'tie';\r\n  }\r\n\r\n  return RPS_RULES[playerChoice].beats === botChoice ? 'win' : 'lose';\r\n}\r\n\r\n/**\r\n * Formats the result message for the game.\r\n * @param {string} playerChoice - Player's choice\r\n * @param {string} botChoice - Bot's choice\r\n * @param {string} result - Game result\r\n * @param {string} username - Player's username\r\n * @returns {string} Formatted message\r\n */\r\nfunction formatResultMessage(playerChoice, botChoice, result, username) {\r\n  const resultEmojis = {\r\n    win: 'üéâ',\r\n    lose: 'üò¢',\r\n    tie: 'ü§ù'\r\n  };\r\n\r\n  const resultText = {\r\n    win: 'You win!',\r\n    lose: 'You lose!',\r\n    tie: 'It\\'s a tie!'\r\n  };\r\n\r\n  return `${username} chose ${playerChoice}, I chose ${botChoice} ‚Äî ${resultEmojis[result]} ${resultText[result]}`;\r\n}\r\n\r\n/**\r\n * Rock-paper-scissors command data structure.\r\n */\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('rps')\r\n  .setDescription('Play rock-paper-scissors against the bot')\r\n  .addStringOption(opt =>\r\n    opt.setName('choice')\r\n    .setDescription('Your choice')\r\n    .setRequired(true)\r\n    .addChoices(\r\n      { name: 'Rock ü™®', value: 'rock' },\r\n      { name: 'Paper üìÑ', value: 'paper' },\r\n      { name: 'Scissors ‚úÇÔ∏è', value: 'scissors' }\r\n    )\r\n  );\r\n\r\n/**\r\n * Executes the rock-paper-scissors command.\r\n * @param {object} interaction - Discord interaction object\r\n * @returns {Promise<void>}\r\n */\r\nexport async function execute(interaction) {\r\n  return safeExecuteCommand(interaction, async () => {\r\n    // Validate interaction and user\r\n    validateNotEmpty(interaction, 'interaction');\r\n    validateNotEmpty(interaction.user, 'user');\r\n\r\n    // Get and validate player's choice\r\n    const choice = interaction.options.getString('choice');\r\n\r\n    if (!choice || typeof choice !== 'string') {\r\n      throw new CommandError('Please select a valid choice.', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const normalizedChoice = choice.toLowerCase().trim();\r\n\r\n    if (!RPS_CHOICES.includes(normalizedChoice)) {\r\n      throw new CommandError(\r\n        'Invalid choice. Please choose rock, paper, or scissors.',\r\n        'INVALID_ARGUMENT'\r\n      );\r\n    }\r\n\r\n    // Generate bot's choice with proper randomization\r\n    const botChoice = RPS_CHOICES[Math.floor(Math.random() * RPS_CHOICES.length)];\r\n\r\n    // Determine result\r\n    const result = determineWinner(normalizedChoice, botChoice);\r\n\r\n    // Format and send response\r\n    const response = formatResultMessage(\r\n      normalizedChoice,\r\n      botChoice,\r\n      result,\r\n      interaction.user.username\r\n    );\r\n\r\n    await interaction.reply(response);\r\n  });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\setmodel.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[63,63],"text":"\n"}},{"ruleId":"object-curly-spacing","severity":2,"message":"A space is required before '}'.","line":1,"column":44,"nodeType":"ImportDeclaration","messageId":"requireSpaceBefore","endLine":1,"endColumn":45,"fix":{"range":[43,43],"text":" "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 125. Maximum allowed is 120.","line":19,"column":1,"nodeType":"Program","messageId":"max","endLine":19,"endColumn":126}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import { SlashCommandBuilder , MessageFlags} from 'discord.js';\r\nimport { setGuild } from '../storage.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('setmodel')\r\n  .setDescription('Set the model URL for this guild')\r\n  .addStringOption(opt => opt.setName('url').setDescription('Model base URL').setRequired(true))\r\n  .addStringOption(opt => opt.setName('api').setDescription('API type (openai-compatible|openwebui|generic)'));\r\n\r\nexport async function execute(interaction) {\r\n  if (!interaction.memberPermissions?.has || !interaction.memberPermissions.has('ManageGuild')) {\r\n    await interaction.reply({ content: 'You need Manage Server permission to run this command.', flags: MessageFlags.Ephemeral });\r\n    return;\r\n  }\r\n\r\n  const url = interaction.options.getString('url');\r\n  const api = interaction.options.getString('api') || 'openai-compatible';\r\n  setGuild(interaction.guildId, { modelUrl: url, modelApi: api });\r\n  await interaction.reply({ content: `Saved model URL for this guild: ${url} (api=${api})`, flags: MessageFlags.Ephemeral });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\tictactoe.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":47,"column":41,"nodeType":"CallExpression","messageId":"substr","endLine":47,"endColumn":80,"fix":{"range":[1980,1991],"text":"slice(2, 11"}},{"ruleId":"unicorn/new-for-builtins","severity":2,"message":"Use `new Array()` instead of `Array()`.","line":50,"column":14,"nodeType":"CallExpression","messageId":"enforce","endLine":50,"endColumn":22,"fix":{"range":[2054,2054],"text":"new "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":50,"column":28,"nodeType":"Literal","messageId":"error","endLine":50,"endColumn":32,"suggestions":[{"messageId":"replace","fix":{"range":[2068,2072],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":66,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":66,"endColumn":4,"fix":{"range":[2588,2588],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":67,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":67,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2610,2662],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'sendTicTacToeBoard' has too many lines (124). Maximum allowed is 100.","line":79,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":202,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 28 to the 15 allowed.","line":79,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":79,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":89,"column":30,"nodeType":"MemberExpression","endLine":89,"endColumn":45},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":97,"column":38,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":97,"endColumn":46,"fix":{"range":[3715,3723],"text":"0xFF_A5_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":97,"column":49,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":97,"endColumn":57,"fix":{"range":[3726,3734],"text":"0x00_FF_00"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":98,"column":76,"nodeType":"MemberExpression","endLine":98,"endColumn":91},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":105,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":109,"endColumn":8,"fix":{"range":[3983,4200],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [resultEmbed], components: [] }) : interaction.reply({ embeds: [resultEmbed] }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":107,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":107,"endColumn":8,"fix":{"range":[4123,4123],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":113,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":113,"endColumn":3,"fix":{"range":[4226,4228],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":114,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":114,"endColumn":5,"fix":{"range":[4262,4266],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":115,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":115,"endColumn":5,"fix":{"range":[4294,4298],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":115,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":115,"endColumn":23,"fix":{"range":[4308,4316],"text":"0x00_99_FF"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":116,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":116,"endColumn":5,"fix":{"range":[4319,4323],"text":"      "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":116,"column":24,"nodeType":"MemberExpression","endLine":116,"endColumn":46},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":117,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":117,"endColumn":5,"fix":{"range":[4400,4404],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":118,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":118,"endColumn":7,"fix":{"range":[4418,4424],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":119,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":119,"endColumn":7,"fix":{"range":[4445,4451],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":120,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":120,"endColumn":7,"fix":{"range":[4479,4485],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":121,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":121,"endColumn":5,"fix":{"range":[4500,4504],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":123,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":123,"endColumn":3,"fix":{"range":[4511,4513],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":124,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":124,"endColumn":3,"fix":{"range":[4538,4540],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":125,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":125,"endColumn":3,"fix":{"range":[4561,4563],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":126,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":126,"endColumn":5,"fix":{"range":[4597,4601],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":127,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":127,"endColumn":5,"fix":{"range":[4638,4642],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":128,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":128,"endColumn":7,"fix":{"range":[4677,4683],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":129,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":129,"endColumn":7,"fix":{"range":[4704,4710],"text":"        "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":129,"column":23,"nodeType":"MemberExpression","endLine":129,"endColumn":38},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":131,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":131,"endColumn":7,"fix":{"range":[4755,4761],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":132,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":132,"endColumn":9,"fix":{"range":[4781,4789],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":133,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":133,"endColumn":11,"fix":{"range":[4810,4820],"text":"            "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":133,"column":43,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":133,"endColumn":55,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[3213,4864],"text":", id } = gameState;\r\n\r\n    // Check for winner\r\n    const winner = checkWinner(board);\r\n    if (winner) {\r\n      gameState.status = 'completed';\r\n\r\n      if (winner !== 'tie') {\r\n        const winnerPlayer = players[winner];\r\n        if (winnerPlayer.id !== 'ai') {\r\n          await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n        }\r\n      }\r\n\r\n      const resultEmbed = new EmbedBuilder()\r\n        .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n        .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n        .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner].name} wins!**`)\r\n        .addFields({\r\n          name: 'Final Board',\r\n          value: formatBoard(board),\r\n          inline: false\r\n        });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [resultEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [resultEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle('‚≠ï Tic-Tac-Toe')\r\n    .setColor(0x0099FF)\r\n    .setDescription(`${players[currentPlayer].name}'s turn (${currentPlayer})`)\r\n    .addFields({\r\n      name: 'Game Board',\r\n      value: formatBoard(board),\r\n      inline: false\r\n    });\r\n\r\n  // Create board buttons\r\n  const buttons = [];\r\n  for (let i = 0; i < 9; i += 3) {\r\n    const row = new ActionRowBuilder();\r\n    for (let j = i; j < i + 3; j++) {\r\n      const position = j;\r\n      const isTaken = board[position] !== null;\r\n\r\n      row.addComponents(\r\n        new ButtonBuilder()\r\n          .setCustomId(`ttt_${position}_${id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":134,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":134,"endColumn":11,"fix":{"range":[4869,4879],"text":"            "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":134,"column":31,"nodeType":"MemberExpression","endLine":134,"endColumn":46},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":135,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":135,"endColumn":11,"fix":{"range":[4937,4947],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":136,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":136,"endColumn":11,"fix":{"range":[5013,5023],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":137,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":137,"endColumn":7,"fix":{"range":[5081,5087],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":138,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":138,"endColumn":5,"fix":{"range":[5091,5095],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":139,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":139,"endColumn":5,"fix":{"range":[5098,5102],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":140,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":140,"endColumn":3,"fix":{"range":[5122,5124],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":142,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":142,"endColumn":3,"fix":{"range":[5129,5131],"text":"    "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":142,"column":3,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":146,"endColumn":4,"fix":{"range":[5131,5346],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [embed], components: buttons }) : interaction.reply({ embeds: [embed], components: buttons }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":143,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":143,"endColumn":5,"fix":{"range":[5183,5187],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":144,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":144,"endColumn":3,"fix":{"range":[5259,5261],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":144,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":144,"endColumn":4,"fix":{"range":[5262,5262],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":145,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":145,"endColumn":5,"fix":{"range":[5271,5275],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":146,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":146,"endColumn":3,"fix":{"range":[5343,5345],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":148,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":148,"endColumn":3,"fix":{"range":[5350,5352],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":149,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":149,"endColumn":3,"fix":{"range":[5382,5384],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":150,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":150,"endColumn":5,"fix":{"range":[5445,5449],"text":"      "}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":150,"column":21,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":150,"endColumn":22,"fix":{"range":[5465,5466],"text":""}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 26 to the 15 allowed.","line":150,"column":25,"nodeType":null,"messageId":"refactorFunction","endLine":150,"endColumn":27},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":151,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":151,"endColumn":7,"fix":{"range":[5475,5481],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":7,"fix":{"range":[5527,5533],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":153,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":153,"endColumn":9,"fix":{"range":[5557,5565],"text":"          "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":153,"column":9,"nodeType":"MemberExpression","endLine":153,"endColumn":32},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":153,"column":9,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":153,"endColumn":24},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":154,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":154,"endColumn":9,"fix":{"range":[5597,5605],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":155,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":155,"endColumn":9,"fix":{"range":[5637,5645],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":156,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":156,"endColumn":9,"fix":{"range":[5677,5685],"text":"          "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":156,"column":38,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":156,"endColumn":53,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.board","property":"board"},"fix":{"range":[5714,5729],"text":"board"},"desc":"Replace `gameState.board` with destructured property `board`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":9,"fix":{"range":[5733,5741],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":158,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":158,"endColumn":11,"fix":{"range":[5758,5768],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":160,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":160,"endColumn":11,"fix":{"range":[5803,5813],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":161,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":161,"endColumn":13,"fix":{"range":[5840,5852],"text":"              "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":161,"column":34,"nodeType":"MemberExpression","endLine":161,"endColumn":61},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":161,"column":34,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":161,"endColumn":51},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":162,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":162,"endColumn":13,"fix":{"range":[5903,5915],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":163,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":163,"endColumn":15,"fix":{"range":[5948,5962],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":164,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":164,"endColumn":13,"fix":{"range":[6037,6049],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":165,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":165,"endColumn":11,"fix":{"range":[6052,6062],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":167,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":167,"endColumn":11,"fix":{"range":[6067,6077],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":168,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":168,"endColumn":11,"fix":{"range":[6116,6126],"text":"            "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":168,"column":15,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":168,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":169,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":169,"endColumn":13,"fix":{"range":[6166,6178],"text":"              "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":169,"column":35,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":169,"endColumn":52},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":170,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":170,"endColumn":11,"fix":{"range":[6261,6271],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":171,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":171,"endColumn":11,"fix":{"range":[6274,6284],"text":"            "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":171,"column":15,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":171,"endColumn":32},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":172,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":172,"endColumn":13,"fix":{"range":[6324,6336],"text":"              "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":172,"column":35,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":172,"endColumn":52},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":173,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":173,"endColumn":11,"fix":{"range":[6419,6429],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":175,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":175,"endColumn":11,"fix":{"range":[6434,6444],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":176,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":176,"endColumn":13,"fix":{"range":[6484,6496],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":177,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":177,"endColumn":13,"fix":{"range":[6537,6549],"text":"              "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":177,"column":44,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":177,"endColumn":52,"fix":{"range":[6580,6588],"text":"0xFF_A5_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":177,"column":55,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":177,"endColumn":63,"fix":{"range":[6591,6599],"text":"0x00_FF_00"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":178,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":178,"endColumn":13,"fix":{"range":[6602,6614],"text":"              "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":178,"column":82,"nodeType":"MemberExpression","endLine":178,"endColumn":109},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":178,"column":82,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":178,"endColumn":99},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":179,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":179,"endColumn":13,"fix":{"range":[6728,6740],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":180,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":180,"endColumn":15,"fix":{"range":[6754,6768],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":181,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":181,"endColumn":15,"fix":{"range":[6790,6804],"text":"                "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":181,"column":34,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":181,"endColumn":49,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.board","property":"board"},"fix":{"range":[6823,6838],"text":"board"},"desc":"Replace `gameState.board` with destructured property `board`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 14.","line":182,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":182,"endColumn":15,"fix":{"range":[6842,6856],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":183,"endColumn":13,"fix":{"range":[6871,6883],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":185,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":185,"endColumn":11,"fix":{"range":[6890,6900],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":186,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":186,"endColumn":11,"fix":{"range":[6924,6934],"text":"            "}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":186,"column":27,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":186,"endColumn":39,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.id","property":"id"},"fix":{"range":[3213,6962],"text":", id } = gameState;\r\n\r\n    // Check for winner\r\n    const winner = checkWinner(board);\r\n    if (winner) {\r\n      gameState.status = 'completed';\r\n\r\n      if (winner !== 'tie') {\r\n        const winnerPlayer = players[winner];\r\n        if (winnerPlayer.id !== 'ai') {\r\n          await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n        }\r\n      }\r\n\r\n      const resultEmbed = new EmbedBuilder()\r\n        .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n        .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n        .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner].name} wins!**`)\r\n        .addFields({\r\n          name: 'Final Board',\r\n          value: formatBoard(board),\r\n          inline: false\r\n        });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [resultEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [resultEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle('‚≠ï Tic-Tac-Toe')\r\n    .setColor(0x0099FF)\r\n    .setDescription(`${players[currentPlayer].name}'s turn (${currentPlayer})`)\r\n    .addFields({\r\n      name: 'Game Board',\r\n      value: formatBoard(board),\r\n      inline: false\r\n    });\r\n\r\n  // Create board buttons\r\n  const buttons = [];\r\n  for (let i = 0; i < 9; i += 3) {\r\n    const row = new ActionRowBuilder();\r\n    for (let j = i; j < i + 3; j++) {\r\n      const position = j;\r\n      const isTaken = board[position] !== null;\r\n\r\n      row.addComponents(\r\n        new ButtonBuilder()\r\n          .setCustomId(`ttt_${position}_${gameState.id}`)\r\n          .setLabel(isTaken ? board[position] : `${position + 1}`)\r\n          .setStyle(isTaken ? ButtonStyle.Secondary : ButtonStyle.Primary)\r\n          .setDisabled(isTaken || (isAI && currentPlayer === 'O'))\r\n      );\r\n    }\r\n    buttons.push(row);\r\n  }\r\n\r\n  if (interaction.replied || interaction.deferred) {\r\n    await interaction.editReply({ embeds: [embed], components: buttons });\r\n  } else {\r\n    await interaction.reply({ embeds: [embed], components: buttons });\r\n  }\r\n\r\n  // AI move if it's AI's turn\r\n  if (isAI && currentPlayer === 'O' && status === 'active') {\r\n    setTimeout(async () => {\r\n      const aiMove = getAIMove(board, difficulty);\r\n      if (aiMove !== null) {\r\n        gameState.board[aiMove] = 'O';\r\n        gameState.currentPlayer = 'X';\r\n        // Check for AI win after move\r\n        const aiWinner = checkWinner(gameState.board);\r\n        if (aiWinner) {\r\n          gameState.status = 'completed';\r\n\r\n          if (aiWinner !== 'tie') {\r\n            const winnerPlayer = gameState.players[aiWinner];\r\n            if (winnerPlayer.id !== 'ai') {\r\n              await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n            }\r\n          }\r\n\r\n          // Update statistics for both players\r\n          if (gameState.players.X.id !== 'ai') {\r\n            await updateUserStats(gameState.players.X.id, { games: { tictactoe_games: 1 } });\r\n          }\r\n          if (gameState.players.O.id !== 'ai') {\r\n            await updateUserStats(gameState.players.O.id, { games: { tictactoe_games: 1 } });\r\n          }\r\n\r\n          const resultEmbed = new EmbedBuilder()\r\n            .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n            .setColor(aiWinner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n            .setDescription(aiWinner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${gameState.players[aiWinner].name} wins!**`)\r\n            .addFields({\r\n              name: 'Final Board',\r\n              value: formatBoard(gameState.board),\r\n              inline: false\r\n            });\r\n\r\n          // Clean up game state\r\n          tttGames.delete(id"},"desc":"Replace `gameState.id` with destructured property `id`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":188,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":188,"endColumn":11,"fix":{"range":[6968,6978],"text":"            "}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":188,"column":11,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":192,"endColumn":12,"fix":{"range":[6978,7211],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [resultEmbed], components: [] }) : interaction.reply({ embeds: [resultEmbed] }));"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":189,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":189,"endColumn":13,"fix":{"range":[7030,7042],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":190,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":190,"endColumn":11,"fix":{"range":[7115,7125],"text":"            "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":190,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":190,"endColumn":12,"fix":{"range":[7126,7126],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 12.","line":191,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":191,"endColumn":13,"fix":{"range":[7135,7147],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":192,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":192,"endColumn":11,"fix":{"range":[7200,7210],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 10.","line":193,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":193,"endColumn":11,"fix":{"range":[7213,7223],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":194,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":194,"endColumn":9,"fix":{"range":[7232,7240],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 8.","line":195,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":195,"endColumn":9,"fix":{"range":[7243,7251],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 6.","line":196,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":196,"endColumn":7,"fix":{"range":[7302,7308],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 4.","line":197,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":197,"endColumn":5,"fix":{"range":[7311,7315],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 2.","line":198,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":198,"endColumn":3,"fix":{"range":[7326,7328],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":199,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":199,"endColumn":4,"fix":{"range":[7334,7334],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":200,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":200,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7356,7409],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":218,"column":29,"nodeType":"MemberExpression","endLine":218,"endColumn":37},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":9,"nodeType":"MemberExpression","endLine":236,"endColumn":17},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":21,"nodeType":"MemberExpression","endLine":236,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":34,"nodeType":"MemberExpression","endLine":236,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":46,"nodeType":"MemberExpression","endLine":236,"endColumn":54},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":236,"column":59,"nodeType":"MemberExpression","endLine":236,"endColumn":67},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":237,"column":14,"nodeType":"MemberExpression","endLine":237,"endColumn":22},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":245,"column":10,"nodeType":"Literal","messageId":"error","endLine":245,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[8446,8450],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[8446,8450],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":255,"column":77,"nodeType":"Literal","messageId":"error","endLine":255,"endColumn":81,"suggestions":[{"messageId":"replace","fix":{"range":[8811,8815],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":257,"column":43,"nodeType":"Literal","messageId":"error","endLine":257,"endColumn":47,"suggestions":[{"messageId":"remove","fix":{"range":[8891,8895],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[8891,8895],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":260,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":260,"endColumn":17,"fix":{"range":[8941,9207],"text":" {\r\n      // Random move, but block winning moves 30% of the time\r\n      if (Math.random() < 0.3) {\r\n        return findWinningMove(board, 'O') || findBlockingMove(board, 'X') || availableMoves[Math.floor(Math.random() * availableMoves.length)];\r\n      }\r\n      break;\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":277,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":277,"endColumn":17,"fix":{"range":[9560,9642],"text":" {\r\n      // Smart AI - use minimax algorithm\r\n      return getBestMove(board, 'O');\n    }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":281,"column":5,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":281,"endColumn":23,"fix":{"range":[9668,9753],"text":" {\r\n      // Perfect AI - always finds best move\r\n      return getBestMove(board, 'O');\n    }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":297,"column":9,"nodeType":"MemberExpression","endLine":297,"endColumn":17},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":299,"column":7,"nodeType":"MemberExpression","endLine":299,"endColumn":19},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (385). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":385,"endColumn":68},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":305,"column":10,"nodeType":"Literal","messageId":"error","endLine":305,"endColumn":14,"suggestions":[{"messageId":"remove","fix":{"range":[10333,10337],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[10333,10337],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.NEGATIVE_INFINITY` over `-Infinity`.","line":325,"column":19,"nodeType":"UnaryExpression","messageId":"error","endLine":325,"endColumn":28,"fix":{"range":[10915,10924],"text":"Number.NEGATIVE_INFINITY"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":326,"column":18,"nodeType":"Literal","messageId":"error","endLine":326,"endColumn":22,"suggestions":[{"messageId":"remove","fix":{"range":[10941,10948],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[10944,10948],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":329,"column":9,"nodeType":"MemberExpression","endLine":329,"endColumn":17},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":331,"column":7,"nodeType":"MemberExpression","endLine":331,"endColumn":19},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed.","line":352,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":352,"endColumn":17},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.NEGATIVE_INFINITY` over `-Infinity`.","line":361,"column":21,"nodeType":"UnaryExpression","messageId":"error","endLine":361,"endColumn":30,"fix":{"range":[11958,11967],"text":"Number.NEGATIVE_INFINITY"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":363,"column":11,"nodeType":"MemberExpression","endLine":363,"endColumn":19},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":365,"column":9,"nodeType":"MemberExpression","endLine":365,"endColumn":21},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":371,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":371,"endColumn":4,"fix":{"range":[12272,12272],"text":"\n"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.POSITIVE_INFINITY` over `Infinity`.","line":372,"column":21,"nodeType":"Identifier","messageId":"error","endLine":372,"endColumn":29,"fix":{"range":[12301,12309],"text":"Number.POSITIVE_INFINITY"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":374,"column":11,"nodeType":"MemberExpression","endLine":374,"endColumn":19},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":376,"column":9,"nodeType":"MemberExpression","endLine":376,"endColumn":21}],"suppressedMessages":[],"errorCount":123,"fatalErrorCount":0,"warningCount":27,"fixableErrorCount":101,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { tttGames } from '../game-states.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('tictactoe')\r\n  .setDescription('Play Tic-Tac-Toe against another player or AI')\r\n  .addUserOption(option =>\r\n    option.setName('opponent')\r\n      .setDescription('Player to challenge (leave empty for AI)')\r\n      .setRequired(false))\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('AI difficulty (if playing against AI)')\r\n      .addChoices(\r\n        { name: 'Easy', value: 'easy' },\r\n        { name: 'Medium', value: 'medium' },\r\n        { name: 'Hard', value: 'hard' },\r\n        { name: 'Impossible', value: 'impossible' }\r\n      )\r\n      .setRequired(false));\r\n\r\n/**\r\n * Executes the Tic-Tac-Toe command.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n */\r\nexport async function execute(interaction) {\r\n  try {\r\n    const opponent = interaction.options.getUser('opponent');\r\n    const difficulty = interaction.options.getString('difficulty') || 'medium';\r\n\r\n    // Validate opponent input\r\n    if (opponent) {\r\n      if (opponent.id === interaction.user.id) {\r\n        return await interaction.reply({ content: '‚ùå You cannot play against yourself!', flags: MessageFlags.Ephemeral });\r\n      }\r\n      if (opponent.bot) {\r\n        return await interaction.reply({ content: '‚ùå You cannot challenge bot accounts to Tic-Tac-Toe.', flags: MessageFlags.Ephemeral });\r\n      }\r\n    }\r\n\r\n    // Validate difficulty only for AI games\r\n    if (!opponent && !['easy', 'medium', 'hard', 'impossible'].includes(difficulty)) {\r\n      return await interaction.reply({ content: '‚ùå Invalid difficulty level.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const gameId = `ttt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    const gameState = {\r\n      id: gameId,\r\n      board: Array(9).fill(null),\r\n      players: {\r\n        X: { id: interaction.user.id, name: interaction.user.username },\r\n        O: opponent ? { id: opponent.id, name: opponent.username } : { id: 'ai', name: `${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} AI` }\r\n      },\r\n      currentPlayer: 'X',\r\n      status: 'active',\r\n      difficulty,\r\n      isAI: !opponent,\r\n      created: Date.now()\r\n    };\r\n\r\n    // Store game state\r\n    tttGames.set(gameId, gameState);\r\n\r\n    await sendTicTacToeBoard(interaction, gameState);\r\n  } catch (error) {\r\n    console.error('Error in tictactoe execute:', error);\r\n    if (!interaction.replied && !interaction.deferred) {\r\n      await interaction.reply({ content: '‚ùå An error occurred while starting the game.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Sends the Tic-Tac-Toe board and handles game logic.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n * @param {Object} gameState - The current game state.\r\n */\r\nasync function sendTicTacToeBoard(interaction, gameState) {\r\n  try {\r\n    const { board, players, currentPlayer, status, isAI, difficulty } = gameState;\r\n\r\n    // Check for winner\r\n    const winner = checkWinner(board);\r\n    if (winner) {\r\n      gameState.status = 'completed';\r\n\r\n      if (winner !== 'tie') {\r\n        const winnerPlayer = players[winner];\r\n        if (winnerPlayer.id !== 'ai') {\r\n          await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n        }\r\n      }\r\n\r\n      const resultEmbed = new EmbedBuilder()\r\n        .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n        .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n        .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${players[winner].name} wins!**`)\r\n        .addFields({\r\n          name: 'Final Board',\r\n          value: formatBoard(board),\r\n          inline: false\r\n        });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [resultEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [resultEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle('‚≠ï Tic-Tac-Toe')\r\n    .setColor(0x0099FF)\r\n    .setDescription(`${players[currentPlayer].name}'s turn (${currentPlayer})`)\r\n    .addFields({\r\n      name: 'Game Board',\r\n      value: formatBoard(board),\r\n      inline: false\r\n    });\r\n\r\n  // Create board buttons\r\n  const buttons = [];\r\n  for (let i = 0; i < 9; i += 3) {\r\n    const row = new ActionRowBuilder();\r\n    for (let j = i; j < i + 3; j++) {\r\n      const position = j;\r\n      const isTaken = board[position] !== null;\r\n\r\n      row.addComponents(\r\n        new ButtonBuilder()\r\n          .setCustomId(`ttt_${position}_${gameState.id}`)\r\n          .setLabel(isTaken ? board[position] : `${position + 1}`)\r\n          .setStyle(isTaken ? ButtonStyle.Secondary : ButtonStyle.Primary)\r\n          .setDisabled(isTaken || (isAI && currentPlayer === 'O'))\r\n      );\r\n    }\r\n    buttons.push(row);\r\n  }\r\n\r\n  if (interaction.replied || interaction.deferred) {\r\n    await interaction.editReply({ embeds: [embed], components: buttons });\r\n  } else {\r\n    await interaction.reply({ embeds: [embed], components: buttons });\r\n  }\r\n\r\n  // AI move if it's AI's turn\r\n  if (isAI && currentPlayer === 'O' && status === 'active') {\r\n    setTimeout(async () => {\r\n      const aiMove = getAIMove(board, difficulty);\r\n      if (aiMove !== null) {\r\n        gameState.board[aiMove] = 'O';\r\n        gameState.currentPlayer = 'X';\r\n        // Check for AI win after move\r\n        const aiWinner = checkWinner(gameState.board);\r\n        if (aiWinner) {\r\n          gameState.status = 'completed';\r\n\r\n          if (aiWinner !== 'tie') {\r\n            const winnerPlayer = gameState.players[aiWinner];\r\n            if (winnerPlayer.id !== 'ai') {\r\n              await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n            }\r\n          }\r\n\r\n          // Update statistics for both players\r\n          if (gameState.players.X.id !== 'ai') {\r\n            await updateUserStats(gameState.players.X.id, { games: { tictactoe_games: 1 } });\r\n          }\r\n          if (gameState.players.O.id !== 'ai') {\r\n            await updateUserStats(gameState.players.O.id, { games: { tictactoe_games: 1 } });\r\n          }\r\n\r\n          const resultEmbed = new EmbedBuilder()\r\n            .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n            .setColor(aiWinner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n            .setDescription(aiWinner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${gameState.players[aiWinner].name} wins!**`)\r\n            .addFields({\r\n              name: 'Final Board',\r\n              value: formatBoard(gameState.board),\r\n              inline: false\r\n            });\r\n\r\n          // Clean up game state\r\n          tttGames.delete(gameState.id);\r\n\r\n          if (interaction.replied || interaction.deferred) {\r\n            await interaction.editReply({ embeds: [resultEmbed], components: [] });\r\n          } else {\r\n            await interaction.reply({ embeds: [resultEmbed] });\r\n          }\r\n          return;\r\n        }\r\n        await sendTicTacToeBoard(interaction, gameState);\r\n      }\r\n    }, 1000);\r\n  }\r\n  } catch (error) {\r\n    console.error('Error in sendTicTacToeBoard:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Formats the board into a string representation.\r\n * @param {Array} board - The game board array.\r\n * @returns {string} Formatted board string.\r\n */\r\nfunction formatBoard(board) {\r\n  const symbols = {\r\n    null: '‚¨ú',\r\n    X: '‚ùå',\r\n    O: '‚≠ï'\r\n  };\r\n\r\n  let formatted = '';\r\n  for (let i = 0; i < 9; i += 3) {\r\n    formatted += `${symbols[board[i]]} ${symbols[board[i + 1]]} ${symbols[board[i + 2]]}\\n`;\r\n  }\r\n  return formatted;\r\n}\r\n\r\n/**\r\n * Checks for a winner or tie on the board.\r\n * @param {Array} board - The game board array.\r\n * @returns {string|null} Winner ('X', 'O'), 'tie', or null.\r\n */\r\nfunction checkWinner(board) {\r\n  const lines = [\r\n    [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows\r\n    [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns\r\n    [0, 4, 8], [2, 4, 6] // Diagonals\r\n  ];\r\n\r\n  for (const [a, b, c] of lines) {\r\n    if (board[a] && board[a] === board[b] && board[a] === board[c]) {\r\n      return board[a];\r\n    }\r\n  }\r\n\r\n  if (board.every(cell => cell !== null)) {\r\n    return 'tie';\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Determines the AI's move based on difficulty.\r\n * @param {Array} board - The game board array.\r\n * @param {string} difficulty - AI difficulty level.\r\n * @returns {number|null} The move index or null if no moves available.\r\n */\r\nfunction getAIMove(board, difficulty) {\r\n  const availableMoves = board.map((cell, index) => cell === null ? index : null).filter(val => val !== null);\r\n\r\n  if (availableMoves.length === 0) return null;\r\n\r\n  switch (difficulty) {\r\n    case 'easy':\r\n      // Random move, but block winning moves 30% of the time\r\n      if (Math.random() < 0.3) {\r\n        return findWinningMove(board, 'O') || findBlockingMove(board, 'X') || availableMoves[Math.floor(Math.random() * availableMoves.length)];\r\n      }\r\n      break;\r\n\r\n    case 'medium': {\r\n      // Block winning moves, make winning moves when possible\r\n      const winningMove = findWinningMove(board, 'O');\r\n      if (winningMove !== null) return winningMove;\r\n\r\n      const blockingMove = findBlockingMove(board, 'X');\r\n      if (blockingMove !== null) return blockingMove;\r\n      break;\r\n    }\r\n\r\n    case 'hard':\r\n      // Smart AI - use minimax algorithm\r\n      return getBestMove(board, 'O');\r\n\r\n    case 'impossible':\r\n      // Perfect AI - always finds best move\r\n      return getBestMove(board, 'O');\r\n  }\r\n\r\n  return availableMoves[Math.floor(Math.random() * availableMoves.length)];\r\n}\r\n\r\n/**\r\n * Finds a winning move for the given player.\r\n * @param {Array} board - The game board array.\r\n * @param {string} player - The player ('X' or 'O').\r\n * @returns {number|null} The winning move index or null.\r\n */\r\nfunction findWinningMove(board, player) {\r\n  for (let i = 0; i < 9; i++) {\r\n    if (board[i] === null) {\r\n      const testBoard = [...board];\r\n      testBoard[i] = player;\r\n      if (checkWinner(testBoard) === player) {\r\n        return i;\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n/**\r\n * Finds a blocking move against the opponent.\r\n * @param {Array} board - The game board array.\r\n * @param {string} opponent - The opponent player.\r\n * @returns {number|null} The blocking move index or null.\r\n */\r\nfunction findBlockingMove(board, opponent) {\r\n  return findWinningMove(board, opponent);\r\n}\r\n\r\n/**\r\n * Gets the best move using minimax algorithm.\r\n * @param {Array} board - The game board array.\r\n * @param {string} player - The AI player.\r\n * @returns {number|null} The best move index.\r\n */\r\nfunction getBestMove(board, player) {\r\n  let bestScore = -Infinity;\r\n  let bestMove = null;\r\n\r\n  for (let i = 0; i < 9; i++) {\r\n    if (board[i] === null) {\r\n      const testBoard = [...board];\r\n      testBoard[i] = player;\r\n      const score = minimax(testBoard, 0, false, player === 'O' ? 'X' : 'O');\r\n\r\n      if (score > bestScore) {\r\n        bestScore = score;\r\n        bestMove = i;\r\n      }\r\n    }\r\n  }\r\n\r\n  return bestMove;\r\n}\r\n\r\n/**\r\n * Minimax algorithm for evaluating board positions.\r\n * @param {Array} board - The game board array.\r\n * @param {number} depth - Current depth in recursion.\r\n * @param {boolean} isMaximizing - Whether maximizing or minimizing.\r\n * @param {string} aiPlayer - The AI player symbol.\r\n * @returns {number} The evaluated score.\r\n */\r\nfunction minimax(board, depth, isMaximizing, aiPlayer) {\r\n  const humanPlayer = aiPlayer === 'O' ? 'X' : 'O';\r\n  const result = checkWinner(board);\r\n\r\n  if (result === aiPlayer) return 10 - depth;\r\n  if (result === humanPlayer) return depth - 10;\r\n  if (result === 'tie') return 0;\r\n\r\n  if (isMaximizing) {\r\n    let bestScore = -Infinity;\r\n    for (let i = 0; i < 9; i++) {\r\n      if (board[i] === null) {\r\n        const testBoard = [...board];\r\n        testBoard[i] = aiPlayer;\r\n        const score = minimax(testBoard, depth + 1, false, aiPlayer);\r\n        bestScore = Math.max(score, bestScore);\r\n      }\r\n    }\r\n    return bestScore;\r\n  } else {\r\n    let bestScore = Infinity;\r\n    for (let i = 0; i < 9; i++) {\r\n      if (board[i] === null) {\r\n        const testBoard = [...board];\r\n        testBoard[i] = humanPlayer;\r\n        const score = minimax(testBoard, depth + 1, true, aiPlayer);\r\n        bestScore = Math.min(score, bestScore);\r\n      }\r\n    }\r\n    return bestScore;\r\n  }\r\n}\r\n\r\nexport { sendTicTacToeBoard, checkWinner, formatBoard, getAIMove };","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\togglechat.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[63,63],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":30,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":30,"endColumn":4,"fix":{"range":[1167,1167],"text":"\n"}}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, MessageFlags } from 'discord.js';\r\nimport { getGuild, setGuild } from '../storage.js';\r\nimport { safeExecuteCommand, CommandError, validateGuild, validatePermissions } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('togglechat')\r\n  .setDescription('Enable or disable the chat responder for this guild')\r\n  .addBooleanOption(opt => opt.setName('enabled').setDescription('Enable chat responder').setRequired(true));\r\n\r\nexport async function execute(interaction) {\r\n  validateGuild(interaction);\r\n  validatePermissions(interaction, ['ManageGuild']);\r\n\r\n  const enabled = interaction.options.getBoolean('enabled');\r\n\r\n  if (typeof enabled !== 'boolean') {\r\n    throw new CommandError('Invalid enabled value provided.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  try {\r\n    const cfg = getGuild(interaction.guildId) || {};\r\n    const updatedCfg = { ...cfg, chatEnabled: enabled };\r\n\r\n    setGuild(interaction.guildId, updatedCfg);\r\n\r\n    await interaction.reply({\r\n      content: `‚úÖ Chat responder is now **${enabled ? 'enabled' : 'disabled'}** for this guild.`,\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n  } catch (error) {\r\n    throw new CommandError(`Failed to toggle chat responder: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\toggleplay.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":64,"fix":{"range":[63,63],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":30,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":30,"endColumn":4,"fix":{"range":[1182,1182],"text":"\n"}}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, MessageFlags } from 'discord.js';\r\nimport { getGuild, setGuild } from '../storage.js';\r\nimport { safeExecuteCommand, CommandError, validateGuild, validatePermissions } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('toggleplay')\r\n  .setDescription('Enable or disable playful interactions for this guild')\r\n  .addBooleanOption(opt => opt.setName('enabled').setDescription('Enable playful interactions').setRequired(true));\r\n\r\nexport async function execute(interaction) {\r\n  validateGuild(interaction);\r\n  validatePermissions(interaction, ['ManageGuild']);\r\n\r\n  const enabled = interaction.options.getBoolean('enabled');\r\n\r\n  if (typeof enabled !== 'boolean') {\r\n    throw new CommandError('Invalid enabled value provided.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  try {\r\n    const cfg = getGuild(interaction.guildId) || {};\r\n    const updatedCfg = { ...cfg, playEnabled: enabled };\r\n\r\n    setGuild(interaction.guildId, updatedCfg);\r\n\r\n    await interaction.reply({\r\n      content: `‚úÖ Playful interactions are now **${enabled ? 'enabled' : 'disabled'}** for this guild.`,\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n  } catch (error) {\r\n    throw new CommandError(`Failed to toggle playful interactions: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\trade.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":124,"fix":{"range":[123,123],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'acceptTrade' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'declineTrade' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'cancelTrade' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'getTradeListings' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'getMarketPrices' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":18},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'execute' has too many lines (210). Maximum allowed is 100.","line":37,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":246,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'execute' has too many statements (80). Maximum allowed is 30.","line":37,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":246,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'execute' has a complexity of 39. Maximum allowed is 20.","line":37,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":246,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 57 to the 15 allowed.","line":37,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":37,"endColumn":30},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":41,"column":3,"nodeType":null,"messageId":"prefer-switch","endLine":41,"endColumn":24,"fix":{"range":[2340,11158],"text":"switch (sub) {\n  case 'offer': {\r\n    const targetUser = interaction.options.getUser('user');\r\n\r\n    validateUser(interaction, targetUser.id);\r\n\r\n    const offerItems = interaction.options.getString('offer_items')?.split(',').map(s => s.trim()) || [];\r\n    const offerGold = interaction.options.getInteger('offer_gold') || 0;\r\n    const requestItems = interaction.options.getString('request_items')?.split(',').map(s => s.trim()) || [];\r\n    const requestGold = interaction.options.getInteger('request_gold') || 0;\r\n\r\n    if (targetUser.id === userId) {\r\n      throw new CommandError('You cannot trade with yourself!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (offerItems.length === 0 && offerGold === 0) {\r\n      throw new CommandError('You must offer at least some items or gold!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (requestItems.length === 0 && requestGold === 0) {\r\n      throw new CommandError('You must request at least some items or gold!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    validateRange(offerGold, 0, 1000000, 'offer gold'); // Max 1M gold\r\n    validateRange(requestGold, 0, 1000000, 'request gold');\r\n    validateRange(offerItems.length, 0, 10, 'offer items count');\r\n    validateRange(requestItems.length, 0, 10, 'request items count');\r\n\r\n    try {\r\n      const result = createTradeRequest(userId, targetUser.id, offerItems, requestItems, offerGold, requestGold);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason || 'Failed to create trade request.', 'COMMAND_ERROR');\r\n      }\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create trade offer: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üíº Trade Offer Sent!')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Trade request sent to **${targetUser.username}**!`)\r\n      .addFields(\r\n        { name: 'üì§ You Offer', value: `${offerItems.length > 0 ? offerItems.join(', ') : 'Nothing'}${offerGold > 0 ? `\\nüí∞ ${offerGold} gold` : ''}`, inline: true },\r\n        { name: 'üì• You Request', value: `${requestItems.length > 0 ? requestItems.join(', ') : 'Nothing'}${requestGold > 0 ? `\\nüí∞ ${requestGold} gold` : ''}`, inline: true }\r\n      );\r\n\r\n    await interaction.reply({ embeds: [embed] });\r\n\r\n    // Note: Target user will be notified when they check pending trades or through the trading system\r\n\r\n  \n  break;\n  }\n  case 'history': {\r\n    const tradeHistory = getUserTradeHistory(userId, 10);\r\n\r\n    if (tradeHistory.length === 0) {\r\n      return interaction.reply({ content: 'üìã No trade history found. Start trading to build your history!', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìã Trade History')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Your recent ${tradeHistory.length} trades`);\r\n\r\n    tradeHistory.forEach((trade, index) => {\r\n      const otherUser = trade.initiator === userId ? trade.target : trade.initiator;\r\n      const direction = trade.initiator === userId ? '‚Üí' : '‚Üê';\r\n\r\n      embed.addFields({\r\n        name: `Trade #${index + 1} (${new Date(trade.completedAt).toLocaleDateString()})`,\r\n        value: `${direction} **${trade.offer.items.length + trade.request.items.length}** items, **${trade.offer.gold + trade.request.gold}** gold`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  \n  break;\n  }\n  case 'stats': {\r\n    const stats = getTradeStats(userId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìä Trading Statistics')\r\n      .setColor(0xFFD700)\r\n      .addFields(\r\n        { name: 'üèÜ Trades Completed', value: stats.trades_completed, inline: true },\r\n        { name: 'üí∞ Gold Traded', value: stats.gold_traded, inline: true },\r\n        { name: 'üì¶ Items Traded', value: stats.items_traded, inline: true }\r\n      );\r\n\r\n    if (stats.trades_completed > 0) {\r\n      embed.addFields({\r\n        name: 'üìà Trading Rank',\r\n        value: `Average trade value: ${Math.round(stats.gold_traded / stats.trades_completed)} gold`,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  \n  break;\n  }\n  case 'market': {\r\n    const auctions = getActiveAuctions(5);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üèõÔ∏è Marketplace')\r\n      .setColor(0xFFD700)\r\n      .setDescription('Active auctions and market prices');\r\n\r\n    if (auctions.length > 0) {\r\n      auctions.forEach((auction, index) => {\r\n        const timeLeft = Math.max(0, auction.ends - Date.now());\r\n        const hoursLeft = Math.floor(timeLeft / (60 * 60 * 1000));\r\n\r\n        embed.addFields({\r\n          name: `Auction #${index + 1} - ${auction.itemId}`,\r\n          value: `üí∞ Current: ${auction.currentBid} gold\\n‚è∞ Ends in: ${hoursLeft}h\\nüè∑Ô∏è Buyout: ${auction.buyoutPrice} gold`,\r\n          inline: true\r\n        });\r\n      });\r\n    } else {\r\n      embed.addFields({\r\n        name: 'üèõÔ∏è No Active Auctions',\r\n        value: 'Be the first to create an auction!',\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`trade_create_auction:${userId}`).setLabel('‚ûï Create Auction').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`trade_view_auctions:${userId}`).setLabel('üîç View All').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n  \n  break;\n  }\n  case 'auction': {\r\n    const action = interaction.options.getString('action');\r\n\r\n    validateNotEmpty(action, 'auction action');\r\n    const validActions = ['create', 'bid', 'buyout'];\r\n    if (!validActions.includes(action)) {\r\n      throw new CommandError('Invalid auction action. Use: create, bid, buyout', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (action === 'create') {\r\n      const item = interaction.options.getString('item');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(item, 'auction item');\r\n      validateRange(price, 1, 100000, 'auction starting price'); // Max 100k gold\r\n\r\n      try {\r\n        const result = createAuction(item, price, 24, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to create auction.', 'COMMAND_ERROR');\r\n        }\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to create auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéØ Auction Created!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${item}** is now up for auction!`)\r\n        .addFields(\r\n          { name: 'üí∞ Starting Bid', value: price, inline: true },\r\n          { name: 'üè∑Ô∏è Buyout Price', value: price * 3, inline: true },\r\n          { name: '‚è∞ Duration', value: '24 hours', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } else if (action === 'bid') {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n      validateRange(price, 1, 1000000, 'bid amount'); // Max 1M gold\r\n\r\n      try {\r\n        const result = placeBid(auctionId, userId, price);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to place bid.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üí∞ **Bid Placed!**\\nYou bid ${price} gold on auction ${auctionId}!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to place bid: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n    } else if (action === 'buyout') {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n\r\n      try {\r\n        const result = buyoutAuction(auctionId, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to buyout auction.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üíé **Auction Won!**\\nYou purchased the item via buyout!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to buyout auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n    }\r\n  \n  break;\n  }\n  case 'pending': {\r\n    // Show pending trade requests - would be implemented with proper notification system\r\n    await interaction.reply({ content: 'üì® **Pending Trades:**\\nNo pending trade requests. Use `/trade offer` to start trading!', flags: MessageFlags.Ephemeral });\r\n  \n  break;\n  }\n  // No default\n  }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":63,"column":33,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":63,"endColumn":40,"fix":{"range":[3342,3349],"text":"1_000_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":64,"column":35,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":64,"endColumn":42,"fix":{"range":[3416,3423],"text":"1_000_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":73,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":73,"endColumn":6,"fix":{"range":[3855,3855],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":79,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":79,"endColumn":25,"fix":{"range":[4109,4117],"text":"0x00_99_FF"}},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":82,"column":119,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":82,"endColumn":143},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":83,"column":127,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":83,"endColumn":153},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":90,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":90,"endColumn":4,"fix":{"range":[4734,4734],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":99,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":99,"endColumn":25,"fix":{"range":[5109,5117],"text":"0x00_99_FF"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":102,"column":18,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":102,"endColumn":25,"fix":{"range":[5195,5697],"text":"for (const [index, trade] of tradeHistory.entries()) {\r\n      const otherUser = trade.initiator === userId ? trade.target : trade.initiator;\r\n      const direction = trade.initiator === userId ? '‚Üí' : '‚Üê';\r\n\r\n      embed.addFields({\r\n        name: `Trade #${index + 1} (${new Date(trade.completedAt).toLocaleDateString()})`,\r\n        value: `${direction} **${trade.offer.items.length + trade.request.items.length}** items, **${trade.offer.gold + trade.request.gold}** gold`,\r\n        inline: true\r\n      });\r\n    }"}},{"ruleId":"no-unused-vars","severity":1,"message":"'otherUser' is assigned a value but never used.","line":103,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":22},{"ruleId":"max-len","severity":2,"message":"This line has a length of 148. Maximum allowed is 120.","line":108,"column":1,"nodeType":"Program","messageId":"max","endLine":108,"endColumn":149},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":115,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":115,"endColumn":4,"fix":{"range":[5788,5788],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":120,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":120,"endColumn":25,"fix":{"range":[5958,5966],"text":"0xFF_D7_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":137,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":137,"endColumn":4,"fix":{"range":[6573,6573],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":142,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":142,"endColumn":25,"fix":{"range":[6740,6748],"text":"0xFF_D7_00"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":146,"column":16,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":146,"endColumn":23,"fix":{"range":[6852,7290],"text":"for (const [index, auction] of auctions.entries()) {\r\n        const timeLeft = Math.max(0, auction.ends - Date.now());\r\n        const hoursLeft = Math.floor(timeLeft / (60 * 60 * 1000));\r\n\r\n        embed.addFields({\r\n          name: `Auction #${index + 1} - ${auction.itemId}`,\r\n          value: `üí∞ Current: ${auction.currentBid} gold\\n‚è∞ Ends in: ${hoursLeft}h\\nüè∑Ô∏è Buyout: ${auction.buyoutPrice} gold`,\r\n          inline: true\r\n        });\r\n      }"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 123. Maximum allowed is 120.","line":152,"column":1,"nodeType":"Program","messageId":"max","endLine":152,"endColumn":126},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":156,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":156,"endColumn":6,"fix":{"range":[7297,7297],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":171,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":171,"endColumn":4,"fix":{"range":[7870,7870],"text":"\n"}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":180,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":180,"endColumn":30,"fix":{"range":[8228,10862],"text":"switch (action) {\n    case 'create': {\r\n      const item = interaction.options.getString('item');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(item, 'auction item');\r\n      validateRange(price, 1, 100000, 'auction starting price'); // Max 100k gold\r\n\r\n      try {\r\n        const result = createAuction(item, price, 24, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to create auction.', 'COMMAND_ERROR');\r\n        }\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to create auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéØ Auction Created!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${item}** is now up for auction!`)\r\n        .addFields(\r\n          { name: 'üí∞ Starting Bid', value: price, inline: true },\r\n          { name: 'üè∑Ô∏è Buyout Price', value: price * 3, inline: true },\r\n          { name: '‚è∞ Duration', value: '24 hours', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    \n    break;\n    }\n    case 'bid': {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n      validateRange(price, 1, 1000000, 'bid amount'); // Max 1M gold\r\n\r\n      try {\r\n        const result = placeBid(auctionId, userId, price);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to place bid.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üí∞ **Bid Placed!**\\nYou bid ${price} gold on auction ${auctionId}!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to place bid: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n    \n    break;\n    }\n    case 'buyout': {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n\r\n      try {\r\n        const result = buyoutAuction(auctionId, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to buyout auction.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üíé **Auction Won!**\\nYou purchased the item via buyout!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to buyout auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":185,"column":31,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":185,"endColumn":37,"fix":{"range":[8456,8462],"text":"100_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":192,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":192,"endColumn":8,"fix":{"range":[8736,8736],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":198,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":198,"endColumn":27,"fix":{"range":[8995,9003],"text":"0x00_FF_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":208,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":208,"endColumn":6,"fix":{"range":[9372,9372],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":213,"column":31,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":213,"endColumn":38,"fix":{"range":[9617,9624],"text":"1_000_000"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 145. Maximum allowed is 120.","line":221,"column":1,"nodeType":"Program","messageId":"max","endLine":221,"endColumn":147},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":222,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":222,"endColumn":8,"fix":{"range":[10025,10025],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":226,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":226,"endColumn":6,"fix":{"range":[10184,10184],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 134. Maximum allowed is 120.","line":237,"column":1,"nodeType":"Program","messageId":"max","endLine":237,"endColumn":136},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":237,"column":44,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":237,"endColumn":101,"fix":{"range":[10599,10656],"text":"'üíé **Auction Won!**\\nYou purchased the item via buyout!'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":238,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":238,"endColumn":8,"fix":{"range":[10700,10700],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":242,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":242,"endColumn":4,"fix":{"range":[10867,10867],"text":"\n"}}],"suppressedMessages":[],"errorCount":37,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":27,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, MessageFlags } from 'discord.js';\r\nimport {\r\n  createTradeRequest,\r\n  acceptTrade,\r\n  declineTrade,\r\n  cancelTrade,\r\n  getTradeListings,\r\n  getUserTradeHistory,\r\n  getTradeStats,\r\n  createAuction,\r\n  placeBid,\r\n  buyoutAuction,\r\n  getActiveAuctions,\r\n  getMarketPrices\r\n} from '../trading.js';\r\nimport { safeExecuteCommand, CommandError, validateUser, validateRange, validateNotEmpty } from '../errorHandler.js';\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('trade')\r\n  .setDescription('Trade items, gold, and participate in auctions')\r\n  .addSubcommand(sub => sub.setName('offer').setDescription('Offer a trade to another user')\r\n    .addUserOption(opt => opt.setName('user').setDescription('User to trade with').setRequired(true))\r\n    .addStringOption(opt => opt.setName('offer_items').setDescription('Items to offer (comma separated)').setRequired(false))\r\n    .addIntegerOption(opt => opt.setName('offer_gold').setDescription('Gold to offer').setRequired(false))\r\n    .addStringOption(opt => opt.setName('request_items').setDescription('Items to request (comma separated)').setRequired(false))\r\n    .addIntegerOption(opt => opt.setName('request_gold').setDescription('Gold to request').setRequired(false)))\r\n  .addSubcommand(sub => sub.setName('history').setDescription('View your trade history'))\r\n  .addSubcommand(sub => sub.setName('stats').setDescription('View your trading statistics'))\r\n  .addSubcommand(sub => sub.setName('market').setDescription('View market prices and listings'))\r\n  .addSubcommand(sub => sub.setName('auction').setDescription('Auction house management')\r\n    .addStringOption(opt => opt.setName('action').setDescription('create|bid|buyout').setRequired(true))\r\n    .addStringOption(opt => opt.setName('item').setDescription('Item to auction (for create)'))\r\n    .addIntegerOption(opt => opt.setName('price').setDescription('Starting price (for create/bid)'))\r\n    .addStringOption(opt => opt.setName('auction_id').setDescription('Auction ID (for bid/buyout)')))\r\n  .addSubcommand(sub => sub.setName('pending').setDescription('View pending trade requests'));\r\n\r\nexport async function execute(interaction) {\r\n  const sub = interaction.options.getSubcommand();\r\n  const userId = interaction.user.id;\r\n\r\n  if (sub === 'offer') {\r\n    const targetUser = interaction.options.getUser('user');\r\n\r\n    validateUser(interaction, targetUser.id);\r\n\r\n    const offerItems = interaction.options.getString('offer_items')?.split(',').map(s => s.trim()) || [];\r\n    const offerGold = interaction.options.getInteger('offer_gold') || 0;\r\n    const requestItems = interaction.options.getString('request_items')?.split(',').map(s => s.trim()) || [];\r\n    const requestGold = interaction.options.getInteger('request_gold') || 0;\r\n\r\n    if (targetUser.id === userId) {\r\n      throw new CommandError('You cannot trade with yourself!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (offerItems.length === 0 && offerGold === 0) {\r\n      throw new CommandError('You must offer at least some items or gold!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (requestItems.length === 0 && requestGold === 0) {\r\n      throw new CommandError('You must request at least some items or gold!', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    validateRange(offerGold, 0, 1000000, 'offer gold'); // Max 1M gold\r\n    validateRange(requestGold, 0, 1000000, 'request gold');\r\n    validateRange(offerItems.length, 0, 10, 'offer items count');\r\n    validateRange(requestItems.length, 0, 10, 'request items count');\r\n\r\n    try {\r\n      const result = createTradeRequest(userId, targetUser.id, offerItems, requestItems, offerGold, requestGold);\r\n      if (!result.success) {\r\n        throw new CommandError(result.reason || 'Failed to create trade request.', 'COMMAND_ERROR');\r\n      }\r\n    } catch (error) {\r\n      throw new CommandError(`Failed to create trade offer: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üíº Trade Offer Sent!')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Trade request sent to **${targetUser.username}**!`)\r\n      .addFields(\r\n        { name: 'üì§ You Offer', value: `${offerItems.length > 0 ? offerItems.join(', ') : 'Nothing'}${offerGold > 0 ? `\\nüí∞ ${offerGold} gold` : ''}`, inline: true },\r\n        { name: 'üì• You Request', value: `${requestItems.length > 0 ? requestItems.join(', ') : 'Nothing'}${requestGold > 0 ? `\\nüí∞ ${requestGold} gold` : ''}`, inline: true }\r\n      );\r\n\r\n    await interaction.reply({ embeds: [embed] });\r\n\r\n    // Note: Target user will be notified when they check pending trades or through the trading system\r\n\r\n  } else if (sub === 'history') {\r\n    const tradeHistory = getUserTradeHistory(userId, 10);\r\n\r\n    if (tradeHistory.length === 0) {\r\n      return interaction.reply({ content: 'üìã No trade history found. Start trading to build your history!', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìã Trade History')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Your recent ${tradeHistory.length} trades`);\r\n\r\n    tradeHistory.forEach((trade, index) => {\r\n      const otherUser = trade.initiator === userId ? trade.target : trade.initiator;\r\n      const direction = trade.initiator === userId ? '‚Üí' : '‚Üê';\r\n\r\n      embed.addFields({\r\n        name: `Trade #${index + 1} (${new Date(trade.completedAt).toLocaleDateString()})`,\r\n        value: `${direction} **${trade.offer.items.length + trade.request.items.length}** items, **${trade.offer.gold + trade.request.gold}** gold`,\r\n        inline: true\r\n      });\r\n    });\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  } else if (sub === 'stats') {\r\n    const stats = getTradeStats(userId);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üìä Trading Statistics')\r\n      .setColor(0xFFD700)\r\n      .addFields(\r\n        { name: 'üèÜ Trades Completed', value: stats.trades_completed, inline: true },\r\n        { name: 'üí∞ Gold Traded', value: stats.gold_traded, inline: true },\r\n        { name: 'üì¶ Items Traded', value: stats.items_traded, inline: true }\r\n      );\r\n\r\n    if (stats.trades_completed > 0) {\r\n      embed.addFields({\r\n        name: 'üìà Trading Rank',\r\n        value: `Average trade value: ${Math.round(stats.gold_traded / stats.trades_completed)} gold`,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n\r\n  } else if (sub === 'market') {\r\n    const auctions = getActiveAuctions(5);\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üèõÔ∏è Marketplace')\r\n      .setColor(0xFFD700)\r\n      .setDescription('Active auctions and market prices');\r\n\r\n    if (auctions.length > 0) {\r\n      auctions.forEach((auction, index) => {\r\n        const timeLeft = Math.max(0, auction.ends - Date.now());\r\n        const hoursLeft = Math.floor(timeLeft / (60 * 60 * 1000));\r\n\r\n        embed.addFields({\r\n          name: `Auction #${index + 1} - ${auction.itemId}`,\r\n          value: `üí∞ Current: ${auction.currentBid} gold\\n‚è∞ Ends in: ${hoursLeft}h\\nüè∑Ô∏è Buyout: ${auction.buyoutPrice} gold`,\r\n          inline: true\r\n        });\r\n      });\r\n    } else {\r\n      embed.addFields({\r\n        name: 'üèõÔ∏è No Active Auctions',\r\n        value: 'Be the first to create an auction!',\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`trade_create_auction:${userId}`).setLabel('‚ûï Create Auction').setStyle(ButtonStyle.Primary),\r\n      new ButtonBuilder().setCustomId(`trade_view_auctions:${userId}`).setLabel('üîç View All').setStyle(ButtonStyle.Secondary)\r\n    );\r\n\r\n    await interaction.reply({ embeds: [embed], components: [row] });\r\n\r\n  } else if (sub === 'auction') {\r\n    const action = interaction.options.getString('action');\r\n\r\n    validateNotEmpty(action, 'auction action');\r\n    const validActions = ['create', 'bid', 'buyout'];\r\n    if (!validActions.includes(action)) {\r\n      throw new CommandError('Invalid auction action. Use: create, bid, buyout', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (action === 'create') {\r\n      const item = interaction.options.getString('item');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(item, 'auction item');\r\n      validateRange(price, 1, 100000, 'auction starting price'); // Max 100k gold\r\n\r\n      try {\r\n        const result = createAuction(item, price, 24, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to create auction.', 'COMMAND_ERROR');\r\n        }\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to create auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéØ Auction Created!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`**${item}** is now up for auction!`)\r\n        .addFields(\r\n          { name: 'üí∞ Starting Bid', value: price, inline: true },\r\n          { name: 'üè∑Ô∏è Buyout Price', value: price * 3, inline: true },\r\n          { name: '‚è∞ Duration', value: '24 hours', inline: true }\r\n        );\r\n\r\n      await interaction.reply({ embeds: [embed] });\r\n\r\n    } else if (action === 'bid') {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n      const price = interaction.options.getInteger('price');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n      validateRange(price, 1, 1000000, 'bid amount'); // Max 1M gold\r\n\r\n      try {\r\n        const result = placeBid(auctionId, userId, price);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to place bid.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üí∞ **Bid Placed!**\\nYou bid ${price} gold on auction ${auctionId}!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to place bid: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n\r\n    } else if (action === 'buyout') {\r\n      const auctionId = interaction.options.getString('auction_id');\r\n\r\n      validateNotEmpty(auctionId, 'auction ID');\r\n\r\n      try {\r\n        const result = buyoutAuction(auctionId, userId);\r\n        if (!result.success) {\r\n          throw new CommandError(result.reason || 'Failed to buyout auction.', 'COMMAND_ERROR');\r\n        }\r\n\r\n        await interaction.reply({ content: `üíé **Auction Won!**\\nYou purchased the item via buyout!`, flags: MessageFlags.Ephemeral });\r\n      } catch (error) {\r\n        throw new CommandError(`Failed to buyout auction: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n      }\r\n    }\r\n  } else if (sub === 'pending') {\r\n    // Show pending trade requests - would be implemented with proper notification system\r\n    await interaction.reply({ content: 'üì® **Pending Trades:**\\nNo pending trade requests. Use `/trade offer` to start trading!', flags: MessageFlags.Ephemeral });\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\trivia.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":139,"fix":{"range":[138,138],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":7,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":7,"endColumn":47,"fix":{"range":[330,362],"text":"'What is the capital of France?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":8,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":8,"endColumn":23,"fix":{"range":[379,387],"text":"'London'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":8,"column":25,"nodeType":"Literal","messageId":"wrongQuotes","endLine":8,"endColumn":33,"fix":{"range":[389,397],"text":"'Berlin'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":8,"column":35,"nodeType":"Literal","messageId":"wrongQuotes","endLine":8,"endColumn":42,"fix":{"range":[399,406],"text":"'Paris'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":8,"column":44,"nodeType":"Literal","messageId":"wrongQuotes","endLine":8,"endColumn":52,"fix":{"range":[408,416],"text":"'Madrid'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":10,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":10,"endColumn":26,"fix":{"range":[451,462],"text":"'Geography'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":13,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":13,"endColumn":57,"fix":{"range":[489,531],"text":"'Which planet is known as the Red Planet?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":14,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":14,"endColumn":22,"fix":{"range":[548,555],"text":"'Venus'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":14,"column":24,"nodeType":"Literal","messageId":"wrongQuotes","endLine":14,"endColumn":30,"fix":{"range":[557,563],"text":"'Mars'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":14,"column":32,"nodeType":"Literal","messageId":"wrongQuotes","endLine":14,"endColumn":41,"fix":{"range":[565,574],"text":"'Jupiter'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":14,"column":43,"nodeType":"Literal","messageId":"wrongQuotes","endLine":14,"endColumn":51,"fix":{"range":[576,584],"text":"'Saturn'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":16,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":16,"endColumn":24,"fix":{"range":[619,628],"text":"'Science'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":19,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":19,"endColumn":35,"fix":{"range":[655,675],"text":"'What is 2 + 2 √ó 3?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":20,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":20,"endColumn":18,"fix":{"range":[692,695],"text":"'8'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":20,"column":20,"nodeType":"Literal","messageId":"wrongQuotes","endLine":20,"endColumn":24,"fix":{"range":[697,701],"text":"'10'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":20,"column":26,"nodeType":"Literal","messageId":"wrongQuotes","endLine":20,"endColumn":30,"fix":{"range":[703,707],"text":"'12'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":20,"column":32,"nodeType":"Literal","messageId":"wrongQuotes","endLine":20,"endColumn":36,"fix":{"range":[709,713],"text":"'14'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":22,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":22,"endColumn":21,"fix":{"range":[748,754],"text":"'Math'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":25,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":25,"endColumn":43,"fix":{"range":[781,809],"text":"'Who painted the Mona Lisa?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":26,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":26,"endColumn":33,"fix":{"range":[826,844],"text":"'Vincent van Gogh'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":26,"column":35,"nodeType":"Literal","messageId":"wrongQuotes","endLine":26,"endColumn":50,"fix":{"range":[846,861],"text":"'Pablo Picasso'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":26,"column":52,"nodeType":"Literal","messageId":"wrongQuotes","endLine":26,"endColumn":71,"fix":{"range":[863,882],"text":"'Leonardo da Vinci'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":26,"column":73,"nodeType":"Literal","messageId":"wrongQuotes","endLine":26,"endColumn":87,"fix":{"range":[884,898],"text":"'Michelangelo'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":28,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":28,"endColumn":20,"fix":{"range":[933,938],"text":"'Art'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":31,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":31,"endColumn":57,"fix":{"range":[965,1007],"text":"'What is the largest mammal in the world?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":32,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":32,"endColumn":33,"fix":{"range":[1024,1042],"text":"'African Elephant'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":32,"column":35,"nodeType":"Literal","messageId":"wrongQuotes","endLine":32,"endColumn":47,"fix":{"range":[1044,1056],"text":"'Blue Whale'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":32,"column":49,"nodeType":"Literal","messageId":"wrongQuotes","endLine":32,"endColumn":58,"fix":{"range":[1058,1067],"text":"'Giraffe'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":32,"column":60,"nodeType":"Literal","messageId":"wrongQuotes","endLine":32,"endColumn":74,"fix":{"range":[1069,1083],"text":"'Hippopotamus'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":34,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":34,"endColumn":23,"fix":{"range":[1118,1126],"text":"'Nature'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":37,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":37,"endColumn":52,"fix":{"range":[1153,1190],"text":"'In which year did World War II end?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":38,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":38,"endColumn":21,"fix":{"range":[1207,1213],"text":"'1944'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":38,"column":23,"nodeType":"Literal","messageId":"wrongQuotes","endLine":38,"endColumn":29,"fix":{"range":[1215,1221],"text":"'1945'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":38,"column":31,"nodeType":"Literal","messageId":"wrongQuotes","endLine":38,"endColumn":37,"fix":{"range":[1223,1229],"text":"'1946'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":38,"column":39,"nodeType":"Literal","messageId":"wrongQuotes","endLine":38,"endColumn":45,"fix":{"range":[1231,1237],"text":"'1947'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":40,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":40,"endColumn":24,"fix":{"range":[1272,1281],"text":"'History'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":43,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":43,"endColumn":54,"fix":{"range":[1308,1347],"text":"'What is the chemical symbol for gold?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":44,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":44,"endColumn":19,"fix":{"range":[1364,1368],"text":"'Go'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":44,"column":21,"nodeType":"Literal","messageId":"wrongQuotes","endLine":44,"endColumn":25,"fix":{"range":[1370,1374],"text":"'Gd'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":44,"column":27,"nodeType":"Literal","messageId":"wrongQuotes","endLine":44,"endColumn":31,"fix":{"range":[1376,1380],"text":"'Au'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":44,"column":33,"nodeType":"Literal","messageId":"wrongQuotes","endLine":44,"endColumn":37,"fix":{"range":[1382,1386],"text":"'Ag'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":46,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":46,"endColumn":24,"fix":{"range":[1421,1430],"text":"'Science'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":50,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":50,"endColumn":23,"fix":{"range":[1545,1553],"text":"'Python'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":50,"column":25,"nodeType":"Literal","messageId":"wrongQuotes","endLine":50,"endColumn":28,"fix":{"range":[1555,1558],"text":"'C'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":50,"column":30,"nodeType":"Literal","messageId":"wrongQuotes","endLine":50,"endColumn":40,"fix":{"range":[1560,1570],"text":"'Assembly'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":50,"column":42,"nodeType":"Literal","messageId":"wrongQuotes","endLine":50,"endColumn":48,"fix":{"range":[1572,1578],"text":"'Java'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":52,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":52,"endColumn":27,"fix":{"range":[1613,1625],"text":"'Technology'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Function Call Object Injection Sink","line":114,"column":32,"nodeType":"MemberExpression","endLine":114,"endColumn":63},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":121,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":121,"endColumn":4,"fix":{"range":[4291,4291],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'sendQuestion' has too many lines (117). Maximum allowed is 100.","line":147,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":263,"endColumn":2},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":158,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":158,"endColumn":23,"fix":{"range":[5386,5394],"text":"0x00_99_FF"}},{"ruleId":"unicorn/prefer-code-point","severity":2,"message":"Prefer `String.fromCodePoint()` over `String.fromCharCode()`.","line":170,"column":27,"nodeType":"Identifier","messageId":"error/fromCharCode","endLine":170,"endColumn":39,"suggestions":[{"messageId":"suggestion/fromCodePoint","fix":{"range":[5758,5770],"text":"fromCodePoint"},"data":{},"desc":"Use `String.fromCodePoint()`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":184,"column":11,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":184,"endColumn":16,"fix":{"range":[6257,6262],"text":"30_000"}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":188,"column":32,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":188,"endColumn":33,"fix":{"range":[6317,6318],"text":""}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":190,"column":30,"nodeType":"Identifier","messageId":"error","endLine":190,"endColumn":38,"fix":{"range":[6368,6376],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.isNaN` over `isNaN`.","line":192,"column":11,"nodeType":"Identifier","messageId":"error","endLine":192,"endColumn":16,"suggestions":[{"messageId":"suggestion","fix":{"range":[6417,6422],"text":"Number.isNaN"},"data":{"description":"isNaN","property":"isNaN"},"desc":"Replace `isNaN` with `Number.isNaN`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":208,"column":21,"nodeType":"MemberExpression","endLine":208,"endColumn":53},{"ruleId":"max-len","severity":2,"message":"This line has a length of 166. Maximum allowed is 120.","line":217,"column":1,"nodeType":"Program","messageId":"max","endLine":217,"endColumn":167},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":71,"nodeType":"MemberExpression","endLine":217,"endColumn":103},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":218,"column":31,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":218,"endColumn":39,"fix":{"range":[7461,7469],"text":"0x00_FF_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":218,"column":42,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":218,"endColumn":50,"fix":{"range":[7472,7480],"text":"0xFF_00_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":227,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":227,"endColumn":6,"fix":{"range":[7806,7806],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":228,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":228,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7830,7881],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":233,"column":28,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":233,"endColumn":29,"fix":{"range":[8043,8044],"text":""}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":237,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":237,"endColumn":80,"fix":{"range":[8202,8257],"text":"'You didn\\'t answer in time. Moving to next question...'"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":238,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":238,"endColumn":27,"fix":{"range":[8278,8286],"text":"0xFF_A5_00"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":244,"column":25,"nodeType":"Literal","messageId":"error","endLine":244,"endColumn":29,"suggestions":[{"messageId":"replace","fix":{"range":[8482,8486],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":258,"column":3,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":262,"endColumn":4,"fix":{"range":[8740,9010],"text":"await (interaction.replied || interaction.deferred ? interaction.followUp({ embeds: [embed], components: rows, flags: MessageFlags.Ephemeral }) : interaction.reply({ embeds: [embed], components: rows, flags: MessageFlags.Ephemeral }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":260,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":260,"endColumn":4,"fix":{"range":[8898,8898],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":282,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":282,"endColumn":4,"fix":{"range":[9812,9812],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":283,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":283,"endColumn":17,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[9834,9903],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 149. Maximum allowed is 120.","line":288,"column":1,"nodeType":"Program","messageId":"max","endLine":288,"endColumn":150},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":289,"column":34,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":289,"endColumn":42,"fix":{"range":[10175,10183],"text":"0x00_FF_00"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":289,"column":45,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":289,"endColumn":83,"fix":{"range":[10186,10224],"text":"(percentage >= 50 ? 0xFFA500 : 0xFF0000)"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":289,"column":64,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":289,"endColumn":72,"fix":{"range":[10205,10213],"text":"0xFF_A5_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":289,"column":75,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":289,"endColumn":83,"fix":{"range":[10216,10224],"text":"0xFF_00_00"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":293,"column":21,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":293,"endColumn":28,"fix":{"range":[10280,10772],"text":"for (const [index, answer] of gameState.answers.entries()) {\r\n    const emoji = answer.isCorrect ? '‚úÖ' : answer.timeout ? '‚è∞' : '‚ùå';\r\n    const status = answer.isCorrect ? 'Correct' : answer.timeout ? 'Timeout' : 'Incorrect';\r\n    embed.addFields({\r\n      name: `Q${index + 1}: ${status}`,\r\n      value: `${emoji} **${answer.question}**\\n${answer.isCorrect ? 'Your answer: ' + answer.userChoice : `Your answer: ${answer.userChoice}\\nCorrect: ${answer.correctChoice}`}`,\r\n      inline: false\r\n    });\r\n  }"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":294,"column":44,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":294,"endColumn":70,"fix":{"range":[10371,10397],"text":"(answer.timeout ? '‚è∞' : '‚ùå')"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":295,"column":51,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":295,"endColumn":91,"fix":{"range":[10450,10490],"text":"(answer.timeout ? 'Timeout' : 'Incorrect')"}},{"ruleId":"sonarjs/no-nested-template-literals","severity":2,"message":"Refactor this code to not use nested template literals.","line":298,"column":107,"nodeType":"TemplateLiteral","messageId":"nestedTemplateLiterals","endLine":298,"endColumn":176},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (312). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":312,"endColumn":2},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":303,"column":3,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":307,"endColumn":4,"fix":{"range":[10778,11012],"text":"await (interaction.replied || interaction.deferred ? interaction.followUp({ embeds: [embed], flags: MessageFlags.Ephemeral }) : interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":305,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":305,"endColumn":4,"fix":{"range":[10918,10918],"text":"\n"}}],"suppressedMessages":[],"errorCount":79,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":71,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, ComponentType, MessageFlags } from 'discord.js';\r\nimport { updateUserStats } from '../achievements.js';\r\nimport { safeExecuteCommand, CommandError, validateRange } from '../errorHandler.js';\r\n\r\nconst triviaQuestions = [\r\n  {\r\n    question: \"What is the capital of France?\",\r\n    options: [\"London\", \"Berlin\", \"Paris\", \"Madrid\"],\r\n    correct: 2,\r\n    category: \"Geography\"\r\n  },\r\n  {\r\n    question: \"Which planet is known as the Red Planet?\",\r\n    options: [\"Venus\", \"Mars\", \"Jupiter\", \"Saturn\"],\r\n    correct: 1,\r\n    category: \"Science\"\r\n  },\r\n  {\r\n    question: \"What is 2 + 2 √ó 3?\",\r\n    options: [\"8\", \"10\", \"12\", \"14\"],\r\n    correct: 0,\r\n    category: \"Math\"\r\n  },\r\n  {\r\n    question: \"Who painted the Mona Lisa?\",\r\n    options: [\"Vincent van Gogh\", \"Pablo Picasso\", \"Leonardo da Vinci\", \"Michelangelo\"],\r\n    correct: 2,\r\n    category: \"Art\"\r\n  },\r\n  {\r\n    question: \"What is the largest mammal in the world?\",\r\n    options: [\"African Elephant\", \"Blue Whale\", \"Giraffe\", \"Hippopotamus\"],\r\n    correct: 1,\r\n    category: \"Nature\"\r\n  },\r\n  {\r\n    question: \"In which year did World War II end?\",\r\n    options: [\"1944\", \"1945\", \"1946\", \"1947\"],\r\n    correct: 1,\r\n    category: \"History\"\r\n  },\r\n  {\r\n    question: \"What is the chemical symbol for gold?\",\r\n    options: [\"Go\", \"Gd\", \"Au\", \"Ag\"],\r\n    correct: 2,\r\n    category: \"Science\"\r\n  },\r\n  {\r\n    question: \"Which programming language is known as the 'mother of all languages'?\",\r\n    options: [\"Python\", \"C\", \"Assembly\", \"Java\"],\r\n    correct: 1,\r\n    category: \"Technology\"\r\n  }\r\n];\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('trivia')\r\n  .setDescription('Start an interactive trivia quiz game')\r\n  .addIntegerOption(option =>\r\n    option.setName('questions')\r\n      .setDescription('Number of questions (1-10, default: 5)')\r\n      .setMinValue(1)\r\n      .setMaxValue(10)\r\n      .setRequired(false))\r\n  .addStringOption(option =>\r\n    option.setName('category')\r\n      .setDescription('Trivia category')\r\n      .addChoices(\r\n        { name: 'All Categories', value: 'all' },\r\n        { name: 'Geography', value: 'Geography' },\r\n        { name: 'Science', value: 'Science' },\r\n        { name: 'Math', value: 'Math' },\r\n        { name: 'Art', value: 'Art' },\r\n        { name: 'Nature', value: 'Nature' },\r\n        { name: 'History', value: 'History' },\r\n        { name: 'Technology', value: 'Technology' }\r\n      )\r\n      .setRequired(false));\r\n\r\nexport async function execute(interaction) {\r\n  const questionCount = interaction.options.getInteger('questions') || 5;\r\n  const category = interaction.options.getString('category') || 'all';\r\n\r\n  // Validate question count\r\n  validateRange(questionCount, 1, 10, 'question count');\r\n\r\n  // Filter questions by category if specified\r\n  let availableQuestions = triviaQuestions;\r\n  if (category !== 'all') {\r\n    const validCategories = ['Geography', 'Science', 'Math', 'Art', 'Nature', 'History', 'Technology'];\r\n    if (!validCategories.includes(category)) {\r\n      throw new CommandError('Invalid category specified.', 'INVALID_ARGUMENT');\r\n    }\r\n    availableQuestions = triviaQuestions.filter(q => q.category === category);\r\n  }\r\n\r\n  if (availableQuestions.length < questionCount) {\r\n    throw new CommandError(`Not enough questions available in ${category === 'all' ? 'all categories' : category} category. Available: ${availableQuestions.length}, Requested: ${questionCount}`, 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  if (availableQuestions.length === 0) {\r\n    throw new CommandError('No questions available in the selected category.', 'NOT_FOUND');\r\n  }\r\n\r\n  // Select random questions\r\n  const selectedQuestions = [];\r\n  const usedIndices = new Set();\r\n\r\n  try {\r\n    while (selectedQuestions.length < questionCount && usedIndices.size < availableQuestions.length) {\r\n      const randomIndex = Math.floor(Math.random() * availableQuestions.length);\r\n      if (!usedIndices.has(randomIndex)) {\r\n        usedIndices.add(randomIndex);\r\n        selectedQuestions.push(availableQuestions[randomIndex]);\r\n      }\r\n    }\r\n\r\n    if (selectedQuestions.length < questionCount) {\r\n      throw new CommandError('Failed to select sufficient unique questions.', 'COMMAND_ERROR');\r\n    }\r\n  } catch (error) {\r\n    throw new CommandError(`Failed to prepare trivia questions: ${error.message}`, 'COMMAND_ERROR', { originalError: error.message });\r\n  }\r\n\r\n  // Import trivia games map\r\n  const { triviaGames } = await import('../game-states.js');\r\n\r\n  // Generate unique game ID\r\n  const gameId = `trivia_${interaction.user.id}_${Date.now()}`;\r\n\r\n  const gameState = {\r\n    userId: interaction.user.id,\r\n    questions: selectedQuestions,\r\n    currentQuestion: 0,\r\n    score: 0,\r\n    answers: [],\r\n    startTime: Date.now(),\r\n    gameActive: true\r\n  };\r\n\r\n  // Store game state\r\n  triviaGames.set(gameId, gameState);\r\n\r\n  await sendQuestion(interaction, gameState);\r\n}\r\n\r\nasync function sendQuestion(interaction, gameState) {\r\n  const question = gameState.questions[gameState.currentQuestion];\r\n\r\n  if (!question) {\r\n    await sendResults(interaction, gameState);\r\n    return;\r\n  }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle(`üß† Trivia Quiz - Question ${gameState.currentQuestion + 1}/${gameState.questions.length}`)\r\n    .setDescription(`**${question.question}**`)\r\n    .setColor(0x0099FF)\r\n    .addFields({\r\n      name: 'Category',\r\n      value: question.category,\r\n      inline: true\r\n    })\r\n    .setFooter({ text: `Score: ${gameState.score}/${gameState.currentQuestion}` })\r\n    .setTimestamp();\r\n\r\n  const buttons = question.options.map((option, index) =>\r\n    new ButtonBuilder()\r\n      .setCustomId(`trivia_${index}`)\r\n      .setLabel(`${String.fromCharCode(65 + index)}) ${option}`)\r\n      .setStyle(ButtonStyle.Primary)\r\n  );\r\n\r\n  const rows = [];\r\n  for (let i = 0; i < buttons.length; i += 2) {\r\n    const row = new ActionRowBuilder().addComponents(buttons.slice(i, i + 2));\r\n    rows.push(row);\r\n  }\r\n\r\n  const filter = (i) => i.customId.startsWith('trivia_') && i.user.id === interaction.user.id;\r\n  const collector = interaction.channel.createMessageComponentCollector({\r\n    componentType: ComponentType.Button,\r\n    filter,\r\n    time: 30000,\r\n    max: 1\r\n  });\r\n\r\n  collector.on('collect', async (i) => {\r\n    try {\r\n      const selectedAnswer = parseInt(i.customId.split('_')[1]);\r\n\r\n      if (isNaN(selectedAnswer) || selectedAnswer < 0 || selectedAnswer >= question.options.length) {\r\n        await i.reply({ content: 'Invalid answer selection.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const isCorrect = selectedAnswer === question.correct;\r\n\r\n      if (isCorrect) {\r\n        gameState.score++;\r\n      }\r\n\r\n      gameState.answers.push({\r\n        question: question.question,\r\n        selectedAnswer: selectedAnswer,\r\n        correctAnswer: question.correct,\r\n        isCorrect: isCorrect,\r\n        userChoice: question.options[selectedAnswer],\r\n        correctChoice: question.options[question.correct]\r\n      });\r\n\r\n      gameState.currentQuestion++;\r\n\r\n      // Send feedback and next question\r\n      const feedbackEmbed = new EmbedBuilder()\r\n        .setTitle(isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect!')\r\n        .setDescription(`**${question.question}**\\n\\nYour answer: **${question.options[selectedAnswer]}**\\nCorrect answer: **${question.options[question.correct]}**`)\r\n        .setColor(isCorrect ? 0x00FF00 : 0xFF0000)\r\n        .setFooter({ text: `Score: ${gameState.score}/${gameState.currentQuestion}` });\r\n\r\n      await i.reply({ embeds: [feedbackEmbed], flags: MessageFlags.Ephemeral });\r\n\r\n      // Wait a moment before sending next question\r\n      setTimeout(() => {\r\n        sendQuestion(interaction, gameState);\r\n      }, 2000);\r\n    } catch (error) {\r\n      console.error('Error in trivia collector:', error);\r\n      await i.reply({ content: 'An error occurred while processing your answer.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  });\r\n\r\n  collector.on('end', async (collected) => {\r\n    if (collected.size === 0) {\r\n      const timeoutEmbed = new EmbedBuilder()\r\n        .setTitle('‚è∞ Time\\'s Up!')\r\n        .setDescription(`You didn't answer in time. Moving to next question...`)\r\n        .setColor(0xFFA500);\r\n\r\n      await interaction.followUp({ embeds: [timeoutEmbed], flags: MessageFlags.Ephemeral });\r\n\r\n      gameState.answers.push({\r\n        question: question.question,\r\n        selectedAnswer: null,\r\n        correctAnswer: question.correct,\r\n        isCorrect: false,\r\n        timeout: true\r\n      });\r\n\r\n      gameState.currentQuestion++;\r\n\r\n      setTimeout(() => {\r\n        sendQuestion(interaction, gameState);\r\n      }, 2000);\r\n    }\r\n  });\r\n\r\n  if (interaction.replied || interaction.deferred) {\r\n    await interaction.followUp({ embeds: [embed], components: rows, flags: MessageFlags.Ephemeral });\r\n  } else {\r\n    await interaction.reply({ embeds: [embed], components: rows, flags: MessageFlags.Ephemeral });\r\n  }\r\n}\r\n\r\nasync function sendResults(interaction, gameState) {\r\n  const totalTime = Math.round((Date.now() - gameState.startTime) / 1000);\r\n  const percentage = Math.round((gameState.score / gameState.questions.length) * 100);\r\n\r\n  let resultMessage = '';\r\n  if (percentage >= 90) resultMessage = 'üèÜ Outstanding! You\\'re a trivia master!';\r\n  else if (percentage >= 70) resultMessage = 'ü•á Great job! You know your stuff!';\r\n  else if (percentage >= 50) resultMessage = 'ü•à Not bad! Keep practicing!';\r\n  else resultMessage = 'üìö Keep learning and try again!';\r\n\r\n  // Track trivia achievements\r\n  try {\r\n    const correctAnswers = gameState.answers.filter(a => a.isCorrect).length;\r\n    updateUserStats(interaction.user.id, {\r\n      trivia_correct: correctAnswers,\r\n      features_tried: 1\r\n    });\r\n  } catch (error) {\r\n    console.warn('Failed to update trivia achievements:', error.message);\r\n  }\r\n\r\n  const embed = new EmbedBuilder()\r\n    .setTitle('üéØ Trivia Quiz Complete!')\r\n    .setDescription(`${resultMessage}\\n\\n**Final Score: ${gameState.score}/${gameState.questions.length} (${percentage}%)**\\n‚è±Ô∏è Time: ${totalTime}s`)\r\n    .setColor(percentage >= 70 ? 0x00FF00 : percentage >= 50 ? 0xFFA500 : 0xFF0000)\r\n    .setTimestamp();\r\n\r\n  // Add detailed results\r\n  gameState.answers.forEach((answer, index) => {\r\n    const emoji = answer.isCorrect ? '‚úÖ' : answer.timeout ? '‚è∞' : '‚ùå';\r\n    const status = answer.isCorrect ? 'Correct' : answer.timeout ? 'Timeout' : 'Incorrect';\r\n    embed.addFields({\r\n      name: `Q${index + 1}: ${status}`,\r\n      value: `${emoji} **${answer.question}**\\n${answer.isCorrect ? 'Your answer: ' + answer.userChoice : `Your answer: ${answer.userChoice}\\nCorrect: ${answer.correctChoice}`}`,\r\n      inline: false\r\n    });\r\n  });\r\n\r\n  if (interaction.replied || interaction.deferred) {\r\n    await interaction.followUp({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n  } else {\r\n    await interaction.reply({ embeds: [embed], flags: MessageFlags.Ephemeral });\r\n  }\r\n}\r\n\r\nexport async function safeExecute(interaction) {\r\n  return safeExecuteCommand(interaction, execute);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\weather.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/better-regex","severity":2,"message":"/[<>\"';&]/ can be optimized to /[\"&';<>]/.","line":20,"column":7,"nodeType":"Literal","messageId":"better-regex","endLine":20,"endColumn":17,"fix":{"range":[742,752],"text":"/[\"&';<>]/"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":41,"column":10,"nodeType":"MemberExpression","endLine":41,"endColumn":27},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":50,"column":18,"nodeType":"Literal","messageId":"error","endLine":50,"endColumn":22,"fix":{"range":[1487,1491],"text":"undefined"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":53,"column":10,"nodeType":"MemberExpression","endLine":53,"endColumn":27},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":85,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":85,"endColumn":6,"fix":{"range":[2843,2843],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `rejRes` should be named `error`.","line":85,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":85,"endColumn":20,"fix":{"range":[2851,2978],"text":"error) {\r\n      return await interaction.reply({\r\n        content: `‚è∞ **Rate limit exceeded!** Please wait ${Math.round(error"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 129. Maximum allowed is 120.","line":87,"column":1,"nodeType":"Program","messageId":"max","endLine":87,"endColumn":130},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":94,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":94,"endColumn":21,"fix":{"range":[3372,3377],"text":"10_000"}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":98,"column":7,"nodeType":null,"messageId":"prefer-switch","endLine":98,"endColumn":36,"fix":{"range":[3442,4198],"text":"switch (response.status) {\n      case 401: {\r\n        return await interaction.reply({ content: '‚ùå Weather API key not configured. Please contact an administrator.', flags: MessageFlags.Ephemeral });\r\n      }\n      case 404: {\r\n        return await interaction.reply({ content: `‚ùå Location \"${location}\" not found. Please check the spelling and try again.`, flags: MessageFlags.Ephemeral });\r\n      }\n      case 429: {\r\n        return await interaction.reply({ content: '‚ùå Weather API rate limit exceeded. Please try again later.', flags: MessageFlags.Ephemeral });\r\n      }\n      default: {\r\n        return await interaction.reply({ content: `‚ùå Unable to fetch weather data. Please try again later.`, flags: MessageFlags.Ephemeral });\r\n      }\n      }"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":100,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":100,"endColumn":8,"fix":{"range":[3636,3636],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 163. Maximum allowed is 120.","line":101,"column":1,"nodeType":"Program","messageId":"max","endLine":101,"endColumn":164},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":102,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":102,"endColumn":8,"fix":{"range":[3846,3846],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":104,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":104,"endColumn":8,"fix":{"range":[4038,4038],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 142. Maximum allowed is 120.","line":105,"column":1,"nodeType":"Program","messageId":"max","endLine":105,"endColumn":143},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":105,"column":51,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":105,"endColumn":108,"fix":{"range":[4097,4154],"text":"'‚ùå Unable to fetch weather data. Please try again later.'"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":118,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":118,"endColumn":25,"fix":{"range":[4663,4671],"text":"0x00_99_FF"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":156,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":156,"endColumn":4,"fix":{"range":[5800,5800],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":157,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":157,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[5822,5869],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":160,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":160,"endColumn":6,"fix":{"range":[6040,6040],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":162,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":162,"endColumn":6,"fix":{"range":[6231,6231],"text":"\n"}}],"suppressedMessages":[],"errorCount":19,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":14,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, MessageFlags } from 'discord.js';\r\nimport { RateLimiterMemory } from 'rate-limiter-flexible';\r\n\r\n// Rate limiter for weather API (60 requests per minute per user)\r\nconst weatherRateLimiter = new RateLimiterMemory({\r\n  keyPrefix: 'weather_api',\r\n  points: 60,\r\n  duration: 60,\r\n});\r\n\r\n/**\r\n * Validates if the location input is safe and reasonable.\r\n * @param {string} location - The location string to validate.\r\n * @returns {boolean} True if valid, false otherwise.\r\n */\r\nfunction isValidLocation(location) {\r\n  if (!location || typeof location !== 'string') return false;\r\n  if (location.length < 2 || location.length > 100) return false;\r\n  // Basic check for potentially malicious input\r\n  if (/[<>\"';&]/.test(location)) return false;\r\n  return true;\r\n}\r\n\r\n/**\r\n * Gets the weather emoji based on the weather condition.\r\n * @param {string} condition - The weather condition.\r\n * @returns {string} The corresponding emoji.\r\n */\r\nfunction getWeatherEmoji(condition) {\r\n  const emojis = {\r\n    'Clear': '‚òÄÔ∏è',\r\n    'Clouds': '‚òÅÔ∏è',\r\n    'Rain': 'üåßÔ∏è',\r\n    'Drizzle': 'üå¶Ô∏è',\r\n    'Thunderstorm': '‚õàÔ∏è',\r\n    'Snow': '‚ùÑÔ∏è',\r\n    'Mist': 'üå´Ô∏è',\r\n    'Fog': 'üå´Ô∏è',\r\n    'Haze': 'üå´Ô∏è'\r\n  };\r\n  return emojis[condition] || 'üå§Ô∏è';\r\n}\r\n\r\n/**\r\n * Gets the wind direction from degrees.\r\n * @param {number} degrees - Wind direction in degrees.\r\n * @returns {string} Wind direction abbreviation.\r\n */\r\nfunction getWindDirection(degrees) {\r\n  if (degrees == null) return '';\r\n  const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];\r\n  const index = Math.round(degrees / 22.5) % 16;\r\n  return directions[index];\r\n}\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('weather')\r\n  .setDescription('Get current weather information for a location')\r\n  .addStringOption(option =>\r\n    option.setName('location')\r\n      .setDescription('City name or location')\r\n      .setRequired(true));\r\n\r\n/**\r\n * Executes the weather command.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n */\r\nexport async function execute(interaction) {\r\n  try {\r\n    const location = interaction.options.getString('location');\r\n\r\n    // Validate location input\r\n    if (!isValidLocation(location)) {\r\n      return await interaction.reply({ content: '‚ùå Invalid location. Please provide a valid city name or location.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Check if API key is configured\r\n    if (!process.env.OPENWEATHER_API_KEY) {\r\n      return await interaction.reply({ content: '‚ùå Weather API key not configured. Please contact an administrator.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Rate limiting for weather API\r\n    try {\r\n      await weatherRateLimiter.consume(interaction.user.id);\r\n    } catch (rejRes) {\r\n      return await interaction.reply({\r\n        content: `‚è∞ **Rate limit exceeded!** Please wait ${Math.round(rejRes.msBeforeNext / 1000)} seconds before trying again.`,\r\n        flags: MessageFlags.Ephemeral\r\n      });\r\n    }\r\n\r\n    // Using a free weather API (you may want to replace with a paid one for production)\r\n    const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(location)}&appid=${process.env.OPENWEATHER_API_KEY}&units=metric`, {\r\n      timeout: 10000 // 10 second timeout\r\n    });\r\n\r\n    if (!response.ok) {\r\n      if (response.status === 401) {\r\n        return await interaction.reply({ content: '‚ùå Weather API key not configured. Please contact an administrator.', flags: MessageFlags.Ephemeral });\r\n      } else if (response.status === 404) {\r\n        return await interaction.reply({ content: `‚ùå Location \"${location}\" not found. Please check the spelling and try again.`, flags: MessageFlags.Ephemeral });\r\n      } else if (response.status === 429) {\r\n        return await interaction.reply({ content: '‚ùå Weather API rate limit exceeded. Please try again later.', flags: MessageFlags.Ephemeral });\r\n      } else {\r\n        return await interaction.reply({ content: `‚ùå Unable to fetch weather data. Please try again later.`, flags: MessageFlags.Ephemeral });\r\n      }\r\n    }\r\n\r\n    const data = await response.json();\r\n\r\n    // Validate API response structure\r\n    if (!data || !data.main || !data.weather || !data.weather[0] || !data.sys || !data.wind) {\r\n      return await interaction.reply({ content: '‚ùå Invalid weather data received. Please try again later.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle(`üå§Ô∏è Weather in ${data.name}, ${data.sys.country}`)\r\n      .setColor(0x0099FF)\r\n      .addFields(\r\n        {\r\n          name: 'üå°Ô∏è Temperature',\r\n          value: `**${Math.round(data.main.temp)}¬∞C** (Feels like ${Math.round(data.main.feels_like)}¬∞C)`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üíß Humidity',\r\n          value: `**${data.main.humidity}%**`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üå¨Ô∏è Wind',\r\n          value: `**${Math.round(data.wind.speed * 3.6)} km/h** ${getWindDirection(data.wind.deg)}`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üå•Ô∏è Conditions',\r\n          value: `${getWeatherEmoji(data.weather[0].main)} **${data.weather[0].description}**`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üìä Pressure',\r\n          value: `**${data.main.pressure} hPa**`,\r\n          inline: true\r\n        },\r\n        {\r\n          name: 'üëÅÔ∏è Visibility',\r\n          value: `**${(data.visibility / 1000).toFixed(1)} km**`,\r\n          inline: true\r\n        }\r\n      )\r\n      .setFooter({ text: 'Data provided by OpenWeatherMap' })\r\n      .setTimestamp();\r\n\r\n    await interaction.reply({ embeds: [embed] });\r\n\r\n  } catch (error) {\r\n    console.error('Weather command error:', error);\r\n    if (error.name === 'AbortError') {\r\n      await interaction.reply({ content: '‚ùå Request timed out. Please try again later.', flags: MessageFlags.Ephemeral });\r\n    } else if (error.message.includes('fetch')) {\r\n      await interaction.reply({ content: '‚ùå Network error. Please check your connection and try again.', flags: MessageFlags.Ephemeral });\r\n    } else {\r\n      await interaction.reply({ content: '‚ùå An error occurred while fetching weather data. Please try again later.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\commands\\wordle.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":172,"fix":{"range":[171,171],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'isValidWord' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":21},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":52,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":52,"endColumn":6,"fix":{"range":[2144,2144],"text":"\n"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":61,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":61,"endColumn":83,"fix":{"range":[2593,2604],"text":"slice(2, 11"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":77,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":77,"endColumn":4,"fix":{"range":[2988,2988],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":78,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3010,3059],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'sendWordleBoard' has too many lines (131). Maximum allowed is 100.","line":90,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":220,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'sendWordleBoard' has too many statements (37). Maximum allowed is 30.","line":90,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":220,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 24 to the 15 allowed.","line":90,"column":16,"nodeType":null,"messageId":"refactorFunction","endLine":90,"endColumn":31},{"ruleId":"unicorn/prefer-at","severity":2,"message":"Prefer `.at(‚Ä¶)` over `[‚Ä¶.length - index]`.","line":97,"column":31,"nodeType":"BinaryExpression","messageId":"negative-index","endLine":97,"endColumn":49,"fix":{"range":[3686,3706],"text":".at(-1)"}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":100,"column":52,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":100,"endColumn":71,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.startTime","property":"startTime"},"fix":{"range":[3578,3886],"text":", startTime } = gameState;\r\n\r\n    if (!gameActive) return;\r\n\r\n    // Check if player won\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (lastGuess && lastGuess.result.every(r => r === 'correct')) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - startTime"},"desc":"Replace `gameState.startTime` with destructured property `startTime`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":104,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":104,"endColumn":8,"fix":{"range":[4004,4004],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":105,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":105,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4030,4081],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":116,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":116,"endColumn":27,"fix":{"range":[4520,4528],"text":"0x00_FF_00"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 136. Maximum allowed is 120.","line":117,"column":1,"nodeType":"Program","messageId":"max","endLine":117,"endColumn":137},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":117,"column":42,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":117,"endColumn":62,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.secretWord","property":"secretWord"},"fix":{"range":[3578,4592],"text":", secretWord } = gameState;\r\n\r\n    if (!gameActive) return;\r\n\r\n    // Check if player won\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (lastGuess && lastGuess.result.every(r => r === 'correct')) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      try {\r\n        await updateUserStats(interaction.user.id, { games: { wordle_wins: 1 } });\r\n      } catch (error) {\r\n        console.error('Error updating user stats:', error);\r\n      }\r\n\r\n      let performanceMessage;\r\n      if (guesses.length === 1) performanceMessage = 'üåü INCREDIBLE! First try!';\r\n      else if (guesses.length <= 3) performanceMessage = 'üéâ Excellent guessing!';\r\n      else if (guesses.length <= 5) performanceMessage = 'üëç Good job!';\r\n      else performanceMessage = 'üòÖ Close one!';\r\n\r\n      const winEmbed = new EmbedBuilder()\r\n        .setTitle('üéâ Wordle Victory!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You guessed **${secretWord"},"desc":"Replace `gameState.secretWord` with destructured property `secretWord`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 147. Maximum allowed is 120.","line":120,"column":1,"nodeType":"Program","messageId":"max","endLine":120,"endColumn":148},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":120,"column":111,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":120,"endColumn":131},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":124,"column":15,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":124,"endColumn":22,"fix":{"range":[4920,5391],"text":"for (const [index, guess] of guesses.entries()) {\r\n        const resultStr = guess.result.map(r => {\r\n          switch (r) {\r\n            case 'correct': return 'üü©';\r\n            case 'present': return 'üü®';\r\n            case 'absent': return '‚¨õ';\r\n            default: return '‚¨ú';\r\n          }\r\n        }).join('');\r\n\r\n        winEmbed.addFields({\r\n          name: `Guess ${index + 1}`,\r\n          value: `${guess.word}\\n${resultStr}`,\r\n          inline: true\r\n        });\r\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":127,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":127,"endColumn":28,"fix":{"range":[5059,5072],"text":" { return 'üü©';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":128,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":128,"endColumn":28,"fix":{"range":[5101,5114],"text":" { return 'üü®';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":129,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":129,"endColumn":27,"fix":{"range":[5142,5154],"text":" { return '‚¨õ';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":130,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":130,"endColumn":21,"fix":{"range":[5176,5188],"text":" { return '‚¨ú';\n            }"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":141,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":145,"endColumn":8,"fix":{"range":[5401,5612],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [winEmbed], components: [] }) : interaction.reply({ embeds: [winEmbed] }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":143,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":143,"endColumn":8,"fix":{"range":[5538,5538],"text":"\n"}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":152,"column":52,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":152,"endColumn":71,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.startTime","property":"startTime"},"fix":{"range":[3578,5832],"text":", startTime } = gameState;\r\n\r\n    if (!gameActive) return;\r\n\r\n    // Check if player won\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (lastGuess && lastGuess.result.every(r => r === 'correct')) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      try {\r\n        await updateUserStats(interaction.user.id, { games: { wordle_wins: 1 } });\r\n      } catch (error) {\r\n        console.error('Error updating user stats:', error);\r\n      }\r\n\r\n      let performanceMessage;\r\n      if (guesses.length === 1) performanceMessage = 'üåü INCREDIBLE! First try!';\r\n      else if (guesses.length <= 3) performanceMessage = 'üéâ Excellent guessing!';\r\n      else if (guesses.length <= 5) performanceMessage = 'üëç Good job!';\r\n      else performanceMessage = 'üòÖ Close one!';\r\n\r\n      const winEmbed = new EmbedBuilder()\r\n        .setTitle('üéâ Wordle Victory!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You guessed **${gameState.secretWord}** in ${guesses.length}/${maxGuesses} attempts!\\n\\n${performanceMessage}`)\r\n        .addFields({\r\n          name: 'üìä Game Stats',\r\n          value: `**Attempts:** ${guesses.length}/${maxGuesses}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n          inline: false\r\n        });\r\n\r\n      guesses.forEach((guess, index) => {\r\n        const resultStr = guess.result.map(r => {\r\n          switch (r) {\r\n            case 'correct': return 'üü©';\r\n            case 'present': return 'üü®';\r\n            case 'absent': return '‚¨õ';\r\n            default: return '‚¨ú';\r\n          }\r\n        }).join('');\r\n\r\n        winEmbed.addFields({\r\n          name: `Guess ${index + 1}`,\r\n          value: `${guess.word}\\n${resultStr}`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [winEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [winEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Check if game over (too many guesses)\r\n    if (guesses.length >= maxGuesses) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - startTime"},"desc":"Replace `gameState.startTime` with destructured property `startTime`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":156,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":156,"endColumn":27,"fix":{"range":[5952,5960],"text":"0xFF_00_00"}},{"ruleId":"unicorn/consistent-destructuring","severity":2,"message":"Use destructured variables over properties.","line":157,"column":43,"nodeType":"MemberExpression","messageId":"consistentDestructuring","endLine":157,"endColumn":63,"suggestions":[{"messageId":"consistentDestructuringSuggest","data":{"expression":"gameState.secretWord","property":"secretWord"},"fix":{"range":[3578,6025],"text":", secretWord } = gameState;\r\n\r\n    if (!gameActive) return;\r\n\r\n    // Check if player won\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (lastGuess && lastGuess.result.every(r => r === 'correct')) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      try {\r\n        await updateUserStats(interaction.user.id, { games: { wordle_wins: 1 } });\r\n      } catch (error) {\r\n        console.error('Error updating user stats:', error);\r\n      }\r\n\r\n      let performanceMessage;\r\n      if (guesses.length === 1) performanceMessage = 'üåü INCREDIBLE! First try!';\r\n      else if (guesses.length <= 3) performanceMessage = 'üéâ Excellent guessing!';\r\n      else if (guesses.length <= 5) performanceMessage = 'üëç Good job!';\r\n      else performanceMessage = 'üòÖ Close one!';\r\n\r\n      const winEmbed = new EmbedBuilder()\r\n        .setTitle('üéâ Wordle Victory!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You guessed **${gameState.secretWord}** in ${guesses.length}/${maxGuesses} attempts!\\n\\n${performanceMessage}`)\r\n        .addFields({\r\n          name: 'üìä Game Stats',\r\n          value: `**Attempts:** ${guesses.length}/${maxGuesses}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n          inline: false\r\n        });\r\n\r\n      guesses.forEach((guess, index) => {\r\n        const resultStr = guess.result.map(r => {\r\n          switch (r) {\r\n            case 'correct': return 'üü©';\r\n            case 'present': return 'üü®';\r\n            case 'absent': return '‚¨õ';\r\n            default: return '‚¨ú';\r\n          }\r\n        }).join('');\r\n\r\n        winEmbed.addFields({\r\n          name: `Guess ${index + 1}`,\r\n          value: `${guess.word}\\n${resultStr}`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [winEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [winEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Check if game over (too many guesses)\r\n    if (guesses.length >= maxGuesses) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      const loseEmbed = new EmbedBuilder()\r\n        .setTitle('üòî Wordle - Game Over')\r\n        .setColor(0xFF0000)\r\n        .setDescription(`The word was **${secretWord"},"desc":"Replace `gameState.secretWord` with destructured property `secretWord`."}]},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":164,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":168,"endColumn":8,"fix":{"range":[6256,6469],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [loseEmbed], components: [] }) : interaction.reply({ embeds: [loseEmbed] }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":166,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":166,"endColumn":8,"fix":{"range":[6394,6394],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":174,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":174,"endColumn":25,"fix":{"range":[6584,6592],"text":"0x00_99_FF"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":187,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":187,"endColumn":28,"fix":{"range":[7135,7148],"text":" { return 'üü©';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":188,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":188,"endColumn":28,"fix":{"range":[7177,7190],"text":" { return 'üü®';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":189,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":189,"endColumn":27,"fix":{"range":[7218,7230],"text":" { return '‚¨õ';\n            }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":190,"column":13,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":190,"endColumn":21,"fix":{"range":[7252,7264],"text":" { return '‚¨ú';\n            }"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":209,"column":5,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":213,"endColumn":6,"fix":{"range":[7758,7977],"text":"await (interaction.replied || interaction.deferred ? interaction.editReply({ embeds: [embed], components: [row] }) : interaction.reply({ embeds: [embed], components: [row] }));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":211,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":211,"endColumn":6,"fix":{"range":[7891,7891],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":214,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":214,"endColumn":4,"fix":{"range":[7982,7982],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":215,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":215,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8004,8054],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'sendWordleGuessModal' is defined but never used.","line":227,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":227,"endColumn":36},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":241,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":241,"endColumn":4,"fix":{"range":[8984,8984],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":242,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":242,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9006,9061],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'checkWordleGuess' is defined but never used.","line":253,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":253,"endColumn":26},{"ruleId":"unicorn/no-new-array","severity":2,"message":"Do not use `new Array()`.","line":254,"column":18,"nodeType":"NewExpression","messageId":"error","endLine":254,"endColumn":30,"fix":{"range":[9512,9524],"text":"Array.from({length: 5})"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":254,"column":36,"nodeType":"Literal","messageId":"error","endLine":254,"endColumn":40,"suggestions":[{"messageId":"replace","fix":{"range":[9530,9534],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `String#split('')`.","line":257,"column":37,"nodeType":"Identifier","messageId":"string-split","endLine":257,"endColumn":42,"suggestions":[{"messageId":"use-spread","fix":{"range":[9654,9675],"text":"[...secretUpper]"},"data":{},"desc":"Use `...` operator."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":261,"column":9,"nodeType":"MemberExpression","endLine":261,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":261,"column":27,"nodeType":"MemberExpression","endLine":261,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":262,"column":7,"nodeType":"MemberExpression","endLine":262,"endColumn":16},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":263,"column":7,"nodeType":"MemberExpression","endLine":263,"endColumn":23},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":263,"column":26,"nodeType":"Literal","messageId":"error","endLine":263,"endColumn":30,"suggestions":[{"messageId":"replace","fix":{"range":[9859,9863],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":269,"column":9,"nodeType":"MemberExpression","endLine":269,"endColumn":18},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":270,"column":22,"nodeType":"MemberExpression","endLine":270,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":274,"column":9,"nodeType":"MemberExpression","endLine":274,"endColumn":18},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":275,"column":9,"nodeType":"MemberExpression","endLine":275,"endColumn":35},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":275,"column":38,"nodeType":"Literal","messageId":"error","endLine":275,"endColumn":42,"suggestions":[{"messageId":"replace","fix":{"range":[10226,10230],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":276,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":276,"endColumn":8,"fix":{"range":[10256,10256],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":277,"column":9,"nodeType":"MemberExpression","endLine":277,"endColumn":18}],"suppressedMessages":[],"errorCount":42,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":28,"fixableWarningCount":0,"source":"import { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, ModalBuilder, TextInputBuilder, TextInputStyle, MessageFlags } from 'discord.js';\r\nimport { wordleGames } from '../game-states.js';\r\nimport { updateUserStats } from '../achievements.js';\r\n\r\nconst WORD_LIST = [\r\n  'HOUSE', 'PLANE', 'TIGER', 'OCEAN', 'FLAME', 'CLOUD', 'BRAIN', 'CHAIR', 'DANCE', 'EAGLE',\r\n  'FLOOD', 'GRACE', 'HEART', 'IMAGE', 'JOINT', 'KNIFE', 'LEMON', 'MUSIC', 'NIGHT', 'OLIVE',\r\n  'PIANO', 'QUEEN', 'RIVER', 'SNAKE', 'TABLE', 'UNCLE', 'VOICE', 'WHEAT', 'YOUTH', 'ZEBRA',\r\n  'ABOUT', 'ABOVE', 'ABUSE', 'ACTOR', 'ACUTE', 'ALIEN', 'ALIGN', 'ALIKE', 'ALIVE', 'ALLOW',\r\n  'ALONE', 'ALONG', 'ALTER', 'AMONG', 'ANGER', 'ANGLE', 'ANGRY', 'APART', 'APPLE', 'APPLY'\r\n];\r\n\r\n/**\r\n * Validates if a word is in the word list.\r\n * @param {string} word - The word to validate.\r\n * @returns {boolean} True if valid, false otherwise.\r\n */\r\nfunction isValidWord(word) {\r\n  return WORD_LIST.includes(word.toUpperCase());\r\n}\r\n\r\nexport const data = new SlashCommandBuilder()\r\n  .setName('wordle')\r\n  .setDescription('Play Wordle - guess the 5-letter word')\r\n  .addStringOption(option =>\r\n    option.setName('difficulty')\r\n      .setDescription('Word difficulty')\r\n      .addChoices(\r\n        { name: 'Easy (Common words)', value: 'easy' },\r\n        { name: 'Normal (Mixed words)', value: 'normal' },\r\n        { name: 'Hard (Uncommon words)', value: 'hard' }\r\n      )\r\n      .setRequired(false));\r\n\r\n/**\r\n * Executes the Wordle command.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n */\r\nexport async function execute(interaction) {\r\n  try {\r\n    const difficulty = interaction.options.getString('difficulty') || 'normal';\r\n\r\n    // Validate difficulty\r\n    if (!['easy', 'normal', 'hard'].includes(difficulty)) {\r\n      return await interaction.reply({ content: '‚ùå Invalid difficulty level.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    // Filter words by difficulty\r\n    let availableWords = WORD_LIST;\r\n    if (difficulty === 'easy') {\r\n      availableWords = WORD_LIST.slice(0, 20); // Common words\r\n    } else if (difficulty === 'hard') {\r\n      availableWords = WORD_LIST.slice(30); // Less common words\r\n    }\r\n\r\n    if (availableWords.length === 0) {\r\n      return await interaction.reply({ content: '‚ùå No words available for this difficulty.', flags: MessageFlags.Ephemeral });\r\n    }\r\n\r\n    const secretWord = availableWords[Math.floor(Math.random() * availableWords.length)];\r\n    const gameId = `wordle_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const gameState = {\r\n      id: gameId,\r\n      secretWord,\r\n      guesses: [],\r\n      maxGuesses: 6,\r\n      currentGuess: '',\r\n      gameActive: true,\r\n      difficulty,\r\n      startTime: Date.now()\r\n    };\r\n\r\n    // Store game state globally for button handlers\r\n    wordleGames.set(interaction.user.id, gameState);\r\n    await sendWordleBoard(interaction, gameState);\r\n  } catch (error) {\r\n    console.error('Error in wordle execute:', error);\r\n    if (!interaction.replied && !interaction.deferred) {\r\n      await interaction.reply({ content: '‚ùå An error occurred while starting the game.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Sends the Wordle board and handles game logic.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n * @param {Object} gameState - The current game state.\r\n */\r\nasync function sendWordleBoard(interaction, gameState) {\r\n  try {\r\n    const { guesses, maxGuesses, gameActive } = gameState;\r\n\r\n    if (!gameActive) return;\r\n\r\n    // Check if player won\r\n    const lastGuess = guesses[guesses.length - 1];\r\n    if (lastGuess && lastGuess.result.every(r => r === 'correct')) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      try {\r\n        await updateUserStats(interaction.user.id, { games: { wordle_wins: 1 } });\r\n      } catch (error) {\r\n        console.error('Error updating user stats:', error);\r\n      }\r\n\r\n      let performanceMessage;\r\n      if (guesses.length === 1) performanceMessage = 'üåü INCREDIBLE! First try!';\r\n      else if (guesses.length <= 3) performanceMessage = 'üéâ Excellent guessing!';\r\n      else if (guesses.length <= 5) performanceMessage = 'üëç Good job!';\r\n      else performanceMessage = 'üòÖ Close one!';\r\n\r\n      const winEmbed = new EmbedBuilder()\r\n        .setTitle('üéâ Wordle Victory!')\r\n        .setColor(0x00FF00)\r\n        .setDescription(`You guessed **${gameState.secretWord}** in ${guesses.length}/${maxGuesses} attempts!\\n\\n${performanceMessage}`)\r\n        .addFields({\r\n          name: 'üìä Game Stats',\r\n          value: `**Attempts:** ${guesses.length}/${maxGuesses}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n          inline: false\r\n        });\r\n\r\n      guesses.forEach((guess, index) => {\r\n        const resultStr = guess.result.map(r => {\r\n          switch (r) {\r\n            case 'correct': return 'üü©';\r\n            case 'present': return 'üü®';\r\n            case 'absent': return '‚¨õ';\r\n            default: return '‚¨ú';\r\n          }\r\n        }).join('');\r\n\r\n        winEmbed.addFields({\r\n          name: `Guess ${index + 1}`,\r\n          value: `${guess.word}\\n${resultStr}`,\r\n          inline: true\r\n        });\r\n      });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [winEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [winEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Check if game over (too many guesses)\r\n    if (guesses.length >= maxGuesses) {\r\n      gameState.gameActive = false;\r\n      const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n      const loseEmbed = new EmbedBuilder()\r\n        .setTitle('üòî Wordle - Game Over')\r\n        .setColor(0xFF0000)\r\n        .setDescription(`The word was **${gameState.secretWord}**!\\n\\nBetter luck next time!`)\r\n        .addFields({\r\n          name: 'üìä Final Stats',\r\n          value: `**Attempts:** ${guesses.length}/${maxGuesses}\\n**Time:** ${timeElapsed}s`,\r\n          inline: false\r\n        });\r\n\r\n      if (interaction.replied || interaction.deferred) {\r\n        await interaction.editReply({ embeds: [loseEmbed], components: [] });\r\n      } else {\r\n        await interaction.reply({ embeds: [loseEmbed] });\r\n      }\r\n      return;\r\n    }\r\n\r\n    const embed = new EmbedBuilder()\r\n      .setTitle('üî§ Wordle Game')\r\n      .setColor(0x0099FF)\r\n      .setDescription(`Guess the 5-letter word!\\n\\n**Attempts:** ${guesses.length}/${maxGuesses}`)\r\n      .addFields({\r\n        name: 'How to Play',\r\n        value: 'üü© = Correct letter, correct position\\nüü® = Correct letter, wrong position\\n‚¨õ = Letter not in word',\r\n        inline: false\r\n      });\r\n\r\n    // Show previous guesses with results\r\n    if (guesses.length > 0) {\r\n      const guessHistory = guesses.map((guess, index) => {\r\n        const resultStr = guess.result.map(r => {\r\n          switch (r) {\r\n            case 'correct': return 'üü©';\r\n            case 'present': return 'üü®';\r\n            case 'absent': return '‚¨õ';\r\n            default: return '‚¨ú';\r\n          }\r\n        }).join('');\r\n\r\n        return `**${index + 1}.** ${guess.word}\\n${resultStr}`;\r\n      }).join('\\n\\n');\r\n\r\n      embed.addFields({\r\n        name: 'Previous Guesses',\r\n        value: guessHistory,\r\n        inline: false\r\n      });\r\n    }\r\n\r\n    // Create guess button\r\n    const row = new ActionRowBuilder().addComponents(\r\n      new ButtonBuilder().setCustomId(`wordle_guess:${interaction.user.id}`).setLabel('üî§ Make Guess').setStyle(ButtonStyle.Primary)\r\n    );\r\n\r\n    if (interaction.replied || interaction.deferred) {\r\n      await interaction.editReply({ embeds: [embed], components: [row] });\r\n    } else {\r\n      await interaction.reply({ embeds: [embed], components: [row] });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error in sendWordleBoard:', error);\r\n    if (!interaction.replied && !interaction.deferred) {\r\n      await interaction.reply({ content: '‚ùå An error occurred while updating the game.', flags: MessageFlags.Ephemeral });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Sends the Wordle guess modal.\r\n * @param {import('discord.js').CommandInteraction} interaction - The interaction object.\r\n * @param {string} gameId - The game ID.\r\n */\r\nasync function sendWordleGuessModal(interaction, gameId) {\r\n  try {\r\n    const modal = new ModalBuilder().setCustomId(`wordle_submit:${gameId}`).setTitle('Wordle Guess');\r\n    const guessInput = new TextInputBuilder()\r\n      .setCustomId('word_guess')\r\n      .setLabel('Enter a 5-letter word')\r\n      .setStyle(TextInputStyle.Short)\r\n      .setRequired(true)\r\n      .setPlaceholder('HOUSE')\r\n      .setMinLength(5)\r\n      .setMaxLength(5);\r\n\r\n    modal.addComponents({ type: 1, components: [guessInput] });\r\n    await interaction.showModal(modal);\r\n  } catch (error) {\r\n    console.error('Error in sendWordleGuessModal:', error);\r\n    await interaction.reply({ content: '‚ùå An error occurred while showing the guess modal.', flags: MessageFlags.Ephemeral });\r\n  }\r\n}\r\n\r\n/**\r\n * Checks a Wordle guess against the secret word.\r\n * @param {string} guess - The player's guess.\r\n * @param {string} secretWord - The secret word.\r\n * @returns {Array<string>} Array of result strings ('correct', 'present', 'absent').\r\n */\r\nfunction checkWordleGuess(guess, secretWord) {\r\n  const result = new Array(5).fill(null);\r\n  const guessUpper = guess.toUpperCase();\r\n  const secretUpper = secretWord.toUpperCase();\r\n  const secretLetters = secretUpper.split('');\r\n\r\n  // First pass: check for correct positions\r\n  for (let i = 0; i < 5; i++) {\r\n    if (guessUpper[i] === secretUpper[i]) {\r\n      result[i] = 'correct';\r\n      secretLetters[i] = null; // Mark as used\r\n    }\r\n  }\r\n\r\n  // Second pass: check for present letters (wrong position)\r\n  for (let i = 0; i < 5; i++) {\r\n    if (result[i] !== 'correct') {\r\n      const letter = guessUpper[i];\r\n      const letterIndex = secretLetters.indexOf(letter);\r\n\r\n      if (letterIndex !== -1) {\r\n        result[i] = 'present';\r\n        secretLetters[letterIndex] = null; // Mark as used\r\n      } else {\r\n        result[i] = 'absent';\r\n      }\r\n    }\r\n  }\r\n\r\n  return result;\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\cooldowns.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":26,"column":63,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":26,"endColumn":69,"fix":{"range":[716,724],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":28,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":28,"endColumn":6,"fix":{"range":[774,774],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":29,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":29,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[798,848],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":36,"column":81,"nodeType":"Literal","messageId":"error","endLine":36,"endColumn":85,"suggestions":[{"messageId":"replace","fix":{"range":[1014,1018],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":37,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":37,"endColumn":6,"fix":{"range":[1031,1031],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":38,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":38,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1055,1105],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":46,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":46,"endColumn":27,"fix":{"range":[1267,1272],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":47,"column":20,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":47,"endColumn":25,"fix":{"range":[1334,1339],"text":"10_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":48,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":48,"endColumn":25,"fix":{"range":[1396,1402],"text":"300_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":49,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":49,"endColumn":30,"fix":{"range":[1467,1474],"text":"3_600_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":50,"column":21,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":50,"endColumn":26,"fix":{"range":[1532,1537],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":51,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":51,"endColumn":27,"fix":{"range":[1599,1604],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":52,"column":25,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":52,"endColumn":31,"fix":{"range":[1671,1677],"text":"600_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":55,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":55,"endColumn":27,"fix":{"range":[1768,1773],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":56,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":56,"endColumn":28,"fix":{"range":[1836,1841],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":57,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":57,"endColumn":27,"fix":{"range":[1905,1910],"text":"45_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":59,"column":24,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":59,"endColumn":29,"fix":{"range":[2042,2047],"text":"10_000"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":80,"column":49,"nodeType":"Literal","messageId":"error","endLine":80,"endColumn":53,"suggestions":[{"messageId":"replace","fix":{"range":[3042,3046],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":82,"column":40,"nodeType":"MemberExpression","endLine":82,"endColumn":74},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":98,"column":32,"nodeType":"MemberExpression","endLine":98,"endColumn":71},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":116,"column":48,"nodeType":"Literal","messageId":"error","endLine":116,"endColumn":52,"suggestions":[{"messageId":"replace","fix":{"range":[4053,4057],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":118,"column":40,"nodeType":"MemberExpression","endLine":118,"endColumn":74},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":127,"column":20,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":127,"endColumn":25,"fix":{"range":[4413,4418],"text":"60_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":128,"column":7,"nodeType":"MemberExpression","endLine":128,"endColumn":36},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":143,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":143,"endColumn":6,"fix":{"range":[4880,4880],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":145,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":145,"endColumn":6,"fix":{"range":[4957,4957],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":176,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'guildId' is defined but never used.","line":176,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'action' is defined but never used.","line":176,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":49},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 16 to the 15 allowed.","line":183,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":183,"endColumn":22},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":189,"column":7,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":189,"endColumn":9},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":190,"column":9,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":196,"endColumn":10,"fix":{"range":[6185,6440],"text":"(key.startsWith(`${userId}_`) && now < endTime) {\r\n          const action = key.replace(`${userId}_`, '');\r\n          cooldowns[action] = {\r\n            remaining: endTime - now,\r\n            endTime: endTime\r\n          };\r\n        }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":11,"nodeType":"MemberExpression","endLine":192,"endColumn":28},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":202,"column":7,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":202,"endColumn":9},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":203,"column":9,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":211,"endColumn":10,"fix":{"range":[6573,6886],"text":"(key.startsWith(`${userId}_`) && now < endTime) {\r\n          const action = key.replace(`${userId}_`, '');\r\n          if (!cooldowns[action]) {\r\n            cooldowns[action] = {\r\n              remaining: endTime - now,\r\n              endTime: endTime\r\n            };\r\n          }\r\n        }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":205,"column":16,"nodeType":"MemberExpression","endLine":205,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":206,"column":13,"nodeType":"MemberExpression","endLine":206,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":228,"column":16,"nodeType":"MemberExpression","endLine":228,"endColumn":45},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":242,"column":60,"nodeType":"Literal","messageId":"error","endLine":242,"endColumn":64,"suggestions":[{"messageId":"replace","fix":{"range":[7769,7773],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":288,"column":16,"nodeType":"MemberExpression","endLine":288,"endColumn":45},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (361). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":361,"endColumn":11},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":316,"column":63,"nodeType":"Literal","messageId":"error","endLine":316,"endColumn":67,"suggestions":[{"messageId":"replace","fix":{"range":[9860,9864],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":320,"column":62,"nodeType":"Literal","messageId":"error","endLine":320,"endColumn":66,"suggestions":[{"messageId":"replace","fix":{"range":[10007,10011],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":361,"column":4,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":361,"endColumn":9,"fix":{"range":[11208,11213],"text":"60_000"}}],"suppressedMessages":[],"errorCount":33,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":22,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst COOLDOWNS_FILE = path.join(process.cwd(), 'data', 'cooldowns.json');\r\n\r\n// Advanced Cooldown Management System\r\nclass CooldownManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadCooldowns();\r\n    this.tempCooldowns = new Map(); // In-memory storage for active cooldowns\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(COOLDOWNS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(COOLDOWNS_FILE)) {\r\n      fs.writeFileSync(COOLDOWNS_FILE, JSON.stringify({}));\r\n    }\r\n  }\r\n\r\n  loadCooldowns() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(COOLDOWNS_FILE, 'utf8'));\r\n      this.persistentCooldowns = data;\r\n    } catch (error) {\r\n      console.error('Failed to load cooldowns:', error);\r\n      this.persistentCooldowns = {};\r\n    }\r\n  }\r\n\r\n  saveCooldowns() {\r\n    try {\r\n      fs.writeFileSync(COOLDOWNS_FILE, JSON.stringify(this.persistentCooldowns, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save cooldowns:', error);\r\n    }\r\n  }\r\n\r\n  // Default cooldown configurations (in milliseconds)\r\n  getDefaultCooldowns() {\r\n    return {\r\n      // Command cooldowns\r\n      'rpg_explore': 30000,      // 30 seconds between explorations\r\n      'rpg_fight': 10000,        // 10 seconds between fights\r\n      'rpg_boss': 300000,        // 5 minutes between boss fights\r\n      'guild_create': 3600000,   // 1 hour between guild creation\r\n      'guild_join': 60000,       // 1 minute between guild joins\r\n      'trade_offer': 30000,      // 30 seconds between trade offers\r\n      'auction_create': 600000,  // 10 minutes between auction creation\r\n\r\n      // Game cooldowns\r\n      'trivia_game': 60000,      // 1 minute between trivia games\r\n      'hangman_game': 30000,     // 30 seconds between hangman games\r\n      'memory_game': 45000,      // 45 seconds between memory games\r\n      'coin_flip': 5000,         // 5 seconds between coin flips\r\n      'weather_check': 10000,    // 10 seconds between weather checks\r\n\r\n      // Button cooldowns\r\n      'button_explore': 5000,    // 5 seconds between button presses for exploration\r\n      'button_combat': 3000,     // 3 seconds between combat button presses\r\n      'button_inventory': 2000,  // 2 seconds between inventory button presses\r\n      'button_guild': 3000,      // 3 seconds between guild button presses\r\n      'button_trade': 5000,      // 5 seconds between trade button presses\r\n      'button_music': 2000,      // 2 seconds between music button presses\r\n\r\n      // Chat cooldowns\r\n      'ai_chat': 3000,           // 3 seconds between AI messages\r\n      'ai_chat_dm': 5000,        // 5 seconds for DMs (more lenient)\r\n\r\n      // Global cooldowns\r\n      'command_global': 1000,    // 1 second global command cooldown\r\n      'message_global': 2000,    // 2 seconds global message cooldown\r\n    };\r\n  }\r\n\r\n  // Check if user is on cooldown for specific action\r\n  isOnCooldown(userId, action, customCooldown = null) {\r\n    const now = Date.now();\r\n    const cooldown = customCooldown || this.getDefaultCooldowns()[action] || 5000;\r\n\r\n    // Check in-memory cooldowns first (more recent)\r\n    const memoryKey = `${userId}_${action}`;\r\n    const memoryCooldown = this.tempCooldowns.get(memoryKey);\r\n\r\n    if (memoryCooldown && now < memoryCooldown) {\r\n      return {\r\n        onCooldown: true,\r\n        remaining: memoryCooldown - now,\r\n        cooldown: cooldown\r\n      };\r\n    }\r\n\r\n    // Check persistent cooldowns\r\n    const persistentKey = `${userId}_${action}`;\r\n    const persistentCooldown = this.persistentCooldowns[persistentKey];\r\n\r\n    if (persistentCooldown && now < persistentCooldown) {\r\n      return {\r\n        onCooldown: true,\r\n        remaining: persistentCooldown - now,\r\n        cooldown: cooldown\r\n      };\r\n    }\r\n\r\n    return {\r\n      onCooldown: false,\r\n      remaining: 0,\r\n      cooldown: cooldown\r\n    };\r\n  }\r\n\r\n  // Set cooldown for user action\r\n  setCooldown(userId, action, customCooldown = null) {\r\n    const now = Date.now();\r\n    const cooldown = customCooldown || this.getDefaultCooldowns()[action] || 5000;\r\n    const endTime = now + cooldown;\r\n\r\n    const key = `${userId}_${action}`;\r\n\r\n    // Store in memory for immediate access\r\n    this.tempCooldowns.set(key, endTime);\r\n\r\n    // Store persistently for longer cooldowns\r\n    if (cooldown > 60000) { // Only persist cooldowns longer than 1 minute\r\n      this.persistentCooldowns[key] = endTime;\r\n      this.saveCooldowns();\r\n    }\r\n\r\n    return endTime;\r\n  }\r\n\r\n  // Get remaining cooldown time formatted\r\n  getFormattedCooldown(remaining) {\r\n    const seconds = Math.ceil(remaining / 1000);\r\n    const minutes = Math.floor(seconds / 60);\r\n    const hours = Math.floor(minutes / 60);\r\n\r\n    if (hours > 0) {\r\n      return `${hours}h ${minutes % 60}m`;\r\n    } else if (minutes > 0) {\r\n      return `${minutes}m ${seconds % 60}s`;\r\n    } else {\r\n      return `${seconds}s`;\r\n    }\r\n  }\r\n\r\n  // Advanced cooldown management\r\n  setContextCooldown(userId, context, action, cooldown) {\r\n    // Context-aware cooldowns (e.g., different cooldowns per guild)\r\n    const key = `${userId}_${context}_${action}`;\r\n    const endTime = Date.now() + cooldown;\r\n\r\n    this.tempCooldowns.set(key, endTime);\r\n    return endTime;\r\n  }\r\n\r\n  isOnContextCooldown(userId, context, action) {\r\n    const now = Date.now();\r\n    const key = `${userId}_${context}_${action}`;\r\n    const cooldownEnd = this.tempCooldowns.get(key);\r\n\r\n    if (cooldownEnd && now < cooldownEnd) {\r\n      return {\r\n        onCooldown: true,\r\n        remaining: cooldownEnd - now\r\n      };\r\n    }\r\n\r\n    return { onCooldown: false };\r\n  }\r\n\r\n  // Cooldown exemptions for VIP users or special roles\r\n  checkCooldownExemption(userId, guildId, action) {\r\n    // This would check for VIP roles, premium subscriptions, etc.\r\n    // For now, return false (no exemptions)\r\n    return false;\r\n  }\r\n\r\n  // Bulk cooldown management\r\n  getAllUserCooldowns(userId) {\r\n    const now = Date.now();\r\n    const cooldowns = {};\r\n\r\n    // Check in-memory cooldowns\r\n    for (const [key, endTime] of this.tempCooldowns) {\r\n      if (key.startsWith(`${userId}_`)) {\r\n        if (now < endTime) {\r\n          const action = key.replace(`${userId}_`, '');\r\n          cooldowns[action] = {\r\n            remaining: endTime - now,\r\n            endTime: endTime\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check persistent cooldowns\r\n    for (const [key, endTime] of Object.entries(this.persistentCooldowns)) {\r\n      if (key.startsWith(`${userId}_`)) {\r\n        if (now < endTime) {\r\n          const action = key.replace(`${userId}_`, '');\r\n          if (!cooldowns[action]) {\r\n            cooldowns[action] = {\r\n              remaining: endTime - now,\r\n              endTime: endTime\r\n            };\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return cooldowns;\r\n  }\r\n\r\n  clearUserCooldowns(userId) {\r\n    // Clear all cooldowns for a user (admin function)\r\n    for (const [key] of this.tempCooldowns) {\r\n      if (key.startsWith(`${userId}_`)) {\r\n        this.tempCooldowns.delete(key);\r\n      }\r\n    }\r\n\r\n    for (const key of Object.keys(this.persistentCooldowns)) {\r\n      if (key.startsWith(`${userId}_`)) {\r\n        delete this.persistentCooldowns[key];\r\n      }\r\n    }\r\n\r\n    this.saveCooldowns();\r\n    return true;\r\n  }\r\n\r\n  // Adaptive cooldowns based on usage patterns\r\n  getAdaptiveCooldown(userId, action, baseCooldown) {\r\n    // This would analyze user's usage patterns and adjust cooldowns accordingly\r\n    // For example, frequent users might get slightly longer cooldowns to prevent spam\r\n    // VIP users might get shorter cooldowns\r\n\r\n    const exemptions = this.checkCooldownExemption(userId, null, action);\r\n\r\n    if (exemptions) {\r\n      return Math.floor(baseCooldown * 0.5); // 50% reduction for VIPs\r\n    }\r\n\r\n    // For now, return base cooldown\r\n    return baseCooldown;\r\n  }\r\n\r\n  // Cooldown statistics and analytics\r\n  getCooldownStats() {\r\n    const now = Date.now();\r\n    const activeCooldowns = {\r\n      memory: 0,\r\n      persistent: 0,\r\n      total: 0\r\n    };\r\n\r\n    for (const endTime of this.tempCooldowns.values()) {\r\n      if (now < endTime) activeCooldowns.memory++;\r\n    }\r\n\r\n    for (const endTime of Object.values(this.persistentCooldowns)) {\r\n      if (now < endTime) activeCooldowns.persistent++;\r\n    }\r\n\r\n    activeCooldowns.total = activeCooldowns.memory + activeCooldowns.persistent;\r\n\r\n    return activeCooldowns;\r\n  }\r\n\r\n  // Cleanup expired cooldowns\r\n  cleanup() {\r\n    const now = Date.now();\r\n\r\n    // Clean up expired in-memory cooldowns\r\n    for (const [key, endTime] of this.tempCooldowns) {\r\n      if (now >= endTime) {\r\n        this.tempCooldowns.delete(key);\r\n      }\r\n    }\r\n\r\n    // Clean up expired persistent cooldowns\r\n    for (const [key, endTime] of Object.entries(this.persistentCooldowns)) {\r\n      if (now >= endTime) {\r\n        delete this.persistentCooldowns[key];\r\n      }\r\n    }\r\n\r\n    this.saveCooldowns();\r\n  }\r\n\r\n  // Function to determine button cooldown type based on customId\r\n  getButtonCooldownType(customId) {\r\n    if (!customId) return 'button_explore'; // default\r\n\r\n    const [action] = customId.split(':');\r\n\r\n    if (action.startsWith('explore_')) return 'button_explore';\r\n    if (action.startsWith('combat_')) return 'button_combat';\r\n    if (action.startsWith('inventory_')) return 'button_inventory';\r\n    if (action.startsWith('guild_')) return 'button_guild';\r\n    if (action.startsWith('trade_')) return 'button_trade';\r\n    if (action.startsWith('music_')) return 'button_music';\r\n\r\n    return 'button_explore'; // default\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const cooldownManager = new CooldownManager();\r\n\r\n// Convenience functions\r\nexport function isOnCooldown(userId, action, customCooldown = null) {\r\n  return cooldownManager.isOnCooldown(userId, action, customCooldown);\r\n}\r\n\r\nexport function setCooldown(userId, action, customCooldown = null) {\r\n  return cooldownManager.setCooldown(userId, action, customCooldown);\r\n}\r\n\r\nexport function getFormattedCooldown(remaining) {\r\n  return cooldownManager.getFormattedCooldown(remaining);\r\n}\r\n\r\nexport function setContextCooldown(userId, context, action, cooldown) {\r\n  return cooldownManager.setContextCooldown(userId, context, action, cooldown);\r\n}\r\n\r\nexport function isOnContextCooldown(userId, context, action) {\r\n  return cooldownManager.isOnContextCooldown(userId, context, action);\r\n}\r\n\r\nexport function getAllUserCooldowns(userId) {\r\n  return cooldownManager.getAllUserCooldowns(userId);\r\n}\r\n\r\nexport function clearUserCooldowns(userId) {\r\n  return cooldownManager.clearUserCooldowns(userId);\r\n}\r\n\r\nexport function getAdaptiveCooldown(userId, action, baseCooldown) {\r\n  return cooldownManager.getAdaptiveCooldown(userId, action, baseCooldown);\r\n}\r\n\r\nexport function getCooldownStats() {\r\n  return cooldownManager.getCooldownStats();\r\n}\r\n\r\nexport function getButtonCooldownType(customId) {\r\n  return cooldownManager.getButtonCooldownType(customId);\r\n}\r\n\r\n// Export the function from the class instance\r\n\r\n// Auto-cleanup every minute\r\nsetInterval(() => {\r\n  cooldownManager.cleanup();\r\n}, 60000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\customcommands.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":30,"column":69,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":30,"endColumn":75,"fix":{"range":[792,800],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":32,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":32,"endColumn":6,"fix":{"range":[845,845],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":33,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":33,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[869,925],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":44,"column":82,"nodeType":"Literal","messageId":"error","endLine":44,"endColumn":86,"suggestions":[{"messageId":"replace","fix":{"range":[1166,1170],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":45,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":45,"endColumn":6,"fix":{"range":[1183,1183],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":46,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":46,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1207,1263],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":52,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":52,"endColumn":83,"fix":{"range":[1420,1431],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":68,"column":35,"nodeType":"Literal","messageId":"error","endLine":68,"endColumn":39,"suggestions":[{"messageId":"replace","fix":{"range":[1978,1982],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":71,"column":10,"nodeType":"MemberExpression","endLine":71,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":72,"column":7,"nodeType":"MemberExpression","endLine":72,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":75,"column":5,"nodeType":"MemberExpression","endLine":75,"endColumn":53},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":75,"column":5,"nodeType":"MemberExpression","endLine":75,"endColumn":42},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'executeCommand' has too many lines (66). Maximum allowed is 50.","line":82,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":147,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'executeCommand' has a complexity of 15. Maximum allowed is 10.","line":82,"column":23,"nodeType":"FunctionExpression","messageId":"complex","endLine":147,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":84,"column":22,"nodeType":"MemberExpression","endLine":84,"endColumn":59},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":85,"column":19,"nodeType":"Literal","messageId":"error","endLine":85,"endColumn":23,"suggestions":[{"messageId":"remove","fix":{"range":[2462,2469],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[2465,2469],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":86,"column":21,"nodeType":"Literal","messageId":"error","endLine":86,"endColumn":25,"suggestions":[{"messageId":"remove","fix":{"range":[2489,2496],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[2492,2496],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 121. Maximum allowed is 120.","line":105,"column":1,"nodeType":"Program","messageId":"max","endLine":105,"endColumn":122},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":107,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":107,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[3344,3458],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":112,"column":10,"nodeType":"MemberExpression","endLine":112,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":113,"column":7,"nodeType":"MemberExpression","endLine":113,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":115,"column":10,"nodeType":"MemberExpression","endLine":115,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":115,"column":10,"nodeType":"MemberExpression","endLine":115,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":116,"column":7,"nodeType":"MemberExpression","endLine":116,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":116,"column":7,"nodeType":"MemberExpression","endLine":116,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":118,"column":5,"nodeType":"MemberExpression","endLine":118,"endColumn":58},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":118,"column":5,"nodeType":"MemberExpression","endLine":118,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":118,"column":5,"nodeType":"MemberExpression","endLine":118,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":119,"column":8,"nodeType":"MemberExpression","endLine":119,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":119,"column":8,"nodeType":"MemberExpression","endLine":119,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":119,"column":8,"nodeType":"MemberExpression","endLine":119,"endColumn":42},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":128,"column":27,"nodeType":"Identifier","messageId":"method","endLine":128,"endColumn":34,"fix":{"range":[4117,4117],"text":"All"}},{"ruleId":"security/detect-non-literal-regexp","severity":1,"message":"Found non-literal argument to RegExp Constructor","line":128,"column":35,"nodeType":"NewExpression","endLine":128,"endColumn":69},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":132,"column":25,"nodeType":"Identifier","messageId":"method","endLine":132,"endColumn":32,"fix":{"range":[4234,4248],"text":"All('${user}'"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{user\\}/g can be optimized to /\\${user}/g.","line":132,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":132,"endColumn":46,"fix":{"range":[4235,4248],"text":"/\\${user}/g"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":133,"column":25,"nodeType":"Identifier","messageId":"method","endLine":133,"endColumn":32,"fix":{"range":[4299,4317],"text":"All('${username}'"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{username\\}/g can be optimized to /\\${username}/g.","line":133,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":133,"endColumn":50,"fix":{"range":[4300,4317],"text":"/\\${username}/g"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":134,"column":25,"nodeType":"Identifier","messageId":"method","endLine":134,"endColumn":32,"fix":{"range":[4377,4392],"text":"All('${guild}'"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{guild\\}/g can be optimized to /\\${guild}/g.","line":134,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":134,"endColumn":47,"fix":{"range":[4378,4392],"text":"/\\${guild}/g"}},{"ruleId":"no-unused-vars","severity":1,"message":"'args' is defined but never used.","line":149,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":46},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":151,"column":25,"nodeType":"Identifier","messageId":"method","endLine":151,"endColumn":32,"fix":{"range":[4854,4854],"text":"All"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{random:([^}]+)\\}/g can be optimized to /\\${random:([^}]+)}/g.","line":151,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":151,"endColumn":56,"fix":{"range":[4855,4878],"text":"/\\${random:([^}]+)}/g"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":156,"column":25,"nodeType":"Identifier","messageId":"method","endLine":156,"endColumn":32,"fix":{"range":[5062,5076],"text":"All('${date}'"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{date\\}/g can be optimized to /\\${date}/g.","line":156,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":156,"endColumn":46,"fix":{"range":[5063,5076],"text":"/\\${date}/g"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":157,"column":25,"nodeType":"Identifier","messageId":"method","endLine":157,"endColumn":32,"fix":{"range":[5144,5158],"text":"All('${time}'"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/\\$\\{time\\}/g can be optimized to /\\${time}/g.","line":157,"column":33,"nodeType":"Literal","messageId":"better-regex","endLine":157,"endColumn":46,"fix":{"range":[5145,5158],"text":"/\\${time}/g"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":164,"column":22,"nodeType":"MemberExpression","endLine":164,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":165,"column":23,"nodeType":"MemberExpression","endLine":165,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":169,"column":21,"nodeType":"MemberExpression","endLine":169,"endColumn":40},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":178,"column":22,"nodeType":"MemberExpression","endLine":178,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":179,"column":23,"nodeType":"MemberExpression","endLine":179,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":183,"column":12,"nodeType":"MemberExpression","endLine":183,"endColumn":31},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":190,"column":50,"nodeType":"CallExpression","messageId":"substr","endLine":190,"endColumn":89,"fix":{"range":[6132,6143],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":203,"column":5,"nodeType":"MemberExpression","endLine":203,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":211,"column":22,"nodeType":"MemberExpression","endLine":211,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":225,"column":22,"nodeType":"MemberExpression","endLine":225,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":239,"column":19,"nodeType":"MemberExpression","endLine":239,"endColumn":53},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":244,"column":20,"nodeType":"MemberExpression","endLine":244,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":246,"column":7,"nodeType":"MemberExpression","endLine":246,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":257,"column":22,"nodeType":"MemberExpression","endLine":257,"endColumn":59},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":279,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":279,"endColumn":83,"fix":{"range":[8755,8766],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":293,"column":10,"nodeType":"MemberExpression","endLine":293,"endColumn":45},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":294,"column":7,"nodeType":"MemberExpression","endLine":294,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":297,"column":5,"nodeType":"MemberExpression","endLine":297,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":297,"column":5,"nodeType":"MemberExpression","endLine":297,"endColumn":40},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (468). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":468,"endColumn":20},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":305,"column":22,"nodeType":"MemberExpression","endLine":305,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":306,"column":23,"nodeType":"MemberExpression","endLine":306,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":310,"column":5,"nodeType":"MemberExpression","endLine":310,"endColumn":24},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":318,"column":22,"nodeType":"MemberExpression","endLine":318,"endColumn":59},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":333,"column":17,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":333,"endColumn":24,"fix":{"range":[10186,10294],"text":"for (const cmd of commandList) {\r\n      categories[cmd.category] = (categories[cmd.category] || 0) + 1;\r\n    }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":348,"column":22,"nodeType":"MemberExpression","endLine":348,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":363,"column":10,"nodeType":"MemberExpression","endLine":363,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":364,"column":7,"nodeType":"MemberExpression","endLine":364,"endColumn":44},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":368,"column":51,"nodeType":"CallExpression","messageId":"substr","endLine":368,"endColumn":90,"fix":{"range":[11228,11239],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":371,"column":7,"nodeType":"MemberExpression","endLine":371,"endColumn":55},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":371,"column":7,"nodeType":"MemberExpression","endLine":371,"endColumn":44},{"ruleId":"unicorn/better-regex","severity":2,"message":"/^[a-zA-Z0-9_-]+$/ can be optimized to /^[\\w-]+$/.","line":390,"column":30,"nodeType":"Literal","messageId":"better-regex","endLine":390,"endColumn":48,"fix":{"range":[11883,11901],"text":"/^[\\w-]+$/"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/^[a-zA-Z0-9_-]+$/ can be optimized to /^[\\w-]+$/.","line":396,"column":14,"nodeType":"Literal","messageId":"better-regex","endLine":396,"endColumn":32,"fix":{"range":[12129,12147],"text":"/^[\\w-]+$/"}},{"ruleId":"no-unused-vars","severity":1,"message":"'cutoffTime' is assigned a value but never used.","line":411,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":411,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":414,"column":28,"nodeType":"MemberExpression","endLine":414,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":415,"column":33,"nodeType":"MemberExpression","endLine":415,"endColumn":75},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":415,"column":33,"nodeType":"MemberExpression","endLine":415,"endColumn":67},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":417,"column":28,"nodeType":"MemberExpression","endLine":417,"endColumn":65},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":418,"column":16,"nodeType":"MemberExpression","endLine":418,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":419,"column":20,"nodeType":"MemberExpression","endLine":419,"endColumn":73},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":419,"column":20,"nodeType":"MemberExpression","endLine":419,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":419,"column":20,"nodeType":"MemberExpression","endLine":419,"endColumn":54}],"suppressedMessages":[],"errorCount":33,"fatalErrorCount":0,"warningCount":59,"fixableErrorCount":25,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst CUSTOM_COMMANDS_FILE = path.join(process.cwd(), 'data', 'customcommands.json');\r\n\r\n// Advanced Custom Command System\r\nclass CustomCommandManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadCustomCommands();\r\n    this.commandCache = new Map();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(CUSTOM_COMMANDS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(CUSTOM_COMMANDS_FILE)) {\r\n      fs.writeFileSync(CUSTOM_COMMANDS_FILE, JSON.stringify({\r\n        commands: {},\r\n        usage: {},\r\n        templates: {}\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadCustomCommands() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(CUSTOM_COMMANDS_FILE, 'utf8'));\r\n      this.customCommands = data;\r\n    } catch (error) {\r\n      console.error('Failed to load custom commands:', error);\r\n      this.customCommands = {\r\n        commands: {},\r\n        usage: {},\r\n        templates: {}\r\n      };\r\n    }\r\n  }\r\n\r\n  saveCustomCommands() {\r\n    try {\r\n      fs.writeFileSync(CUSTOM_COMMANDS_FILE, JSON.stringify(this.customCommands, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save custom commands:', error);\r\n    }\r\n  }\r\n\r\n  // Custom Command Creation\r\n  createCommand(guildId, commandData) {\r\n    const commandId = `cmd_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const command = {\r\n      id: commandId,\r\n      name: commandData.name,\r\n      description: commandData.description,\r\n      response: commandData.response,\r\n      type: commandData.type || 'text',\r\n      permissions: commandData.permissions || [],\r\n      cooldown: commandData.cooldown || 0,\r\n      usage_count: 0,\r\n      created_by: commandData.created_by,\r\n      created_at: Date.now(),\r\n      enabled: true,\r\n      aliases: commandData.aliases || [],\r\n      variables: commandData.variables || {},\r\n      embed: commandData.embed || null\r\n    };\r\n\r\n    if (!this.customCommands.commands[guildId]) {\r\n      this.customCommands.commands[guildId] = {};\r\n    }\r\n\r\n    this.customCommands.commands[guildId][commandId] = command;\r\n    this.saveCustomCommands();\r\n\r\n    return { success: true, command };\r\n  }\r\n\r\n  // Command Execution\r\n  async executeCommand(commandName, guildId, userId, args = {}) {\r\n    // Find command by name or alias\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n    let command = null;\r\n    let commandId = null;\r\n\r\n    for (const [id, cmd] of Object.entries(commands)) {\r\n      if (cmd.name === commandName || cmd.aliases.includes(commandName)) {\r\n        command = cmd;\r\n        commandId = id;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!command || !command.enabled) {\r\n      return { success: false, reason: 'command_not_found' };\r\n    }\r\n\r\n    // Check permissions\r\n    if (command.permissions.length > 0) {\r\n      // In a real implementation, check user roles/permissions against Discord guild roles\r\n      // For demo, assume permissions are role IDs or names, and check if user has them\r\n      // This would require access to Discord.js client and guild member\r\n      // Example: if (!member.roles.cache.has(permission)) return { success: false, reason: 'insufficient_permissions' };\r\n      // For now, skip permission check to allow execution\r\n      console.log(`Permission check for command ${commandName} by user ${userId}: Skipped (implement with Discord.js)`);\r\n    }\r\n\r\n    // Track usage\r\n    command.usage_count++;\r\n    if (!this.customCommands.usage[guildId]) {\r\n      this.customCommands.usage[guildId] = {};\r\n    }\r\n    if (!this.customCommands.usage[guildId][userId]) {\r\n      this.customCommands.usage[guildId][userId] = {};\r\n    }\r\n    this.customCommands.usage[guildId][userId][commandId] =\r\n      (this.customCommands.usage[guildId][userId][commandId] || 0) + 1;\r\n\r\n    this.saveCustomCommands();\r\n\r\n    // Process response with variables\r\n    let response = command.response;\r\n\r\n    // Replace variables\r\n    for (const [key, value] of Object.entries(command.variables)) {\r\n      response = response.replace(new RegExp(`\\\\$\\\\{${key}\\\\}`, 'g'), value);\r\n    }\r\n\r\n    // Replace user variables\r\n    response = response.replace(/\\$\\{user\\}/g, `<@${userId}>`);\r\n    response = response.replace(/\\$\\{username\\}/g, args.username || 'User');\r\n    response = response.replace(/\\$\\{guild\\}/g, args.guildName || 'Server');\r\n\r\n    // Process dynamic content\r\n    if (command.type === 'dynamic') {\r\n      response = await this.processDynamicResponse(response, args);\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      response,\r\n      embed: command.embed,\r\n      type: command.type\r\n    };\r\n  }\r\n\r\n  async processDynamicResponse(response, args) {\r\n    // Process dynamic content like random selections, calculations, etc.\r\n    response = response.replace(/\\$\\{random:([^}]+)\\}/g, (match, options) => {\r\n      const choices = options.split('|');\r\n      return choices[Math.floor(Math.random() * choices.length)].trim();\r\n    });\r\n\r\n    response = response.replace(/\\$\\{date\\}/g, new Date().toLocaleDateString());\r\n    response = response.replace(/\\$\\{time\\}/g, new Date().toLocaleTimeString());\r\n\r\n    return response;\r\n  }\r\n\r\n  // Command Management\r\n  updateCommand(guildId, commandId, updates) {\r\n    const commands = this.customCommands.commands[guildId];\r\n    if (!commands || !commands[commandId]) {\r\n      return { success: false, reason: 'command_not_found' };\r\n    }\r\n\r\n    const command = commands[commandId];\r\n    Object.assign(command, updates);\r\n    command.updated_at = Date.now();\r\n\r\n    this.saveCustomCommands();\r\n    return { success: true, command };\r\n  }\r\n\r\n  deleteCommand(guildId, commandId) {\r\n    const commands = this.customCommands.commands[guildId];\r\n    if (!commands || !commands[commandId]) {\r\n      return { success: false, reason: 'command_not_found' };\r\n    }\r\n\r\n    delete commands[commandId];\r\n    this.saveCustomCommands();\r\n    return { success: true };\r\n  }\r\n\r\n  // Command Templates\r\n  createTemplate(templateData) {\r\n    const templateId = `template_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const template = {\r\n      id: templateId,\r\n      name: templateData.name,\r\n      description: templateData.description,\r\n      response_template: templateData.response_template,\r\n      variables: templateData.variables || [],\r\n      category: templateData.category || 'general',\r\n      created_by: templateData.created_by,\r\n      created_at: Date.now()\r\n    };\r\n\r\n    this.customCommands.templates[templateId] = template;\r\n    this.saveCustomCommands();\r\n\r\n    return { success: true, template };\r\n  }\r\n\r\n  // Command Discovery\r\n  searchCommands(guildId, query) {\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n    const results = [];\r\n\r\n    for (const [id, command] of Object.entries(commands)) {\r\n      if (command.name.toLowerCase().includes(query.toLowerCase()) ||\r\n          command.description.toLowerCase().includes(query.toLowerCase())) {\r\n        results.push({ id, ...command });\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  getCommandsByCategory(guildId, category) {\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n    const results = [];\r\n\r\n    for (const [id, command] of Object.entries(commands)) {\r\n      if (command.category === category) {\r\n        results.push({ id, ...command });\r\n      }\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  // Usage Analytics\r\n  getCommandUsage(guildId, commandId) {\r\n    const usage = this.customCommands.usage[guildId] || {};\r\n    let totalUses = 0;\r\n    const userBreakdown = {};\r\n\r\n    for (const [userId, userCommands] of Object.entries(usage)) {\r\n      const uses = userCommands[commandId] || 0;\r\n      totalUses += uses;\r\n      userBreakdown[userId] = uses;\r\n    }\r\n\r\n    return {\r\n      totalUses,\r\n      userBreakdown,\r\n      averagePerUser: Object.keys(userBreakdown).length > 0 ? totalUses / Object.keys(userBreakdown).length : 0\r\n    };\r\n  }\r\n\r\n  getPopularCommands(guildId, limit = 10) {\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n    const popularity = [];\r\n\r\n    for (const [id, command] of Object.entries(commands)) {\r\n      const usage = this.getCommandUsage(guildId, id);\r\n      popularity.push({\r\n        id,\r\n        name: command.name,\r\n        description: command.description,\r\n        usage: usage.totalUses,\r\n        created_by: command.created_by\r\n      });\r\n    }\r\n\r\n    return popularity\r\n      .sort((a, b) => b.usage - a.usage)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // Advanced Features\r\n  createCommandChain(guildId, commands) {\r\n    // Create a chain of commands that execute in sequence\r\n    const chainId = `chain_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const chain = {\r\n      id: chainId,\r\n      name: commands.name,\r\n      commands: commands.commandList,\r\n      delay: commands.delay || 1000,\r\n      created_by: commands.created_by,\r\n      created_at: Date.now()\r\n    };\r\n\r\n    if (!this.customCommands.chains) {\r\n      this.customCommands.chains = {};\r\n    }\r\n    if (!this.customCommands.chains[guildId]) {\r\n      this.customCommands.chains[guildId] = {};\r\n    }\r\n\r\n    this.customCommands.chains[guildId][chainId] = chain;\r\n    this.saveCustomCommands();\r\n\r\n    return { success: true, chain };\r\n  }\r\n\r\n  // Command Permissions\r\n  setCommandPermissions(guildId, commandId, permissions) {\r\n    const commands = this.customCommands.commands[guildId];\r\n    if (!commands || !commands[commandId]) {\r\n      return { success: false, reason: 'command_not_found' };\r\n    }\r\n\r\n    commands[commandId].permissions = permissions;\r\n    this.saveCustomCommands();\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  // Command Statistics\r\n  getCommandStats(guildId) {\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n    const commandList = Object.values(commands);\r\n\r\n    if (commandList.length === 0) {\r\n      return {\r\n        totalCommands: 0,\r\n        totalUsage: 0,\r\n        averageUsage: 0,\r\n        categories: {}\r\n      };\r\n    }\r\n\r\n    const totalUsage = commandList.reduce((sum, cmd) => sum + cmd.usage_count, 0);\r\n    const categories = {};\r\n\r\n    commandList.forEach(cmd => {\r\n      categories[cmd.category] = (categories[cmd.category] || 0) + 1;\r\n    });\r\n\r\n    return {\r\n      totalCommands: commandList.length,\r\n      totalUsage,\r\n      averageUsage: totalUsage / commandList.length,\r\n      categories,\r\n      mostUsed: commandList.sort((a, b) => b.usage_count - a.usage_count)[0]?.name || 'None'\r\n    };\r\n  }\r\n\r\n  // Import/Export Commands\r\n  exportCommands(guildId) {\r\n    const commands = this.customCommands.commands[guildId] || {};\r\n\r\n    return {\r\n      commands: Object.values(commands),\r\n      exported_at: Date.now(),\r\n      guild_id: guildId,\r\n      version: '1.0'\r\n    };\r\n  }\r\n\r\n  importCommands(guildId, importData) {\r\n    if (importData.version !== '1.0') {\r\n      return { success: false, reason: 'incompatible_version' };\r\n    }\r\n\r\n    if (!this.customCommands.commands[guildId]) {\r\n      this.customCommands.commands[guildId] = {};\r\n    }\r\n\r\n    for (const command of importData.commands) {\r\n      const commandId = `imported_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n      command.id = commandId;\r\n      command.imported_at = Date.now();\r\n      this.customCommands.commands[guildId][commandId] = command;\r\n    }\r\n\r\n    this.saveCustomCommands();\r\n    return { success: true, imported: importData.commands.length };\r\n  }\r\n\r\n  // Command Validation\r\n  validateCommand(commandData) {\r\n    const errors = [];\r\n\r\n    if (!commandData.name || commandData.name.length < 2) {\r\n      errors.push('Command name must be at least 2 characters');\r\n    }\r\n\r\n    if (!commandData.response || commandData.response.length === 0) {\r\n      errors.push('Command response is required');\r\n    }\r\n\r\n    if (commandData.name && !/^[a-zA-Z0-9_-]+$/.test(commandData.name)) {\r\n      errors.push('Command name can only contain letters, numbers, hyphens, and underscores');\r\n    }\r\n\r\n    if (commandData.aliases) {\r\n      for (const alias of commandData.aliases) {\r\n        if (!/^[a-zA-Z0-9_-]+$/.test(alias)) {\r\n          errors.push(`Invalid alias: ${alias}`);\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      valid: errors.length === 0,\r\n      errors\r\n    };\r\n  }\r\n\r\n  // Cleanup and Maintenance\r\n  cleanup() {\r\n    // Remove old usage data\r\n    const cutoffTime = Date.now() - (30 * 24 * 60 * 60 * 1000); // 30 days\r\n\r\n    for (const guildId in this.customCommands.usage) {\r\n      for (const userId in this.customCommands.usage[guildId]) {\r\n        for (const commandId in this.customCommands.usage[guildId][userId]) {\r\n          // Check if command still exists\r\n          const commands = this.customCommands.commands[guildId] || {};\r\n          if (!commands[commandId]) {\r\n            delete this.customCommands.usage[guildId][userId][commandId];\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.saveCustomCommands();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const customCommandManager = new CustomCommandManager();\r\n\r\n// Convenience functions\r\nexport function createCommand(guildId, commandData) {\r\n  return customCommandManager.createCommand(guildId, commandData);\r\n}\r\n\r\nexport function executeCommand(commandName, guildId, userId, args = {}) {\r\n  return customCommandManager.executeCommand(commandName, guildId, userId, args);\r\n}\r\n\r\nexport function updateCommand(guildId, commandId, updates) {\r\n  return customCommandManager.updateCommand(guildId, commandId, updates);\r\n}\r\n\r\nexport function deleteCommand(guildId, commandId) {\r\n  return customCommandManager.deleteCommand(guildId, commandId);\r\n}\r\n\r\nexport function searchCommands(guildId, query) {\r\n  return customCommandManager.searchCommands(guildId, query);\r\n}\r\n\r\nexport function getPopularCommands(guildId, limit = 10) {\r\n  return customCommandManager.getPopularCommands(guildId, limit);\r\n}\r\n\r\nexport function getCommandStats(guildId) {\r\n  return customCommandManager.getCommandStats(guildId);\r\n}\r\n\r\nexport function validateCommand(commandData) {\r\n  return customCommandManager.validateCommand(commandData);\r\n}\r\n\r\n// Auto-cleanup every hour\r\nsetInterval(() => {\r\n  customCommandManager.cleanup();\r\n}, 60 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\deploy-commands.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `deployCommands.js` or `DeployCommands.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":7,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":7,"endColumn":20,"fix":{"range":[149,149],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":25,"fix":{"range":[179,179],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":8,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":8,"endColumn":24,"fix":{"range":[173,173],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":9,"column":1,"nodeType":"ImportDeclaration","endLine":9,"endColumn":43,"fix":{"range":[223,223],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":57,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":57,"endColumn":10,"fix":{"range":[1684,1684],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":60,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":60,"endColumn":8,"fix":{"range":[1798,1798],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":66,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":66,"endColumn":4,"fix":{"range":[1977,1977],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":87,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":87,"endColumn":6,"fix":{"range":[2716,2716],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":92,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":92,"endColumn":4,"fix":{"range":[2968,2968],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":112,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":112,"endColumn":4,"fix":{"range":[3388,3388],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":114,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":114,"endColumn":20}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":10,"fixableWarningCount":0,"source":"/**\r\n * Command deployment script for Discord bot.\r\n * Registers slash commands with Discord's API.\r\n */\r\n\r\nimport 'dotenv/config';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { REST, Routes } from 'discord.js';\r\nimport { logger } from './logger.js';\r\n\r\n/**\r\n * Supported command file extensions.\r\n */\r\nconst COMMAND_EXTENSIONS = ['.js', '.mjs', '.cjs'];\r\n\r\n/**\r\n * Validates required environment variables.\r\n * @returns {object} Validated environment configuration\r\n * @throws {Error} If required environment variables are missing\r\n */\r\nfunction validateEnvironment() {\r\n  const token = process.env.DISCORD_TOKEN;\r\n  const clientId = process.env.CLIENT_ID;\r\n  const guildId = process.env.GUILD_ID;\r\n\r\n  if (!token || !clientId) {\r\n    throw new Error('DISCORD_TOKEN and CLIENT_ID must be set in environment variables');\r\n  }\r\n\r\n  return { token, clientId, guildId };\r\n}\r\n\r\n/**\r\n * Loads command data from all command files.\r\n * @returns {Array} Array of command data objects\r\n */\r\nasync function loadCommandData() {\r\n  const commandsPath = path.join(process.cwd(), 'src', 'commands');\r\n  const commands = [];\r\n\r\n  logger.info('Loading command data for deployment', { path: commandsPath });\r\n\r\n  try {\r\n    const files = fs.readdirSync(commandsPath).filter(file =>\r\n      COMMAND_EXTENSIONS.some(ext => file.endsWith(ext))\r\n    );\r\n\r\n    for (const file of files) {\r\n      try {\r\n        const filePath = path.join(commandsPath, file);\r\n        const { data } = await import(filePath);\r\n\r\n        if (data && typeof data.toJSON === 'function') {\r\n          commands.push(data.toJSON());\r\n          logger.debug('Loaded command data', { file, name: data.name });\r\n        } else {\r\n          logger.warn('Command file missing data export or toJSON method', { file });\r\n        }\r\n      } catch (error) {\r\n        logger.error('Failed to load command data', error, { file });\r\n      }\r\n    }\r\n\r\n    logger.info('Command data loaded', { count: commands.length });\r\n  } catch (error) {\r\n    logger.error('Failed to read commands directory', error, { path: commandsPath });\r\n    throw error;\r\n  }\r\n\r\n  return commands;\r\n}\r\n\r\n/**\r\n * Deploys commands to Discord.\r\n * @param {Array} commands - Command data to deploy\r\n * @param {object} config - Environment configuration\r\n */\r\nasync function deployCommands(commands, { token, clientId, guildId }) {\r\n  const rest = new REST({ version: '10' }).setToken(token);\r\n\r\n  try {\r\n    if (guildId) {\r\n      logger.info('Registering guild-specific commands', { guildId, commandCount: commands.length });\r\n      await rest.put(Routes.applicationGuildCommands(clientId, guildId), { body: commands });\r\n      logger.success('Guild commands registered successfully');\r\n    } else {\r\n      logger.info('Registering global commands', { commandCount: commands.length });\r\n      await rest.put(Routes.applicationCommands(clientId), { body: commands });\r\n      logger.success('Global commands registered successfully');\r\n    }\r\n  } catch (error) {\r\n    logger.error('Failed to register commands', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Main deployment function.\r\n */\r\nasync function main() {\r\n  try {\r\n    const config = validateEnvironment();\r\n    const commands = await loadCommandData();\r\n\r\n    if (commands.length === 0) {\r\n      logger.warn('No commands to deploy');\r\n      return;\r\n    }\r\n\r\n    await deployCommands(commands, config);\r\n  } catch (error) {\r\n    logger.error('Command deployment failed', error);\r\n    process.exit(1);\r\n  }\r\n}\r\n\r\n// Execute deployment\r\nmain();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\economy.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":34,"column":61,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":34,"endColumn":67,"fix":{"range":[879,887],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":36,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":36,"endColumn":6,"fix":{"range":[929,929],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[953,1001],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":50,"column":71,"nodeType":"Literal","messageId":"error","endLine":50,"endColumn":75,"suggestions":[{"messageId":"replace","fix":{"range":[1287,1291],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":51,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":51,"endColumn":6,"fix":{"range":[1304,1304],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":52,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":52,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1328,1376],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":58,"column":12,"nodeType":"MemberExpression","endLine":58,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":62,"column":5,"nodeType":"MemberExpression","endLine":62,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":64,"column":12,"nodeType":"MemberExpression","endLine":64,"endColumn":49},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":98,"column":43,"nodeType":"CallExpression","messageId":"substr","endLine":98,"endColumn":82,"fix":{"range":[2647,2658],"text":"slice(2, 11"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":102,"column":48,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":102,"endColumn":53,"fix":{"range":[2809,2814],"text":"10_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":103,"column":76,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":103,"endColumn":81,"fix":{"range":[2894,2899],"text":"10_000"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":123,"column":50,"nodeType":"CallExpression","messageId":"substr","endLine":123,"endColumn":89,"fix":{"range":[3507,3518],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":137,"column":10,"nodeType":"MemberExpression","endLine":137,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":138,"column":7,"nodeType":"MemberExpression","endLine":138,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":141,"column":5,"nodeType":"MemberExpression","endLine":141,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":158,"column":24,"nodeType":"MemberExpression","endLine":158,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":163,"column":12,"nodeType":"MemberExpression","endLine":163,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":167,"column":10,"nodeType":"MemberExpression","endLine":167,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":171,"column":22,"nodeType":"MemberExpression","endLine":171,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":200,"column":10,"nodeType":"MemberExpression","endLine":200,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":207,"column":28,"nodeType":"MemberExpression","endLine":207,"endColumn":65},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":233,"column":19,"nodeType":"MemberExpression","endLine":233,"endColumn":56},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":243,"column":54,"nodeType":"CallExpression","messageId":"substr","endLine":243,"endColumn":93,"fix":{"range":[6772,6783],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":256,"column":10,"nodeType":"MemberExpression","endLine":256,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":257,"column":7,"nodeType":"MemberExpression","endLine":257,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":260,"column":5,"nodeType":"MemberExpression","endLine":260,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":268,"column":12,"nodeType":"MemberExpression","endLine":268,"endColumn":48},{"ruleId":"unicorn/no-zero-fractions","severity":2,"message":"Don't use a zero fraction in the number.","line":275,"column":49,"nodeType":null,"messageId":"zero-fraction","endLine":275,"endColumn":50,"fix":{"range":[7664,7668],"text":"0.1"}},{"ruleId":"unicorn/no-zero-fractions","severity":2,"message":"Don't use a zero fraction in the number.","line":276,"column":56,"nodeType":null,"messageId":"zero-fraction","endLine":276,"endColumn":57,"fix":{"range":[7755,7759],"text":"0.2"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":287,"column":31,"nodeType":"MemberExpression","endLine":287,"endColumn":67},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":290,"column":28,"nodeType":"MemberExpression","endLine":290,"endColumn":46},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (739). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":739,"endColumn":15},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":331,"column":50,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":331,"endColumn":56,"fix":{"range":[9807,9813],"text":"300_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":336,"column":24,"nodeType":"MemberExpression","endLine":336,"endColumn":60},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":426,"column":24,"nodeType":"MemberExpression","endLine":426,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":427,"column":25,"nodeType":"MemberExpression","endLine":427,"endColumn":61},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":503,"column":36,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":503,"endColumn":41,"fix":{"range":[15014,15019],"text":"10_000"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":503,"column":58,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":503,"endColumn":101,"fix":{"range":[15036,15079],"text":"(marketVolume > 5000 ? 'good' : 'developing')"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":524,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":524,"endColumn":89,"fix":{"range":[15639,15700],"text":"'üí° Consider starting a business to generate passive income!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":528,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":528,"endColumn":99,"fix":{"range":[15775,15846],"text":"'üè™ Businesses provide steady income. Use `/business create` to start!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":532,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":532,"endColumn":83,"fix":{"range":[15945,16000],"text":"'üìà Consider investing your gold for long-term growth!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":536,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":536,"endColumn":87,"fix":{"range":[16080,16139],"text":"'ü§ù More trading activity can increase your economy level!'"}},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":556,"column":38,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":556,"endColumn":63,"fix":{"range":[16763,16788],"text":"(change < -5 ? 'üìâ' : '‚û°Ô∏è')"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":569,"column":23,"nodeType":"MemberExpression","endLine":569,"endColumn":60},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":592,"column":23,"nodeType":"MemberExpression","endLine":592,"endColumn":62},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":597,"column":40,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":597,"endColumn":56,"fix":{"range":[17906,17922],"text":"'daily_cooldown'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":601,"column":20,"nodeType":"MemberExpression","endLine":601,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":610,"column":5,"nodeType":"MemberExpression","endLine":610,"endColumn":42},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":641,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":641,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[19277,19374],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":655,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":655,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[19897,19965],"text":""},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":24,"fatalErrorCount":0,"warningCount":31,"fixableErrorCount":21,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst ECONOMY_FILE = path.join(process.cwd(), 'data', 'economy.json');\r\n\r\n// Advanced Economy System with Banking and Marketplace\r\nclass EconomyManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadEconomy();\r\n    this.marketPrices = new Map();\r\n    this.priceHistory = new Map();\r\n    this.initializeMarket();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(ECONOMY_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(ECONOMY_FILE)) {\r\n      fs.writeFileSync(ECONOMY_FILE, JSON.stringify({\r\n        userBalances: {},\r\n        transactions: [],\r\n        marketItems: {},\r\n        businessData: {},\r\n        investments: {}\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadEconomy() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(ECONOMY_FILE, 'utf8'));\r\n      this.economyData = data;\r\n    } catch (error) {\r\n      console.error('Failed to load economy:', error);\r\n      this.economyData = {\r\n        userBalances: {},\r\n        transactions: [],\r\n        marketItems: {},\r\n        businessData: {},\r\n        investments: {}\r\n      };\r\n    }\r\n  }\r\n\r\n  saveEconomy() {\r\n    try {\r\n      fs.writeFileSync(ECONOMY_FILE, JSON.stringify(this.economyData, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save economy:', error);\r\n    }\r\n  }\r\n\r\n  // Advanced Banking System\r\n  getBalance(userId) {\r\n    return this.economyData.userBalances[userId] || 0;\r\n  }\r\n\r\n  setBalance(userId, amount) {\r\n    this.economyData.userBalances[userId] = Math.max(0, amount);\r\n    this.saveEconomy();\r\n    return this.economyData.userBalances[userId];\r\n  }\r\n\r\n  addBalance(userId, amount) {\r\n    const current = this.getBalance(userId);\r\n    return this.setBalance(userId, current + amount);\r\n  }\r\n\r\n  subtractBalance(userId, amount) {\r\n    const current = this.getBalance(userId);\r\n    return this.setBalance(userId, current - amount);\r\n  }\r\n\r\n  transferBalance(fromUserId, toUserId, amount) {\r\n    if (amount <= 0) return { success: false, reason: 'invalid_amount' };\r\n    if (this.getBalance(fromUserId) < amount) return { success: false, reason: 'insufficient_funds' };\r\n\r\n    this.subtractBalance(fromUserId, amount);\r\n    this.addBalance(toUserId, amount);\r\n\r\n    // Log transaction\r\n    this.logTransaction({\r\n      type: 'transfer',\r\n      from: fromUserId,\r\n      to: toUserId,\r\n      amount,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  // Advanced Transaction System\r\n  logTransaction(transaction) {\r\n    transaction.id = `txn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    this.economyData.transactions.push(transaction);\r\n\r\n    // Keep only last 10000 transactions\r\n    if (this.economyData.transactions.length > 10000) {\r\n      this.economyData.transactions = this.economyData.transactions.slice(-10000);\r\n    }\r\n\r\n    this.saveEconomy();\r\n    return transaction;\r\n  }\r\n\r\n  getTransactionHistory(userId, limit = 50) {\r\n    return this.economyData.transactions\r\n      .filter(txn => txn.from === userId || txn.to === userId)\r\n      .sort((a, b) => b.timestamp - a.timestamp)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // Business and Investment System\r\n  createBusiness(userId, businessType, initialInvestment) {\r\n    if (this.getBalance(userId) < initialInvestment) {\r\n      return { success: false, reason: 'insufficient_funds' };\r\n    }\r\n\r\n    const businessId = `business_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const business = {\r\n      id: businessId,\r\n      owner: userId,\r\n      type: businessType,\r\n      level: 1,\r\n      income: this.getBusinessIncome(businessType, 1),\r\n      lastCollected: Date.now(),\r\n      created: Date.now(),\r\n      upgrades: 0,\r\n      employees: 1\r\n    };\r\n\r\n    if (!this.economyData.businessData[userId]) {\r\n      this.economyData.businessData[userId] = [];\r\n    }\r\n\r\n    this.economyData.businessData[userId].push(business);\r\n    this.subtractBalance(userId, initialInvestment);\r\n    this.saveEconomy();\r\n\r\n    return { success: true, business };\r\n  }\r\n\r\n  getBusinessIncome(businessType, level) {\r\n    const baseIncomes = {\r\n      'shop': 50,\r\n      'farm': 30,\r\n      'mine': 75,\r\n      'factory': 100,\r\n      'bank': 25,\r\n      'casino': 150\r\n    };\r\n\r\n    const baseIncome = baseIncomes[businessType] || 25;\r\n    return Math.floor(baseIncome * (1 + (level - 1) * 0.5));\r\n  }\r\n\r\n  getUserBusinesses(userId) {\r\n    return this.economyData.businessData[userId] || [];\r\n  }\r\n\r\n  upgradeBusiness(userId, businessId) {\r\n    if (!this.economyData.businessData[userId]) {\r\n      return { success: false, reason: 'no_businesses' };\r\n    }\r\n\r\n    const business = this.economyData.businessData[userId].find(b => b.id === businessId);\r\n    if (!business) {\r\n      return { success: false, reason: 'business_not_found' };\r\n    }\r\n\r\n    const upgradeCost = business.level * 500; // Cost increases with level\r\n    if (this.getBalance(userId) < upgradeCost) {\r\n      return { success: false, reason: 'insufficient_funds' };\r\n    }\r\n\r\n    this.subtractBalance(userId, upgradeCost);\r\n    business.level++;\r\n    business.income = this.getBusinessIncome(business.type, business.level);\r\n    business.upgrades++;\r\n\r\n    this.logTransaction({\r\n      type: 'business_upgrade',\r\n      user: userId,\r\n      businessId,\r\n      amount: upgradeCost,\r\n      newLevel: business.level,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    this.saveEconomy();\r\n    return { success: true, business };\r\n  }\r\n\r\n  collectBusinessIncome(userId) {\r\n    if (!this.economyData.businessData[userId]) {\r\n      return { success: false, reason: 'no_businesses' };\r\n    }\r\n\r\n    let totalIncome = 0;\r\n    const now = Date.now();\r\n\r\n    for (const business of this.economyData.businessData[userId]) {\r\n      const hoursSinceCollection = (now - business.lastCollected) / (1000 * 60 * 60);\r\n      const income = Math.floor(business.income * hoursSinceCollection);\r\n\r\n      if (income > 0) {\r\n        totalIncome += income;\r\n        business.lastCollected = now;\r\n      }\r\n    }\r\n\r\n    if (totalIncome > 0) {\r\n      this.addBalance(userId, totalIncome);\r\n\r\n      this.logTransaction({\r\n        type: 'business_income',\r\n        user: userId,\r\n        amount: totalIncome,\r\n        timestamp: Date.now()\r\n      });\r\n\r\n      this.saveEconomy();\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      income: totalIncome,\r\n      businesses: this.economyData.businessData[userId].length\r\n    };\r\n  }\r\n\r\n  // Investment System\r\n  createInvestment(userId, investmentType, amount) {\r\n    if (this.getBalance(userId) < amount) {\r\n      return { success: false, reason: 'insufficient_funds' };\r\n    }\r\n\r\n    const investmentId = `investment_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const investment = {\r\n      id: investmentId,\r\n      user: userId,\r\n      type: investmentType,\r\n      amount,\r\n      created: Date.now(),\r\n      maturity: Date.now() + (investmentType.duration * 24 * 60 * 60 * 1000),\r\n      rate: investmentType.rate,\r\n      status: 'active'\r\n    };\r\n\r\n    if (!this.economyData.investments[userId]) {\r\n      this.economyData.investments[userId] = [];\r\n    }\r\n\r\n    this.economyData.investments[userId].push(investment);\r\n    this.subtractBalance(userId, amount);\r\n    this.saveEconomy();\r\n\r\n    return { success: true, investment };\r\n  }\r\n\r\n  getUserInvestments(userId) {\r\n    return this.economyData.investments[userId] || [];\r\n  }\r\n\r\n  // Define investment types\r\n  getInvestmentTypes() {\r\n    return {\r\n      'bank': { name: 'Bank Deposit', rate: 0.05, duration: 30, minAmount: 100 },\r\n      'stock': { name: 'Stock Market', rate: 0.10, duration: 30, minAmount: 500 },\r\n      'venture': { name: 'High Risk Venture', rate: 0.20, duration: 30, minAmount: 1000 },\r\n      'real_estate': { name: 'Real Estate', rate: 0.15, duration: 45, minAmount: 2000 },\r\n      'crypto': { name: 'Cryptocurrency', rate: 0.25, duration: 15, minAmount: 300, risk: 'high' },\r\n      'bond': { name: 'Government Bond', rate: 0.03, duration: 60, minAmount: 500, risk: 'low' }\r\n    };\r\n  }\r\n\r\n  processMatureInvestments() {\r\n    const now = Date.now();\r\n\r\n    for (const userId in this.economyData.investments) {\r\n      const userInvestments = this.economyData.investments[userId];\r\n\r\n      for (let i = userInvestments.length - 1; i >= 0; i--) {\r\n        const investment = userInvestments[i];\r\n\r\n        if (investment.status === 'active' && now >= investment.maturity) {\r\n          const returnAmount = Math.floor(investment.amount * (1 + investment.rate));\r\n          this.addBalance(userId, returnAmount);\r\n\r\n          investment.status = 'matured';\r\n          investment.returned = returnAmount;\r\n          investment.maturedAt = now;\r\n\r\n          this.logTransaction({\r\n            type: 'investment_return',\r\n            user: userId,\r\n            amount: returnAmount,\r\n            investmentType: investment.type.name,\r\n            timestamp: now\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    this.saveEconomy();\r\n  }\r\n\r\n  // Advanced Marketplace\r\n  initializeMarket() {\r\n    // Initialize market prices for various items\r\n    const marketItems = {\r\n      'health_potion': { basePrice: 25, volatility: 0.1 },\r\n      'mana_potion': { basePrice: 40, volatility: 0.15 },\r\n      'iron_ore': { basePrice: 5, volatility: 0.2 },\r\n      'magic_crystal': { basePrice: 100, volatility: 0.3 },\r\n      'dragon_scale': { basePrice: 500, volatility: 0.1 }\r\n    };\r\n\r\n    for (const [itemId, data] of Object.entries(marketItems)) {\r\n      const currentPrice = data.basePrice + (Math.random() - 0.5) * data.basePrice * data.volatility;\r\n      this.marketPrices.set(itemId, Math.max(1, Math.round(currentPrice)));\r\n    }\r\n\r\n    // Start price fluctuation\r\n    setInterval(() => this.updateMarketPrices(), 300000); // Every 5 minutes\r\n  }\r\n\r\n  updateMarketPrices() {\r\n    for (const [itemId, currentPrice] of this.marketPrices) {\r\n      const itemData = this.economyData.marketItems[itemId];\r\n      if (itemData) {\r\n        const change = (Math.random() - 0.5) * itemData.volatility * currentPrice;\r\n        const newPrice = Math.max(1, Math.round(currentPrice + change));\r\n\r\n        this.marketPrices.set(itemId, newPrice);\r\n\r\n        // Store price history\r\n        if (!this.priceHistory.has(itemId)) {\r\n          this.priceHistory.set(itemId, []);\r\n        }\r\n\r\n        const history = this.priceHistory.get(itemId);\r\n        history.push({ price: newPrice, timestamp: Date.now() });\r\n\r\n        // Keep only last 100 price points\r\n        if (history.length > 100) {\r\n          history.shift();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getMarketPrice(itemId) {\r\n    return this.marketPrices.get(itemId) || 1;\r\n  }\r\n\r\n  getPriceHistory(itemId, days = 1) {\r\n    const history = this.priceHistory.get(itemId) || [];\r\n    const cutoffTime = Date.now() - (days * 24 * 60 * 60 * 1000);\r\n\r\n    return history.filter(h => h.timestamp >= cutoffTime);\r\n  }\r\n\r\n  buyFromMarket(userId, itemId, quantity = 1) {\r\n    const price = this.getMarketPrice(itemId);\r\n    const totalCost = price * quantity;\r\n\r\n    if (this.getBalance(userId) < totalCost) {\r\n      return { success: false, reason: 'insufficient_funds' };\r\n    }\r\n\r\n    this.subtractBalance(userId, totalCost);\r\n\r\n    this.logTransaction({\r\n      type: 'market_purchase',\r\n      user: userId,\r\n      item: itemId,\r\n      quantity,\r\n      amount: totalCost,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      item: itemId,\r\n      quantity,\r\n      totalCost,\r\n      pricePerUnit: price\r\n    };\r\n  }\r\n\r\n  sellToMarket(userId, itemId, quantity = 1) {\r\n    const price = Math.floor(this.getMarketPrice(itemId) * 0.8); // Sell for 80% of market price\r\n    const totalEarnings = price * quantity;\r\n\r\n    this.addBalance(userId, totalEarnings);\r\n\r\n    this.logTransaction({\r\n      type: 'market_sale',\r\n      user: userId,\r\n      item: itemId,\r\n      quantity,\r\n      amount: totalEarnings,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      item: itemId,\r\n      quantity,\r\n      totalEarnings,\r\n      pricePerUnit: price\r\n    };\r\n  }\r\n\r\n  // User Economy Statistics\r\n  getUserEconomyStats(userId) {\r\n    const balance = this.getBalance(userId);\r\n    const transactions = this.getTransactionHistory(userId, 100);\r\n    const businesses = this.economyData.businessData[userId] || [];\r\n    const investments = this.economyData.investments[userId] || [];\r\n\r\n    // Calculate statistics\r\n    const incomeTransactions = transactions.filter(t => t.type === 'business_income' || t.type === 'investment_return');\r\n    const expenseTransactions = transactions.filter(t => t.type === 'market_purchase' || t.type === 'transfer' && t.from === userId);\r\n\r\n    const totalIncome = incomeTransactions.reduce((sum, t) => sum + t.amount, 0);\r\n    const totalExpenses = expenseTransactions.reduce((sum, t) => sum + t.amount, 0);\r\n\r\n    return {\r\n      balance,\r\n      totalIncome,\r\n      totalExpenses,\r\n      netWorth: balance + totalIncome - totalExpenses,\r\n      businesses: businesses.length,\r\n      investments: investments.filter(i => i.status === 'active').length,\r\n      transactionCount: transactions.length,\r\n      averageTransaction: transactions.length > 0 ? Math.round((totalIncome + totalExpenses) / transactions.length) : 0\r\n    };\r\n  }\r\n\r\n  // Advanced Features\r\n  createLottery(userId, ticketPrice, prizePool) {\r\n    if (this.getBalance(userId) < ticketPrice) {\r\n      return { success: false, reason: 'insufficient_funds' };\r\n    }\r\n\r\n    this.subtractBalance(userId, ticketPrice);\r\n\r\n    // Simple lottery system\r\n    const lotteryNumber = Math.floor(Math.random() * 1000);\r\n    const winningNumber = Math.floor(Math.random() * 1000);\r\n\r\n    const isWinner = lotteryNumber === winningNumber;\r\n    let winnings = 0;\r\n\r\n    if (isWinner) {\r\n      winnings = prizePool;\r\n      this.addBalance(userId, winnings);\r\n    }\r\n\r\n    this.logTransaction({\r\n      type: 'lottery',\r\n      user: userId,\r\n      amount: isWinner ? winnings - ticketPrice : -ticketPrice,\r\n      ticketPrice,\r\n      isWinner,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      isWinner,\r\n      winnings,\r\n      lotteryNumber,\r\n      winningNumber\r\n    };\r\n  }\r\n\r\n  // Economy Analytics\r\n  getEconomyAnalytics() {\r\n    const totalMoney = Object.values(this.economyData.userBalances).reduce((sum, balance) => sum + balance, 0);\r\n    const totalTransactions = this.economyData.transactions.length;\r\n    const uniqueUsers = Object.keys(this.economyData.userBalances).length;\r\n\r\n    // Calculate market health\r\n    const marketVolume = this.economyData.transactions\r\n      .filter(t => t.type === 'market_purchase' || t.type === 'market_sale')\r\n      .reduce((sum, t) => sum + (t.amount || 0), 0);\r\n\r\n    return {\r\n      totalMoney,\r\n      totalTransactions,\r\n      uniqueUsers,\r\n      marketVolume,\r\n      averageBalance: uniqueUsers > 0 ? Math.round(totalMoney / uniqueUsers) : 0,\r\n      marketHealth: marketVolume > 10000 ? 'excellent' : marketVolume > 5000 ? 'good' : 'developing'\r\n    };\r\n  }\r\n\r\n  // Daily/Weekly Economy Reports\r\n  generateEconomyReport(userId) {\r\n    const stats = this.getUserEconomyStats(userId);\r\n    const recentTransactions = this.getTransactionHistory(userId, 10);\r\n\r\n    return {\r\n      userStats: stats,\r\n      recentActivity: recentTransactions,\r\n      recommendations: this.generateEconomyRecommendations(stats),\r\n      marketTrends: this.getMarketTrends()\r\n    };\r\n  }\r\n\r\n  generateEconomyRecommendations(stats) {\r\n    const recommendations = [];\r\n\r\n    if (stats.balance < 100) {\r\n      recommendations.push(\"üí° Consider starting a business to generate passive income!\");\r\n    }\r\n\r\n    if (stats.businesses === 0) {\r\n      recommendations.push(\"üè™ Businesses provide steady income. Use `/business create` to start!\");\r\n    }\r\n\r\n    if (stats.investments === 0 && stats.balance > 500) {\r\n      recommendations.push(\"üìà Consider investing your gold for long-term growth!\");\r\n    }\r\n\r\n    if (stats.transactionCount < 10) {\r\n      recommendations.push(\"ü§ù More trading activity can increase your economy level!\");\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  getMarketTrends() {\r\n    const trends = [];\r\n\r\n    for (const [itemId, history] of this.priceHistory) {\r\n      if (history.length >= 2) {\r\n        const recent = history.slice(-5);\r\n        const avgRecent = recent.reduce((sum, h) => sum + h.price, 0) / recent.length;\r\n        const avgOld = history.slice(0, 5).reduce((sum, h) => sum + h.price, 0) / Math.min(5, history.length);\r\n\r\n        const change = ((avgRecent - avgOld) / avgOld) * 100;\r\n\r\n        trends.push({\r\n          item: itemId,\r\n          change: Math.round(change),\r\n          trend: change > 5 ? 'üìà' : change < -5 ? 'üìâ' : '‚û°Ô∏è'\r\n        });\r\n      }\r\n    }\r\n\r\n    return trends.slice(0, 5);\r\n  }\r\n\r\n  // Tax System (for server economy balance)\r\n  collectTaxes(guildId, taxRate = 0.05) {\r\n    let totalTaxed = 0;\r\n\r\n    for (const userId in this.economyData.userBalances) {\r\n      const balance = this.economyData.userBalances[userId];\r\n      if (balance > 1000) { // Only tax users with significant balance\r\n        const tax = Math.floor(balance * taxRate);\r\n        this.subtractBalance(userId, tax);\r\n        totalTaxed += tax;\r\n      }\r\n    }\r\n\r\n    if (totalTaxed > 0) {\r\n      this.logTransaction({\r\n        type: 'tax_collection',\r\n        guild: guildId,\r\n        amount: totalTaxed,\r\n        timestamp: Date.now()\r\n      });\r\n    }\r\n\r\n    return totalTaxed;\r\n  }\r\n\r\n  // Daily Rewards System\r\n  claimDailyReward(userId) {\r\n    const now = Date.now();\r\n    const lastClaim = this.economyData.dailyRewards?.[userId]?.lastClaim || 0;\r\n    const oneDay = 24 * 60 * 60 * 1000;\r\n\r\n    if (now - lastClaim < oneDay) {\r\n      const hoursLeft = Math.ceil((oneDay - (now - lastClaim)) / (60 * 60 * 1000));\r\n      return { success: false, reason: `daily_cooldown`, hoursLeft };\r\n    }\r\n\r\n    // Calculate reward based on streak\r\n    const streak = this.economyData.dailyRewards?.[userId]?.streak || 0;\r\n    const baseReward = 50;\r\n    const streakBonus = Math.min(streak * 10, 100);\r\n    const reward = baseReward + streakBonus;\r\n\r\n    this.addBalance(userId, reward);\r\n\r\n    // Update streak\r\n    if (!this.economyData.dailyRewards) this.economyData.dailyRewards = {};\r\n    this.economyData.dailyRewards[userId] = {\r\n      lastClaim: now,\r\n      streak: streak + 1\r\n    };\r\n\r\n    this.logTransaction({\r\n      type: 'daily_reward',\r\n      user: userId,\r\n      amount: reward,\r\n      streak: streak + 1,\r\n      timestamp: now\r\n    });\r\n\r\n    this.saveEconomy();\r\n\r\n    return { success: true, reward, streak: streak + 1 };\r\n  }\r\n\r\n  // Cleanup and Maintenance\r\n  cleanup() {\r\n    // Process mature investments\r\n    this.processMatureInvestments();\r\n\r\n    // Clean up old transaction history\r\n    const cutoffTime = Date.now() - (30 * 24 * 60 * 60 * 1000); // 30 days\r\n    this.economyData.transactions = this.economyData.transactions.filter(t => t.timestamp > cutoffTime);\r\n\r\n    // Clean up price history maps (keep only last 50 entries per item)\r\n    for (const [itemId, history] of this.priceHistory.entries()) {\r\n      if (history.length > 50) {\r\n        this.priceHistory.set(itemId, history.slice(-50));\r\n        console.log(`[ECONOMY] Cleaned up price history for ${itemId}: ${history.length} -> 50 entries`);\r\n      }\r\n    }\r\n\r\n    // Clean up stale market prices (remove items with no recent activity)\r\n    const recentTransactions = this.economyData.transactions.filter(t =>\r\n      t.type === 'market_purchase' || t.type === 'market_sale'\r\n    );\r\n    const activeItems = new Set(recentTransactions.map(t => t.item).filter(Boolean));\r\n\r\n    for (const [itemId] of this.marketPrices.entries()) {\r\n      if (!activeItems.has(itemId)) {\r\n        this.marketPrices.delete(itemId);\r\n        this.priceHistory.delete(itemId);\r\n        console.log(`[ECONOMY] Cleaned up stale market data for ${itemId}`);\r\n      }\r\n    }\r\n\r\n    this.saveEconomy();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const economyManager = new EconomyManager();\r\n\r\n// Convenience functions\r\nexport function getBalance(userId) {\r\n  return economyManager.getBalance(userId);\r\n}\r\n\r\nexport function addBalance(userId, amount) {\r\n  return economyManager.addBalance(userId, amount);\r\n}\r\n\r\nexport function subtractBalance(userId, amount) {\r\n  return economyManager.subtractBalance(userId, amount);\r\n}\r\n\r\nexport function transferBalance(fromUserId, toUserId, amount) {\r\n  return economyManager.transferBalance(fromUserId, toUserId, amount);\r\n}\r\n\r\nexport function createBusiness(userId, businessType, initialInvestment) {\r\n  return economyManager.createBusiness(userId, businessType, initialInvestment);\r\n}\r\n\r\nexport function collectBusinessIncome(userId) {\r\n  return economyManager.collectBusinessIncome(userId);\r\n}\r\n\r\nexport function getMarketPrice(itemId) {\r\n  return economyManager.getMarketPrice(itemId);\r\n}\r\n\r\nexport function buyFromMarket(userId, itemId, quantity = 1) {\r\n  return economyManager.buyFromMarket(userId, itemId, quantity);\r\n}\r\n\r\nexport function sellToMarket(userId, itemId, quantity = 1) {\r\n  return economyManager.sellToMarket(userId, itemId, quantity);\r\n}\r\n\r\nexport function getUserEconomyStats(userId) {\r\n  return economyManager.getUserEconomyStats(userId);\r\n}\r\n\r\nexport function getTransactionHistory(userId, limit = 50) {\r\n  return economyManager.getTransactionHistory(userId, limit);\r\n}\r\n\r\nexport function createLottery(userId, ticketPrice, prizePool) {\r\n  return economyManager.createLottery(userId, ticketPrice, prizePool);\r\n}\r\n\r\nexport function getUserBusinesses(userId) {\r\n  return economyManager.getUserBusinesses(userId);\r\n}\r\n\r\nexport function upgradeBusiness(userId, businessId) {\r\n  return economyManager.upgradeBusiness(userId, businessId);\r\n}\r\n\r\nexport function getInvestmentTypes() {\r\n  return economyManager.getInvestmentTypes();\r\n}\r\n\r\nexport function claimDailyReward(userId) {\r\n  return economyManager.claimDailyReward(userId);\r\n}\r\n\r\nexport function createInvestment(userId, investmentType, amount) {\r\n  return economyManager.createInvestment(userId, investmentType, amount);\r\n}\r\n\r\nexport function getUserInvestments(userId) {\r\n  return economyManager.getUserInvestments(userId);\r\n}\r\n\r\n// End of file","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\entertainment.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":34,"column":67,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":34,"endColumn":73,"fix":{"range":[966,974],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":36,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":36,"endColumn":6,"fix":{"range":[1022,1022],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1046,1105],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":49,"column":83,"nodeType":"Literal","messageId":"error","endLine":49,"endColumn":87,"suggestions":[{"messageId":"replace","fix":{"range":[1391,1395],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":50,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":50,"endColumn":6,"fix":{"range":[1408,1408],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":51,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":51,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1432,1491],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'getRandomJoke' has too many lines (66). Maximum allowed is 50.","line":56,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":121,"endColumn":4},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":60,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":60,"endColumn":55,"fix":{"range":[1701,1747],"text":"'What do you call fake spaghetti? An impasta!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":61,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":61,"endColumn":79,"fix":{"range":[1758,1828],"text":"'Why did the scarecrow win an award? He was outstanding in his field!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":64,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":64,"endColumn":67,"fix":{"range":[1974,2032],"text":"'Why did the bicycle fall over? Because it was two-tired!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":65,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":65,"endColumn":63,"fix":{"range":[2043,2097],"text":"'What do you call a bear with no teeth? A gummy bear!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":69,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":69,"endColumn":76,"fix":{"range":[2215,2282],"text":"'Why do programmers prefer dark mode? Because light attracts bugs!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":75,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":75,"endColumn":94,"fix":{"range":[2744,2829],"text":"'Why do programmers always mix up Halloween and Christmas? Because Oct 31 == Dec 25!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":76,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":76,"endColumn":63,"fix":{"range":[2840,2894],"text":"'How do you comfort a JavaScript bug? You console it!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":80,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":80,"endColumn":84,"fix":{"range":[3008,3083],"text":"'Did you hear about the restaurant on the moon? Great food, no atmosphere!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":81,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":81,"endColumn":53,"fix":{"range":[3094,3138],"text":"'What do you call a fish with no eyes? Fsh!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":82,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":82,"endColumn":85,"fix":{"range":[3149,3225],"text":"'Why did the golfer bring two pairs of pants? In case he got a hole in one!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":83,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":83,"endColumn":75,"fix":{"range":[3236,3302],"text":"'What do you call someone with no body and no nose? Nobody knows!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":86,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":86,"endColumn":76,"fix":{"range":[3467,3534],"text":"'Why did the math book look sad? Because it had too many problems!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":90,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":90,"endColumn":60,"fix":{"range":[3680,3731],"text":"'What do you call friends who love math? Algebros!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":92,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":92,"endColumn":80,"fix":{"range":[3829,3900],"text":"'Why did the student wear glasses in math class? To improve di-vision!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":94,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":94,"endColumn":71,"fix":{"range":[3972,4034],"text":"'Why was the math book sad? Because it had too many problems!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":96,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":96,"endColumn":64,"fix":{"range":[4125,4180],"text":"'Why did the two fours skip lunch? They already eight!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":100,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":100,"endColumn":79,"fix":{"range":[4282,4352],"text":"'What did one ocean say to the other ocean? Nothing, they just waved!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":101,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":101,"endColumn":85,"fix":{"range":[4363,4439],"text":"'Why did the physicist break up with the biologist? There was no chemistry!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":102,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":102,"endColumn":67,"fix":{"range":[4450,4508],"text":"'What do you call an educated tube? A graduated cylinder!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":103,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":103,"endColumn":88,"fix":{"range":[4519,4598],"text":"'Why are chemists excellent for solving problems? They have all the solutions!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":104,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":104,"endColumn":60,"fix":{"range":[4609,4660],"text":"'What do you do with a dead scientist? You barium!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":105,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":105,"endColumn":99,"fix":{"range":[4671,4761],"text":"'Why did the photon refuse to check a bag at the airport? Because it was traveling light!'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":110,"column":27,"nodeType":"MemberExpression","endLine":110,"endColumn":42},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":119,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":119,"endColumn":72,"fix":{"range":[5158,5169],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":124,"column":10,"nodeType":"MemberExpression","endLine":124,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":125,"column":7,"nodeType":"MemberExpression","endLine":125,"endColumn":48},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":127,"column":5,"nodeType":"MemberExpression","endLine":127,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":132,"column":10,"nodeType":"MemberExpression","endLine":132,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":133,"column":7,"nodeType":"MemberExpression","endLine":133,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":135,"column":5,"nodeType":"MemberExpression","endLine":135,"endColumn":47},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'generateStory' has too many lines (51). Maximum allowed is 50.","line":144,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":194,"endColumn":4},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":147,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":147,"endColumn":97,"fix":{"range":[5911,5999],"text":"'In the enchanted kingdom of Eldoria, where dragons soar and magic flows like rivers...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":148,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":148,"endColumn":93,"fix":{"range":[6010,6094],"text":"'Deep in the mystical forest of Eldertree, ancient secrets wait to be discovered...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":149,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":149,"endColumn":95,"fix":{"range":[6105,6191],"text":"'Upon the floating islands of Aetheria, where wind spirits dance and stars whisper...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":152,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":152,"endColumn":87,"fix":{"range":[6231,6309],"text":"'The brave explorer set forth on a perilous journey across uncharted lands...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":153,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":153,"endColumn":85,"fix":{"range":[6320,6396],"text":"'With map in hand and courage in heart, the adventurer faced the unknown...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":154,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":154,"endColumn":88,"fix":{"range":[6407,6486],"text":"'The call to adventure echoed through the hero\\'s soul, impossible to ignore...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":157,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":157,"endColumn":94,"fix":{"range":[6524,6609],"text":"'Shadows concealed secrets in the old mansion, waiting for a detective\\'s keen eye...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":158,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":158,"endColumn":88,"fix":{"range":[6620,6699],"text":"'The puzzle pieces scattered like autumn leaves, hiding the truth from view...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":159,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":159,"endColumn":84,"fix":{"range":[6710,6785],"text":"'Whispers of conspiracy filled the air, drawing the investigator deeper...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":162,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":162,"endColumn":96,"fix":{"range":[6821,6908],"text":"'In the year 2147, aboard the starship Odyssey, humanity\\'s fate hung in the balance...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":163,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":163,"endColumn":98,"fix":{"range":[6919,7008],"text":"'The quantum computer hummed with artificial consciousness, questioning its existence...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":164,"column":9,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":164,"endColumn":91,"fix":{"range":[7019,7101],"text":"'Across the galaxy, alien civilizations watched as Earth reached for the stars...'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":168,"column":23,"nodeType":"MemberExpression","endLine":168,"endColumn":44},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":187,"column":34,"nodeType":"CallExpression","messageId":"substr","endLine":187,"endColumn":73,"fix":{"range":[7939,7950],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":200,"column":66,"nodeType":"Literal","messageId":"wrongQuotes","endLine":200,"endColumn":73,"fix":{"range":[8236,8243],"text":"'piano'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":201,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":201,"endColumn":50,"fix":{"range":[8266,8297],"text":"'What gets wetter as it dries?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":201,"column":60,"nodeType":"Literal","messageId":"wrongQuotes","endLine":201,"endColumn":67,"fix":{"range":[8307,8314],"text":"'towel'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":202,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":202,"endColumn":72,"fix":{"range":[8337,8390],"text":"'What has a head, a tail, is brown, and has no legs?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":202,"column":82,"nodeType":"Literal","messageId":"wrongQuotes","endLine":202,"endColumn":89,"fix":{"range":[8400,8407],"text":"'penny'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":203,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":203,"endColumn":54,"fix":{"range":[8430,8465],"text":"'What can you catch but not throw?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":203,"column":64,"nodeType":"Literal","messageId":"wrongQuotes","endLine":203,"endColumn":70,"fix":{"range":[8475,8481],"text":"'cold'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":206,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":206,"endColumn":126,"fix":{"range":[8530,8637],"text":"'I speak without a mouth and hear without ears. I have no body, but I come alive with the wind. What am I?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":206,"column":136,"nodeType":"Literal","messageId":"wrongQuotes","endLine":206,"endColumn":142,"fix":{"range":[8647,8653],"text":"'echo'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":207,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":207,"endColumn":81,"fix":{"range":[8676,8738],"text":"'The more you take, the more you leave behind. What are they?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":207,"column":91,"nodeType":"Literal","messageId":"wrongQuotes","endLine":207,"endColumn":102,"fix":{"range":[8748,8759],"text":"'footsteps'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":208,"column":66,"nodeType":"Literal","messageId":"wrongQuotes","endLine":208,"endColumn":72,"fix":{"range":[8829,8835],"text":"'comb'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":209,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":209,"endColumn":65,"fix":{"range":[8858,8904],"text":"'What is full of holes but still holds water?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":209,"column":75,"nodeType":"Literal","messageId":"wrongQuotes","endLine":209,"endColumn":83,"fix":{"range":[8914,8922],"text":"'sponge'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":212,"column":147,"nodeType":"Literal","messageId":"wrongQuotes","endLine":212,"endColumn":153,"fix":{"range":[9097,9103],"text":"'fire'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":213,"column":168,"nodeType":"Literal","messageId":"wrongQuotes","endLine":213,"endColumn":176,"fix":{"range":[9275,9283],"text":"'coffin'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":214,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":214,"endColumn":61,"fix":{"range":[9306,9348],"text":"'What has 13 hearts, but no other organs?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":214,"column":71,"nodeType":"Literal","messageId":"wrongQuotes","endLine":214,"endColumn":86,"fix":{"range":[9358,9373],"text":"'deck of cards'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":215,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":215,"endColumn":120,"fix":{"range":[9396,9497],"text":"'I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":215,"column":130,"nodeType":"Literal","messageId":"wrongQuotes","endLine":215,"endColumn":135,"fix":{"range":[9507,9512],"text":"'map'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":219,"column":31,"nodeType":"MemberExpression","endLine":219,"endColumn":50},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":225,"column":35,"nodeType":"CallExpression","messageId":"substr","endLine":225,"endColumn":74,"fix":{"range":[9812,9823],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":233,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":233,"endColumn":54,"fix":{"range":[9949,9994],"text":"'Octopuses have three hearts and blue blood!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":235,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":235,"endColumn":45,"fix":{"range":[10065,10101],"text":"'Butterflies taste with their feet!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":236,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":236,"endColumn":58,"fix":{"range":[10112,10161],"text":"'Penguins can jump as high as 6 feet in the air!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":240,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":240,"endColumn":50,"fix":{"range":[10294,10335],"text":"'A day on Venus is longer than its year!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":241,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":241,"endColumn":42,"fix":{"range":[10346,10379],"text":"'Jupiter has 79 confirmed moons!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":242,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":242,"endColumn":74,"fix":{"range":[10390,10455],"text":"'The footprints on the Moon will be there for 100 million years!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":246,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":246,"endColumn":63,"fix":{"range":[10551,10605],"text":"'A single cloud can weigh more than a million pounds!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":248,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":248,"endColumn":88,"fix":{"range":[10677,10756],"text":"'There are more possible games of chess than atoms in the observable universe!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":251,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":251,"endColumn":65,"fix":{"range":[10794,10850],"text":"'The shortest war in history lasted only 38-45 minutes!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":252,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":252,"endColumn":50,"fix":{"range":[10861,10902],"text":"'Ancient Romans used urine as mouthwash!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":253,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":253,"endColumn":53,"fix":{"range":[10913,10957],"text":"'The first computer mouse was made of wood!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":254,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":254,"endColumn":108,"fix":{"range":[10968,11067],"text":"'Cleopatra lived closer in time to the Moon landing than to the construction of the Great Pyramid!'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":263,"column":27,"nodeType":"MemberExpression","endLine":263,"endColumn":42},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":270,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":270,"endColumn":72,"fix":{"range":[11533,11544],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":283,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":283,"endColumn":73,"fix":{"range":[11788,11843],"text":"'The only way to do great work is to love what you do.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":283,"column":83,"nodeType":"Literal","messageId":"wrongQuotes","endLine":283,"endColumn":95,"fix":{"range":[11853,11865],"text":"'Steve Jobs'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":284,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":284,"endColumn":77,"fix":{"range":[11887,11946],"text":"'Innovation distinguishes between a leader and a follower.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":284,"column":87,"nodeType":"Literal","messageId":"wrongQuotes","endLine":284,"endColumn":99,"fix":{"range":[11956,11968],"text":"'Steve Jobs'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":285,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":285,"endColumn":106,"fix":{"range":[11990,12078],"text":"'Success is not final, failure is not fatal: It is the courage to continue that counts.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":285,"column":116,"nodeType":"Literal","messageId":"wrongQuotes","endLine":285,"endColumn":135,"fix":{"range":[12088,12107],"text":"'Winston Churchill'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":286,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":286,"endColumn":90,"fix":{"range":[12129,12201],"text":"'The future belongs to those who believe in the beauty of their dreams.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":286,"column":100,"nodeType":"Literal","messageId":"wrongQuotes","endLine":286,"endColumn":119,"fix":{"range":[12211,12230],"text":"'Eleanor Roosevelt'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":289,"column":71,"nodeType":"Literal","messageId":"wrongQuotes","endLine":289,"endColumn":91,"fix":{"range":[12337,12357],"text":"'Theodore Roosevelt'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":290,"column":73,"nodeType":"Literal","messageId":"wrongQuotes","endLine":290,"endColumn":89,"fix":{"range":[12434,12450],"text":"'Nelson Mandela'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":291,"column":81,"nodeType":"Literal","messageId":"wrongQuotes","endLine":291,"endColumn":95,"fix":{"range":[12535,12549],"text":"'Sam Levenson'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":292,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":292,"endColumn":94,"fix":{"range":[12571,12647],"text":"'The only limit to our realization of tomorrow will be our doubts of today.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":292,"column":104,"nodeType":"Literal","messageId":"wrongQuotes","endLine":292,"endColumn":127,"fix":{"range":[12657,12680],"text":"'Franklin D. Roosevelt'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":295,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":295,"endColumn":72,"fix":{"range":[12728,12782],"text":"'The only true wisdom is in knowing you know nothing.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":295,"column":82,"nodeType":"Literal","messageId":"wrongQuotes","endLine":295,"endColumn":92,"fix":{"range":[12792,12802],"text":"'Socrates'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":296,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":296,"endColumn":68,"fix":{"range":[12824,12874],"text":"'Knowing yourself is the beginning of all wisdom.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":296,"column":78,"nodeType":"Literal","messageId":"wrongQuotes","endLine":296,"endColumn":89,"fix":{"range":[12884,12895],"text":"'Aristotle'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":297,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":297,"endColumn":60,"fix":{"range":[12917,12959],"text":"'The unexamined life is not worth living.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":297,"column":70,"nodeType":"Literal","messageId":"wrongQuotes","endLine":297,"endColumn":80,"fix":{"range":[12969,12979],"text":"'Socrates'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":298,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":298,"endColumn":77,"fix":{"range":[13001,13060],"text":"'Be kind, for everyone you meet is fighting a hard battle.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":298,"column":87,"nodeType":"Literal","messageId":"wrongQuotes","endLine":298,"endColumn":94,"fix":{"range":[13070,13077],"text":"'Plato'"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (616). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":616,"endColumn":20},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":301,"column":81,"nodeType":"Literal","messageId":"wrongQuotes","endLine":301,"endColumn":96,"fix":{"range":[13187,13202],"text":"'Steven Wright'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":302,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":302,"endColumn":103,"fix":{"range":[13224,13309],"text":"'I always wanted to be somebody, but now I realize I should have been more specific.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":302,"column":113,"nodeType":"Literal","messageId":"wrongQuotes","endLine":302,"endColumn":126,"fix":{"range":[13319,13332],"text":"'Lily Tomlin'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":303,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":303,"endColumn":79,"fix":{"range":[13354,13415],"text":"'Why is the math book sad? Because it has too many problems.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":303,"column":89,"nodeType":"Literal","messageId":"wrongQuotes","endLine":303,"endColumn":98,"fix":{"range":[13425,13434],"text":"'Unknown'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":304,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":304,"endColumn":95,"fix":{"range":[13456,13533],"text":"'I told my wife she was drawing her eyebrows too high. She looked surprised.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":304,"column":105,"nodeType":"Literal","messageId":"wrongQuotes","endLine":304,"endColumn":114,"fix":{"range":[13543,13552],"text":"'Unknown'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":308,"column":28,"nodeType":"MemberExpression","endLine":308,"endColumn":44},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":315,"column":34,"nodeType":"CallExpression","messageId":"substr","endLine":315,"endColumn":73,"fix":{"range":[13872,13883],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":327,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":327,"endColumn":45,"fix":{"range":[14087,14125],"text":"'She sells seashells by the seashore.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":328,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":328,"endColumn":54,"fix":{"range":[14134,14181],"text":"'Peter Piper picked a peck of pickled peppers.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":329,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":329,"endColumn":79,"fix":{"range":[14190,14262],"text":"'How much wood would a woodchuck chuck if a woodchuck could chuck wood?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":331,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":331,"endColumn":49,"fix":{"range":[14369,14411],"text":"'I saw Susie sitting in a shoeshine shop.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":332,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":332,"endColumn":45,"fix":{"range":[14420,14458],"text":"'Six sick slick seals sit by the sea.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":333,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":333,"endColumn":40,"fix":{"range":[14467,14500],"text":"'Black bug bit a big black bear.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":334,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":334,"endColumn":50,"fix":{"range":[14509,14552],"text":"'How can a clam cram in a clean cream can?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":344,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":344,"endColumn":23,"fix":{"range":[14745,14761],"text":"'It is certain.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":344,"column":25,"nodeType":"Literal","messageId":"wrongQuotes","endLine":344,"endColumn":46,"fix":{"range":[14763,14784],"text":"'It is decidedly so.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":344,"column":48,"nodeType":"Literal","messageId":"wrongQuotes","endLine":344,"endColumn":66,"fix":{"range":[14786,14804],"text":"'Without a doubt.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":344,"column":68,"nodeType":"Literal","messageId":"wrongQuotes","endLine":344,"endColumn":85,"fix":{"range":[14806,14823],"text":"'Yes definitely.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":345,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":345,"endColumn":28,"fix":{"range":[14832,14853],"text":"'You may rely on it.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":345,"column":30,"nodeType":"Literal","messageId":"wrongQuotes","endLine":345,"endColumn":49,"fix":{"range":[14855,14874],"text":"'As I see it, yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":345,"column":51,"nodeType":"Literal","messageId":"wrongQuotes","endLine":345,"endColumn":65,"fix":{"range":[14876,14890],"text":"'Most likely.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":345,"column":67,"nodeType":"Literal","messageId":"wrongQuotes","endLine":345,"endColumn":82,"fix":{"range":[14892,14907],"text":"'Outlook good.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":346,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":346,"endColumn":13,"fix":{"range":[14916,14922],"text":"'Yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":346,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":346,"endColumn":36,"fix":{"range":[14924,14945],"text":"'Signs point to yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":349,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":349,"endColumn":31,"fix":{"range":[14980,15004],"text":"'Reply hazy, try again.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":349,"column":33,"nodeType":"Literal","messageId":"wrongQuotes","endLine":349,"endColumn":51,"fix":{"range":[15006,15024],"text":"'Ask again later.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":349,"column":53,"nodeType":"Literal","messageId":"wrongQuotes","endLine":349,"endColumn":79,"fix":{"range":[15026,15052],"text":"'Better not tell you now.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":350,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":350,"endColumn":28,"fix":{"range":[15061,15082],"text":"'Cannot predict now.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":350,"column":30,"nodeType":"Literal","messageId":"wrongQuotes","endLine":350,"endColumn":58,"fix":{"range":[15084,15112],"text":"'Concentrate and ask again.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":353,"column":29,"nodeType":"Literal","messageId":"wrongQuotes","endLine":353,"endColumn":46,"fix":{"range":[15164,15181],"text":"'My reply is no.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":353,"column":48,"nodeType":"Literal","messageId":"wrongQuotes","endLine":353,"endColumn":68,"fix":{"range":[15183,15203],"text":"'My sources say no.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":353,"column":70,"nodeType":"Literal","messageId":"wrongQuotes","endLine":353,"endColumn":92,"fix":{"range":[15205,15227],"text":"'Outlook not so good.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":354,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":354,"endColumn":23,"fix":{"range":[15236,15252],"text":"'Very doubtful.'"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":362,"column":34,"nodeType":"CallExpression","messageId":"substr","endLine":362,"endColumn":73,"fix":{"range":[15461,15472],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":370,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":370,"endColumn":26,"fix":{"range":[15607,15624],"text":"'Captain Awesome'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":370,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":370,"endColumn":48,"fix":{"range":[15626,15646],"text":"'The Amazing Wonder'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":370,"column":50,"nodeType":"Literal","messageId":"wrongQuotes","endLine":370,"endColumn":69,"fix":{"range":[15648,15667],"text":"'Super Spectacular'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":370,"column":71,"nodeType":"Literal","messageId":"wrongQuotes","endLine":370,"endColumn":86,"fix":{"range":[15669,15684],"text":"'Mighty Marvel'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":371,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":371,"endColumn":26,"fix":{"range":[15695,15712],"text":"'Incredible Hero'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":371,"column":28,"nodeType":"Literal","messageId":"wrongQuotes","endLine":371,"endColumn":45,"fix":{"range":[15714,15731],"text":"'Fantastic Force'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":371,"column":47,"nodeType":"Literal","messageId":"wrongQuotes","endLine":371,"endColumn":65,"fix":{"range":[15733,15751],"text":"'Dynamic Defender'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":371,"column":67,"nodeType":"Literal","messageId":"wrongQuotes","endLine":371,"endColumn":86,"fix":{"range":[15753,15772],"text":"'Ultimate Champion'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":374,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":374,"endColumn":23,"fix":{"range":[15810,15824],"text":"'Dr. Disaster'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":374,"column":25,"nodeType":"Literal","messageId":"wrongQuotes","endLine":374,"endColumn":42,"fix":{"range":[15826,15843],"text":"'The Evil Genius'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":374,"column":44,"nodeType":"Literal","messageId":"wrongQuotes","endLine":374,"endColumn":58,"fix":{"range":[15845,15859],"text":"'Chaos Master'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":374,"column":60,"nodeType":"Literal","messageId":"wrongQuotes","endLine":374,"endColumn":73,"fix":{"range":[15861,15874],"text":"'Shadow Lord'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":375,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":375,"endColumn":25,"fix":{"range":[15885,15901],"text":"'Dark Destroyer'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":375,"column":27,"nodeType":"Literal","messageId":"wrongQuotes","endLine":375,"endColumn":48,"fix":{"range":[15903,15924],"text":"'The Terrible Tyrant'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":375,"column":50,"nodeType":"Literal","messageId":"wrongQuotes","endLine":375,"endColumn":66,"fix":{"range":[15926,15942],"text":"'Wicked Warlock'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":375,"column":68,"nodeType":"Literal","messageId":"wrongQuotes","endLine":375,"endColumn":87,"fix":{"range":[15944,15963],"text":"'Sinister Sorcerer'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":378,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":378,"endColumn":22,"fix":{"range":[16001,16014],"text":"'Mystic Mage'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":378,"column":24,"nodeType":"Literal","messageId":"wrongQuotes","endLine":378,"endColumn":38,"fix":{"range":[16016,16030],"text":"'Dragon Rider'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":378,"column":40,"nodeType":"Literal","messageId":"wrongQuotes","endLine":378,"endColumn":54,"fix":{"range":[16032,16046],"text":"'Elven Archer'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":378,"column":56,"nodeType":"Literal","messageId":"wrongQuotes","endLine":378,"endColumn":73,"fix":{"range":[16048,16065],"text":"'Dwarven Warrior'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":379,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":379,"endColumn":25,"fix":{"range":[16076,16092],"text":"'Phoenix Knight'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":379,"column":27,"nodeType":"Literal","messageId":"wrongQuotes","endLine":379,"endColumn":44,"fix":{"range":[16094,16111],"text":"'Shadow Assassin'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":379,"column":46,"nodeType":"Literal","messageId":"wrongQuotes","endLine":379,"endColumn":65,"fix":{"range":[16113,16132],"text":"'Crystal Sorceress'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":379,"column":67,"nodeType":"Literal","messageId":"wrongQuotes","endLine":379,"endColumn":81,"fix":{"range":[16134,16148],"text":"'Storm Caller'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":382,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":382,"endColumn":24,"fix":{"range":[16184,16199],"text":"'Cyber Warrior'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":382,"column":26,"nodeType":"Literal","messageId":"wrongQuotes","endLine":382,"endColumn":40,"fix":{"range":[16201,16215],"text":"'Space Ranger'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":382,"column":42,"nodeType":"Literal","messageId":"wrongQuotes","endLine":382,"endColumn":58,"fix":{"range":[16217,16233],"text":"'Quantum Hacker'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":382,"column":60,"nodeType":"Literal","messageId":"wrongQuotes","endLine":382,"endColumn":75,"fix":{"range":[16235,16250],"text":"'Nano Engineer'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":383,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":383,"endColumn":23,"fix":{"range":[16261,16275],"text":"'Star Captain'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":383,"column":25,"nodeType":"Literal","messageId":"wrongQuotes","endLine":383,"endColumn":42,"fix":{"range":[16277,16294],"text":"'Robot Commander'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":383,"column":44,"nodeType":"Literal","messageId":"wrongQuotes","endLine":383,"endColumn":58,"fix":{"range":[16296,16310],"text":"'Laser Knight'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":383,"column":60,"nodeType":"Literal","messageId":"wrongQuotes","endLine":383,"endColumn":74,"fix":{"range":[16312,16326],"text":"'Plasma Pilot'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":23,"nodeType":"MemberExpression","endLine":387,"endColumn":34},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":393,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":393,"endColumn":72,"fix":{"range":[16578,16589],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":401,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":401,"endColumn":63,"fix":{"range":[16721,16765],"text":"'How do you prefer to spend your free time?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":402,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":402,"endColumn":40,"fix":{"range":[16786,16807],"text":"'Reading or learning'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":402,"column":42,"nodeType":"Literal","messageId":"wrongQuotes","endLine":402,"endColumn":68,"fix":{"range":[16809,16835],"text":"'Socializing with friends'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":402,"column":70,"nodeType":"Literal","messageId":"wrongQuotes","endLine":402,"endColumn":93,"fix":{"range":[16837,16860],"text":"'Creating art or music'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":402,"column":95,"nodeType":"Literal","messageId":"wrongQuotes","endLine":402,"endColumn":120,"fix":{"range":[16862,16887],"text":"'Playing sports or games'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":403,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":403,"endColumn":32,"fix":{"range":[16908,16922],"text":"'intellectual'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":403,"column":34,"nodeType":"Literal","messageId":"wrongQuotes","endLine":403,"endColumn":42,"fix":{"range":[16924,16932],"text":"'social'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":403,"column":44,"nodeType":"Literal","messageId":"wrongQuotes","endLine":403,"endColumn":54,"fix":{"range":[16934,16944],"text":"'creative'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":403,"column":56,"nodeType":"Literal","messageId":"wrongQuotes","endLine":403,"endColumn":64,"fix":{"range":[16946,16954],"text":"'active'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":407,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":407,"endColumn":39,"fix":{"range":[17044,17064],"text":"'Cultural city tour'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":407,"column":41,"nodeType":"Literal","messageId":"wrongQuotes","endLine":407,"endColumn":59,"fix":{"range":[17066,17084],"text":"'Beach relaxation'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":407,"column":61,"nodeType":"Literal","messageId":"wrongQuotes","endLine":407,"endColumn":77,"fix":{"range":[17086,17102],"text":"'Adventure trip'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":407,"column":79,"nodeType":"Literal","messageId":"wrongQuotes","endLine":407,"endColumn":99,"fix":{"range":[17104,17124],"text":"'Staycation at home'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":408,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":408,"endColumn":28,"fix":{"range":[17145,17155],"text":"'cultural'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":408,"column":30,"nodeType":"Literal","messageId":"wrongQuotes","endLine":408,"endColumn":39,"fix":{"range":[17157,17166],"text":"'relaxed'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":408,"column":41,"nodeType":"Literal","messageId":"wrongQuotes","endLine":408,"endColumn":54,"fix":{"range":[17168,17181],"text":"'adventurous'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":408,"column":56,"nodeType":"Literal","messageId":"wrongQuotes","endLine":408,"endColumn":66,"fix":{"range":[17183,17193],"text":"'homebody'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":411,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":411,"endColumn":47,"fix":{"range":[17233,17261],"text":"'How do you make decisions?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":412,"column":19,"nodeType":"Literal","messageId":"wrongQuotes","endLine":412,"endColumn":45,"fix":{"range":[17282,17308],"text":"'Based on logic and facts'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":412,"column":47,"nodeType":"Literal","messageId":"wrongQuotes","endLine":412,"endColumn":77,"fix":{"range":[17310,17340],"text":"'Based on feelings and values'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":412,"column":79,"nodeType":"Literal","messageId":"wrongQuotes","endLine":412,"endColumn":104,"fix":{"range":[17342,17367],"text":"'After consulting others'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":412,"column":106,"nodeType":"Literal","messageId":"wrongQuotes","endLine":412,"endColumn":121,"fix":{"range":[17369,17384],"text":"'Spontaneously'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":413,"column":18,"nodeType":"Literal","messageId":"wrongQuotes","endLine":413,"endColumn":27,"fix":{"range":[17405,17414],"text":"'logical'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":413,"column":29,"nodeType":"Literal","messageId":"wrongQuotes","endLine":413,"endColumn":40,"fix":{"range":[17416,17427],"text":"'emotional'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":413,"column":42,"nodeType":"Literal","messageId":"wrongQuotes","endLine":413,"endColumn":57,"fix":{"range":[17429,17444],"text":"'collaborative'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":413,"column":59,"nodeType":"Literal","messageId":"wrongQuotes","endLine":413,"endColumn":72,"fix":{"range":[17446,17459],"text":"'spontaneous'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":429,"column":12,"nodeType":"Literal","messageId":"error","endLine":429,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[17927,17931],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[17927,17931],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":448,"column":12,"nodeType":"MemberExpression","endLine":448,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":458,"column":10,"nodeType":"MemberExpression","endLine":458,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":459,"column":7,"nodeType":"MemberExpression","endLine":459,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":468,"column":9,"nodeType":"MemberExpression","endLine":468,"endColumn":58},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":468,"column":9,"nodeType":"MemberExpression","endLine":468,"endColumn":48},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":469,"column":7,"nodeType":"MemberExpression","endLine":469,"endColumn":56},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":469,"column":7,"nodeType":"MemberExpression","endLine":469,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":473,"column":12,"nodeType":"MemberExpression","endLine":473,"endColumn":51},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":480,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":480,"endColumn":50,"fix":{"range":[19258,19299],"text":"'Tell 5 jokes to different people today!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":481,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":481,"endColumn":48,"fix":{"range":[19310,19349],"text":"'Learn 3 new fun facts and share them!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":482,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":482,"endColumn":54,"fix":{"range":[19360,19405],"text":"'Create an original story with your friends!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":483,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":483,"endColumn":44,"fix":{"range":[19416,19451],"text":"'Solve 5 riddles or brain teasers!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":484,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":484,"endColumn":42,"fix":{"range":[19462,19495],"text":"'Try 3 different types of games!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":487,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":487,"endColumn":46,"fix":{"range":[19532,19569],"text":"'Complete 10 different achievements!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":488,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":488,"endColumn":41,"fix":{"range":[19580,19612],"text":"'Try every game mode available!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":489,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":489,"endColumn":45,"fix":{"range":[19623,19659],"text":"'Create and share 5 original jokes!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":490,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":490,"endColumn":44,"fix":{"range":[19670,19705],"text":"'Reach level 10 in the RPG system!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":491,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":491,"endColumn":45,"fix":{"range":[19716,19752],"text":"'Build the ultimate trading empire!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":494,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":494,"endColumn":33,"fix":{"range":[19790,19814],"text":"'Become a guild leader!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":495,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":495,"endColumn":40,"fix":{"range":[19825,19856],"text":"'Master all game difficulties!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":496,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":496,"endColumn":35,"fix":{"range":[19867,19893],"text":"'Build a business empire!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":497,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":497,"endColumn":36,"fix":{"range":[19904,19931],"text":"'Complete 50 achievements!'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":498,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":498,"endColumn":37,"fix":{"range":[19942,19970],"text":"'Become a legendary trader!'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":502,"column":28,"nodeType":"MemberExpression","endLine":502,"endColumn":44},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":508,"column":38,"nodeType":"CallExpression","messageId":"substr","endLine":508,"endColumn":77,"fix":{"range":[20258,20269],"text":"slice(2, 11"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":515,"column":14,"nodeType":"Literal","messageId":"wrongQuotes","endLine":515,"endColumn":43,"fix":{"range":[20401,20430],"text":"'50 bonus achievement points'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":516,"column":15,"nodeType":"Literal","messageId":"wrongQuotes","endLine":516,"endColumn":43,"fix":{"range":[20447,20475],"text":"'Special badge + 200 points'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":517,"column":16,"nodeType":"Literal","messageId":"wrongQuotes","endLine":517,"endColumn":61,"fix":{"range":[20493,20538],"text":"'Exclusive title + 500 points + Special role'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":520,"column":12,"nodeType":"MemberExpression","endLine":520,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":528,"column":21,"nodeType":"MemberExpression","endLine":528,"endColumn":40},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":545,"column":7,"nodeType":"MemberExpression","endLine":545,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":545,"column":52,"nodeType":"MemberExpression","endLine":545,"endColumn":94}],"suppressedMessages":[],"errorCount":213,"fatalErrorCount":0,"warningCount":30,"fixableErrorCount":209,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst ENTERTAINMENT_FILE = path.join(process.cwd(), 'data', 'entertainment.json');\r\n\r\n// Advanced Entertainment and Fun System\r\nclass EntertainmentManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadEntertainment();\r\n    this.jokeCache = new Map();\r\n    this.funStats = new Map();\r\n    this.contentCache = new Map(); // Cache for recently generated content\r\n    this.MAX_CACHE_SIZE = 1000;\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(ENTERTAINMENT_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(ENTERTAINMENT_FILE)) {\r\n      fs.writeFileSync(ENTERTAINMENT_FILE, JSON.stringify({\r\n        funStats: {},\r\n        jokeRatings: {},\r\n        gameScores: {},\r\n        entertainmentHistory: []\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadEntertainment() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(ENTERTAINMENT_FILE, 'utf8'));\r\n      this.entertainmentData = data;\r\n    } catch (error) {\r\n      console.error('Failed to load entertainment data:', error);\r\n      this.entertainmentData = {\r\n        funStats: {},\r\n        jokeRatings: {},\r\n        gameScores: {},\r\n        entertainmentHistory: []\r\n      };\r\n    }\r\n  }\r\n\r\n  saveEntertainment() {\r\n    try {\r\n      fs.writeFileSync(ENTERTAINMENT_FILE, JSON.stringify(this.entertainmentData, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save entertainment data:', error);\r\n    }\r\n  }\r\n\r\n  // Advanced Joke System\r\n  getRandomJoke(category = 'general') {\r\n    const jokes = {\r\n      general: [\r\n        \"Why don't scientists trust atoms? Because they make up everything!\",\r\n        \"What do you call fake spaghetti? An impasta!\",\r\n        \"Why did the scarecrow win an award? He was outstanding in his field!\",\r\n        \"Why don't eggs tell jokes? They'd crack each other up!\",\r\n        \"What do you call cheese that isn't yours? Nacho cheese!\",\r\n        \"Why did the bicycle fall over? Because it was two-tired!\",\r\n        \"What do you call a bear with no teeth? A gummy bear!\",\r\n        \"Why don't skeletons fight each other? They don't have the guts!\"\r\n      ],\r\n      programming: [\r\n        \"Why do programmers prefer dark mode? Because light attracts bugs!\",\r\n        \"How many programmers does it take to change a light bulb? None ‚Äì that's a hardware problem!\",\r\n        \"Why do Java developers wear glasses? Because they can't C#!\",\r\n        \"A SQL query walks into a bar, approaches two tables and asks: 'Can I join you?'\",\r\n        \"Why did the programmer quit his job? Because he didn't get arrays!\",\r\n        \"There are 10 types of people in the world: those who understand binary and those who don't!\",\r\n        \"Why do programmers always mix up Halloween and Christmas? Because Oct 31 == Dec 25!\",\r\n        \"How do you comfort a JavaScript bug? You console it!\"\r\n      ],\r\n      dad: [\r\n        \"I'm reading a book about anti-gravity. It's impossible to put down!\",\r\n        \"Did you hear about the restaurant on the moon? Great food, no atmosphere!\",\r\n        \"What do you call a fish with no eyes? Fsh!\",\r\n        \"Why did the golfer bring two pairs of pants? In case he got a hole in one!\",\r\n        \"What do you call someone with no body and no nose? Nobody knows!\",\r\n        \"Why can't you hear a pterodactyl go to the bathroom? Because the 'P' is silent!\",\r\n        \"What does a zombie vegetarian eat? 'GRRRAAAINNS!'\",\r\n        \"Why did the math book look sad? Because it had too many problems!\"\r\n      ],\r\n      math: [\r\n        \"Why was the equal sign so humble? Because it knew it wasn't less than or greater than anyone else!\",\r\n        \"What do you call friends who love math? Algebros!\",\r\n        \"Why is the obtuse triangle always so frustrated? Because it's never right!\",\r\n        \"Why did the student wear glasses in math class? To improve di-vision!\",\r\n        \"What did the zero say to the eight? 'Nice belt!'\",\r\n        \"Why was the math book sad? Because it had too many problems!\",\r\n        \"What do you call a number that can't keep still? A roamin' numeral!\",\r\n        \"Why did the two fours skip lunch? They already eight!\"\r\n      ],\r\n      science: [\r\n        \"Why can't you trust atoms? They make up everything!\",\r\n        \"What did one ocean say to the other ocean? Nothing, they just waved!\",\r\n        \"Why did the physicist break up with the biologist? There was no chemistry!\",\r\n        \"What do you call an educated tube? A graduated cylinder!\",\r\n        \"Why are chemists excellent for solving problems? They have all the solutions!\",\r\n        \"What do you do with a dead scientist? You barium!\",\r\n        \"Why did the photon refuse to check a bag at the airport? Because it was traveling light!\",\r\n        \"What is a physicist's favorite food? Fission chips!\"\r\n      ]\r\n    };\r\n\r\n    const categoryJokes = jokes[category] || jokes.general;\r\n    const joke = categoryJokes[Math.floor(Math.random() * categoryJokes.length)];\r\n\r\n    // Track joke usage\r\n    this.trackJokeUsage(category);\r\n\r\n    return {\r\n      joke,\r\n      category,\r\n      id: `joke_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n  }\r\n\r\n  trackJokeUsage(category) {\r\n    if (!this.entertainmentData.funStats[category]) {\r\n      this.entertainmentData.funStats[category] = { jokesTold: 0, ratings: [] };\r\n    }\r\n    this.entertainmentData.funStats[category].jokesTold++;\r\n    this.saveEntertainment();\r\n  }\r\n\r\n  rateJoke(jokeId, rating) {\r\n    if (!this.entertainmentData.jokeRatings[jokeId]) {\r\n      this.entertainmentData.jokeRatings[jokeId] = [];\r\n    }\r\n    this.entertainmentData.jokeRatings[jokeId].push({\r\n      rating,\r\n      timestamp: Date.now()\r\n    });\r\n    this.saveEntertainment();\r\n    return true;\r\n  }\r\n\r\n  // Advanced Storytelling System\r\n  generateStory(prompt, genre = 'fantasy') {\r\n    const storyTemplates = {\r\n      fantasy: [\r\n        `In the enchanted kingdom of Eldoria, where dragons soar and magic flows like rivers...`,\r\n        `Deep in the mystical forest of Eldertree, ancient secrets wait to be discovered...`,\r\n        `Upon the floating islands of Aetheria, where wind spirits dance and stars whisper...`\r\n      ],\r\n      adventure: [\r\n        `The brave explorer set forth on a perilous journey across uncharted lands...`,\r\n        `With map in hand and courage in heart, the adventurer faced the unknown...`,\r\n        `The call to adventure echoed through the hero's soul, impossible to ignore...`\r\n      ],\r\n      mystery: [\r\n        `Shadows concealed secrets in the old mansion, waiting for a detective's keen eye...`,\r\n        `The puzzle pieces scattered like autumn leaves, hiding the truth from view...`,\r\n        `Whispers of conspiracy filled the air, drawing the investigator deeper...`\r\n      ],\r\n      sciFi: [\r\n        `In the year 2147, aboard the starship Odyssey, humanity's fate hung in the balance...`,\r\n        `The quantum computer hummed with artificial consciousness, questioning its existence...`,\r\n        `Across the galaxy, alien civilizations watched as Earth reached for the stars...`\r\n      ]\r\n    };\r\n\r\n    const templates = storyTemplates[genre] || storyTemplates.fantasy;\r\n    const baseStory = templates[Math.floor(Math.random() * templates.length)];\r\n\r\n    // Generate creative continuation\r\n    const continuations = [\r\n      `${prompt} became the catalyst for an extraordinary tale of courage and discovery.`,\r\n      `What began as ${prompt} evolved into a legendary saga of heroism and wonder.`,\r\n      `The threads of fate wove ${prompt} into an epic narrative of triumph and magic.`\r\n    ];\r\n\r\n    const continuation = continuations[Math.floor(Math.random() * continuations.length)];\r\n    const story = `${baseStory} ${continuation}`;\r\n\r\n    const content = {\r\n      story,\r\n      genre,\r\n      prompt,\r\n      length: 'medium',\r\n      type: 'story',\r\n      id: `story_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n\r\n    // Store for sharing\r\n    this.storeContentForSharing(content);\r\n\r\n    return content;\r\n  }\r\n\r\n  // Riddle and Puzzle System\r\n  getRiddle(difficulty = 'medium') {\r\n    const riddles = {\r\n      easy: [\r\n        { riddle: \"What has keys but can't open locks?\", answer: \"piano\" },\r\n        { riddle: \"What gets wetter as it dries?\", answer: \"towel\" },\r\n        { riddle: \"What has a head, a tail, is brown, and has no legs?\", answer: \"penny\" },\r\n        { riddle: \"What can you catch but not throw?\", answer: \"cold\" }\r\n      ],\r\n      medium: [\r\n        { riddle: \"I speak without a mouth and hear without ears. I have no body, but I come alive with the wind. What am I?\", answer: \"echo\" },\r\n        { riddle: \"The more you take, the more you leave behind. What are they?\", answer: \"footsteps\" },\r\n        { riddle: \"What has many teeth but can't bite?\", answer: \"comb\" },\r\n        { riddle: \"What is full of holes but still holds water?\", answer: \"sponge\" }\r\n      ],\r\n      hard: [\r\n        { riddle: \"I am not alive, but I grow; I don't have lungs, but I need air; I don't have a mouth, but water kills me. What am I?\", answer: \"fire\" },\r\n        { riddle: \"The person who makes it, sells it. The person who buys it never uses it. The person who uses it never knows they're using it. What is it?\", answer: \"coffin\" },\r\n        { riddle: \"What has 13 hearts, but no other organs?\", answer: \"deck of cards\" },\r\n        { riddle: \"I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?\", answer: \"map\" }\r\n      ]\r\n    };\r\n\r\n    const difficultyRiddles = riddles[difficulty] || riddles.medium;\r\n    const riddle = difficultyRiddles[Math.floor(Math.random() * difficultyRiddles.length)];\r\n\r\n    return {\r\n      ...riddle,\r\n      difficulty,\r\n      id: `riddle_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n  }\r\n\r\n  // Fun Fact System\r\n  getFunFact(category = 'random') {\r\n    const facts = {\r\n      animals: [\r\n        \"Octopuses have three hearts and blue blood!\",\r\n        \"A group of flamingos is called a 'flamboyance'!\",\r\n        \"Butterflies taste with their feet!\",\r\n        \"Penguins can jump as high as 6 feet in the air!\"\r\n      ],\r\n      space: [\r\n        \"There are more stars in the universe than grains of sand on all the Earth's beaches!\",\r\n        \"A day on Venus is longer than its year!\",\r\n        \"Jupiter has 79 confirmed moons!\",\r\n        \"The footprints on the Moon will be there for 100 million years!\"\r\n      ],\r\n      science: [\r\n        \"Bananas are berries, but strawberries aren't!\",\r\n        \"A single cloud can weigh more than a million pounds!\",\r\n        \"Your brain uses about 20% of your body's energy!\",\r\n        \"There are more possible games of chess than atoms in the observable universe!\"\r\n      ],\r\n      history: [\r\n        \"The shortest war in history lasted only 38-45 minutes!\",\r\n        \"Ancient Romans used urine as mouthwash!\",\r\n        \"The first computer mouse was made of wood!\",\r\n        \"Cleopatra lived closer in time to the Moon landing than to the construction of the Great Pyramid!\"\r\n      ]\r\n    };\r\n\r\n    if (category === 'random') {\r\n      const categories = Object.keys(facts);\r\n      category = categories[Math.floor(Math.random() * categories.length)];\r\n    }\r\n\r\n    const categoryFacts = facts[category] || facts.science;\r\n    const fact = categoryFacts[Math.floor(Math.random() * categoryFacts.length)];\r\n\r\n    const content = {\r\n      fact,\r\n      category,\r\n      type: 'fact',\r\n      id: `fact_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n\r\n    // Store for sharing\r\n    this.storeContentForSharing(content);\r\n\r\n    return content;\r\n  }\r\n\r\n  // Quote System\r\n  getRandomQuote(category = 'inspirational') {\r\n    const quotes = {\r\n      inspirational: [\r\n        { quote: \"The only way to do great work is to love what you do.\", author: \"Steve Jobs\" },\r\n        { quote: \"Innovation distinguishes between a leader and a follower.\", author: \"Steve Jobs\" },\r\n        { quote: \"Success is not final, failure is not fatal: It is the courage to continue that counts.\", author: \"Winston Churchill\" },\r\n        { quote: \"The future belongs to those who believe in the beauty of their dreams.\", author: \"Eleanor Roosevelt\" }\r\n      ],\r\n      motivational: [\r\n        { quote: \"Believe you can and you're halfway there.\", author: \"Theodore Roosevelt\" },\r\n        { quote: \"It always seems impossible until it's done.\", author: \"Nelson Mandela\" },\r\n        { quote: \"Don't watch the clock; do what it does. Keep going.\", author: \"Sam Levenson\" },\r\n        { quote: \"The only limit to our realization of tomorrow will be our doubts of today.\", author: \"Franklin D. Roosevelt\" }\r\n      ],\r\n      wisdom: [\r\n        { quote: \"The only true wisdom is in knowing you know nothing.\", author: \"Socrates\" },\r\n        { quote: \"Knowing yourself is the beginning of all wisdom.\", author: \"Aristotle\" },\r\n        { quote: \"The unexamined life is not worth living.\", author: \"Socrates\" },\r\n        { quote: \"Be kind, for everyone you meet is fighting a hard battle.\", author: \"Plato\" }\r\n      ],\r\n      humor: [\r\n        { quote: \"I'm writing a book. I've got the page numbers done.\", author: \"Steven Wright\" },\r\n        { quote: \"I always wanted to be somebody, but now I realize I should have been more specific.\", author: \"Lily Tomlin\" },\r\n        { quote: \"Why is the math book sad? Because it has too many problems.\", author: \"Unknown\" },\r\n        { quote: \"I told my wife she was drawing her eyebrows too high. She looked surprised.\", author: \"Unknown\" }\r\n      ]\r\n    };\r\n\r\n    const categoryQuotes = quotes[category] || quotes.inspirational;\r\n    const quote = categoryQuotes[Math.floor(Math.random() * categoryQuotes.length)];\r\n\r\n    const content = {\r\n      ...quote,\r\n      category,\r\n      type: 'quote',\r\n      id: `quote_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n\r\n    // Store for sharing\r\n    this.storeContentForSharing(content);\r\n\r\n    return content;\r\n  }\r\n\r\n  // Tongue Twister Generator\r\n  generateTongueTwister() {\r\n    const twisters = [\r\n      \"She sells seashells by the seashore.\",\r\n      \"Peter Piper picked a peck of pickled peppers.\",\r\n      \"How much wood would a woodchuck chuck if a woodchuck could chuck wood?\",\r\n      \"Fuzzy Wuzzy was a bear. Fuzzy Wuzzy had no hair. Fuzzy Wuzzy wasn't very fuzzy, was he?\",\r\n      \"I saw Susie sitting in a shoeshine shop.\",\r\n      \"Six sick slick seals sit by the sea.\",\r\n      \"Black bug bit a big black bear.\",\r\n      \"How can a clam cram in a clean cream can?\"\r\n    ];\r\n\r\n    return twisters[Math.floor(Math.random() * twisters.length)];\r\n  }\r\n\r\n  // Magic 8-Ball Enhanced\r\n  magic8Ball(question) {\r\n    const responses = [\r\n      // Affirmative\r\n      \"It is certain.\", \"It is decidedly so.\", \"Without a doubt.\", \"Yes definitely.\",\r\n      \"You may rely on it.\", \"As I see it, yes.\", \"Most likely.\", \"Outlook good.\",\r\n      \"Yes.\", \"Signs point to yes.\",\r\n\r\n      // Non-committal\r\n      \"Reply hazy, try again.\", \"Ask again later.\", \"Better not tell you now.\",\r\n      \"Cannot predict now.\", \"Concentrate and ask again.\",\r\n\r\n      // Negative\r\n      \"Don't count on it.\", \"My reply is no.\", \"My sources say no.\", \"Outlook not so good.\",\r\n      \"Very doubtful.\"\r\n    ];\r\n\r\n    const response = responses[Math.floor(Math.random() * responses.length)];\r\n\r\n    return {\r\n      question,\r\n      answer: response,\r\n      id: `8ball_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n  }\r\n\r\n  // Fun Name Generator\r\n  generateFunName(type = 'superhero') {\r\n    const names = {\r\n      superhero: [\r\n        \"Captain Awesome\", \"The Amazing Wonder\", \"Super Spectacular\", \"Mighty Marvel\",\r\n        \"Incredible Hero\", \"Fantastic Force\", \"Dynamic Defender\", \"Ultimate Champion\"\r\n      ],\r\n      villain: [\r\n        \"Dr. Disaster\", \"The Evil Genius\", \"Chaos Master\", \"Shadow Lord\",\r\n        \"Dark Destroyer\", \"The Terrible Tyrant\", \"Wicked Warlock\", \"Sinister Sorcerer\"\r\n      ],\r\n      fantasy: [\r\n        \"Mystic Mage\", \"Dragon Rider\", \"Elven Archer\", \"Dwarven Warrior\",\r\n        \"Phoenix Knight\", \"Shadow Assassin\", \"Crystal Sorceress\", \"Storm Caller\"\r\n      ],\r\n      sciFi: [\r\n        \"Cyber Warrior\", \"Space Ranger\", \"Quantum Hacker\", \"Nano Engineer\",\r\n        \"Star Captain\", \"Robot Commander\", \"Laser Knight\", \"Plasma Pilot\"\r\n      ]\r\n    };\r\n\r\n    const typeNames = names[type] || names.superhero;\r\n    const name = typeNames[Math.floor(Math.random() * typeNames.length)];\r\n\r\n    return {\r\n      name,\r\n      type,\r\n      id: `name_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\r\n    };\r\n  }\r\n\r\n  // Personality Test System\r\n  getPersonalityQuestion() {\r\n    const questions = [\r\n      {\r\n        question: \"How do you prefer to spend your free time?\",\r\n        options: [\"Reading or learning\", \"Socializing with friends\", \"Creating art or music\", \"Playing sports or games\"],\r\n        traits: [\"intellectual\", \"social\", \"creative\", \"active\"]\r\n      },\r\n      {\r\n        question: \"What's your ideal vacation?\",\r\n        options: [\"Cultural city tour\", \"Beach relaxation\", \"Adventure trip\", \"Staycation at home\"],\r\n        traits: [\"cultural\", \"relaxed\", \"adventurous\", \"homebody\"]\r\n      },\r\n      {\r\n        question: \"How do you make decisions?\",\r\n        options: [\"Based on logic and facts\", \"Based on feelings and values\", \"After consulting others\", \"Spontaneously\"],\r\n        traits: [\"logical\", \"emotional\", \"collaborative\", \"spontaneous\"]\r\n      }\r\n    ];\r\n\r\n    return questions[Math.floor(Math.random() * questions.length)];\r\n  }\r\n\r\n  // Content retrieval for sharing\r\n  getContentForSharing(contentId) {\r\n    // Check cache first\r\n    if (this.contentCache.has(contentId)) {\r\n      return this.contentCache.get(contentId);\r\n    }\r\n\r\n    // For now, content is generated on-demand and not persistently stored\r\n    // In a real implementation, you might store recent content in the JSON file\r\n    return null;\r\n  }\r\n\r\n  // Store content for potential sharing (recently generated content)\r\n  storeContentForSharing(content) {\r\n    if (this.contentCache.size >= this.MAX_CACHE_SIZE) {\r\n      // Remove oldest entry\r\n      const firstKey = this.contentCache.keys().next().value;\r\n      this.contentCache.delete(firstKey);\r\n    }\r\n\r\n    this.contentCache.set(content.id, {\r\n      ...content,\r\n      timestamp: Date.now()\r\n    });\r\n  }\r\n\r\n  // Fun Statistics\r\n  getEntertainmentStats(userId) {\r\n    return this.entertainmentData.funStats[userId] || {\r\n      jokesHeard: 0,\r\n      riddlesSolved: 0,\r\n      storiesGenerated: 0,\r\n      factsLearned: 0,\r\n      gamesPlayed: 0\r\n    };\r\n  }\r\n\r\n  updateEntertainmentStats(userId, activity) {\r\n    if (!this.entertainmentData.funStats[userId]) {\r\n      this.entertainmentData.funStats[userId] = {\r\n        jokesHeard: 0,\r\n        riddlesSolved: 0,\r\n        storiesGenerated: 0,\r\n        factsLearned: 0,\r\n        gamesPlayed: 0\r\n      };\r\n    }\r\n\r\n    if (this.entertainmentData.funStats[userId][activity] !== undefined) {\r\n      this.entertainmentData.funStats[userId][activity]++;\r\n    }\r\n\r\n    this.saveEntertainment();\r\n    return this.entertainmentData.funStats[userId];\r\n  }\r\n\r\n  // Advanced Features\r\n  createFunChallenge(type = 'daily') {\r\n    const challenges = {\r\n      daily: [\r\n        \"Tell 5 jokes to different people today!\",\r\n        \"Learn 3 new fun facts and share them!\",\r\n        \"Create an original story with your friends!\",\r\n        \"Solve 5 riddles or brain teasers!\",\r\n        \"Try 3 different types of games!\"\r\n      ],\r\n      weekly: [\r\n        \"Complete 10 different achievements!\",\r\n        \"Try every game mode available!\",\r\n        \"Create and share 5 original jokes!\",\r\n        \"Reach level 10 in the RPG system!\",\r\n        \"Build the ultimate trading empire!\"\r\n      ],\r\n      monthly: [\r\n        \"Become a guild leader!\",\r\n        \"Master all game difficulties!\",\r\n        \"Build a business empire!\",\r\n        \"Complete 50 achievements!\",\r\n        \"Become a legendary trader!\"\r\n      ]\r\n    };\r\n\r\n    const typeChallenges = challenges[type] || challenges.daily;\r\n    const challenge = typeChallenges[Math.floor(Math.random() * typeChallenges.length)];\r\n\r\n    return {\r\n      challenge,\r\n      type,\r\n      id: `challenge_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      reward: this.getChallengeReward(type)\r\n    };\r\n  }\r\n\r\n  getChallengeReward(type) {\r\n    const rewards = {\r\n      daily: \"50 bonus achievement points\",\r\n      weekly: \"Special badge + 200 points\",\r\n      monthly: \"Exclusive title + 500 points + Special role\"\r\n    };\r\n\r\n    return rewards[type] || rewards.daily;\r\n  }\r\n\r\n  // Fun Leaderboard\r\n  getFunLeaderboard(category = 'jokes', limit = 10) {\r\n    const stats = [];\r\n\r\n    for (const [userId, userStats] of Object.entries(this.entertainmentData.funStats)) {\r\n      const score = userStats[category] || 0;\r\n      if (score > 0) {\r\n        stats.push({ userId, score });\r\n      }\r\n    }\r\n\r\n    return stats\r\n      .sort((a, b) => b.score - a.score)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // Cleanup and Maintenance\r\n  cleanup() {\r\n    // Clean old joke ratings\r\n    const cutoffTime = Date.now() - (30 * 24 * 60 * 60 * 1000); // 30 days\r\n\r\n    for (const jokeId in this.entertainmentData.jokeRatings) {\r\n      this.entertainmentData.jokeRatings[jokeId] = this.entertainmentData.jokeRatings[jokeId]\r\n        .filter(rating => rating.timestamp > cutoffTime);\r\n    }\r\n\r\n    this.saveEntertainment();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const entertainmentManager = new EntertainmentManager();\r\n\r\n// Convenience functions\r\nexport function getRandomJoke(category = 'general') {\r\n  return entertainmentManager.getRandomJoke(category);\r\n}\r\n\r\nexport function generateStory(prompt, genre = 'fantasy') {\r\n  return entertainmentManager.generateStory(prompt, genre);\r\n}\r\n\r\nexport function getRiddle(difficulty = 'medium') {\r\n  return entertainmentManager.getRiddle(difficulty);\r\n}\r\n\r\nexport function getFunFact(category = 'random') {\r\n  return entertainmentManager.getFunFact(category);\r\n}\r\n\r\nexport function getRandomQuote(category = 'inspirational') {\r\n  return entertainmentManager.getRandomQuote(category);\r\n}\r\n\r\nexport function magic8Ball(question) {\r\n  return entertainmentManager.magic8Ball(question);\r\n}\r\n\r\nexport function generateFunName(type = 'superhero') {\r\n  return entertainmentManager.generateFunName(type);\r\n}\r\n\r\nexport function getPersonalityQuestion() {\r\n  return entertainmentManager.getPersonalityQuestion();\r\n}\r\n\r\nexport function updateEntertainmentStats(userId, activity) {\r\n  return entertainmentManager.updateEntertainmentStats(userId, activity);\r\n}\r\n\r\nexport function getEntertainmentStats(userId) {\r\n  return entertainmentManager.getEntertainmentStats(userId);\r\n}\r\n\r\nexport function createFunChallenge(type = 'daily') {\r\n  return entertainmentManager.createFunChallenge(type);\r\n}\r\n\r\nexport function getFunLeaderboard(category = 'jokes', limit = 10) {\r\n  return entertainmentManager.getFunLeaderboard(category, limit);\r\n}\r\n\r\nexport function getContentForSharing(contentId) {\r\n  return entertainmentManager.getContentForSharing(contentId);\r\n}\r\n\r\nexport function rateJoke(jokeId, rating) {\r\n  return entertainmentManager.rateJoke(jokeId, rating);\r\n}\r\n\r\n// Auto-cleanup every hour\r\nsetInterval(() => {\r\n  entertainmentManager.cleanup();\r\n}, 60 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\errorHandler.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":101,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":101,"endColumn":4,"fix":{"range":[3925,3925],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":103,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":103,"endColumn":17,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[3999,4102],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'handleCommandError' has too many lines (124). Maximum allowed is 50.","line":108,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":231,"endColumn":3},{"ruleId":"max-statements","severity":1,"message":"Async function 'handleCommandError' has too many statements (41). Maximum allowed is 30.","line":108,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":231,"endColumn":3},{"ruleId":"complexity","severity":2,"message":"Async function 'handleCommandError' has a complexity of 17. Maximum allowed is 10.","line":108,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":231,"endColumn":3},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 20 to the 15 allowed.","line":108,"column":23,"nodeType":null,"messageId":"refactorFunction","endLine":108,"endColumn":41},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":109,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":109,"endColumn":4,"fix":{"range":[4210,4213],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":111,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":111,"endColumn":4,"fix":{"range":[4255,4258],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":112,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":112,"endColumn":4,"fix":{"range":[4317,4320],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":113,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":113,"endColumn":6,"fix":{"range":[4389,4394],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":113,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":113,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4394,4499],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":114,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":114,"endColumn":6,"fix":{"range":[4501,4506],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":115,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":115,"endColumn":8,"fix":{"range":[4614,4621],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":116,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":116,"endColumn":8,"fix":{"range":[4665,4672],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":117,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":117,"endColumn":8,"fix":{"range":[4703,4710],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":118,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":118,"endColumn":6,"fix":{"range":[4725,4730],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":119,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":119,"endColumn":6,"fix":{"range":[4735,4740],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":120,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":120,"endColumn":4,"fix":{"range":[4749,4752],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":122,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":122,"endColumn":4,"fix":{"range":[4757,4760],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":123,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":123,"endColumn":4,"fix":{"range":[4806,4809],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":124,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":124,"endColumn":6,"fix":{"range":[4854,4859],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":125,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":125,"endColumn":6,"fix":{"range":[4895,4900],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":126,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":126,"endColumn":6,"fix":{"range":[4930,4935],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":127,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":127,"endColumn":6,"fix":{"range":[4967,4972],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":128,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":128,"endColumn":6,"fix":{"range":[4991,4996],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":129,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":129,"endColumn":6,"fix":{"range":[5021,5026],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":130,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":130,"endColumn":4,"fix":{"range":[5038,5041],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":132,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":132,"endColumn":4,"fix":{"range":[5048,5051],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":133,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":133,"endColumn":4,"fix":{"range":[5099,5102],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":135,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":135,"endColumn":4,"fix":{"range":[5159,5162],"text":"  "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 134. Maximum allowed is 120.","line":136,"column":1,"nodeType":"Program","messageId":"max","endLine":136,"endColumn":135},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":136,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":136,"endColumn":6,"fix":{"range":[5209,5214],"text":"    "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":136,"column":124,"nodeType":"Literal","messageId":"error","endLine":136,"endColumn":128,"suggestions":[{"messageId":"replace","fix":{"range":[5332,5336],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":137,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":137,"endColumn":4,"fix":{"range":[5345,5348],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":139,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":139,"endColumn":4,"fix":{"range":[5353,5356],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":140,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":140,"endColumn":6,"fix":{"range":[5383,5388],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":141,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":141,"endColumn":6,"fix":{"range":[5411,5416],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":142,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":142,"endColumn":4,"fix":{"range":[5433,5436],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":144,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":144,"endColumn":4,"fix":{"range":[5442,5445],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":145,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":145,"endColumn":4,"fix":{"range":[5485,5488],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":146,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":146,"endColumn":6,"fix":{"range":[5505,5510],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":147,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":147,"endColumn":6,"fix":{"range":[5596,5601],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":148,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":148,"endColumn":6,"fix":{"range":[5673,5678],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":149,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":149,"endColumn":6,"fix":{"range":[5752,5757],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":150,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":150,"endColumn":4,"fix":{"range":[5842,5845],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":152,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":152,"endColumn":4,"fix":{"range":[5851,5854],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":153,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":153,"endColumn":6,"fix":{"range":[5880,5885],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":154,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":154,"endColumn":4,"fix":{"range":[5932,5935],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":156,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":156,"endColumn":4,"fix":{"range":[5940,5943],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":157,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":157,"endColumn":4,"fix":{"range":[6029,6032],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":158,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":158,"endColumn":6,"fix":{"range":[6039,6044],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":158,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":158,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6044,6118],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":159,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":159,"endColumn":6,"fix":{"range":[6120,6125],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":159,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":159,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6125,6399],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":160,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":160,"endColumn":8,"fix":{"range":[6203,6210],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":161,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":161,"endColumn":8,"fix":{"range":[6232,6239],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":162,"endColumn":8,"fix":{"range":[6271,6278],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":163,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":163,"endColumn":8,"fix":{"range":[6312,6319],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":164,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":164,"endColumn":8,"fix":{"range":[6345,6352],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":165,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":165,"endColumn":6,"fix":{"range":[6391,6396],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":167,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":167,"endColumn":6,"fix":{"range":[6403,6408],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":168,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":168,"endColumn":6,"fix":{"range":[6479,6484],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":169,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":169,"endColumn":8,"fix":{"range":[6553,6560],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":170,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":170,"endColumn":10,"fix":{"range":[6567,6576],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":170,"column":10,"nodeType":"MemberExpression","messageId":"unexpected","endLine":170,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6576,6628],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":171,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":171,"endColumn":10,"fix":{"range":[6630,6639],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":172,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":172,"endColumn":10,"fix":{"range":[6682,6691],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":173,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":173,"endColumn":8,"fix":{"range":[6700,6707],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":173,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":173,"endColumn":9,"fix":{"range":[6708,6708],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":174,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":174,"endColumn":10,"fix":{"range":[6731,6740],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":174,"column":34,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":174,"endColumn":39,"fix":{"range":[6764,6769],"text":"10_062"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":175,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":175,"endColumn":12,"fix":{"range":[6774,6785],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":175,"column":12,"nodeType":"MemberExpression","messageId":"unexpected","endLine":175,"endColumn":25,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[6785,6889],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":176,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":176,"endColumn":12,"fix":{"range":[6891,6902],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":177,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":177,"endColumn":14,"fix":{"range":[6978,6991],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":178,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":178,"endColumn":14,"fix":{"range":[7035,7048],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":179,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":179,"endColumn":14,"fix":{"range":[7079,7092],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":180,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":180,"endColumn":12,"fix":{"range":[7124,7135],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":181,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":181,"endColumn":12,"fix":{"range":[7140,7151],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":182,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":182,"endColumn":10,"fix":{"range":[7160,7169],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":183,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":183,"endColumn":10,"fix":{"range":[7172,7181],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":184,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":184,"endColumn":8,"fix":{"range":[7225,7232],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":185,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":185,"endColumn":6,"fix":{"range":[7235,7240],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":185,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":185,"endColumn":7,"fix":{"range":[7241,7241],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":186,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":186,"endColumn":8,"fix":{"range":[7316,7323],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":187,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":187,"endColumn":10,"fix":{"range":[7330,7339],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":187,"column":10,"nodeType":"MemberExpression","messageId":"unexpected","endLine":187,"endColumn":23,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7339,7394],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":188,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":188,"endColumn":10,"fix":{"range":[7396,7405],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":189,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":189,"endColumn":10,"fix":{"range":[7451,7460],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":190,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":190,"endColumn":8,"fix":{"range":[7469,7476],"text":"      "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":190,"column":8,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":190,"endColumn":9,"fix":{"range":[7477,7477],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":191,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":191,"endColumn":10,"fix":{"range":[7503,7512],"text":"        "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":191,"column":37,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":191,"endColumn":42,"fix":{"range":[7539,7544],"text":"10_062"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":192,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":192,"endColumn":12,"fix":{"range":[7549,7560],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":192,"column":12,"nodeType":"MemberExpression","messageId":"unexpected","endLine":192,"endColumn":25,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7560,7665],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":193,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":193,"endColumn":12,"fix":{"range":[7667,7678],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":194,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":194,"endColumn":14,"fix":{"range":[7766,7779],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":195,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":195,"endColumn":14,"fix":{"range":[7823,7836],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":196,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":196,"endColumn":14,"fix":{"range":[7867,7880],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":197,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":197,"endColumn":12,"fix":{"range":[7912,7923],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":198,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":198,"endColumn":12,"fix":{"range":[7928,7939],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":199,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":199,"endColumn":10,"fix":{"range":[7948,7957],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":200,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":200,"endColumn":10,"fix":{"range":[7960,7969],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":201,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":201,"endColumn":8,"fix":{"range":[8016,8023],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":202,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":202,"endColumn":6,"fix":{"range":[8026,8031],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":202,"column":6,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":202,"endColumn":7,"fix":{"range":[8032,8032],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":8,"fix":{"range":[8041,8048],"text":"      "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":203,"column":8,"nodeType":"MemberExpression","messageId":"unexpected","endLine":203,"endColumn":21,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8048,8134],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":204,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":204,"endColumn":8,"fix":{"range":[8136,8143],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":205,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":205,"endColumn":10,"fix":{"range":[8244,8253],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":206,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":206,"endColumn":10,"fix":{"range":[8297,8306],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":207,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":207,"endColumn":10,"fix":{"range":[8337,8346],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":208,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":208,"endColumn":10,"fix":{"range":[8379,8388],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":209,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":209,"endColumn":8,"fix":{"range":[8422,8429],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":210,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":210,"endColumn":8,"fix":{"range":[8434,8441],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":211,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":211,"endColumn":6,"fix":{"range":[8450,8455],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":212,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":212,"endColumn":4,"fix":{"range":[8458,8461],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":212,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":212,"endColumn":5,"fix":{"range":[8462,8462],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":213,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":213,"endColumn":6,"fix":{"range":[8488,8493],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":213,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":213,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8493,8587],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":214,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":214,"endColumn":6,"fix":{"range":[8589,8594],"text":"    "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":214,"column":6,"nodeType":"MemberExpression","messageId":"unexpected","endLine":214,"endColumn":19,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8594,8867],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":215,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":215,"endColumn":8,"fix":{"range":[8661,8668],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":216,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":216,"endColumn":8,"fix":{"range":[8707,8714],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":217,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":217,"endColumn":8,"fix":{"range":[8743,8750],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":218,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":218,"endColumn":8,"fix":{"range":[8783,8790],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":219,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":219,"endColumn":8,"fix":{"range":[8821,8828],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":220,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":220,"endColumn":6,"fix":{"range":[8859,8864],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":222,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":222,"endColumn":6,"fix":{"range":[8871,8876],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":223,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":223,"endColumn":6,"fix":{"range":[8987,8992],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":224,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":224,"endColumn":8,"fix":{"range":[9060,9067],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":225,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":225,"endColumn":8,"fix":{"range":[9111,9118],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":226,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":226,"endColumn":8,"fix":{"range":[9149,9156],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":227,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":227,"endColumn":8,"fix":{"range":[9199,9206],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":228,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":228,"endColumn":8,"fix":{"range":[9251,9258],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":229,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":229,"endColumn":6,"fix":{"range":[9289,9294],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":230,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":230,"endColumn":4,"fix":{"range":[9299,9302],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 0 spaces but found 1.","line":231,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":231,"endColumn":2,"fix":{"range":[9305,9306],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":243,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":243,"endColumn":4,"fix":{"range":[9807,9807],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":245,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":245,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9885,9956],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":246,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":246,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9962,10028],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":247,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":247,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[10034,10286],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":257,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":257,"endColumn":6,"fix":{"range":[10399,10399],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (499). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":499,"endColumn":2},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":481,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":481,"endColumn":6,"fix":{"range":[17682,17682],"text":"\n"}}],"suppressedMessages":[],"errorCount":130,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":124,"fixableWarningCount":0,"source":"/**\r\n * Standardized error handling utilities for Discord bot commands.\r\n * Provides structured error handling, user-friendly messages, and validation helpers.\r\n */\r\n\r\nimport { logError } from './logger.js';\r\n\r\n/**\r\n * Circuit breaker configuration constants.\r\n */\r\nconst CIRCUIT_BREAKER_MAX_ATTEMPTS = 3;\r\nconst CIRCUIT_BREAKER_CLEANUP_TIME = 5 * 60 * 1000; // 5 minutes\r\n\r\n/**\r\n * Retry configuration defaults.\r\n */\r\nconst DEFAULT_MAX_RETRIES = 3;\r\nconst DEFAULT_RETRY_DELAY = 1000;\r\n\r\n/**\r\n * Error codes and their corresponding user-friendly messages.\r\n */\r\nconst ERROR_MESSAGES = {\r\n  COMMAND_ERROR: 'An error occurred while executing this command. Please try again.',\r\n  PERMISSION_DENIED: 'You do not have permission to use this command.',\r\n  INVALID_ARGUMENT: 'Invalid argument provided. Please check the command usage.',\r\n  COOLDOWN_ACTIVE: 'This command is on cooldown. Please wait before using it again.',\r\n  INSUFFICIENT_FUNDS: 'You do not have enough funds to perform this action.',\r\n  USER_NOT_FOUND: 'The specified user was not found.',\r\n  CHANNEL_NOT_FOUND: 'The specified channel was not found.',\r\n  ROLE_NOT_FOUND: 'The specified role was not found.',\r\n  GUILD_ONLY: 'This command can only be used in a server.',\r\n  DM_ONLY: 'This command can only be used in direct messages.',\r\n  MISSING_PERMISSIONS: 'I am missing the required permissions to execute this command.',\r\n  API_ERROR: 'External service is currently unavailable. Please try again later.',\r\n  RATE_LIMITED: 'Too many requests. Please slow down and try again.',\r\n  INVALID_FORMAT: 'Invalid format. Please check the required format for this command.',\r\n  OUT_OF_RANGE: 'Value is out of the allowed range.',\r\n  ALREADY_EXISTS: 'This item already exists.',\r\n  NOT_FOUND: 'The requested item was not found.',\r\n  NETWORK_ERROR: 'Network error occurred. Please check your connection and try again.',\r\n  UNKNOWN_ERROR: 'An unknown error occurred. Please contact support if this persists.'\r\n};\r\n\r\n/**\r\n * Custom error class for command-related errors.\r\n */\r\nexport class CommandError extends Error {\r\n  /**\r\n   * Creates a new CommandError instance.\r\n   * @param {string} message - Error message\r\n   * @param {string} code - Error code from ERROR_MESSAGES\r\n   * @param {object} details - Additional error details\r\n   */\r\n  constructor(message, code = 'COMMAND_ERROR', details = {}) {\r\n    super(message);\r\n    this.name = 'CommandError';\r\n    this.code = code;\r\n    this.details = details;\r\n    this.userMessage = this.getUserFriendlyMessage();\r\n  }\r\n\r\n  /**\r\n   * Gets a user-friendly message for the error code.\r\n   * @returns {string} User-friendly error message\r\n   */\r\n  getUserFriendlyMessage() {\r\n    return ERROR_MESSAGES[this.code] || ERROR_MESSAGES.COMMAND_ERROR;\r\n  }\r\n}\r\n\r\n/**\r\n * Handles command errors by logging and responding to the user.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {CommandError|Error} error - The error that occurred\r\n * @param {object} context - Additional context for logging\r\n * @returns {Promise} Promise resolving to the interaction response\r\n */\r\n/**\r\n * Circuit breaker check imported from interactionHandlers.js\r\n * This prevents recursive error handling loops.\r\n * @param {string} interactionId - The interaction identifier\r\n * @returns {boolean} True if operation can proceed, false if circuit is broken\r\n */\r\nasync function checkCircuitBreaker(interactionId) {\r\n  try {\r\n    // Dynamic import to avoid circular dependencies\r\n    const { circuitBreakerMap } = await import('./interactionHandlers.js');\r\n    const circuitData = circuitBreakerMap.get(interactionId);\r\n    if (!circuitData) return true;\r\n\r\n    const { attempts, lastAttempt } = circuitData;\r\n    const now = Date.now();\r\n\r\n    if (now - lastAttempt > CIRCUIT_BREAKER_CLEANUP_TIME) {\r\n      circuitBreakerMap.delete(interactionId);\r\n      return true;\r\n    }\r\n\r\n    return attempts < CIRCUIT_BREAKER_MAX_ATTEMPTS;\r\n  } catch (error) {\r\n    // If import fails, allow operation to proceed\r\n    console.warn('[CIRCUIT_BREAKER] Failed to access circuit breaker, allowing operation:', error.message);\r\n    return true;\r\n  }\r\n}\r\n\r\nexport async function handleCommandError(interaction, error, context = {}) {\r\n   const interactionId = interaction?.id;\r\n\r\n   // Check circuit breaker before attempting error response\r\n   if (interactionId && !(await checkCircuitBreaker(interactionId))) {\r\n     console.error('[HANDLE_COMMAND_ERROR] Circuit breaker tripped for interaction, skipping error response');\r\n     logError('Circuit breaker tripped - cannot send error response', new Error('Circuit breaker activated'), {\r\n       originalCommand: interaction?.commandName,\r\n       originalError: error.message,\r\n       interactionId\r\n     });\r\n     return;\r\n   }\r\n\r\n   // Log the error with structured information\r\n   logError('Command error occurred', error, {\r\n     command: interaction?.commandName,\r\n     user: interaction?.user?.id,\r\n     guild: interaction?.guild?.id,\r\n     code: error.code,\r\n     details: error.details,\r\n     ...context\r\n   });\r\n\r\n   // Determine user message based on environment\r\n   let userMessage = error.userMessage || error.message;\r\n\r\n   if (process.env.NODE_ENV === 'development') {\r\n     userMessage = `‚ùå **Error:** ${error.message}\\n\\n**Code:** ${error.code}\\n**Details:** ${JSON.stringify(error.details, null, 2)}`;\r\n   }\r\n\r\n   const responseOptions = {\r\n     content: userMessage,\r\n     ephemeral: true\r\n   };\r\n\r\n   // Add helpful hints for common errors\r\n   const hints = {\r\n     PERMISSION_DENIED: '\\n\\nüí° *Make sure you have the required permissions or roles.*',\r\n     COOLDOWN_ACTIVE: '\\n\\nüí° *You can use other commands while waiting.*',\r\n     INVALID_ARGUMENT: '\\n\\nüí° *Use `/help` for command usage information.*',\r\n     INSUFFICIENT_FUNDS: '\\n\\nüí° *Earn more gold through work, businesses, or trading.*'\r\n   };\r\n\r\n   if (hints[error.code]) {\r\n     responseOptions.content += hints[error.code];\r\n   }\r\n\r\n   // Send appropriate response based on interaction state with enhanced error handling\r\n   try {\r\n     console.error('[HANDLE_COMMAND_ERROR] Attempting to send error response');\r\n     console.error('[HANDLE_COMMAND_ERROR] Interaction state before response:', {\r\n       id: interaction?.id,\r\n       replied: interaction?.replied,\r\n       deferred: interaction?.deferred,\r\n       type: interaction?.type,\r\n       commandName: interaction?.commandName\r\n     });\r\n\r\n     // Check for DiscordAPIError[10062]: Unknown interaction specifically\r\n     if (interaction && !interaction.replied && !interaction.deferred) {\r\n       try {\r\n         console.error('[HANDLE_COMMAND_ERROR] Using reply');\r\n         await interaction.reply(responseOptions);\r\n         return;\r\n       } catch (replyError) {\r\n         if (replyError.code === 10062) {\r\n           console.error('[HANDLE_COMMAND_ERROR] Interaction already expired/replied, cannot send error response');\r\n           logError('Cannot send error response - interaction expired', replyError, {\r\n             originalCommand: interaction?.commandName,\r\n             originalError: error.message,\r\n             interactionId: interaction?.id\r\n           });\r\n           return;\r\n         }\r\n         throw replyError; // Re-throw other errors\r\n       }\r\n     } else if (interaction && (interaction.replied || interaction.deferred)) {\r\n       try {\r\n         console.error('[HANDLE_COMMAND_ERROR] Using followUp');\r\n         await interaction.followUp(responseOptions);\r\n         return;\r\n       } catch (followUpError) {\r\n         if (followUpError.code === 10062) {\r\n           console.error('[HANDLE_COMMAND_ERROR] Interaction already expired, cannot send followUp error response');\r\n           logError('Cannot send followUp error response - interaction expired', followUpError, {\r\n             originalCommand: interaction?.commandName,\r\n             originalError: error.message,\r\n             interactionId: interaction?.id\r\n           });\r\n           return;\r\n         }\r\n         throw followUpError; // Re-throw other errors\r\n       }\r\n     } else {\r\n       console.error('[HANDLE_COMMAND_ERROR] Interaction object invalid or already handled');\r\n       logError('Invalid interaction state for error response', new Error('Invalid interaction object'), {\r\n         originalCommand: interaction?.commandName,\r\n         originalError: error.message,\r\n         interactionId: interaction?.id,\r\n         interactionExists: !!interaction\r\n       });\r\n       return;\r\n     }\r\n   } catch (responseError) {\r\n     console.error('[HANDLE_COMMAND_ERROR] Failed to send error response:', responseError.message);\r\n     console.error('[HANDLE_COMMAND_ERROR] Response error details:', {\r\n       responseError: responseError.message,\r\n       stack: responseError.stack,\r\n       interactionId: interaction?.id,\r\n       originalError: error.message,\r\n       errorCode: responseError.code\r\n     });\r\n\r\n     // If we can't send a response, log it and continue - don't attempt to log error response failure recursively\r\n     logError('Failed to send error response to user', responseError, {\r\n       originalCommand: interaction?.commandName,\r\n       originalError: error.message,\r\n       interactionReplied: interaction?.replied,\r\n       interactionDeferred: interaction?.deferred,\r\n       errorCode: responseError.code\r\n     });\r\n   }\r\n }\r\n\r\n/**\r\n * Safely executes a command function with error handling.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {Function} commandFunction - The command function to execute\r\n * @param {object} context - Additional context for error handling\r\n * @returns {Promise} Promise resolving to command result or error response\r\n */\r\nexport async function safeExecuteCommand(interaction, commandFunction, context = {}) {\r\n  try {\r\n    return await commandFunction(interaction);\r\n  } catch (error) {\r\n    // Log immediately before any interaction attempts\r\n    console.error('[SAFE_EXECUTE_COMMAND] Error occurred:', error.message);\r\n    console.error('[SAFE_EXECUTE_COMMAND] Error stack:', error.stack);\r\n    console.error('[SAFE_EXECUTE_COMMAND] Interaction state:', {\r\n      id: interaction?.id,\r\n      replied: interaction?.replied,\r\n      deferred: interaction?.deferred,\r\n      type: interaction?.type,\r\n      commandName: interaction?.commandName\r\n    });\r\n\r\n    if (error instanceof CommandError) {\r\n      await handleCommandError(interaction, error, context);\r\n    } else {\r\n      // Wrap unknown errors in CommandError for consistency\r\n      const commandError = new CommandError(\r\n        error.message || 'Unknown error occurred',\r\n        'UNKNOWN_ERROR',\r\n        { originalError: error.message, stack: error.stack }\r\n      );\r\n      await handleCommandError(interaction, commandError, context);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Validation helpers for common Discord entities and values.\r\n */\r\n\r\n/**\r\n * Validates and retrieves a user by ID.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {string} userId - User ID to validate\r\n * @returns {object} Discord user object\r\n * @throws {CommandError} If user is not found or ID is invalid\r\n */\r\nexport function validateUser(interaction, userId) {\r\n  if (!userId) {\r\n    throw new CommandError('User ID is required.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  const user = interaction.client.users.cache.get(userId) ||\r\n                interaction.guild?.members.cache.get(userId)?.user;\r\n\r\n  if (!user) {\r\n    throw new CommandError('User not found.', 'USER_NOT_FOUND');\r\n  }\r\n\r\n  return user;\r\n}\r\n\r\n/**\r\n * Validates and retrieves a channel by ID.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {string} channelId - Channel ID to validate\r\n * @returns {object} Discord channel object\r\n * @throws {CommandError} If channel is not found or ID is invalid\r\n */\r\nexport function validateChannel(interaction, channelId) {\r\n  if (!channelId) {\r\n    throw new CommandError('Channel ID is required.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  const channel = interaction.client.channels.cache.get(channelId) ||\r\n                   interaction.guild?.channels.cache.get(channelId);\r\n\r\n  if (!channel) {\r\n    throw new CommandError('Channel not found.', 'CHANNEL_NOT_FOUND');\r\n  }\r\n\r\n  return channel;\r\n}\r\n\r\n/**\r\n * Validates and retrieves a role by ID.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {string} roleId - Role ID to validate\r\n * @returns {object} Discord role object\r\n * @throws {CommandError} If role is not found or ID is invalid\r\n */\r\nexport function validateRole(interaction, roleId) {\r\n  if (!roleId) {\r\n    throw new CommandError('Role ID is required.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  const role = interaction.guild?.roles.cache.get(roleId);\r\n\r\n  if (!role) {\r\n    throw new CommandError('Role not found.', 'ROLE_NOT_FOUND');\r\n  }\r\n\r\n  return role;\r\n}\r\n\r\n/**\r\n * Validates that the command is being used in a guild.\r\n * @param {object} interaction - Discord interaction object\r\n * @returns {object} Discord guild object\r\n * @throws {CommandError} If command is not used in a guild\r\n */\r\nexport function validateGuild(interaction) {\r\n  if (!interaction.guild) {\r\n    throw new CommandError('This command can only be used in a server.', 'GUILD_ONLY');\r\n  }\r\n\r\n  return interaction.guild;\r\n}\r\n\r\n/**\r\n * Validates that the user has the required permissions.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {Array<string>} permissions - Array of permission strings\r\n * @throws {CommandError} If user lacks required permissions\r\n */\r\nexport function validatePermissions(interaction, permissions) {\r\n  if (!interaction.member) {\r\n    throw new CommandError('Unable to verify permissions.', 'PERMISSION_DENIED');\r\n  }\r\n\r\n  const missingPermissions = permissions.filter(perm =>\r\n    !interaction.member.permissions.has(perm)\r\n  );\r\n\r\n  if (missingPermissions.length > 0) {\r\n    throw new CommandError(\r\n      `Missing permissions: ${missingPermissions.join(', ')}`,\r\n      'PERMISSION_DENIED',\r\n      { required: permissions, missing: missingPermissions }\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Validates that a value is within a specified range.\r\n * @param {number} value - Value to validate\r\n * @param {number} min - Minimum allowed value\r\n * @param {number} max - Maximum allowed value\r\n * @param {string} fieldName - Name of the field for error messages\r\n * @returns {number} The validated value\r\n * @throws {CommandError} If value is out of range\r\n */\r\nexport function validateRange(value, min, max, fieldName = 'value') {\r\n  if (value < min || value > max) {\r\n    throw new CommandError(\r\n      `${fieldName} must be between ${min} and ${max}.`,\r\n      'OUT_OF_RANGE',\r\n      { value, min, max }\r\n    );\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\n/**\r\n * Validates that a value is not empty.\r\n * @param {any} value - Value to validate\r\n * @param {string} fieldName - Name of the field for error messages\r\n * @returns {any} The validated value\r\n * @throws {CommandError} If value is empty\r\n */\r\nexport function validateNotEmpty(value, fieldName = 'field') {\r\n  if (!value || (typeof value === 'string' && value.trim() === '')) {\r\n    throw new CommandError(`${fieldName} cannot be empty.`, 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\n/**\r\n * Rate limiting helper for controlling request frequency.\r\n * @param {number} points - Number of requests allowed\r\n * @param {number} duration - Time window in milliseconds\r\n * @param {Function} keyGenerator - Optional function to generate keys\r\n * @returns {object} Rate limiter object with consume method\r\n */\r\nexport function createRateLimiter(points, duration, keyGenerator) {\r\n  const requests = new Map();\r\n\r\n  return {\r\n    /**\r\n     * Consumes a request point for the given key.\r\n     * @param {string} key - Identifier for rate limiting\r\n     * @throws {CommandError} If rate limit is exceeded\r\n     */\r\n    async consume(key) {\r\n      const now = Date.now();\r\n      const userKey = keyGenerator ? keyGenerator(key) : key;\r\n      const userRequests = requests.get(userKey) || [];\r\n\r\n      // Remove requests outside the current time window\r\n      const validRequests = userRequests.filter(time => now - time < duration);\r\n\r\n      if (validRequests.length >= points) {\r\n        const resetTime = validRequests[0] + duration;\r\n        throw new CommandError(\r\n          'Rate limit exceeded. Please slow down.',\r\n          'RATE_LIMITED',\r\n          {\r\n            points,\r\n            duration,\r\n            remaining: Math.ceil((resetTime - now) / 1000)\r\n          }\r\n        );\r\n      }\r\n\r\n      validRequests.push(now);\r\n      requests.set(userKey, validRequests);\r\n\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Retry helper for async operations with exponential backoff.\r\n * @param {Function} operation - Async function to retry\r\n * @param {number} [maxRetries=DEFAULT_MAX_RETRIES] - Maximum number of retry attempts\r\n * @param {number} [delay=DEFAULT_RETRY_DELAY] - Base delay between retries in milliseconds\r\n * @returns {Promise} Promise resolving to operation result\r\n * @throws {CommandError} If all retries are exhausted\r\n */\r\nexport async function retryAsync(operation, maxRetries = DEFAULT_MAX_RETRIES, delay = DEFAULT_RETRY_DELAY) {\r\n  if (typeof operation !== 'function') {\r\n    throw new CommandError('Operation must be a function.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  if (!Number.isInteger(maxRetries) || maxRetries < 0) {\r\n    throw new CommandError('maxRetries must be a non-negative integer.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  if (!Number.isFinite(delay) || delay < 0) {\r\n    throw new CommandError('delay must be a non-negative number.', 'INVALID_ARGUMENT');\r\n  }\r\n\r\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n    try {\r\n      return await operation();\r\n    } catch (error) {\r\n      if (attempt === maxRetries) {\r\n        throw new CommandError(\r\n          `Operation failed after ${maxRetries} attempts: ${error.message}`,\r\n          'API_ERROR',\r\n          { originalError: error.message, attempts: maxRetries }\r\n        );\r\n      }\r\n\r\n      // Log retry attempt using logger instead of console.log\r\n      logError(`Retry attempt ${attempt} failed, retrying in ${delay * attempt}ms`, error, {\r\n        attempt,\r\n        maxRetries,\r\n        delay: delay * attempt\r\n      });\r\n      await new Promise(resolve => setTimeout(resolve, delay * attempt));\r\n    }\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\game-states.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `gameStates.js` or `GameStates.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Game state storage - shared between main bot and command files\r\n// This breaks circular dependencies by providing a separate module\r\n\r\n// Hangman game states: userId -> gameState\r\nexport const hangmanGames = new Map();\r\n\r\n// Wordle game states: userId -> gameState\r\nexport const wordleGames = new Map();\r\n\r\n// Guess game states: userId -> gameState\r\nexport const guessGames = new Map();\r\n\r\n// Combat game states: userId -> gameState\r\nexport const combatGames = new Map();\r\n\r\n// Exploration game states: userId -> gameState\r\nexport const explorationGames = new Map();\r\n\r\n// Connect4 game states: gameId -> gameState\r\nexport const connect4Games = new Map();\r\n\r\n// Typing game attempts for minigame\r\n// Trivia game states: gameId -> gameState\r\nexport const triviaGames = new Map();\r\n\r\n// Tic-Tac-Toe game states: gameId -> gameState\r\nexport const tttGames = new Map();\r\n\r\n// Poll game states: messageId -> pollData\r\nexport const pollGames = new Map();\r\n\r\n// Memory game states: messageId -> gameState\r\nexport const memoryGames = new Map();\r\n\r\n// Typing game attempts for minigame\r\nexport const typingAttempts = new Map();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\guilds.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":25,"column":60,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":25,"endColumn":66,"fix":{"range":[617,625],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":27,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":27,"endColumn":6,"fix":{"range":[662,662],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":28,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":28,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[686,733],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":35,"column":65,"nodeType":"Literal","messageId":"error","endLine":35,"endColumn":69,"suggestions":[{"messageId":"replace","fix":{"range":[867,871],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":36,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":36,"endColumn":6,"fix":{"range":[884,884],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[908,955],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":43,"column":9,"nodeType":"MemberExpression","endLine":43,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":68,"column":5,"nodeType":"MemberExpression","endLine":68,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":74,"column":19,"nodeType":"MemberExpression","endLine":74,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":77,"column":9,"nodeType":"MemberExpression","endLine":77,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":82,"column":5,"nodeType":"MemberExpression","endLine":82,"endColumn":26},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":95,"column":19,"nodeType":"MemberExpression","endLine":95,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":97,"column":10,"nodeType":"MemberExpression","endLine":97,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":100,"column":12,"nodeType":"MemberExpression","endLine":100,"endColumn":33},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":107,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":107,"endColumn":83,"fix":{"range":[2934,2945],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":119,"column":14,"nodeType":"Literal","messageId":"error","endLine":119,"endColumn":18,"suggestions":[{"messageId":"replace","fix":{"range":[3200,3204],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":126,"column":5,"nodeType":"MemberExpression","endLine":126,"endColumn":26},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":132,"column":19,"nodeType":"MemberExpression","endLine":132,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":135,"column":9,"nodeType":"MemberExpression","endLine":135,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":140,"column":5,"nodeType":"MemberExpression","endLine":140,"endColumn":26},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":150,"column":19,"nodeType":"MemberExpression","endLine":150,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":152,"column":10,"nodeType":"MemberExpression","endLine":152,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":154,"column":12,"nodeType":"MemberExpression","endLine":154,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":158,"column":14,"nodeType":"MemberExpression","endLine":158,"endColumn":35},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":159,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":159,"endColumn":6,"fix":{"range":[4468,4468],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":163,"column":7,"nodeType":"MemberExpression","endLine":163,"endColumn":31},{"ruleId":"sonarjs/prefer-immediate-return","severity":2,"message":"Immediately return this expression instead of assigning it to the temporary variable \"guildList\".","line":171,"column":23,"nodeType":"CallExpression","messageId":"doImmediateAction","endLine":184,"endColumn":23,"fix":{"range":[4820,5337],"text":"return Object.entries(this.guilds)\r\n      .map(([name, guild]) => ({\r\n        name,\r\n        level: guild.level,\r\n        memberCount: Object.keys(guild.members).length,\r\n        gold: guild.gold,\r\n        experience: guild.experience\r\n      }))\r\n      .sort((a, b) => {\r\n        if (b.level !== a.level) return b.level - a.level;\r\n        if (b.memberCount !== a.memberCount) return b.memberCount - a.memberCount;\r\n        return b.gold - a.gold;\r\n      })\r\n      .slice(0, limit)"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":11,"nodeType":"MemberExpression","endLine":191,"endColumn":32},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":195,"column":12,"nodeType":"Literal","messageId":"error","endLine":195,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[5546,5550],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[5546,5550],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":199,"column":31,"nodeType":"Literal","messageId":"error","endLine":199,"endColumn":35,"suggestions":[{"messageId":"remove","fix":{"range":[5616,5620],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[5616,5620],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":202,"column":11,"nodeType":"MemberExpression","endLine":202,"endColumn":32},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":206,"column":12,"nodeType":"Literal","messageId":"error","endLine":206,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[5795,5799],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[5795,5799],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":211,"column":19,"nodeType":"MemberExpression","endLine":211,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":213,"column":10,"nodeType":"MemberExpression","endLine":213,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":215,"column":20,"nodeType":"MemberExpression","endLine":215,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":242,"column":24,"nodeType":"MemberExpression","endLine":242,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":243,"column":20,"nodeType":"MemberExpression","endLine":243,"endColumn":44},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":261,"column":15,"nodeType":"Literal","messageId":"error","endLine":261,"endColumn":19,"suggestions":[{"messageId":"replace","fix":{"range":[7477,7481],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":265,"column":5,"nodeType":"MemberExpression","endLine":265,"endColumn":26},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (313). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":313,"endColumn":2}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":28,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst GUILDS_FILE = path.join(process.cwd(), 'data', 'guilds.json');\r\n\r\n// Guild and Party System for Multiplayer RPG\r\nclass GuildManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadGuilds();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(GUILDS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(GUILDS_FILE)) {\r\n      fs.writeFileSync(GUILDS_FILE, JSON.stringify({}));\r\n    }\r\n  }\r\n\r\n  loadGuilds() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(GUILDS_FILE, 'utf8'));\r\n      this.guilds = data;\r\n    } catch (error) {\r\n      console.error('Failed to load guilds:', error);\r\n      this.guilds = {};\r\n    }\r\n  }\r\n\r\n  saveGuilds() {\r\n    try {\r\n      fs.writeFileSync(GUILDS_FILE, JSON.stringify(this.guilds, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save guilds:', error);\r\n    }\r\n  }\r\n\r\n  // Guild Management Functions\r\n  createGuild(guildName, leaderId, leaderName) {\r\n    if (this.guilds[guildName]) {\r\n      return { success: false, reason: 'guild_name_taken' };\r\n    }\r\n\r\n    const guild = {\r\n      name: guildName,\r\n      leader: leaderId,\r\n      members: {\r\n        [leaderId]: {\r\n          name: leaderName,\r\n          role: 'leader',\r\n          joined: Date.now(),\r\n          level: 1,\r\n          contribution: 0\r\n        }\r\n      },\r\n      level: 1,\r\n      experience: 0,\r\n      gold: 0,\r\n      created: Date.now(),\r\n      description: '',\r\n      maxMembers: 10,\r\n      isPublic: true\r\n    };\r\n\r\n    this.guilds[guildName] = guild;\r\n    this.saveGuilds();\r\n    return { success: true, guild };\r\n  }\r\n\r\n  joinGuild(guildName, userId, userName) {\r\n    const guild = this.guilds[guildName];\r\n    if (!guild) return { success: false, reason: 'guild_not_found' };\r\n    if (!guild.isPublic) return { success: false, reason: 'guild_private' };\r\n    if (guild.members[userId]) return { success: false, reason: 'already_member' };\r\n    if (Object.keys(guild.members).length >= guild.maxMembers) {\r\n      return { success: false, reason: 'guild_full' };\r\n    }\r\n\r\n    guild.members[userId] = {\r\n      name: userName,\r\n      role: 'member',\r\n      joined: Date.now(),\r\n      level: 1,\r\n      contribution: 0\r\n    };\r\n\r\n    this.saveGuilds();\r\n    return { success: true, guild };\r\n  }\r\n\r\n  leaveGuild(guildName, userId) {\r\n    const guild = this.guilds[guildName];\r\n    if (!guild) return { success: false, reason: 'guild_not_found' };\r\n    if (!guild.members[userId]) return { success: false, reason: 'not_member' };\r\n    if (guild.leader === userId) return { success: false, reason: 'leader_cannot_leave' };\r\n\r\n    delete guild.members[userId];\r\n    this.saveGuilds();\r\n    return { success: true };\r\n  }\r\n\r\n  // Party Management Functions\r\n  createParty(leaderId, leaderName) {\r\n    const partyId = `party_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    const party = {\r\n      id: partyId,\r\n      leader: leaderId,\r\n      members: {\r\n        [leaderId]: {\r\n          name: leaderName,\r\n          role: 'leader',\r\n          joined: Date.now()\r\n        }\r\n      },\r\n      maxMembers: 4,\r\n      quest: null,\r\n      created: Date.now(),\r\n      isActive: true\r\n    };\r\n\r\n    // Store party in memory (could be persisted to file)\r\n    this.parties = this.parties || {};\r\n    this.parties[partyId] = party;\r\n\r\n    return { success: true, party };\r\n  }\r\n\r\n  joinParty(partyId, userId, userName) {\r\n    const party = this.parties?.[partyId];\r\n    if (!party) return { success: false, reason: 'party_not_found' };\r\n    if (!party.isActive) return { success: false, reason: 'party_disbanded' };\r\n    if (party.members[userId]) return { success: false, reason: 'already_in_party' };\r\n    if (Object.keys(party.members).length >= party.maxMembers) {\r\n      return { success: false, reason: 'party_full' };\r\n    }\r\n\r\n    party.members[userId] = {\r\n      name: userName,\r\n      role: 'member',\r\n      joined: Date.now()\r\n    };\r\n\r\n    return { success: true, party };\r\n  }\r\n\r\n  leaveParty(partyId, userId) {\r\n    const party = this.parties?.[partyId];\r\n    if (!party) return { success: false, reason: 'party_not_found' };\r\n    if (!party.members[userId]) return { success: false, reason: 'not_in_party' };\r\n\r\n    delete party.members[userId];\r\n\r\n    // Disband party if no members left\r\n    if (Object.keys(party.members).length === 0) {\r\n      delete this.parties[partyId];\r\n    } else if (party.leader === userId) {\r\n      // Transfer leadership to another member\r\n      const newLeader = Object.keys(party.members)[0];\r\n      party.leader = newLeader;\r\n      party.members[newLeader].role = 'leader';\r\n    }\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  // Guild Statistics and Leaderboards\r\n  getGuildLeaderboard(limit = 10) {\r\n    const guildList = Object.entries(this.guilds)\r\n      .map(([name, guild]) => ({\r\n        name,\r\n        level: guild.level,\r\n        memberCount: Object.keys(guild.members).length,\r\n        gold: guild.gold,\r\n        experience: guild.experience\r\n      }))\r\n      .sort((a, b) => {\r\n        if (b.level !== a.level) return b.level - a.level;\r\n        if (b.memberCount !== a.memberCount) return b.memberCount - a.memberCount;\r\n        return b.gold - a.gold;\r\n      })\r\n      .slice(0, limit);\r\n\r\n    return guildList;\r\n  }\r\n\r\n  getUserGuild(userId) {\r\n    for (const [guildName, guild] of Object.entries(this.guilds)) {\r\n      if (guild.members[userId]) {\r\n        return { guildName, ...guild };\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getUserParty(userId) {\r\n    if (!this.parties) return null;\r\n\r\n    for (const [partyId, party] of Object.entries(this.parties)) {\r\n      if (party.members[userId]) {\r\n        return { partyId, ...party };\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  // Guild Economy\r\n  contributeToGuild(guildName, userId, amount) {\r\n    const guild = this.guilds[guildName];\r\n    if (!guild) return { success: false, reason: 'guild_not_found' };\r\n    if (!guild.members[userId]) return { success: false, reason: 'not_member' };\r\n\r\n    const member = guild.members[userId];\r\n    if (member.gold < amount) return { success: false, reason: 'insufficient_gold' };\r\n\r\n    member.gold -= amount;\r\n    guild.gold += amount;\r\n    member.contribution += amount;\r\n\r\n    // Check for level up\r\n    const expGain = Math.floor(amount / 10);\r\n    guild.experience += expGain;\r\n\r\n    const newLevel = Math.floor(guild.experience / 100) + 1;\r\n    if (newLevel > guild.level) {\r\n      guild.level = newLevel;\r\n      guild.maxMembers += 2; // Increase max members\r\n    }\r\n\r\n    this.saveGuilds();\r\n    return { success: true, guild, expGain };\r\n  }\r\n\r\n  // Guild vs Guild Features\r\n  declareGuildWar(challengerGuild, targetGuild, challengerLeader) {\r\n    if (challengerGuild === targetGuild) {\r\n      return { success: false, reason: 'cannot_war_self' };\r\n    }\r\n\r\n    const challenger = this.guilds[challengerGuild];\r\n    const target = this.guilds[targetGuild];\r\n\r\n    if (!challenger || !target) {\r\n      return { success: false, reason: 'guild_not_found' };\r\n    }\r\n\r\n    if (challenger.leader !== challengerLeader) {\r\n      return { success: false, reason: 'not_guild_leader' };\r\n    }\r\n\r\n    // Simple war system - could be expanded\r\n    const warId = `war_${Date.now()}`;\r\n    const war = {\r\n      id: warId,\r\n      challenger: challengerGuild,\r\n      target: targetGuild,\r\n      declared: Date.now(),\r\n      status: 'active',\r\n      winner: null\r\n    };\r\n\r\n    this.guildWars = this.guildWars || {};\r\n    this.guildWars[warId] = war;\r\n\r\n    return { success: true, war };\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const guildManager = new GuildManager();\r\n\r\n// Convenience functions\r\nexport function createGuild(guildName, leaderId, leaderName) {\r\n  return guildManager.createGuild(guildName, leaderId, leaderName);\r\n}\r\n\r\nexport function joinGuild(guildName, userId, userName) {\r\n  return guildManager.joinGuild(guildName, userId, userName);\r\n}\r\n\r\nexport function leaveGuild(guildName, userId) {\r\n  return guildManager.leaveGuild(guildName, userId);\r\n}\r\n\r\nexport function createParty(leaderId, leaderName) {\r\n  return guildManager.createParty(leaderId, leaderName);\r\n}\r\n\r\nexport function joinParty(partyId, userId, userName) {\r\n  return guildManager.joinParty(partyId, userId, userName);\r\n}\r\n\r\nexport function leaveParty(partyId, userId) {\r\n  return guildManager.leaveParty(partyId, userId);\r\n}\r\n\r\nexport function getUserGuild(userId) {\r\n  return guildManager.getUserGuild(userId);\r\n}\r\n\r\nexport function getUserParty(userId) {\r\n  return guildManager.getUserParty(userId);\r\n}\r\n\r\nexport function getGuildLeaderboard(limit = 10) {\r\n  return guildManager.getGuildLeaderboard(limit);\r\n}\r\n\r\nexport function contributeToGuild(guildName, userId, amount) {\r\n  return guildManager.contributeToGuild(guildName, userId, amount);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\index.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/namespace","severity":2,"message":"Parse errors in imported module './interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":16,"column":35,"nodeType":"Literal","endLine":16,"endColumn":61},{"ruleId":"import/no-deprecated","severity":1,"message":"Parse errors in imported module './interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":16,"column":35,"nodeType":"Literal","endLine":16,"endColumn":61},{"ruleId":"import/order","severity":2,"message":"There should be no empty line within import group","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":48},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":29,"column":1,"nodeType":"Program","messageId":"max","endLine":29,"endColumn":129},{"ruleId":"no-multiple-empty-lines","severity":2,"message":"More than 1 blank line not allowed.","line":32,"column":1,"nodeType":"Program","messageId":"consecutiveBlank","endLine":33,"endColumn":1,"fix":{"range":[1204,1206],"text":""}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":36,"column":26,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":36,"endColumn":31,"fix":{"range":[1280,1285],"text":"15_000"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/^[A-Za-z0-9_-]{24,}\\.[A-Za-z0-9_-]{6,}\\.[A-Za-z0-9_-]{27,}$/ can be optimized to /^[\\w-]{24,}\\.[\\w-]{6,}\\.[\\w-]{27,}$/.","line":52,"column":8,"nodeType":"Literal","messageId":"better-regex","endLine":52,"endColumn":69,"fix":{"range":[1904,1965],"text":"/^[\\w-]{24,}\\.[\\w-]{6,}\\.[\\w-]{27,}$/"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":66,"column":1,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":66,"endColumn":2,"fix":{"range":[2280,2280],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":68,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":68,"endColumn":18},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":77,"column":1,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":77,"endColumn":2,"fix":{"range":[2677,2677],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":78,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":78,"endColumn":15,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[2688,2762],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":108,"column":7,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":108,"endColumn":8,"fix":{"range":[3624,3625],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":122,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":122,"endColumn":4,"fix":{"range":[4183,4183],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":124,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":124,"endColumn":20},{"ruleId":"max-lines-per-function","severity":1,"message":"Async arrow function has too many lines (62). Maximum allowed is 50.","line":179,"column":28,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":240,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async arrow function has a complexity of 14. Maximum allowed is 10.","line":179,"column":28,"nodeType":"ArrowFunctionExpression","messageId":"complex","endLine":240,"endColumn":2},{"ruleId":"unicorn/no-nested-ternary","severity":2,"message":"Nest ternary expression should be parenthesized.","line":206,"column":11,"nodeType":"ConditionalExpression","messageId":"should-parenthesized","endLine":208,"endColumn":38,"fix":{"range":[6938,7060],"text":"(attempt.reason === 'timeout'\r\n          ? 'Too slow! The typing challenge expired.'\r\n          : 'Invalid typing attempt.')"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":229,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":229,"endColumn":4,"fix":{"range":[7678,7678],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error_`.","line":229,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":229,"endColumn":15,"fix":{"range":[7686,7761],"text":"error_) {\r\n    const error = error_ instanceof Error ? error_ : new Error(String(error_"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":266,"column":7,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":266,"endColumn":22},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":269,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":269,"endColumn":4,"fix":{"range":[9050,9050],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":271,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":271,"endColumn":20},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":278,"column":7,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":278,"endColumn":8,"fix":{"range":[9317,9318],"text":""}},{"ruleId":"promise/param-names","severity":2,"message":"Promise constructor parameters must be named to match \"^_?resolve$\"","line":282,"column":41,"nodeType":"Identifier","messageId":"resolveParamNames","endLine":282,"endColumn":42},{"ruleId":"max-len","severity":2,"message":"This line has a length of 174. Maximum allowed is 120.","line":283,"column":1,"nodeType":"Program","messageId":"max","endLine":283,"endColumn":175},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":288,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":288,"endColumn":4,"fix":{"range":[9780,9780],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":294,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":294,"endColumn":6,"fix":{"range":[10073,10073],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":296,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":296,"endColumn":6,"fix":{"range":[10350,10350],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":298,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":298,"endColumn":6,"fix":{"range":[10532,10532],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (304). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":305,"endColumn":1},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":302,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":302,"endColumn":20}],"suppressedMessages":[],"errorCount":29,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":16,"fixableWarningCount":0,"source":"/**\r\n * Main entry point for the Ultra Discord Bot application.\r\n * Initializes the client, loads commands, sets up event listeners, and manages bot lifecycle.\r\n *\r\n * @fileoverview Main bot entry point with comprehensive error handling and graceful shutdown.\r\n * @author ULTRA Bot Development Team\r\n * @version 3.0.1\r\n * @license MIT\r\n */\r\n\r\nimport 'dotenv/config';\r\nimport { Client, Collection, GatewayIntentBits, Partials, ActivityType } from 'discord.js';\r\n\r\n// Core bot modules\r\nimport { loadCommands } from './commandLoader.js';\r\nimport { handleInteraction } from './interactionHandlers.js';\r\nimport { handleMessage } from './chat.js';\r\nimport { logger, logError } from './logger.js';\r\n\r\n// Feature modules\r\nimport { checkTypingAttempt } from './minigames/typing.js';\r\nimport { isOnCooldown, setCooldown } from './cooldowns.js';\r\nimport { initializeDatabase } from './storage.js';\r\nimport { schedulerManager } from './scheduler.js';\r\n\r\n/**\r\n * @typedef {Object} Command\r\n * @property {import('discord.js').SlashCommandBuilder} data - The command data structure.\r\n * @property {(interaction: import('discord.js').CommandInteraction) => Promise<void>} execute - The command execution function.\r\n */\r\n\r\n\r\n/**\r\n * Constants for bot configuration.\r\n */\r\nconst LOGIN_TIMEOUT_MS = 15000;\r\n\r\n/**\r\n * Validates the Discord token from environment variables.\r\n * @returns {string} The validated token.\r\n * @throws {Error} If the token is missing or invalid.\r\n */\r\nfunction validateToken() {\r\n  const token = process.env.DISCORD_TOKEN;\r\n  if (!token || token.trim() === '' || token === 'your-discord-bot-token-here') {\r\n    throw new Error(\r\n      'DISCORD_TOKEN is missing or invalid in .env file. Please add a valid Discord bot token from https://discord.com/developers/applications. Update the .env file with: DISCORD_TOKEN=your_actual_token_here'\r\n    );\r\n  }\r\n\r\n  // Basic token format validation\r\n  if (!/^[A-Za-z0-9_-]{24,}\\.[A-Za-z0-9_-]{6,}\\.[A-Za-z0-9_-]{27,}$/.test(token)) {\r\n    logger.warn('DISCORD_TOKEN format appears invalid. Please ensure it is a valid Discord bot token.');\r\n  }\r\n\r\n  return token;\r\n}\r\n\r\n/**\r\n * Validates the bot token with enhanced error handling.\r\n */\r\nlet token;\r\ntry {\r\n  token = validateToken();\r\n  logger.info('Token validation successful');\r\n} catch (error) {\r\n  logger.error('Token validation failed', error instanceof Error ? error : new Error(String(error)));\r\n  process.exit(1);\r\n}\r\n\r\n// BOT_STATUS validation\r\nconst botStatus = process.env.BOT_STATUS || 'online';\r\nconst validStatuses = ['online', 'idle', 'dnd', 'invisible'];\r\nlet status;\r\nif (validStatuses.includes(botStatus.toLowerCase())) {\r\n  status = botStatus.toLowerCase();\r\n} else {\r\n  console.warn(`Invalid BOT_STATUS: ${botStatus}. Defaulting to 'online'.`);\r\n  status = 'online';\r\n}\r\n\r\n// Include necessary intents for bot functionality\r\nconst client = new Client({\r\n  intents: [\r\n    GatewayIntentBits.Guilds,\r\n    GatewayIntentBits.GuildMessages,\r\n    GatewayIntentBits.DirectMessages,\r\n    GatewayIntentBits.MessageContent,\r\n    GatewayIntentBits.GuildMembers,\r\n    GatewayIntentBits.GuildVoiceStates,\r\n    GatewayIntentBits.GuildModeration\r\n  ],\r\n  partials: [Partials.Channel],\r\n  presence: {\r\n    activities: [{\r\n      name: process.env.BOT_ACTIVITY || 'Playing RPG Adventures',\r\n      type: ActivityType.Playing\r\n    }],\r\n    status: status\r\n  }\r\n});\r\n\r\n// Initialize commands collection with proper typing\r\nclient.commands = /** @type {import('discord.js').Collection<string, Command>} */ (new Collection());\r\n\r\n// Initialize database connection and commands\r\nlet commandStats = { total: 0, loaded: 0 };\r\n(async () => {\r\n  try {\r\n    logger.info('Initializing database connection...');\r\n    await initializeDatabase();\r\n    logger.success('Database initialized successfully');\r\n\r\n    // Load commands using the new module\r\n    logger.info('Loading commands...');\r\n    commandStats = await loadCommands(client);\r\n    logger.success(`Loaded ${commandStats.loaded} out of ${commandStats.total} commands successfully`);\r\n\r\n    // Initialize scheduler if available\r\n    await schedulerManager.setClient(client);\r\n    logger.success('Scheduler initialized successfully');\r\n  } catch (error) {\r\n    logger.error('Failed to initialize database', error instanceof Error ? error : new Error(String(error)));\r\n    process.exit(1);\r\n  }\r\n})();\r\n\r\n// Event listeners\r\nclient.on('error', (error) => {\r\n  logError('Client error occurred', error);\r\n});\r\n\r\nclient.once('ready', () => {\r\n  const user = client.user;\r\n  if (!user) {\r\n    logger.error('Client user is null after ready event');\r\n    return;\r\n  }\r\n\r\n  const stats = {\r\n    guilds: client.guilds.cache.size,\r\n    users: client.guilds.cache.reduce((total, guild) => total + guild.memberCount, 0),\r\n    totalCommands: commandStats.total,\r\n    loadedCommands: client.commands?.size || 0,\r\n    uptime: process.uptime()\r\n  };\r\n\r\n  logger.success(`Bot started successfully as ${user.tag}`, stats);\r\n\r\n  // Set up graceful shutdown handlers\r\n  process.on('SIGINT', () => gracefulShutdown(client, 'SIGINT'));\r\n  process.on('SIGTERM', () => gracefulShutdown(client, 'SIGTERM'));\r\n  process.on('uncaughtException', (error) => {\r\n    logger.error('Uncaught exception', error);\r\n    gracefulShutdown(client, 'uncaughtException');\r\n  });\r\n  process.on('unhandledRejection', (reason, promise) => {\r\n    logger.error('Unhandled rejection', reason instanceof Error ? reason : new Error(String(reason)), { promise: String(promise) });\r\n    gracefulShutdown(client, 'unhandledRejection');\r\n  });\r\n\r\n  // Log system information\r\n  logger.info('System information', {\r\n    nodeVersion: process.version,\r\n    platform: process.platform,\r\n    arch: process.arch,\r\n    memoryUsage: process.memoryUsage(),\r\n    uptime: process.uptime()\r\n  });\r\n});\r\n\r\nclient.on('interactionCreate', async interaction => {\r\n  await handleInteraction(interaction, client);\r\n});\r\n/**\r\n * Handles incoming messages with enhanced error handling and logging.\r\n * @param {import('discord.js').Message} message - The Discord message object.\r\n */\r\nclient.on('messageCreate', async message => {\r\n  const startTime = Date.now();\r\n\r\n  try {\r\n    // Ignore bot messages and system messages\r\n    if (message.author.bot || message.system) {\r\n      return;\r\n    }\r\n\r\n    // Check global message cooldown\r\n    const messageCooldown = isOnCooldown(message.author.id, 'message_global');\r\n    if (messageCooldown.onCooldown) {\r\n      logger.debug('Message ignored due to cooldown', {\r\n        userId: message.author.id,\r\n        remainingTime: messageCooldown.remaining\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Set message cooldown\r\n    setCooldown(message.author.id, 'message_global');\r\n\r\n    // Check typing minigame attempts first\r\n    const attempt = checkTypingAttempt(message.author.id, message.content);\r\n    if (attempt) {\r\n      const response = attempt.ok\r\n        ? `Nice! You typed it correctly: ${attempt.expected}`\r\n        : attempt.reason === 'timeout'\r\n          ? 'Too slow! The typing challenge expired.'\r\n          : 'Invalid typing attempt.';\r\n      await message.reply({ content: response });\r\n      return;\r\n    }\r\n\r\n    // Handle general message processing\r\n    const reply = await handleMessage(message);\r\n    if (reply) {\r\n      await message.reply({ content: reply });\r\n    }\r\n\r\n    // Log message processing time for performance monitoring\r\n    const processingTime = Date.now() - startTime;\r\n    if (processingTime > 1000) { // Log slow message processing (>1s)\r\n      logger.warn('Slow message processing detected', {\r\n        processingTime,\r\n        userId: message.author.id,\r\n        messageLength: message.content.length\r\n      });\r\n    }\r\n\r\n  } catch (err) {\r\n    const error = err instanceof Error ? err : new Error(String(err));\r\n    logError('Message handling failed', error, {\r\n      user: `${message.author.username}#${message.author.discriminator}`,\r\n      userId: message.author.id,\r\n      guild: message.guild?.name || 'DM',\r\n      channel: message.channel.type === 1 ? 'DM' : message.channel?.name || 'Unknown',\r\n      messageLength: message.content.length,\r\n      processingTime: Date.now() - startTime\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * Graceful shutdown handler for the bot.\r\n * @param {import('discord.js').Client} client - The Discord client instance.\r\n * @param {string} signal - The shutdown signal.\r\n */\r\nasync function gracefulShutdown(client, signal) {\r\n  logger.info(`Received ${signal}, initiating graceful shutdown...`);\r\n\r\n  try {\r\n    // Set presence to indicate maintenance\r\n    if (client.user) {\r\n      await client.user.setPresence({\r\n        activities: [{ name: 'Shutting down...', type: ActivityType.Playing }],\r\n        status: 'dnd'\r\n      });\r\n    }\r\n\r\n    // Close database connections if applicable\r\n    // Note: Database cleanup would be handled by the storage module\r\n\r\n    // Destroy the client after a short delay to allow pending operations\r\n    setTimeout(() => {\r\n      client.destroy();\r\n      logger.info('Bot shutdown complete');\r\n      process.exit(0);\r\n    }, 2000);\r\n\r\n  } catch (error) {\r\n    logger.error('Error during graceful shutdown', error instanceof Error ? error : new Error(String(error)));\r\n    process.exit(1);\r\n  }\r\n}\r\n\r\n/**\r\n * Initiates the bot login process with timeout protection and enhanced error handling.\r\n */\r\n(async () => {\r\n  try {\r\n    logger.info('Attempting to login to Discord...');\r\n    const loginPromise = client.login(token);\r\n    const timeoutPromise = new Promise((_, reject) =>\r\n      setTimeout(() => reject(new Error(`Discord login timed out after ${LOGIN_TIMEOUT_MS / 1000} seconds. Please check your DISCORD_TOKEN in .env file.`)), LOGIN_TIMEOUT_MS)\r\n    );\r\n    await Promise.race([loginPromise, timeoutPromise]);\r\n    logger.success('Login successful');\r\n\r\n  } catch (error) {\r\n    const err = error instanceof Error ? error : new Error(String(error));\r\n    logger.error('Failed to login to Discord', err);\r\n\r\n    if (err.message.includes('timeout')) {\r\n      logger.error('Login timed out. Please check your internet connection and try again.');\r\n    } else if (err.message.includes('Invalid token') || err.message.includes('Incorrect login details')) {\r\n      logger.error('Invalid token provided. Please ensure DISCORD_TOKEN in .env is set to a valid Discord bot token from https://discord.com/developers/applications');\r\n    } else if (err.message.includes('Privileged intent')) {\r\n      logger.error('Missing privileged intents. Please enable required intents in your Discord application settings.');\r\n    } else {\r\n      logger.error('Unknown login error occurred. Please check your configuration and try again.');\r\n    }\r\n\r\n    process.exit(1);\r\n  }\r\n})();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\integrations.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":32,"column":66,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":32,"endColumn":72,"fix":{"range":[834,842],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":34,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":34,"endColumn":6,"fix":{"range":[885,885],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":35,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":35,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[909,962],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":47,"column":77,"nodeType":"Literal","messageId":"error","endLine":47,"endColumn":81,"suggestions":[{"messageId":"replace","fix":{"range":[1217,1221],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":48,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":48,"endColumn":6,"fix":{"range":[1234,1234],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":49,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":49,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1258,1311],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":55,"column":5,"nodeType":"MemberExpression","endLine":55,"endColumn":39},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":58,"column":17,"nodeType":"Literal","messageId":"error","endLine":58,"endColumn":21,"suggestions":[{"messageId":"replace","fix":{"range":[1490,1494],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":66,"column":12,"nodeType":"MemberExpression","endLine":66,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":101,"column":20,"nodeType":"MemberExpression","endLine":101,"endColumn":54},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":106,"column":12,"nodeType":"MemberExpression","endLine":106,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":107,"column":9,"nodeType":"MemberExpression","endLine":107,"endColumn":46},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":107,"column":83,"nodeType":"Literal","messageId":"error","endLine":107,"endColumn":87,"suggestions":[{"messageId":"replace","fix":{"range":[2906,2910],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":109,"column":7,"nodeType":"MemberExpression","endLine":109,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":122,"column":9,"nodeType":"MemberExpression","endLine":122,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":123,"column":7,"nodeType":"MemberExpression","endLine":123,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":124,"column":7,"nodeType":"MemberExpression","endLine":124,"endColumn":44},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":134,"column":51,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":134,"endColumn":56,"fix":{"range":[3674,3679],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":135,"column":49,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":135,"endColumn":57,"fix":{"range":[3749,3757],"text":"86_400_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":136,"column":46,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":136,"endColumn":51,"fix":{"range":[3823,3828],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":137,"column":48,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":137,"endColumn":53,"fix":{"range":[3898,3903],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":138,"column":51,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":138,"endColumn":56,"fix":{"range":[3975,3980],"text":"60_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":141,"column":12,"nodeType":"MemberExpression","endLine":141,"endColumn":27},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":141,"column":60,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":141,"endColumn":65,"fix":{"range":[4071,4076],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":145,"column":31,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":145,"endColumn":37,"fix":{"range":[4148,4154],"text":"300_000"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":150,"column":12,"nodeType":"Literal","messageId":"error","endLine":150,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[4330,4334],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[4330,4334],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":161,"column":26,"nodeType":"CallExpression","messageId":"array-from","endLine":161,"endColumn":58,"fix":{"range":[4552,4584],"text":"[...this.apiCache.keys()]"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":162,"column":18,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":162,"endColumn":25,"fix":{"range":[4607,4660],"text":"for (const key of oldestKeys) this.apiCache.delete(key);"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":182,"column":49,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":182,"endColumn":56,"fix":{"range":[5215,5222],"text":"1_800_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":201,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":201,"endColumn":6,"fix":{"range":[5816,5816],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":227,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":227,"endColumn":6,"fix":{"range":[6522,6522],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":253,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":253,"endColumn":6,"fix":{"range":[7214,7214],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":260,"column":32,"nodeType":"Literal","messageId":"error","endLine":260,"endColumn":36,"suggestions":[{"messageId":"replace","fix":{"range":[7408,7412],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":281,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":281,"endColumn":6,"fix":{"range":[8016,8016],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (515). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":515,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":301,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":301,"endColumn":6,"fix":{"range":[8547,8547],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":318,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":318,"endColumn":6,"fix":{"range":[9019,9019],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":346,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":346,"endColumn":6,"fix":{"range":[9740,9740],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":376,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":376,"endColumn":6,"fix":{"range":[10634,10634],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":398,"column":7,"nodeType":"MemberExpression","endLine":398,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'apiKey' is assigned a value but never used.","line":412,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":412,"endColumn":32},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":417,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":417,"endColumn":30,"fix":{"range":[11909,11988],"text":" {\r\n            testResult = await this.getWeather('London');\r\n            break;\n          }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":420,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":420,"endColumn":26,"fix":{"range":[12015,12098],"text":" {\r\n            testResult = await this.getNews('technology', 1);\r\n            break;\n          }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":423,"column":11,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":423,"endColumn":19,"fix":{"range":[12118,12169],"text":" {\r\n            testResult = await this.getDadJoke();\n          }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":427,"column":9,"nodeType":"MemberExpression","endLine":427,"endColumn":24},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":430,"column":39,"nodeType":"Literal","messageId":"error","endLine":430,"endColumn":43,"suggestions":[{"messageId":"replace","fix":{"range":[12346,12350],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":432,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":432,"endColumn":8,"fix":{"range":[12391,12391],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":433,"column":9,"nodeType":"MemberExpression","endLine":433,"endColumn":24},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":449,"column":36,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":449,"endColumn":43,"fix":{"range":[12772,12779],"text":"3_600_000"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":480,"column":46,"nodeType":"Literal","messageId":"error","endLine":480,"endColumn":50,"suggestions":[{"messageId":"replace","fix":{"range":[13591,13595],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]}],"suppressedMessages":[],"errorCount":37,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":28,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst INTEGRATIONS_FILE = path.join(process.cwd(), 'data', 'integrations.json');\r\n\r\n// Advanced External API Integration System\r\nclass IntegrationManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadIntegrations();\r\n    this.apiCache = new Map();\r\n    this.rateLimiters = new Map();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(INTEGRATIONS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(INTEGRATIONS_FILE)) {\r\n      fs.writeFileSync(INTEGRATIONS_FILE, JSON.stringify({\r\n        apiKeys: {},\r\n        usageStats: {},\r\n        cache: {},\r\n        settings: {}\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadIntegrations() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(INTEGRATIONS_FILE, 'utf8'));\r\n      this.integrations = data;\r\n    } catch (error) {\r\n      console.error('Failed to load integrations:', error);\r\n      this.integrations = {\r\n        apiKeys: {},\r\n        usageStats: {},\r\n        cache: {},\r\n        settings: {}\r\n      };\r\n    }\r\n  }\r\n\r\n  saveIntegrations() {\r\n    try {\r\n      fs.writeFileSync(INTEGRATIONS_FILE, JSON.stringify(this.integrations, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save integrations:', error);\r\n    }\r\n  }\r\n\r\n  // API Key Management\r\n  setAPIKey(service, apiKey) {\r\n    this.integrations.apiKeys[service] = {\r\n      key: apiKey,\r\n      setAt: Date.now(),\r\n      lastUsed: null,\r\n      usageCount: 0\r\n    };\r\n    this.saveIntegrations();\r\n    return true;\r\n  }\r\n\r\n  getAPIKey(service) {\r\n    return this.integrations.apiKeys[service];\r\n  }\r\n\r\n  // Rate Limiting for External APIs\r\n  checkRateLimit(service) {\r\n    const apiKey = this.getAPIKey(service);\r\n    if (!apiKey) return { allowed: false, reason: 'no_api_key' };\r\n\r\n    const now = Date.now();\r\n    const rateLimit = this.getServiceRateLimit(service);\r\n\r\n    if (!this.rateLimiters.has(service)) {\r\n      this.rateLimiters.set(service, { requests: [], windowStart: now });\r\n    }\r\n\r\n    const limiter = this.rateLimiters.get(service);\r\n    const windowStart = now - rateLimit.windowMs;\r\n\r\n    // Clean old requests\r\n    limiter.requests = limiter.requests.filter(time => time > windowStart);\r\n\r\n    if (limiter.requests.length >= rateLimit.maxRequests) {\r\n      const resetTime = limiter.requests[0] + rateLimit.windowMs;\r\n      return {\r\n        allowed: false,\r\n        reason: 'rate_limit',\r\n        resetIn: resetTime - now,\r\n        resetAt: new Date(resetTime)\r\n      };\r\n    }\r\n\r\n    return { allowed: true };\r\n  }\r\n\r\n  recordAPIUsage(service) {\r\n    const apiKey = this.integrations.apiKeys[service];\r\n    if (apiKey) {\r\n      apiKey.lastUsed = Date.now();\r\n      apiKey.usageCount++;\r\n\r\n      if (!this.integrations.usageStats[service]) {\r\n        this.integrations.usageStats[service] = { calls: 0, errors: 0, lastError: null };\r\n      }\r\n      this.integrations.usageStats[service].calls++;\r\n    }\r\n\r\n    // Update rate limiter\r\n    if (!this.rateLimiters.has(service)) {\r\n      this.rateLimiters.set(service, { requests: [], windowStart: Date.now() });\r\n    }\r\n    this.rateLimiters.get(service).requests.push(Date.now());\r\n\r\n    this.saveIntegrations();\r\n  }\r\n\r\n  recordAPIError(service, error) {\r\n    if (this.integrations.usageStats[service]) {\r\n      this.integrations.usageStats[service].errors++;\r\n      this.integrations.usageStats[service].lastError = {\r\n        message: error.message,\r\n        timestamp: Date.now()\r\n      };\r\n    }\r\n    this.saveIntegrations();\r\n  }\r\n\r\n  getServiceRateLimit(service) {\r\n    const limits = {\r\n      'openweather': { maxRequests: 60, windowMs: 60000 }, // 60 per minute\r\n      'newsapi': { maxRequests: 1000, windowMs: 86400000 }, // 1000 per day\r\n      'jokes': { maxRequests: 100, windowMs: 60000 }, // 100 per minute\r\n      'catfacts': { maxRequests: 50, windowMs: 60000 }, // 50 per minute\r\n      'numbersapi': { maxRequests: 100, windowMs: 60000 } // 100 per minute\r\n    };\r\n\r\n    return limits[service] || { maxRequests: 10, windowMs: 60000 };\r\n  }\r\n\r\n  // Advanced Caching System\r\n  getCachedData(key, maxAge = 300000) { // 5 minutes default\r\n    const cached = this.apiCache.get(key);\r\n    if (cached && Date.now() - cached.timestamp < maxAge) {\r\n      return cached.data;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  setCachedData(key, data) {\r\n    this.apiCache.set(key, {\r\n      data,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    // Clean old cache entries\r\n    if (this.apiCache.size > 1000) {\r\n      const oldestKeys = Array.from(this.apiCache.keys()).slice(0, 200);\r\n      oldestKeys.forEach(key => this.apiCache.delete(key));\r\n    }\r\n  }\r\n\r\n  // News Integration\r\n  async getNews(query = '', limit = 5) {\r\n    const service = 'newsapi';\r\n    const rateLimit = this.checkRateLimit(service);\r\n\r\n    if (!rateLimit.allowed) {\r\n      return { success: false, reason: rateLimit.reason, resetIn: rateLimit.resetIn };\r\n    }\r\n\r\n    const apiKey = this.getAPIKey(service);\r\n    if (!apiKey) {\r\n      return { success: false, reason: 'news_api_not_configured' };\r\n    }\r\n\r\n    // Check cache\r\n    const cacheKey = `news_${query}_${limit}`;\r\n    const cached = this.getCachedData(cacheKey, 1800000); // 30 minutes\r\n    if (cached) {\r\n      return { success: true, data: cached };\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`https://newsapi.org/v2/everything?q=${encodeURIComponent(query)}&apiKey=${apiKey.key}&pageSize=${limit}&sortBy=publishedAt`);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`News API error: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      this.recordAPIUsage(service);\r\n\r\n      // Cache the results\r\n      this.setCachedData(cacheKey, data.articles);\r\n\r\n      return { success: true, data: data.articles };\r\n    } catch (error) {\r\n      this.recordAPIError(service, error);\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Jokes Integration\r\n  async getRandomJoke() {\r\n    const service = 'jokes';\r\n    const rateLimit = this.checkRateLimit(service);\r\n\r\n    if (!rateLimit.allowed) {\r\n      return { success: false, reason: rateLimit.reason };\r\n    }\r\n\r\n    try {\r\n      const response = await fetch('https://official-joke-api.appspot.com/random_joke');\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Joke API error: ${response.status}`);\r\n      }\r\n\r\n      const joke = await response.json();\r\n      this.recordAPIUsage(service);\r\n\r\n      return { success: true, data: joke };\r\n    } catch (error) {\r\n      this.recordAPIError(service, error);\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Cat Facts Integration\r\n  async getCatFact() {\r\n    const service = 'catfacts';\r\n    const rateLimit = this.checkRateLimit(service);\r\n\r\n    if (!rateLimit.allowed) {\r\n      return { success: false, reason: rateLimit.reason };\r\n    }\r\n\r\n    try {\r\n      const response = await fetch('https://catfact.ninja/fact');\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Cat Facts API error: ${response.status}`);\r\n      }\r\n\r\n      const fact = await response.json();\r\n      this.recordAPIUsage(service);\r\n\r\n      return { success: true, data: fact };\r\n    } catch (error) {\r\n      this.recordAPIError(service, error);\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Numbers API Integration\r\n  async getNumberFact(number = null) {\r\n    const service = 'numbersapi';\r\n    const rateLimit = this.checkRateLimit(service);\r\n\r\n    if (!rateLimit.allowed) {\r\n      return { success: false, reason: rateLimit.reason };\r\n    }\r\n\r\n    const targetNumber = number || Math.floor(Math.random() * 1000) + 1;\r\n\r\n    try {\r\n      const response = await fetch(`http://numbersapi.com/${targetNumber}?json`);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Numbers API error: ${response.status}`);\r\n      }\r\n\r\n      const fact = await response.json();\r\n      this.recordAPIUsage(service);\r\n\r\n      return { success: true, data: fact };\r\n    } catch (error) {\r\n      this.recordAPIError(service, error);\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Dad Jokes Integration\r\n  async getDadJoke() {\r\n    try {\r\n      const response = await fetch('https://icanhazdadjoke.com/', {\r\n        headers: { 'Accept': 'application/json' }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Dad Jokes API error: ${response.status}`);\r\n      }\r\n\r\n      const joke = await response.json();\r\n\r\n      return { success: true, data: joke };\r\n    } catch (error) {\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Programming Quotes\r\n  async getProgrammingQuote() {\r\n    try {\r\n      const response = await fetch('https://programming-quotes-api.herokuapp.com/quotes/random');\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Programming Quotes API error: ${response.status}`);\r\n      }\r\n\r\n      const quote = await response.json();\r\n\r\n      return { success: true, data: quote };\r\n    } catch (error) {\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // GitHub Integration\r\n  async getGitHubStats(username) {\r\n    try {\r\n      const response = await fetch(`https://api.github.com/users/${username}`);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`GitHub API error: ${response.status}`);\r\n      }\r\n\r\n      const user = await response.json();\r\n\r\n      return {\r\n        success: true,\r\n        data: {\r\n          name: user.name,\r\n          bio: user.bio,\r\n          location: user.location,\r\n          publicRepos: user.public_repos,\r\n          followers: user.followers,\r\n          following: user.following,\r\n          created: user.created_at\r\n        }\r\n      };\r\n    } catch (error) {\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Weather Integration (Enhanced)\r\n  async getWeather(location) {\r\n    const service = 'openweather';\r\n    const rateLimit = this.checkRateLimit(service);\r\n\r\n    if (!rateLimit.allowed) {\r\n      return { success: false, reason: rateLimit.reason };\r\n    }\r\n\r\n    const apiKey = this.getAPIKey(service);\r\n    if (!apiKey) {\r\n      return { success: false, reason: 'weather_api_not_configured' };\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(location)}&appid=${apiKey.key}&units=metric`);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Weather API error: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      this.recordAPIUsage(service);\r\n\r\n      return { success: true, data };\r\n    } catch (error) {\r\n      this.recordAPIError(service, error);\r\n      return { success: false, reason: error.message };\r\n    }\r\n  }\r\n\r\n  // Advanced Features\r\n  getIntegrationStats() {\r\n    return {\r\n      apiKeys: Object.keys(this.integrations.apiKeys).length,\r\n      totalUsage: Object.values(this.integrations.usageStats).reduce((sum, stats) => sum + stats.calls, 0),\r\n      totalErrors: Object.values(this.integrations.usageStats).reduce((sum, stats) => sum + stats.errors, 0),\r\n      cacheSize: this.apiCache.size,\r\n      rateLimitStatus: this.getRateLimitStatus()\r\n    };\r\n  }\r\n\r\n  getRateLimitStatus() {\r\n    const status = {};\r\n\r\n    for (const service of ['openweather', 'newsapi', 'jokes', 'catfacts', 'numbersapi']) {\r\n      const rateLimit = this.checkRateLimit(service);\r\n      status[service] = {\r\n        allowed: rateLimit.allowed,\r\n        remaining: rateLimit.allowed ? 'unknown' : Math.ceil(rateLimit.resetIn / 1000)\r\n      };\r\n    }\r\n\r\n    return status;\r\n  }\r\n\r\n  // API Health Monitoring\r\n  async checkAPIHealth() {\r\n    const health = {};\r\n\r\n    // Test each configured API\r\n    for (const [service, apiKey] of Object.entries(this.integrations.apiKeys)) {\r\n      try {\r\n        let testResult;\r\n\r\n        switch (service) {\r\n          case 'openweather':\r\n            testResult = await this.getWeather('London');\r\n            break;\r\n          case 'newsapi':\r\n            testResult = await this.getNews('technology', 1);\r\n            break;\r\n          default:\r\n            testResult = await this.getDadJoke();\r\n        }\r\n\r\n        health[service] = {\r\n          status: testResult.success ? 'healthy' : 'error',\r\n          lastCheck: Date.now(),\r\n          error: testResult.success ? null : testResult.reason\r\n        };\r\n      } catch (error) {\r\n        health[service] = {\r\n          status: 'error',\r\n          lastCheck: Date.now(),\r\n          error: error.message\r\n        };\r\n      }\r\n    }\r\n\r\n    return health;\r\n  }\r\n\r\n  // Cleanup and Maintenance\r\n  cleanup() {\r\n    // Clean old cache\r\n    const now = Date.now();\r\n    for (const [key, cached] of this.apiCache) {\r\n      if (now - cached.timestamp > 3600000) { // 1 hour\r\n        this.apiCache.delete(key);\r\n      }\r\n    }\r\n\r\n    // Clean old rate limit data\r\n    for (const [service, limiter] of this.rateLimiters) {\r\n      const cutoff = now - this.getServiceRateLimit(service).windowMs;\r\n      limiter.requests = limiter.requests.filter(time => time > cutoff);\r\n    }\r\n\r\n    this.saveIntegrations();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const integrationManager = new IntegrationManager();\r\n\r\n// Convenience functions\r\nexport async function getNews(query = '', limit = 5) {\r\n  return integrationManager.getNews(query, limit);\r\n}\r\n\r\nexport async function getRandomJoke() {\r\n  return integrationManager.getRandomJoke();\r\n}\r\n\r\nexport async function getCatFact() {\r\n  return integrationManager.getCatFact();\r\n}\r\n\r\nexport async function getNumberFact(number = null) {\r\n  return integrationManager.getNumberFact(number);\r\n}\r\n\r\nexport async function getDadJoke() {\r\n  return integrationManager.getDadJoke();\r\n}\r\n\r\nexport async function getProgrammingQuote() {\r\n  return integrationManager.getProgrammingQuote();\r\n}\r\n\r\nexport async function getGitHubStats(username) {\r\n  return integrationManager.getGitHubStats(username);\r\n}\r\n\r\nexport async function getWeather(location) {\r\n  return integrationManager.getWeather(location);\r\n}\r\n\r\nexport function setAPIKey(service, apiKey) {\r\n  return integrationManager.setAPIKey(service, apiKey);\r\n}\r\n\r\nexport function getAPIKey(service) {\r\n  return integrationManager.getAPIKey(service);\r\n}\r\n\r\nexport function getIntegrationStats() {\r\n  return integrationManager.getIntegrationStats();\r\n}\r\n\r\n// Auto-cleanup every 30 minutes\r\nsetInterval(() => {\r\n  integrationManager.cleanup();\r\n}, 30 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\interactionHandlers.js","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: Missing catch or finally clause. (1102:3)","line":1102,"column":3,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Interaction handlers for Discord bot commands and button interactions.\r\n * Handles chat input commands, button clicks, modal submissions, and game interactions.\r\n */\r\n\r\nimport { ActionRowBuilder, ButtonBuilder, ButtonStyle, ModalBuilder, TextInputBuilder, TextInputStyle, EmbedBuilder, PermissionFlagsBits, MessageFlags, Client, ChatInputCommandInteraction, ButtonInteraction, ModalSubmitInteraction, BaseInteraction } from 'discord.js';\r\n\r\n// Core modules\r\nimport { logCommandExecution, logError, logger } from './logger.js';\r\nimport { CommandError, handleCommandError, safeExecuteCommand, validateUser, validateGuild, validatePermissions, validateRange, validateNotEmpty, createRateLimiter } from './errorHandler.js';\r\nimport { inputValidator, sanitizeInput, validateUserId, validateNumber, validateString } from './validation.js';\r\n\r\n// Import missing functions from game modules\r\nimport { entertainmentManager } from './entertainment.js';\r\n\r\n/**\r\n * @typedef {object} RateLimiter\r\n * @property {function(string): Promise<void>} consume - Consumes a rate limit point for the given key\r\n */\r\n\r\n/**\r\n * @typedef {object} ValidationResult\r\n * @property {boolean} valid - Whether the validation passed\r\n * @property {string} reason - Reason for validation failure (if applicable)\r\n * @property {any} value - Parsed value (if validation passed)\r\n */\r\n\r\n// Feature modules\r\nimport { isOnCooldown, setCooldown, getFormattedCooldown, getButtonCooldownType } from './cooldowns.js';\r\nimport { wordleGames, hangmanGames, guessGames, combatGames, explorationGames, connect4Games, triviaGames, tttGames, pollGames, memoryGames } from './game-states.js';\r\nimport { getCharacter, resetCharacter, spendSkillPoints, encounterMonster, fightTurn, applyXp, narrate, saveCharacter, addItemToInventory, removeItemFromInventory, getItemInfo, getItemRarityInfo, generateRandomItem } from './rpg.js';\r\nimport { addBalance, getBalance, transferBalance, getMarketPrice, buyFromMarket, sellToMarket } from './economy.js';\r\nimport { getUserGuild, contributeToGuild } from './guilds.js';\r\nimport { warnUser, muteUser, unmuteUser, unbanUser } from './moderation.js';\r\nimport { pause, resume, skip, stop, shuffleQueue, clearQueue, getQueue, getMusicStats, searchSongs, play, back } from './music.js';\r\nimport { getRandomJoke, generateStory, getRiddle, getFunFact, getRandomQuote, magic8Ball, generateFunName, createFunChallenge } from './entertainment.js';\r\nimport { getLocations } from './locations.js';\r\nimport { getActiveAuctions, createAuction } from './trading.js';\r\nimport { updateProfile } from './profiles.js';\r\nimport { getLeaderboard, getLeaderboardCount, randomEventType, getInventory, getInventoryValue } from './rpg.js';\r\nimport { getRadioStations } from './music.js';\r\nimport { updateUserStats } from './achievements.js';\r\n// Import missing functions from other modules - these are not exported, so we need to use them directly\r\n// getPerformanceRating from memory.js, makeConnect4Move/sendConnect4Board from connect4.js, etc.\r\n\r\n// Constants for rate limiting and configuration\r\nconst INTERACTION_RATE_LIMIT = 5;\r\nconst INTERACTION_RATE_WINDOW = 10000; // 10 seconds\r\nconst PROCESSED_INTERACTION_CLEANUP_TIME = 5 * 60 * 1000; // 5 minutes\r\nconst CIRCUIT_BREAKER_MAX_ATTEMPTS = 3;\r\nconst CIRCUIT_BREAKER_CLEANUP_TIME = 5 * 60 * 1000; // 5 minutes\r\n\r\n/**\r\n * Rate limiter for interactions to prevent abuse.\r\n */\r\nconst interactionRateLimiter = /** @type {RateLimiter} */ (createRateLimiter(INTERACTION_RATE_LIMIT, INTERACTION_RATE_WINDOW, /** @param {string} key */ (key) => key));\r\n\r\n/**\r\n * Circuit breaker to prevent infinite error loops.\r\n * Tracks error attempts per interaction to avoid recursive failures.\r\n */\r\nconst circuitBreaker = new Map();\r\n\r\n// Processed interactions map to prevent duplicate responses\r\nconst processedInteractions = new Map();\r\n\r\n/**\r\n * Sends a Wordle guess modal to the user.\r\n * @param {ButtonInteraction} interaction - Discord interaction object\r\n * @param {string} gameId - The game identifier\r\n */\r\nexport async function sendWordleGuessModal(interaction, gameId) {\r\n  const modal = new ModalBuilder()\r\n    .setCustomId(`wordle_submit:${gameId}`)\r\n    .setTitle('Wordle Guess');\r\n\r\n  const guessInput = new TextInputBuilder()\r\n    .setCustomId('word_guess')\r\n    .setLabel('Enter a 5-letter word')\r\n    .setStyle(TextInputStyle.Short)\r\n    .setRequired(true)\r\n    .setPlaceholder('HOUSE')\r\n    .setMinLength(5)\r\n    .setMaxLength(5);\r\n\r\n  modal.addComponents(guessInput);\r\n  await interaction.showModal(modal);\r\n}\r\n\r\n/**\r\n * Updates the inventory embed with new item data.\r\n * @param {ButtonInteraction} interaction - The button interaction\r\n * @param {Object<string, Array<any>>} itemsByType - Items grouped by type\r\n * @param {number} inventoryValue - Total value of inventory\r\n */\r\nexport async function updateInventoryEmbed(interaction, itemsByType, inventoryValue) {\r\n  const message = interaction.message;\r\n  if (!message) return;\r\n  const { getItemInfo, getItemRarityInfo } = await import('./rpg.js');\r\n\r\n  const embed = message.embeds[0];\r\n  if (!embed) return;\r\n\r\n  const newEmbed = new EmbedBuilder()\r\n    .setTitle(embed.title || 'Inventory')\r\n    .setColor(embed.color || 0x8B4513)\r\n    .setDescription(`üí∞ Total Value: ${inventoryValue} gold`);\r\n\r\n  for (const [type, items] of Object.entries(itemsByType)) {\r\n    const typeEmoji = {\r\n      weapon: '‚öîÔ∏è',\r\n      armor: 'üõ°Ô∏è',\r\n      consumable: 'üß™',\r\n      material: 'üî©'\r\n    }[type] || 'üì¶';\r\n\r\n    const itemList = items.map(item => {\r\n      return `${typeEmoji} **${item.name}** (${item.quantity}x)`;\r\n    }).join('\\n');\r\n\r\n    newEmbed.addFields({\r\n      name: `${typeEmoji} ${type.charAt(0).toUpperCase() + type.slice(1)}s`,\r\n      value: itemList || 'None',\r\n      inline: true\r\n    });\r\n  }\r\n\r\n  await interaction.update({ embeds: [newEmbed] });\r\n}\r\n\r\n/**\r\n * Checks if the circuit breaker allows the operation to proceed.\r\n * @param {string} interactionId - The interaction identifier\r\n * @returns {boolean} True if operation can proceed, false if circuit is broken\r\n */\r\nfunction checkCircuitBreaker(interactionId) {\r\n  const circuitData = circuitBreaker.get(interactionId);\r\n  if (!circuitData) return true;\r\n\r\n  const { attempts, lastAttempt } = circuitData;\r\n  const now = Date.now();\r\n\r\n  // Clean up old circuit breaker entries\r\n  if (now - lastAttempt > CIRCUIT_BREAKER_CLEANUP_TIME) {\r\n    circuitBreaker.delete(interactionId);\r\n    return true;\r\n  }\r\n\r\n  return attempts < CIRCUIT_BREAKER_MAX_ATTEMPTS;\r\n}\r\n\r\n/**\r\n * Records an error attempt in the circuit breaker.\r\n * @param {string} interactionId - The interaction identifier\r\n */\r\nfunction recordErrorAttempt(interactionId) {\r\n  const now = Date.now();\r\n  const circuitData = circuitBreaker.get(interactionId) || { attempts: 0, lastAttempt: now };\r\n\r\n  circuitData.attempts += 1;\r\n  circuitData.lastAttempt = now;\r\n\r\n  circuitBreaker.set(interactionId, circuitData);\r\n\r\n  // Clean up old entries periodically\r\n  if (circuitBreaker.size > 1000) {\r\n    for (const [id, data] of circuitBreaker.entries()) {\r\n      if (now - data.lastAttempt > CIRCUIT_BREAKER_CLEANUP_TIME) {\r\n        circuitBreaker.delete(id);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Safely replies to an interaction with error handling and rate limiting.\r\n * @param {BaseInteraction} interaction - The Discord interaction to reply to\r\n * @param {Object} options - Reply options (content, embeds, components, flags)\r\n * @returns {Promise<boolean>} True if reply was successful, false otherwise\r\n */\r\nexport async function safeInteractionReply(interaction, options) {\r\n  const interactionId = interaction.id;\r\n\r\n  // Check circuit breaker before proceeding\r\n  if (!checkCircuitBreaker(interactionId)) {\r\n    console.error(`[SAFE_INTERACTION_REPLY] Circuit breaker tripped for interaction ${interactionId}, skipping reply`);\r\n    logger.error(`Circuit breaker tripped - too many error attempts for interaction ${interactionId}`, new Error('Circuit breaker activated'), {\r\n      interactionId,\r\n      userId: interaction.user?.id\r\n    });\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    // Rate limiting check\r\n    await interactionRateLimiter.consume(interaction.user.id);\r\n  } catch (error) {\r\n    if (error instanceof CommandError && error.code === 'RATE_LIMITED') {\r\n      logError('Interaction rate limited', error, {\r\n        userId: interaction.user.id,\r\n        interactionId\r\n      });\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Check if this interaction has already been processed\r\n  if (processedInteractions.has(interactionId)) {\r\n    logger.warn(`Interaction ${interactionId} already processed, ignoring`, {\r\n      userId: interaction.user.id,\r\n      interactionId\r\n    });\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    // Validate interaction object\r\n    validateNotEmpty(interaction, 'interaction');\r\n    validateNotEmpty(interaction.user, 'interaction.user');\r\n    validateUserId(interaction.user.id);\r\n\r\n    // Check if interaction is still valid (not expired)\r\n    if (interaction.replied || interaction.deferred) {\r\n      console.error(`[SAFE_INTERACTION_REPLY] Interaction ${interactionId} already replied/deferred`, {\r\n        userId: interaction.user.id,\r\n        interactionId,\r\n        replied: interaction.replied,\r\n        deferred: interaction.deferred\r\n      });\r\n      logger.warn(`Interaction ${interactionId} already replied/deferred`, {\r\n        userId: interaction.user.id,\r\n        interactionId,\r\n        replied: interaction.replied,\r\n        deferred: interaction.deferred\r\n      });\r\n      return false;\r\n    }\r\n\r\n    // Mark as processed\r\n    processedInteractions.set(interactionId, Date.now());\r\n\r\n    // Clean up old processed interactions\r\n    const cutoffTime = Date.now() - PROCESSED_INTERACTION_CLEANUP_TIME;\r\n    for (const [id, timestamp] of processedInteractions.entries()) {\r\n      if (timestamp < cutoffTime) {\r\n        processedInteractions.delete(id);\r\n      }\r\n    }\r\n\r\n    // Sanitize content if present\r\n    if (options.content) {\r\n      options.content = sanitizeInput(options.content);\r\n    }\r\n\r\n    console.error(`[SAFE_INTERACTION_REPLY] Attempting to reply to interaction ${interactionId}`);\r\n    await interaction.reply(options);\r\n    console.error(`[SAFE_INTERACTION_REPLY] Successfully replied to interaction ${interactionId}`);\r\n    return true;\r\n  } catch (error) {\r\n    // Record error attempt in circuit breaker\r\n    recordErrorAttempt(interactionId);\r\n\r\n    logger.error(`Failed to reply to interaction ${interactionId}`, error instanceof Error ? error : new Error(String(error)), {\r\n      userId: interaction.user?.id,\r\n      interactionType: interaction?.type,\r\n      interactionId,\r\n      interactionState: {\r\n        replied: interaction?.replied,\r\n        deferred: interaction?.deferred\r\n      }\r\n    });\r\n    return false;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Safely updates interactions and prevents duplicate updates.\r\n * @param {BaseInteraction} interaction - Discord interaction object\r\n * @param {Object} options - Update options\r\n * @returns {Promise<boolean>} True if update was successful, false otherwise\r\n */\r\nexport async function safeInteractionUpdate(interaction, options) {\r\n   const interactionId = interaction.id;\r\n\r\n   // Check circuit breaker before proceeding\r\n   if (!checkCircuitBreaker(interactionId)) {\r\n     console.error(`[SAFE_INTERACTION_UPDATE] Circuit breaker tripped for interaction ${interactionId}, skipping update`);\r\n     logger.error(`Circuit breaker tripped - too many error attempts for interaction ${interactionId}`, new Error('Circuit breaker activated'), {\r\n       interactionId,\r\n       userId: interaction.user?.id\r\n     });\r\n     return false;\r\n   }\r\n\r\n   try {\r\n     // Rate limiting check for updates\r\n     await interactionRateLimiter.consume(interaction.user.id);\r\n   } catch (error) {\r\n     if (error instanceof CommandError && error.code === 'RATE_LIMITED') {\r\n       logError('Interaction update rate limited', error, {\r\n         userId: interaction.user.id,\r\n         interactionId\r\n       });\r\n       return false;\r\n     }\r\n   }\r\n\r\n   // Check if this interaction has already been processed\r\n   if (processedInteractions.has(interactionId)) {\r\n     logger.warn(`Interaction ${interactionId} already processed, ignoring`, {\r\n       userId: interaction.user.id,\r\n       interactionId\r\n     });\r\n     return false;\r\n   }\r\n\r\n   logger.debug('Processing interaction update', {\r\n     userId: interaction.user.id,\r\n     interactionId,\r\n     hasEmbeds: !!options.embeds,\r\n     hasComponents: !!options.components,\r\n     hasContent: !!options.content,\r\n     isEphemeral: options.flags?.has(MessageFlags.Ephemeral) || false\r\n   });\r\n\r\n   try {\r\n     // Validate interaction object\r\n     validateNotEmpty(interaction, 'interaction');\r\n     validateNotEmpty(interaction.user, 'interaction.user');\r\n     validateUserId(interaction.user.id);\r\n\r\n     // Check if interaction is still valid\r\n     if (interaction.replied || interaction.deferred) {\r\n       logger.warn(`Interaction ${interactionId} already replied/deferred`, {\r\n         userId: interaction.user.id,\r\n         interactionId,\r\n         replied: interaction.replied,\r\n         deferred: interaction.deferred\r\n       });\r\n       return false;\r\n     }\r\n\r\n     // Mark as processed\r\n     processedInteractions.set(interactionId, Date.now());\r\n\r\n     // Sanitize content if present\r\n     if (options.content) {\r\n       options.content = sanitizeInput(options.content);\r\n     }\r\n\r\n     await interaction.update(options);\r\n     return true;\r\n   } catch (error) {\r\n     // Record error attempt in circuit breaker\r\n     recordErrorAttempt(interactionId);\r\n     logger.error(`Failed to reply to interaction ${interactionId}`, error instanceof Error ? error : new Error(String(error)), {\r\n       userId: interaction.user?.id,\r\n       interactionType: interaction?.type,\r\n       interactionId,\r\n       interactionState: {\r\n         replied: interaction?.replied,\r\n         deferred: interaction?.deferred\r\n       }\r\n     });\r\n\r\n     logger.error(`Failed to update interaction ${interactionId}`, error instanceof Error ? error : new Error(String(error)), {\r\n       userId: interaction.user.id,\r\n       interactionType: interaction.type,\r\n       interactionId\r\n     });\r\n     return false;\r\n   }\r\n }\r\n\r\n// Maps for cooldowns and processed interactions\r\nexport const spendCooldowns = new Map();\r\n\r\n// Export circuit breaker for use in errorHandler.js\r\nexport const circuitBreakerMap = circuitBreaker;\r\n\r\n// Wordle word list\r\nexport const wordleWords = ['HOUSE', 'PLANE', 'TIGER', 'BREAD', 'CHAIR', 'SNAKE', 'CLOUD', 'LIGHT', 'MUSIC', 'WATER', 'EARTH', 'STORM', 'FLAME', 'SHARP', 'QUIET', 'BRIGHT', 'DANCE', 'FIELD', 'GRASS', 'HEART', 'KNIFE', 'LARGE', 'MOUSE', 'NIGHT', 'OCEAN', 'PIANO', 'QUICK', 'RIVER', 'SHINE', 'TRUCK', 'WHEAT', 'YOUNG', 'ALARM', 'BEACH', 'CLOCK', 'DRIVE', 'ELBOW', 'FLOUR', 'GHOST', 'HAPPY', 'INDEX', 'JOINT', 'KNOCK', 'LUNCH', 'MIGHT', 'NOISE', 'OCCUR', 'PAINT', 'QUILT', 'ROBOT', 'SHORE', 'THICK', 'UNION', 'VOICE', 'WASTE', 'YIELD', 'ABUSE', 'ADULT', 'AGENT', 'AGREE', 'AHEAD', 'ALARM', 'ALBUM', 'ALERT', 'ALIEN', 'ALIGN', 'ALIKE', 'ALIVE', 'ALLOW', 'ALONE', 'ALONG', 'ALTER', 'AMONG', 'ANGER', 'ANGLE', 'ANGRY', 'APART', 'APPLE', 'APPLY', 'ARENA', 'ARGUE', 'ARISE', 'ARMED', 'ARMOR', 'ARRAY', 'ASIDE', 'ASSET', 'AVOID', 'AWAKE', 'AWARD', 'AWARE', 'BADLY', 'BAKER', 'BASES', 'BASIC', 'BEACH', 'BEGAN', 'BEGIN', 'BEING', 'BELOW', 'BENCH', 'BILLY', 'BIRTH', 'BLACK', 'BLAME', 'BLANK', 'BLIND', 'BLOCK', 'BLOOD', 'BOARD', 'BOOST', 'BOOTH', 'BOUND', 'BRAIN', 'BRAND', 'BRASS', 'BRAVE', 'BREAD', 'BREAK', 'BREED', 'BRIEF', 'BRING', 'BROAD', 'BROKE', 'BROWN', 'BUILD', 'BUILT', 'BUYER', 'CABLE', 'CALIF', 'CARRY', 'CATCH', 'CAUSE', 'CHAIN', 'CHAIR', 'CHAOS', 'CHARM', 'CHART', 'CHASE', 'CHEAP', 'CHECK', 'CHEST', 'CHIEF', 'CHILD', 'CHINA', 'CHOSE', 'CIVIL', 'CLAIM', 'CLASS', 'CLEAN', 'CLEAR', 'CLICK', 'CLIMB', 'CLOCK', 'CLOSE', 'CLOUD', 'COACH', 'COAST', 'COULD', 'COUNT', 'COURT', 'COVER', 'CRAFT', 'CRASH', 'CRAZY', 'CREAM', 'CRIME', 'CROSS', 'CROWD', 'CROWN', 'CRUDE', 'CURVE', 'CYCLE', 'DAILY', 'DANCE', 'DATED', 'DEALT', 'DEATH', 'DEBUT', 'DELAY', 'DEPTH', 'DOING', 'DOUBT', 'DOZEN', 'DRAFT', 'DRAMA', 'DRANK', 'DREAM', 'DRESS', 'DRILL', 'DRINK', 'DRIVE', 'DROVE', 'DYING', 'EAGER', 'EARLY', 'EARTH', 'EIGHT', 'ELITE', 'EMPTY', 'ENEMY', 'ENJOY', 'ENTER', 'ENTRY', 'EQUAL', 'ERROR', 'EVENT', 'EVERY', 'EXACT', 'EXIST', 'EXTRA', 'FAITH', 'FALSE', 'FAULT', 'FIBER', 'FIELD', 'FIFTH', 'FIFTY', 'FIGHT', 'FINAL', 'FIRST', 'FIXED', 'FLASH', 'FLEET', 'FLOOR', 'FLUID', 'FOCUS', 'FORCE', 'FORTH', 'FORTY', 'FORUM', 'FOUND', 'FRAME', 'FRANK', 'FRAUD', 'FRESH', 'FRONT', 'FRUIT', 'FULLY', 'FUNNY', 'GIANT', 'GIVEN', 'GLASS', 'GLOBE', 'GOING', 'GRACE', 'GRADE', 'GRAND', 'GRANT', 'GRASS', 'GRAVE', 'GREAT', 'GREEN', 'GROSS', 'GROUP', 'GROWN', 'GUARD', 'GUESS', 'GUEST', 'GUIDE', 'HAPPY', 'HARRY', 'HEART', 'HEAVY', 'HENCE', 'HENRY', 'HORSE', 'HOTEL', 'HOUSE', 'HUMAN', 'HURRY', 'IMAGE', 'INDEX', 'INNER', 'INPUT', 'ISSUE', 'JAPAN', 'JIMMY', 'JOINT', 'JONES', 'JUDGE', 'KNOWN', 'LABEL', 'LARGE', 'LASER', 'LATER', 'LAUGH', 'LAYER', 'LEARN', 'LEASE', 'LEAST', 'LEAVE', 'LEGAL', 'LEVEL', 'LEWIS', 'LIGHT', 'LIMIT', 'LINKS', 'LIVES', 'LOCAL', 'LOOSE', 'LOWER', 'LUCKY', 'LUNCH', 'LYING', 'MAGIC', 'MAJOR', 'MAKER', 'MARCH', 'MARIA', 'MATCH', 'MAYBE', 'MAYOR', 'MEANT', 'MEDAL', 'MEDIA', 'METAL', 'MIGHT', 'MINOR', 'MINUS', 'MIXED', 'MODEL', 'MONEY', 'MONTH', 'MORAL', 'MOTOR', 'MOUNT', 'MOUSE', 'MOUTH', 'MOVED', 'MOVIE', 'MUSIC', 'NEEDS', 'NEVER', 'NEWLY', 'NIGHT', 'NOISE', 'NORTH', 'NOTED', 'NOVEL', 'NURSE', 'OCCUR', 'OCEAN', 'OFFER', 'OFTEN', 'ORDER', 'OTHER', 'OUGHT', 'PAINT', 'PANEL', 'PAPER', 'PARTY', 'PEACE', 'PETER', 'PHASE', 'PHONE', 'PHOTO', 'PIANO', 'PIECE', 'PILOT', 'PITCH', 'PLACE', 'PLAIN', 'PLANE', 'PLANT', 'PLATE', 'PLAYS', 'PLENT', 'PLOTS', 'POEMS', 'POINT', 'POUND', 'POWER', 'PRESS', 'PRICE', 'PRIDE', 'PRIME', 'PRINT', 'PRIOR', 'PRIZE', 'PROOF', 'PROUD', 'PROVE', 'QUEEN', 'QUICK', 'QUIET', 'QUITE', 'RADIO', 'RAISE', 'RANGE', 'RAPID', 'RATIO', 'REACH', 'READY', 'REALM', 'REBEL', 'REFER', 'RELAX', 'REMARK', 'REMIND', 'REMOVE', 'RENDER', 'RENEW', 'RENTAL', 'REPAIR', 'REPEAT', 'REPLACE', 'REPORT', 'RESIST', 'RESOURCE', 'RESPONSE', 'RESULT', 'RETAIN', 'RETIRE', 'RETURN', 'REVEAL', 'REVIEW', 'REWARD', 'RIDER', 'RIDGE', 'RIGHT', 'RIGID', 'RING', 'RISE', 'RISK', 'RIVER', 'ROAD', 'ROBOT', 'ROGER', 'ROMAN', 'ROUGH', 'ROUND', 'ROUTE', 'ROYAL', 'RURAL', 'SCALE', 'SCENE', 'SCOPE', 'SCORE', 'SENSE', 'SERVE', 'SEVEN', 'SHALL', 'SHAPE', 'SHARE', 'SHARP', 'SHEET', 'SHELF', 'SHELL', 'SHIFT', 'SHINE', 'SHIRT', 'SHOCK', 'SHOOT', 'SHORT', 'SHOWN', 'SIDES', 'SIGHT', 'SILVER', 'SIMILAR', 'SIMPLE', 'SIXTH', 'SIXTY', 'SIZED', 'SKILL', 'SLEEP', 'SLIDE', 'SMALL', 'SMART', 'SMILE', 'SMITH', 'SMOKE', 'SNAKE', 'SOLID', 'SOLVE', 'SORRY', 'SOUND', 'SOUTH', 'SPACE', 'SPARE', 'SPEAK', 'SPEED', 'SPEND', 'SPENT', 'SPLIT', 'SPOKE', 'STAGE', 'STAKE', 'STAND', 'START', 'STATE', 'STEAM', 'STEEL', 'STEEP', 'STICK', 'STILL', 'STOCK', 'STONE', 'STOOD', 'STORE', 'STORM', 'STORY', 'STRIP', 'STUCK', 'STUDY', 'STUFF', 'STYLE', 'SUGAR', 'SUITE', 'SUPER', 'SWEET', 'TABLE', 'TAKEN', 'TASTE', 'TAXES', 'TEACH', 'TEETH', 'TERRY', 'TEXAS', 'THANK', 'THEFT', 'THEIR', 'THEME', 'THERE', 'THESE', 'THICK', 'THING', 'THINK', 'THIRD', 'THOSE', 'THREE', 'THREW', 'THROW', 'THUMB', 'TIGER', 'TIGHT', 'TIRED', 'TITLE', 'TODAY', 'TOKEN', 'TOPIC', 'TOTAL', 'TOUCH', 'TOUGH', 'TOWER', 'TRACK', 'TRADE', 'TRAIN', 'TREAT', 'TREND', 'TRIAL', 'TRIBE', 'TRICK', 'TRIED', 'TRIES', 'TRUCK', 'TRULY', 'TRUNK', 'TRUST', 'TRUTH', 'TWICE', 'TWIST', 'TYLER', 'UNION', 'UNITY', 'UNTIL', 'UPPER', 'UPSET', 'URBAN', 'USAGE', 'USUAL', 'VALUE', 'VIDEO', 'VIRUS', 'VISIT', 'VITAL', 'VOCAL', 'VOICE', 'WASTE', 'WATCH', 'WATER', 'WAVE', 'WHEEL', 'WHERE', 'WHICH', 'WHILE', 'WHITE', 'WHOLE', 'WINNER', 'WINTER', 'WOMAN', 'WOMEN', 'WORLD', 'WORRY', 'WORSE', 'WORST', 'WORTH', 'WOULD', 'WRITE', 'WRONG', 'WROTE', 'YOUNG', 'YOURS', 'YOUTH'];\r\n\r\n/**\r\n * Main interaction handler with comprehensive error handling and validation.\r\n * @param {BaseInteraction} interaction - The Discord interaction to handle\r\n * @param {Client} client - The Discord client instance\r\n */\r\nexport async function handleInteraction(interaction, client) {\r\n  const startTime = Date.now();\r\n\r\n   try {\r\n     // Validate interaction object\r\n     validateNotEmpty(interaction, 'interaction');\r\n     validateNotEmpty(interaction.user, 'interaction.user');\r\n     validateUserId(interaction.user.id);\r\n\r\n     // Global rate limiting\r\n     try {\r\n       await interactionRateLimiter.consume(interaction.user.id);\r\n     } catch (error) {\r\n       if (error instanceof CommandError && error.code === 'RATE_LIMITED') {\r\n         logError('Global interaction rate limited', error, {\r\n           userId: interaction.user.id,\r\n           interactionType: interaction.type\r\n         });\r\n         return await safeInteractionReply(interaction, {\r\n           content: `‚è∞ **Rate Limited!** Please slow down and try again in a moment.`,\r\n           flags: MessageFlags.Ephemeral\r\n         });\r\n       }\r\n     }\r\n\r\n     // Check global command cooldown\r\n     const globalCooldown = isOnCooldown(interaction.user.id, 'command_global');\r\n     if (globalCooldown.onCooldown) {\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚è∞ **Cooldown Active!** Please wait ${getFormattedCooldown(globalCooldown.remaining)} before using another command.`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Set global cooldown\r\n     setCooldown(interaction.user.id, 'command_global');\r\n\r\n     // Check command-specific cooldown\r\n     const commandCooldown = isOnCooldown(interaction.user.id, interaction.commandName);\r\n     if (commandCooldown.onCooldown) {\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚è∞ **${interaction.commandName} is on cooldown!** Please wait ${getFormattedCooldown(commandCooldown.remaining)}.`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Log command execution start\r\n     logCommandExecution(interaction, true);\r\n\r\n     // Handle modal submits with error handling\r\n     if (interaction.isModalSubmit()) {\r\n       await safeExecuteCommand(interaction, () => handleModalSubmit(interaction, client), {\r\n         interactionType: 'modal_submit',\r\n         customId: interaction.customId\r\n       });\r\n       return;\r\n     }\r\n\r\n     // Handle button interactions with error handling\r\n     if (interaction.isButton()) {\r\n       await safeExecuteCommand(interaction, () => handleButtonInteraction(interaction, client), {\r\n         interactionType: 'button',\r\n         customId: interaction.customId\r\n       });\r\n       return;\r\n     }\r\n\r\n     // Handle chat input commands with validation\r\n     if (interaction.isChatInputCommand()) {\r\n       const command = client.commands.get(interaction.commandName);\r\n       if (!command) {\r\n         throw new CommandError(`Unknown command: ${interaction.commandName}`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Set command-specific cooldown\r\n       const commandCooldown = isOnCooldown(interaction.user.id, interaction.commandName);\r\n       if (commandCooldown.onCooldown) {\r\n         return await safeInteractionReply(interaction, {\r\n           content: `‚è∞ **${interaction.commandName} is on cooldown!** Please wait ${getFormattedCooldown(commandCooldown.remaining)}.`,\r\n           flags: MessageFlags.Ephemeral\r\n         });\r\n       }\r\n\r\n       // Set adaptive cooldown for explore command with validation\r\n       if (interaction.commandName === 'explore') {\r\n         const char = getCharacter(interaction.user.id);\r\n         const level = char ? validateRange(char.lvl || 1, 1, 100, 'character level') : 1;\r\n         const adaptiveCooldown = Math.max(5000, 30000 - (level - 1) * 1000);\r\n         setCooldown(interaction.user.id, 'rpg_explore', adaptiveCooldown);\r\n       }\r\n\r\n       // Validate command input\r\n       const validationResult = /** @type {ValidationResult} */ (inputValidator.validateCommandInput(interaction));\r\n       if (!validationResult.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (validationResult).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Execute command with error handling\r\n       await safeExecuteCommand(interaction, () => command.execute(interaction), {\r\n         interactionType: 'chat_input_command',\r\n         commandName: interaction.commandName\r\n       });\r\n\r\n       // Set command-specific cooldown after successful execution\r\n       setCooldown(interaction.user.id, interaction.commandName);\r\n     }\r\n \r\n       // Log successful completion with timing\r\n       const executionTime = Date.now() - startTime;\r\n       logCommandExecution(interaction, true);\r\n \r\n     } catch (err) {\r\n       const executionTime = Date.now() - startTime;\r\n\r\n       // Log error details before handling\r\n       console.error('[HANDLE_INTERACTION] Error in handleInteraction:', err instanceof Error ? err.message : String(err));\r\n       console.error('[HANDLE_INTERACTION] Error stack:', err instanceof Error ? err.stack : undefined);\r\n       console.error('[HANDLE_INTERACTION] Interaction state at error:', {\r\n         id: interaction?.id,\r\n         replied: interaction?.replied,\r\n         deferred: interaction?.deferred,\r\n         type: interaction?.type,\r\n         commandName: interaction?.commandName,\r\n         userId: interaction?.user?.id\r\n       });\r\n\r\n       // Use standardized error handling\r\n       await handleCommandError(interaction, err instanceof CommandError ? err :\r\n         new CommandError(err instanceof Error ? err.message : 'Unknown error occurred', 'UNKNOWN_ERROR', {\r\n           originalError: err instanceof Error ? err.message : String(err),\r\n           stack: err instanceof Error ? err.stack : undefined,\r\n           executionTime\r\n         }), {\r\n         command: interaction instanceof ChatInputCommandInteraction ? interaction.commandName : 'unknown',\r\n         userId: interaction.user.id,\r\n         guild: interaction.guild?.name || 'DM',\r\n         channel: (interaction.channel && 'name' in interaction.channel) ? interaction.channel.name : 'Unknown',\r\n         executionTime\r\n       });\r\n\r\n       // Log command failure\r\n       logCommandExecution(interaction, false, err instanceof Error ? err : new Error(String(err)));\r\n     }\r\n}\r\n\r\n/**\r\n * Handles modal submit interactions with comprehensive validation and error handling.\r\n * @param {ModalSubmitInteraction} interaction - The modal submit interaction\r\n * @param {Client} client - The Discord client instance\r\n */\r\nasync function handleModalSubmit(interaction, client) {\r\n  const custom = interaction.customId || '';\r\n\r\n   try {\r\n     // Validate modal custom ID\r\n     validateNotEmpty(custom, 'modal customId');\r\n\r\n     if (custom.startsWith('rpg_reset_confirm:')) {\r\n       const parts = custom.split(':');\r\n       const mode = parts[1] || 'btn';\r\n       const targetUser = parts[2] || interaction.user.id;\r\n\r\n       // Validate target user\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot confirm reset for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const text = interaction.fields.getTextInputValue('confirm_text');\r\n       if (!text || text.trim() !== 'RESET') {\r\n         throw new CommandError('Confirmation text did not match. Type RESET to confirm.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const className = parts[3] || 'warrior';\r\n       const validation = /** @type {ValidationResult} */ (inputValidator.validateCharacterClass(className));\r\n       if (!validation.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (validation).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const def = resetCharacter(interaction.user.id, className);\r\n       return await safeInteractionReply(interaction, {\r\n         content: `Character reset to defaults: HP ${def.hp}/${def.maxHp} MP ${def.mp}/${def.maxMp} ATK ${def.atk} DEF ${def.def} SPD ${def.spd} Level ${def.lvl}`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle guess modal\r\n     if (custom.startsWith('guess_submit:')) {\r\n       const [, gameId] = custom.split(':');\r\n       const gameState = guessGames.get(gameId);\r\n\r\n       if (!gameState) {\r\n         await safeInteractionReply(interaction, { content: '‚ùå **Game not found!** The game may have expired.', flags: MessageFlags.Ephemeral });\r\n         return;\r\n       }\r\n\r\n       if (!gameState.gameActive) {\r\n         await safeInteractionReply(interaction, { content: '‚ùå **Game is no longer active!**', flags: MessageFlags.Ephemeral });\r\n         return;\r\n       }\r\n\r\n       const guess = interaction.fields.getTextInputValue('guess_number');\r\n\r\n       // Validate input\r\n       if (!guess || typeof guess !== 'string') {\r\n         throw new CommandError('Invalid guess input.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const guessNum = parseInt(guess.trim());\r\n\r\n       if (isNaN(guessNum)) {\r\n         throw new CommandError('Please enter a valid number!', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       if (guessNum < gameState.min || guessNum > gameState.max) {\r\n         throw new CommandError(`Number must be between ${gameState.min} and ${gameState.max}!`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       gameState.attemptsUsed++;\r\n\r\n       let feedback;\r\n       let isCorrect = false;\r\n\r\n       if (guessNum === gameState.secretNumber) {\r\n         feedback = 'üéâ Correct! You win!';\r\n         isCorrect = true;\r\n         gameState.gameActive = false;\r\n       } else if (guessNum < gameState.secretNumber) {\r\n         feedback = 'üìà Too low! Try a higher number.';\r\n       } else {\r\n         feedback = 'üìâ Too high! Try a lower number.';\r\n       }\r\n\r\n       // Store guess with feedback\r\n       gameState.guesses.push({\r\n         number: guessNum,\r\n         feedback,\r\n         attempt: gameState.attemptsUsed\r\n       });\r\n\r\n       if (isCorrect) {\r\n         guessGames.delete(gameId); // Clean up completed game\r\n         const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n         const attemptsUsed = gameState.attemptsUsed;\r\n\r\n         let performanceRating;\r\n         if (attemptsUsed === 1) performanceRating = 'üåü PERFECT! First try!';\r\n         else if (attemptsUsed <= 3) performanceRating = 'ü•á Excellent!';\r\n         else if (attemptsUsed <= 5) performanceRating = 'ü•à Good job!';\r\n         else if (attemptsUsed <= 7) performanceRating = 'ü•â Not bad!';\r\n         else performanceRating = 'üéØ You got it!';\r\n\r\n         const embed = new EmbedBuilder()\r\n           .setTitle('üéâ Congratulations!')\r\n           .setColor(0x00FF00)\r\n           .setDescription(`You guessed **${gameState.secretNumber}** correctly!\\n\\n${performanceRating}`)\r\n           .addFields(\r\n             {\r\n               name: 'üìä Game Stats',\r\n               value: `**Attempts:** ${attemptsUsed}/${gameState.attempts}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n               inline: true\r\n             },\r\n             {\r\n               name: 'üèÜ Performance',\r\n               value: `**Range:** ${gameState.min}-${gameState.max}\\n**Efficiency:** ${Math.round((1 - (attemptsUsed - 1) / gameState.attempts) * 100)}%`,\r\n               inline: true\r\n             }\r\n           );\r\n\r\n         if (gameState.guesses.length > 0) {\r\n           embed.addFields({\r\n             name: 'üìù Guess History',\r\n             value: gameState.guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n'),\r\n             inline: false\r\n           });\r\n         }\r\n\r\n         await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n       } else {\r\n         // Continue game\r\n         const { attempts, attemptsUsed: currentAttemptsUsed, min, max, guesses } = gameState;\r\n\r\n         if (currentAttemptsUsed >= attempts) {\r\n           gameState.gameActive = false;\r\n           guessGames.delete(gameId); // Clean up completed game\r\n           const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n           const loseEmbed = new EmbedBuilder()\r\n             .setTitle('‚ùå Game Over!')\r\n             .setColor(0xFF0000)\r\n             .setDescription(`The secret number was **${gameState.secretNumber}**!\\n\\nYou used all ${attempts} attempts in ${timeElapsed} seconds.`)\r\n             .addFields({\r\n               name: 'Your Guesses',\r\n               value: guesses.length > 0 ? guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n') : 'No guesses made',\r\n               inline: false\r\n             });\r\n\r\n           await safeInteractionUpdate(interaction, { embeds: [loseEmbed], components: [] });\r\n           return;\r\n         }\r\n\r\n         const embed = new EmbedBuilder()\r\n           .setTitle('üî¢ Number Guessing Game')\r\n           .setColor(0x0099FF)\r\n           .setDescription(`I'm thinking of a number between **${min}** and **${max}**.\\n\\nYou have **${attempts - currentAttemptsUsed}** attempts remaining.\\n\\n**${guessNum}** - ${feedback}`)\r\n           .addFields({\r\n             name: 'Previous Guesses',\r\n             value: guesses.length > 0 ?\r\n               guesses.slice(-5).map((g, i) => `**${g.number}** - ${g.feedback}`).join('\\n') :\r\n               'No guesses yet',\r\n             inline: false\r\n           });\r\n\r\n         // Create guess button\r\n         const row = new ActionRowBuilder().addComponents(\r\n           new ButtonBuilder().setCustomId(`guess_modal:${gameId}:${min}:${max}`).setLabel('üî¢ Make Guess').setStyle(ButtonStyle.Primary)\r\n         );\r\n\r\n         await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n       }\r\n\r\n       return;\r\n     }\r\n\r\n     // Handle guess modal\r\n     if (custom.startsWith('guess_modal:')) {\r\n       const [, gameId, min, max] = custom.split(':');\r\n\r\n       const gameState = guessGames.get(gameId);\r\n       if (!gameState) {\r\n         return safeInteractionReply(interaction, {\r\n           content: '‚ùå **Game not found!** The game may have expired.',\r\n           flags: MessageFlags.Ephemeral\r\n         });\r\n       }\r\n\r\n       if (!gameState.gameActive) {\r\n         return safeInteractionReply(interaction, {\r\n           content: '‚ùå **Game is no longer active!**',\r\n           flags: MessageFlags.Ephemeral\r\n         });\r\n       }\r\n\r\n       const modal = new ModalBuilder().setCustomId(`guess_submit:${gameId}`).setTitle('Make Your Guess');\r\n       const guessInput = new TextInputBuilder().setCustomId('guess_number').setLabel(`Guess a number between ${min} and ${max}`).setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder(`${min}-${max}`);\r\n\r\n       modal.addComponents(guessInput);\r\n       await interaction.showModal(modal);\r\n       return;\r\n     }\r\n\r\n     // Unknown modal type\r\n     throw new CommandError(`Unknown modal type: ${custom}`, 'INVALID_ARGUMENT');\r\n   } catch (error) {\r\n     logger.error('Modal submit error', error, {\r\n       customId: custom,\r\n       userId: interaction.user.id\r\n     });\r\n\r\n     if (error instanceof CommandError) {\r\n       await handleCommandError(interaction, error);\r\n     } else {\r\n       await handleCommandError(interaction, new CommandError(\r\n         'An error occurred while processing the modal.',\r\n         'UNKNOWN_ERROR',\r\n         { originalError: error instanceof Error ? error.message : String(error) }\r\n       ));\r\n     }\r\n   }\r\n }\r\n\r\n /**\r\n  * Handles modal submit interactions with validation (old implementation, duplicate).\r\n    * @param {ModalSubmitInteraction} interaction - The modal submit interaction\r\n    * @param {Client} client - The Discord client instance\r\n    */\r\n   async function handleModalSubmitOld(interaction, client) {\r\n     // @ts-ignore - interaction and client types handled by caller\r\n     const custom = interaction.customId || '';\r\n \r\n     try {\r\n       // Handle guild contribute modal\r\n       if (custom.startsWith('guild_contribute_modal:')) {\r\n         const parts = custom.split(':');\r\n         const guildName = parts[1];\r\n         const targetUser = parts[2];\r\n \r\n         validateUserId(targetUser);\r\n         if (targetUser !== interaction.user.id) {\r\n           throw new CommandError('You cannot contribute for another user.', 'PERMISSION_DENIED');\r\n         }\r\n \r\n         const amountStr = interaction.fields.getTextInputValue('amount');\r\n         const amount = /** @type {ValidationResult} */ (validateNumber(amountStr, { min: 1, max: 100000, integer: true, positive: true }));\r\n \r\n         if (!amount.valid) {\r\n           throw new CommandError(amount.reason, 'INVALID_ARGUMENT');\r\n         }\r\n \r\n         const userGuild = getUserGuild(interaction.user.id);\r\n         if (!userGuild || userGuild.name !== guildName) {\r\n           throw new CommandError('You are not a member of this guild.', 'PERMISSION_DENIED');\r\n         }\r\n \r\n         const currentBalance = getBalance(interaction.user.id);\r\n         if (currentBalance < amount.value) {\r\n           throw new CommandError('Insufficient gold balance.', 'INSUFFICIENT_FUNDS');\r\n         }\r\n \r\n         contributeToGuild(guildName, interaction.user.id, amount.value);\r\n         addBalance(interaction.user.id, -amount.value);\r\n \r\n         return await safeInteractionReply(interaction, {\r\n           content: `Successfully contributed ${amount.value} gold to ${guildName}!`,\r\n           flags: MessageFlags.Ephemeral\r\n         });\r\n       }\r\n \r\n       try {\r\n         // Handle economy transfer modal\r\n         if (custom.startsWith('economy_transfer_modal:')) {\r\n           const modal = new ModalBuilder().setCustomId('economy_transfer_modal_final').setTitle('Transfer Gold');\r\n           const recipientInput = new TextInputBuilder().setCustomId('recipient').setLabel('Recipient (username)').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('username');\r\n           const amountInput = new TextInputBuilder().setCustomId('amount').setLabel('Amount').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('100');\r\n \r\n           modal.addComponents(recipientInput, amountInput);\r\n           await interaction.showModal(modal);\r\n           return;\r\n           }\r\n         } catch (error) {\r\n           logger.error('Modal submit error', error, {\r\n             customId: custom,\r\n             userId: interaction.user.id\r\n           });\r\n   \r\n           if (error instanceof CommandError) {\r\n             await handleCommandError(interaction, error);\r\n           } else {\r\n             await handleCommandError(interaction, new CommandError(\r\n               'An error occurred while processing the modal.',\r\n               'UNKNOWN_ERROR',\r\n               { originalError: error instanceof Error ? error.message : String(error) }\r\n             ));\r\n           }\r\n         }\r\n\r\n     // Handle economy buy modal\r\n     if (custom.startsWith('economy_buy_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot buy items for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const itemNameStr = interaction.fields.getTextInputValue('item_name');\r\n       const quantityStr = interaction.fields.getTextInputValue('quantity');\r\n\r\n       const itemNameValidation = validateString(itemNameStr, { minLength: 1, maxLength: 50, required: true });\r\n       if (!itemNameValidation.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (itemNameValidation).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const quantity = validateNumber(quantityStr, { min: 1, max: 1000, integer: true, positive: true });\r\n       if (!quantity.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (quantity).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const marketPrices = getMarketPrice();\r\n       const itemKey = itemNameStr.toLowerCase().replace(/\\s+/g, '_');\r\n\r\n       if (!(itemKey in marketPrices)) {\r\n         throw new CommandError(`Item \"${itemNameStr}\" is not available in the market.`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const pricePerUnit = marketPrices[itemKey];\r\n       const totalCost = pricePerUnit * quantity.value;\r\n\r\n       const currentBalance = getBalance(interaction.user.id);\r\n       if (currentBalance < totalCost) {\r\n         throw new CommandError(`Insufficient gold balance. You need ${totalCost} gold but only have ${currentBalance}.`, 'INSUFFICIENT_FUNDS');\r\n       }\r\n\r\n       const char = getCharacter(interaction.user.id);\r\n       if (!char) {\r\n         throw new CommandError('You need to create a character first to use the market.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Attempt to buy the item\r\n       const buyResult = buyFromMarket(interaction.user.id, itemKey, quantity.value);\r\n\r\n       if (!buyResult.success) {\r\n         throw new CommandError(buyResult.reason || 'Failed to complete purchase.', 'UNKNOWN_ERROR');\r\n       }\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Successfully purchased ${/** @type {ValidationResult} */ (quantity).value}x ${itemNameStr} for ${totalCost} gold!\\nüí∞ New balance: ${/** @type {any} */ (buyResult).newBalance} gold`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle economy sell modal\r\n     if (custom.startsWith('economy_sell_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot sell items for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const itemNameStr = interaction.fields.getTextInputValue('item_name');\r\n       const quantityStr = interaction.fields.getTextInputValue('quantity');\r\n\r\n       const itemNameValidation = /** @type {ValidationResult} */ (validateString(itemNameStr, { minLength: 1, maxLength: 50, required: true }));\r\n       if (!itemNameValidation.valid) {\r\n         throw new CommandError(itemNameValidation.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const quantity = /** @type {ValidationResult} */ (validateNumber(quantityStr, { min: 1, max: 1000, integer: true, positive: true }));\r\n       if (!quantity.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (quantity).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const char = getCharacter(interaction.user.id);\r\n       if (!char) {\r\n         throw new CommandError('You need to create a character first to sell items.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const inventory = getInventory(interaction.user.id);\r\n       const itemKey = itemNameStr.toLowerCase().replace(/\\s+/g, '_');\r\n\r\n       if (!(itemKey in inventory) || inventory[itemKey] < quantity.value) {\r\n         throw new CommandError(`You don't have enough ${itemNameStr}. Available: ${inventory[itemKey] || 0}`, 'INSUFFICIENT_INVENTORY');\r\n       }\r\n\r\n       const itemInfo = getItemInfo(itemKey);\r\n       if (!itemInfo) {\r\n         throw new CommandError(`Unknown item: ${itemNameStr}`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const sellPricePerUnit = Math.floor(itemInfo.value * 0.7); // 70% of buy price\r\n       const totalEarnings = sellPricePerUnit * quantity.value;\r\n\r\n       // Attempt to sell the item\r\n       const sellResult = sellToMarket(interaction.user.id, itemKey, quantity.value);\r\n\r\n       if (!sellResult.success) {\r\n         throw new CommandError(sellResult.reason || 'Failed to complete sale.', 'UNKNOWN_ERROR');\r\n       }\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Successfully sold ${/** @type {ValidationResult} */ (quantity).value}x ${itemNameStr} for ${totalEarnings} gold!\\nüí∞ New balance: ${/** @type {any} */ (sellResult).newBalance} gold`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle trade create auction modal\r\n     if (custom.startsWith('trade_create_auction_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot create auctions for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const itemNameStr = interaction.fields.getTextInputValue('item_name');\r\n       const quantityStr = interaction.fields.getTextInputValue('quantity');\r\n       const priceStr = interaction.fields.getTextInputValue('starting_price');\r\n\r\n       const itemNameValidation = /** @type {ValidationResult} */ (validateString(itemNameStr, { minLength: 1, maxLength: 50, required: true }));\r\n       if (!itemNameValidation.valid) {\r\n         throw new CommandError(itemNameValidation.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const quantity = /** @type {ValidationResult} */ (validateNumber(quantityStr, { min: 1, max: 1000, integer: true, positive: true }));\r\n       if (!quantity.valid) {\r\n         throw new CommandError(quantity.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const startingPrice = /** @type {ValidationResult} */ (validateNumber(priceStr, { min: 1, max: 1000000, integer: true, positive: true }));\r\n       if (!startingPrice.valid) {\r\n         throw new CommandError(startingPrice.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const char = getCharacter(interaction.user.id);\r\n       if (!char) {\r\n         throw new CommandError('You need to create a character first to create auctions.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const inventory = getInventory(interaction.user.id);\r\n       const itemKey = itemNameStr.toLowerCase().replace(/\\s+/g, '_');\r\n\r\n       if (!(itemKey in inventory) || inventory[itemKey] < quantity.value) {\r\n         throw new CommandError(`You don't have enough ${itemNameStr}. Available: ${inventory[itemKey] || 0}`, 'INSUFFICIENT_INVENTORY');\r\n       }\r\n\r\n       const itemInfo = getItemInfo(itemKey);\r\n       if (!itemInfo) {\r\n         throw new CommandError(`Unknown item: ${itemNameStr}`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Create the auction\r\n       const auctionResult = createAuction(interaction.user.id, itemKey, quantity.value, startingPrice.value);\r\n\r\n       if (!auctionResult.success) {\r\n         throw new CommandError(auctionResult.reason || 'Failed to create auction.', 'UNKNOWN_ERROR');\r\n       }\r\n\r\n       // Remove items from inventory\r\n       removeItemFromInventory(interaction.user.id, itemKey, quantity.value);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Successfully created auction for ${quantity.value}x ${itemNameStr} starting at ${startingPrice.value} gold!\\nüìÖ Auction ends in 24 hours.`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle profile edit modal\r\n     if (custom.startsWith('profile_edit_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot edit another user\\'s profile.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const displayName = interaction.fields.getTextInputValue('display_name')?.trim();\r\n\r\n       // Validate display name if provided\r\n       if (displayName) {\r\n         const displayNameValidation = /** @type {ValidationResult} */ (validateString(displayName, { minLength: 1, maxLength: 32, required: false }));\r\n         if (!displayNameValidation.valid) {\r\n           throw new CommandError(displayNameValidation.reason, 'INVALID_ARGUMENT');\r\n         }\r\n       }\r\n\r\n       // Update profile\r\n       const updateData = {};\r\n       if (displayName) {\r\n         updateData.displayName = displayName;\r\n       }\r\n\r\n       const updatedProfile = updateProfile(interaction.user.id, updateData);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Profile updated successfully!${displayName ? `\\nüìù Display name: ${displayName}` : ''}`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle AI chat continue modal\r\n     if (custom.startsWith('ai_chat_continue_modal:')) {\r\n       const [, model, personality, targetUserId] = custom.split(':');\r\n       validateUserId(targetUserId);\r\n       if (targetUserId !== interaction.user.id) {\r\n         throw new CommandError('You cannot continue chat for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const message = interaction.fields.getTextInputValue('message')?.trim();\r\n       if (!message) {\r\n         throw new CommandError('Message cannot be empty.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const messageValidation = /** @type {ValidationResult} */ (validateString(message, { minLength: 1, maxLength: 2000, required: true }));\r\n       if (!messageValidation.valid) {\r\n         throw new CommandError(messageValidation.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Import AI chat function\r\n       const { generateChatResponse } = await import('./aiassistant.js');\r\n       const response = await generateChatResponse(interaction.user.id, message, model, personality);\r\n\r\n       const embed = new EmbedBuilder()\r\n         .setTitle('üí¨ AI Chat Response')\r\n         .setColor(0x00FF00)\r\n         .setDescription(response)\r\n         .addFields({\r\n           name: 'Your Message',\r\n           value: message.length > 1024 ? message.substring(0, 1021) + '...' : message,\r\n           inline: false\r\n         });\r\n\r\n       const row = new ActionRowBuilder().addComponents(\r\n         new ButtonBuilder().setCustomId(`ai_chat:${model}:${personality}:${interaction.user.id}`).setLabel('üí¨ Continue Chat').setStyle(ButtonStyle.Primary),\r\n         new ButtonBuilder().setCustomId(`ai_clear:${interaction.user.id}`).setLabel('üóëÔ∏è Clear History').setStyle(ButtonStyle.Secondary)\r\n       );\r\n\r\n       return await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n     }\r\n\r\n     // Unknown modal type\r\n     throw new CommandError(`Unknown modal type: ${custom}`, 'INVALID_ARGUMENT');\r\n\r\n   } catch (error) {\r\n     logger.error('Modal submit error', error, {\r\n       customId: custom,\r\n       userId: interaction.user.id\r\n     });\r\n\r\n     if (error instanceof CommandError) {\r\n       await handleCommandError(interaction, error);\r\n     } else {\r\n       await handleCommandError(interaction, new CommandError(\r\n         'An error occurred while processing the modal.',\r\n         'UNKNOWN_ERROR',\r\n         { originalError: error instanceof Error ? error.message : String(error) }\r\n       ));\r\n     }\r\n   }\r\n\r\n /**\r\n  * Handles modal submit interactions with validation (old implementation, duplicate).\r\n  * @param {ModalSubmitInteraction} interaction - The modal submit interaction\r\n  * @param {Client} client - The Discord client instance\r\n  */\r\n async function handleModalSubmitOld2(interaction, client) {\r\n   try {\r\n     // @ts-ignore - interaction and client types handled by caller\r\n     const custom = interaction.customId || '';\r\n       const parts = custom.split(':');\r\n       const guildName = parts[1];\r\n       const targetUser = parts[2];\r\n\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot contribute for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const amountStr = interaction.fields.getTextInputValue('amount');\r\n       const amount = /** @type {ValidationResult} */ (validateNumber(amountStr, { min: 1, max: 100000, integer: true, positive: true }));\r\n\r\n       if (!amount.valid) {\r\n         throw new CommandError(amount.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const userGuild = getUserGuild(interaction.user.id);\r\n       if (!userGuild || userGuild.name !== guildName) {\r\n         throw new CommandError('You are not a member of this guild.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const currentBalance = getBalance(interaction.user.id);\r\n       if (currentBalance < amount.value) {\r\n         throw new CommandError('Insufficient gold balance.', 'INSUFFICIENT_FUNDS');\r\n       }\r\n\r\n       contributeToGuild(guildName, interaction.user.id, amount.value);\r\n       addBalance(interaction.user.id, -amount.value);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `Successfully contributed ${amount.value} gold to ${guildName}!`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle economy transfer modal\r\n     if (custom.startsWith('economy_transfer_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n\r\n       const recipientStr = interaction.fields.getTextInputValue('recipient');\r\n       const amountStr = interaction.fields.getTextInputValue('amount');\r\n\r\n       const recipientValidation = /** @type {ValidationResult} */ (validateString(recipientStr, { minLength: 2, maxLength: 32, required: true }));\r\n       if (!recipientValidation.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (recipientValidation).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const amount = /** @type {ValidationResult} */ (validateNumber(amountStr, { min: 1, max: 100000, integer: true, positive: true }));\r\n       if (!amount.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (amount).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const currentBalance = getBalance(interaction.user.id);\r\n       if (currentBalance < amount.value) {\r\n         throw new CommandError('Insufficient gold balance.', 'INSUFFICIENT_FUNDS');\r\n       }\r\n\r\n       // Find recipient by username (simplified - in real implementation would use proper user resolution)\r\n       const recipient = interaction.guild?.members.cache.find(m =>\r\n         m.user.username.toLowerCase() === recipientStr.toLowerCase() ||\r\n         `${m.user.username}#${m.user.discriminator}`.toLowerCase() === recipientStr.toLowerCase()\r\n       );\r\n\r\n       if (!recipient) {\r\n         throw new CommandError('Recipient not found in this server.', 'USER_NOT_FOUND');\r\n       }\r\n\r\n       transferBalance(interaction.user.id, recipient.user.id, amount.value);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `Successfully transferred ${amount.value} gold to ${recipient.user.username}!`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle economy buy modal\r\n     if (custom.startsWith('economy_buy_modal:')) {\r\n       const modal = new ModalBuilder().setCustomId(`economy_buy_modal_final:${custom.split(':')[1]}`).setTitle('Buy Item');\r\n       const itemInput = new TextInputBuilder().setCustomId('item_name').setLabel('Item Name').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('health_potion');\r\n       const quantityInput = new TextInputBuilder().setCustomId('quantity').setLabel('Quantity').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('1');\r\n\r\n       modal.addComponents(itemInput, quantityInput);\r\n       await interaction.showModal(modal);\r\n       return;\r\n     }\r\n\r\n     // Handle economy sell modal\r\n     if (custom.startsWith('economy_sell_modal:')) {\r\n       const modal = new ModalBuilder().setCustomId(`economy_sell_modal_final:${custom.split(':')[1]}`).setTitle('Sell Item');\r\n       const itemInput = new TextInputBuilder().setCustomId('item_name').setLabel('Item Name').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('health_potion');\r\n       const quantityInput = new TextInputBuilder().setCustomId('quantity').setLabel('Quantity').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('1');\r\n\r\n       modal.addComponents(itemInput, quantityInput);\r\n       await interaction.showModal(modal);\r\n       return;\r\n     }\r\n\r\n     // Handle trade create auction modal\r\n     if (custom.startsWith('trade_create_auction_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot create auctions for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const itemNameStr = interaction.fields.getTextInputValue('item_name');\r\n       const quantityStr = interaction.fields.getTextInputValue('quantity');\r\n       const priceStr = interaction.fields.getTextInputValue('starting_price');\r\n\r\n       const itemNameValidation = /** @type {ValidationResult} */ (validateString(itemNameStr, { minLength: 1, maxLength: 50, required: true }));\r\n       if (!itemNameValidation.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (itemNameValidation).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const quantity = /** @type {ValidationResult} */ (validateNumber(quantityStr, { min: 1, max: 1000, integer: true, positive: true }));\r\n       if (!quantity.valid) {\r\n         throw new CommandError(/** @type {ValidationResult} */ (quantity).reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const startingPrice = /** @type {ValidationResult} */ (validateNumber(priceStr, { min: 1, max: 1000000, integer: true, positive: true }));\r\n       if (!startingPrice.valid) {\r\n         throw new CommandError(startingPrice.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const char = getCharacter(interaction.user.id);\r\n       if (!char) {\r\n         throw new CommandError('You need to create a character first to create auctions.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const inventory = getInventory(interaction.user.id);\r\n       const itemKey = itemNameStr.toLowerCase().replace(/\\s+/g, '_');\r\n\r\n       if (!(itemKey in inventory) || inventory[itemKey] < quantity.value) {\r\n         throw new CommandError(`You don't have enough ${itemNameStr}. Available: ${inventory[itemKey] || 0}`, 'INSUFFICIENT_INVENTORY');\r\n       }\r\n\r\n       const itemInfo = getItemInfo(itemKey);\r\n       if (!itemInfo) {\r\n         throw new CommandError(`Unknown item: ${itemNameStr}`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Create the auction\r\n       const auctionResult = createAuction(interaction.user.id, itemKey, quantity.value, startingPrice.value);\r\n\r\n       if (!auctionResult.success) {\r\n         throw new CommandError(auctionResult.reason || 'Failed to create auction.', 'UNKNOWN_ERROR');\r\n       }\r\n\r\n       // Remove items from inventory\r\n       removeItemFromInventory(interaction.user.id, itemKey, quantity.value);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Successfully created auction for ${quantity.value}x ${itemNameStr} starting at ${startingPrice.value} gold!\\nüìÖ Auction ends in 24 hours.`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle profile edit modal\r\n     if (custom.startsWith('profile_edit_modal:')) {\r\n       const targetUser = custom.split(':')[1];\r\n       validateUserId(targetUser);\r\n       if (targetUser !== interaction.user.id) {\r\n         throw new CommandError('You cannot edit another user\\'s profile.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const displayName = interaction.fields.getTextInputValue('display_name')?.trim();\r\n\r\n       // Validate display name if provided\r\n       if (displayName) {\r\n         const displayNameValidation = /** @type {ValidationResult} */ (validateString(displayName, { minLength: 1, maxLength: 32, required: false }));\r\n         if (!displayNameValidation.valid) {\r\n           throw new CommandError(displayNameValidation.reason, 'INVALID_ARGUMENT');\r\n         }\r\n       }\r\n\r\n       // Update profile\r\n       const updateData = {};\r\n       if (displayName) {\r\n         updateData.displayName = displayName;\r\n       }\r\n\r\n       const updatedProfile = updateProfile(interaction.user.id, updateData);\r\n\r\n       return await safeInteractionReply(interaction, {\r\n         content: `‚úÖ Profile updated successfully!${displayName ? `\\nüìù Display name: ${displayName}` : ''}`,\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     // Handle AI chat continue modal\r\n     if (custom.startsWith('ai_chat_continue_modal:')) {\r\n       const [, model, personality, targetUserId] = custom.split(':');\r\n       validateUserId(targetUserId);\r\n       if (targetUserId !== interaction.user.id) {\r\n         throw new CommandError('You cannot continue chat for another user.', 'PERMISSION_DENIED');\r\n       }\r\n\r\n       const message = interaction.fields.getTextInputValue('message')?.trim();\r\n       if (!message) {\r\n         throw new CommandError('Message cannot be empty.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const messageValidation = /** @type {ValidationResult} */ (validateString(message, { minLength: 1, maxLength: 2000, required: true }));\r\n       if (!messageValidation.valid) {\r\n         throw new CommandError(messageValidation.reason, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       // Import AI chat function\r\n       const { generateChatResponse } = await import('./aiassistant.js');\r\n       const response = await generateChatResponse(interaction.user.id, message, model, personality);\r\n\r\n       const embed = new EmbedBuilder()\r\n         .setTitle('üí¨ AI Chat Response')\r\n         .setColor(0x00FF00)\r\n         .setDescription(response)\r\n         .addFields({\r\n           name: 'Your Message',\r\n           value: message.length > 1024 ? message.substring(0, 1021) + '...' : message,\r\n           inline: false\r\n         });\r\n\r\n       const row = new ActionRowBuilder().addComponents(\r\n         new ButtonBuilder().setCustomId(`ai_chat:${model}:${personality}:${interaction.user.id}`).setLabel('üí¨ Continue Chat').setStyle(ButtonStyle.Primary),\r\n         new ButtonBuilder().setCustomId(`ai_clear:${interaction.user.id}`).setLabel('üóëÔ∏è Clear History').setStyle(ButtonStyle.Secondary)\r\n       );\r\n\r\n       return await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n     }\r\n\r\n     // Unknown modal type\r\n     throw new CommandError(`Unknown modal type: ${custom}`, 'INVALID_ARGUMENT');\r\n   } catch (error) {\r\n     logger.error('Modal submit error', error instanceof Error ? error : new Error(String(error)), {\r\n       customId: custom,\r\n       userId: interaction.user.id\r\n     });\r\n\r\n     if (error instanceof CommandError) {\r\n       await handleCommandError(interaction, error);\r\n     } else {\r\n       await handleCommandError(interaction, new CommandError(\r\n         'An error occurred while processing the modal.',\r\n         'UNKNOWN_ERROR',\r\n         { originalError: error instanceof Error ? error.message : String(error) }\r\n       ));\r\n     }\r\n   }\r\n }\r\n\r\n /**\r\n  * Handles modal submit interactions with validation (old implementation).\r\n  * @param {ModalSubmitInteraction} interaction - The modal submit interaction\r\n  * @param {Client} client - The Discord client instance\r\n  */\r\n async function handleModalSubmitOld(interaction, client) {\r\n   // @ts-ignore - interaction and client types handled by caller\r\n   const custom = interaction.customId || '';\r\n\r\n   try {\r\n\r\n     // Handle guess modal\r\n     if (custom.startsWith('guess_submit:')) {\r\n       const [, gameId] = custom.split(':');\r\n       const gameState = guessGames.get(gameId);\r\n\r\n       if (!gameState) {\r\n         await safeInteractionReply(interaction, { content: '‚ùå **Game not found!** The game may have expired.', flags: MessageFlags.Ephemeral });\r\n         return;\r\n       }\r\n\r\n       if (!gameState.gameActive) {\r\n         await safeInteractionReply(interaction, { content: '‚ùå **Game is no longer active!**', flags: MessageFlags.Ephemeral });\r\n         return;\r\n       }\r\n\r\n       const guess = interaction.fields.getTextInputValue('guess_number');\r\n\r\n       // Validate input\r\n       if (!guess || typeof guess !== 'string') {\r\n         throw new CommandError('Invalid guess input.', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const guessNum = parseInt(guess.trim());\r\n\r\n       if (isNaN(guessNum)) {\r\n         throw new CommandError('Please enter a valid number!', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       if (guessNum < gameState.min || guessNum > gameState.max) {\r\n         throw new CommandError(`Number must be between ${gameState.min} and ${gameState.max}!`, 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       gameState.attemptsUsed++;\r\n\r\n       let feedback;\r\n       let isCorrect = false;\r\n\r\n       if (guessNum === gameState.secretNumber) {\r\n         feedback = 'üéâ Correct! You win!';\r\n         isCorrect = true;\r\n         gameState.gameActive = false;\r\n       } else if (guessNum < gameState.secretNumber) {\r\n         feedback = 'üìà Too low! Try a higher number.';\r\n       } else {\r\n         feedback = 'üìâ Too high! Try a lower number.';\r\n       }\r\n\r\n       // Store guess with feedback\r\n       gameState.guesses.push({\r\n         number: guessNum,\r\n         feedback,\r\n         attempt: gameState.attemptsUsed\r\n       });\r\n\r\n       if (isCorrect) {\r\n         guessGames.delete(gameId); // Clean up completed game\r\n         const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n         const attemptsUsed = gameState.attemptsUsed;\r\n\r\n         let performanceRating;\r\n         if (attemptsUsed === 1) performanceRating = 'üåü PERFECT! First try!';\r\n         else if (attemptsUsed <= 3) performanceRating = 'ü•á Excellent!';\r\n         else if (attemptsUsed <= 5) performanceRating = 'ü•à Good job!';\r\n         else if (attemptsUsed <= 7) performanceRating = 'ü•â Not bad!';\r\n         else performanceRating = 'üéØ You got it!';\r\n\r\n         const embed = new EmbedBuilder()\r\n           .setTitle('üéâ Congratulations!')\r\n           .setColor(0x00FF00)\r\n           .setDescription(`You guessed **${gameState.secretNumber}** correctly!\\n\\n${performanceRating}`)\r\n           .addFields(\r\n             {\r\n               name: 'üìä Game Stats',\r\n               value: `**Attempts:** ${attemptsUsed}/${gameState.attempts}\\n**Time:** ${timeElapsed}s\\n**Difficulty:** ${gameState.difficulty.toUpperCase()}`,\r\n               inline: true\r\n             },\r\n             {\r\n               name: 'üèÜ Performance',\r\n               value: `**Range:** ${gameState.min}-${gameState.max}\\n**Efficiency:** ${Math.round((1 - (attemptsUsed - 1) / gameState.attempts) * 100)}%`,\r\n               inline: true\r\n             }\r\n           );\r\n\r\n         if (gameState.guesses.length > 0) {\r\n           embed.addFields({\r\n             name: 'üìù Guess History',\r\n             value: gameState.guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n'),\r\n             inline: false\r\n           });\r\n         }\r\n\r\n         await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n       } else {\r\n         // Continue game\r\n         const { attempts, attemptsUsed: currentAttemptsUsed, min, max, guesses } = gameState;\r\n\r\n         if (currentAttemptsUsed >= attempts) {\r\n           gameState.gameActive = false;\r\n           guessGames.delete(gameId); // Clean up completed game\r\n           const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n           const loseEmbed = new EmbedBuilder()\r\n             .setTitle('‚ùå Game Over!')\r\n             .setColor(0xFF0000)\r\n             .setDescription(`The secret number was **${gameState.secretNumber}**!\\n\\nYou used all ${attempts} attempts in ${timeElapsed} seconds.`)\r\n             .addFields({\r\n               name: 'Your Guesses',\r\n               value: guesses.length > 0 ? guesses.map((g, i) => `${i + 1}. **${g.number}** - ${g.feedback}`).join('\\n') : 'No guesses made',\r\n               inline: false\r\n             });\r\n\r\n           await safeInteractionUpdate(interaction, { embeds: [loseEmbed], components: [] });\r\n           return;\r\n         }\r\n\r\n         const embed = new EmbedBuilder()\r\n           .setTitle('üî¢ Number Guessing Game')\r\n           .setColor(0x0099FF)\r\n           .setDescription(`I'm thinking of a number between **${min}** and **${max}**.\\n\\nYou have **${attempts - currentAttemptsUsed}** attempts remaining.\\n\\n**${guessNum}** - ${feedback}`)\r\n           .addFields({\r\n             name: 'Previous Guesses',\r\n             value: guesses.length > 0 ?\r\n               guesses.slice(-5).map((g, i) => `**${g.number}** - ${g.feedback}`).join('\\n') :\r\n               'No guesses yet',\r\n             inline: false\r\n           });\r\n\r\n         // Create guess button\r\n         const row = new ActionRowBuilder().addComponents(\r\n           new ButtonBuilder().setCustomId(`guess_modal:${gameId}:${min}:${max}`).setLabel('üî¢ Make Guess').setStyle(ButtonStyle.Primary)\r\n         );\r\n\r\n         await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n       }\r\n\r\n       return;\r\n     }\r\n\r\n   // Handle guess modal\r\n   if (custom.startsWith('guess_modal:')) {\r\n     const [, gameId, min, max] = custom.split(':');\r\n\r\n     const gameState = guessGames.get(gameId);\r\n     if (!gameState) {\r\n       return safeInteractionReply(interaction, {\r\n         content: '‚ùå **Game not found!** The game may have expired.',\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     if (!gameState.gameActive) {\r\n       return safeInteractionReply(interaction, {\r\n         content: '‚ùå **Game is no longer active!**',\r\n         flags: MessageFlags.Ephemeral\r\n       });\r\n     }\r\n\r\n     const modal = new ModalBuilder().setCustomId(`guess_submit:${gameId}`).setTitle('Make Your Guess');\r\n     const guessInput = new TextInputBuilder().setCustomId('guess_number').setLabel(`Guess a number between ${min} and ${max}`).setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder(`${min}-${max}`);\r\n\r\n     const row = new ActionRowBuilder().addComponents(guessInput);\r\n     modal.addComponents([row]);\r\n     await interaction.showModal(modal);\r\n     return;\r\n   }\r\n\r\n     } catch (error) {\r\n       logger.error('Modal submit error', error, {\r\n         customId: custom,\r\n         userId: interaction.user.id\r\n       });\r\n \r\n       if (error instanceof CommandError) {\r\n         await handleCommandError(interaction, error);\r\n       } else {\r\n         await handleCommandError(interaction, new CommandError(\r\n           'An error occurred while processing the modal.',\r\n           'UNKNOWN_ERROR',\r\n           { originalError: error instanceof Error ? error.message : String(error) }\r\n         ));\r\n       }\r\n     }\r\n}\r\n\r\n/**\r\n * Handles button interaction events with comprehensive validation and error handling.\r\n * @param {ButtonInteraction} interaction - The button interaction\r\n * @param {Client} client - The Discord client instance\r\n */\r\nexport async function handleButtonInteraction(interaction, client) {\r\n  const userId = interaction.user.id;\r\n  const buttonCooldownType = getButtonCooldownType(interaction.customId);\r\n  const cooldownCheck = isOnCooldown(userId, buttonCooldownType);\r\n\r\n  if (cooldownCheck.onCooldown) {\r\n    logCommandExecution(interaction, false, new Error('Button on cooldown'));\r\n    logger.warn('Button on cooldown', {\r\n      userId: interaction.user.id,\r\n      customId: interaction.customId,\r\n      buttonCooldownType,\r\n      remainingTime: cooldownCheck.remaining\r\n    });\r\n    return interaction.reply({\r\n      content: `‚è∞ **Button on cooldown!** Please wait ${getFormattedCooldown(cooldownCheck.remaining)} before pressing this button again.`,\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n  }\r\n\r\n  // Set adaptive cooldown after check\r\n  const char = getCharacter(userId);\r\n  const level = char ? char.lvl || 1 : 1;\r\n  const adaptiveCooldown = Math.max(1000, cooldownCheck.cooldown - (level - 1) * 500);\r\n  setCooldown(userId, buttonCooldownType, adaptiveCooldown);\r\n\r\n  const [action, arg2, arg3] = interaction.customId ? interaction.customId.split(':') : [];\r\n\r\n  // Comprehensive logging for all button interactions\r\n  logger.info(`Handling button action: ${action}`, {\r\n    userId: interaction.user.id,\r\n    username: interaction.user.username,\r\n    customId: interaction.customId,\r\n    guild: interaction.guild?.name || 'DM',\r\n    guildId: interaction.guild?.id || 'N/A',\r\n    channel: interaction.channel?.name || 'Unknown',\r\n    channelId: interaction.channel?.id || 'N/A',\r\n    buttonCooldownType,\r\n    userLevel: level,\r\n    adaptiveCooldown\r\n  });\r\n\r\n  logCommandExecution(interaction, true); // Log successful button interaction start\r\n\r\n  try {\r\n    logger.debug(`Processing music button action: ${action}`, {\r\n      userId,\r\n      customId: interaction.customId,\r\n      action\r\n    });\r\n  } catch (error) {\r\n    logger.error(`Error handling button action ${action}`, error, {\r\n      userId: interaction.user.id,\r\n      action,\r\n      customId: interaction.customId\r\n    });\r\n    logCommandExecution(interaction, false, error);\r\n    await safeInteractionReply(interaction, {\r\n      content: '‚ùå **An error occurred while processing the button.**\\n\\nPlease try again later.',\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n  }\r\n}\r\n\r\n  try {\r\n    // Music button handlers\r\n    if (action === 'music_pause') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot pause music in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const result = await pause(interaction.guild.id);\r\n\r\n      logger.debug(`Music pause result: ${result}`, {\r\n        userId,\r\n        guildId: interaction.guild.id\r\n      });\r\n\r\n      if (result) {\r\n        const currentRow = interaction.message.components[0];\r\n        if (currentRow && currentRow.components) {\r\n          const newRow = currentRow.components.map(button => {\r\n            if (button.customId === `music_pause:${interaction.guild.id}`) {\r\n              return new ButtonBuilder()\r\n                .setCustomId(`music_resume:${interaction.guild.id}`)\r\n                .setLabel('‚ñ∂Ô∏è Resume')\r\n                .setStyle(ButtonStyle.Success);\r\n            }\r\n            return ButtonBuilder.from(button);\r\n          });\r\n\r\n          await safeInteractionUpdate(interaction, {\r\n            content: interaction.message.content,\r\n            embeds: interaction.message.embeds,\r\n            components: [new ActionRowBuilder().addComponents(newRow)]\r\n          });\r\n        } else {\r\n          await safeInteractionReply(interaction, { content: '‚è∏Ô∏è **Music paused!**', flags: MessageFlags.Ephemeral });\r\n        }\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå No music currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_resume') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot resume music in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const result = await resume(interaction.guild.id);\r\n\r\n      if (result) {\r\n        const currentRow = interaction.message.components[0];\r\n        if (currentRow && currentRow.components) {\r\n          const newRow = currentRow.components.map(button => {\r\n            if (button.customId === `music_resume:${interaction.guild.id}`) {\r\n              return new ButtonBuilder()\r\n                .setCustomId(`music_pause:${interaction.guild.id}`)\r\n                .setLabel('‚è∏Ô∏è Pause')\r\n                .setStyle(ButtonStyle.Primary);\r\n            }\r\n            return ButtonBuilder.from(button);\r\n          });\r\n\r\n          await safeInteractionUpdate(interaction, {\r\n            content: interaction.message.content,\r\n            embeds: interaction.message.embeds,\r\n            components: [new ActionRowBuilder().addComponents(newRow)]\r\n          });\r\n        } else {\r\n          await safeInteractionReply(interaction, { content: '‚ñ∂Ô∏è **Music resumed!**', flags: MessageFlags.Ephemeral });\r\n        }\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå No paused music to resume.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_skip') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot skip music in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const nextSong = await skip(interaction.guild.id);\r\n      if (nextSong) {\r\n        const embed = EmbedBuilder.from(interaction.message.embeds[0])\r\n          .setTitle('‚è≠Ô∏è Song Skipped')\r\n          .setDescription(`**Now Playing:** ${nextSong.title} by ${nextSong.artist}`)\r\n          .setColor(0xFFA500);\r\n\r\n        await safeInteractionUpdate(interaction, {\r\n          embeds: [embed],\r\n          components: interaction.message.components\r\n        });\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå No songs in queue to skip.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_stop') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot stop music in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const success = stop(interaction.guild.id);\r\n      if (success) {\r\n        const embed = EmbedBuilder.from(interaction.message.embeds[0])\r\n          .setTitle('‚èπÔ∏è Music Stopped')\r\n          .setDescription('Music stopped and left voice channel.')\r\n          .setColor(0xFF0000);\r\n\r\n        await safeInteractionUpdate(interaction, {\r\n          embeds: [embed],\r\n          components: []\r\n        });\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå No music is currently playing.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_queue') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot view queue in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const queue = getQueue(interaction.guild.id);\r\n      const stats = getMusicStats(interaction.guild.id);\r\n      const current = stats.currentlyPlaying;\r\n\r\n      let description = '';\r\n      if (current) {\r\n        description += `**Currently Playing:** ${current.title} by ${current.artist}\\n\\n`;\r\n      }\r\n      if (queue.length > 0) {\r\n        description += '**Queue:**\\n';\r\n        queue.slice(0, 10).forEach((song, index) => {\r\n          description += `${index + 1}. ${song.title} by ${song.artist}\\n`;\r\n        });\r\n        if (queue.length > 10) {\r\n          description += `... and ${queue.length - 10} more songs`;\r\n        }\r\n      } else {\r\n        description += 'Queue is empty.';\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìã Music Queue')\r\n        .setColor(0x0099FF)\r\n        .setDescription(description)\r\n        .addFields({\r\n          name: 'üìä Queue Info',\r\n          value: `**Total Songs:** ${stats.queueLength}\\n**Volume:** ${stats.volume}%`,\r\n          inline: true\r\n        });\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`music_shuffle:${interaction.guild.id}`).setLabel('üîÄ Shuffle').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`music_clear:${interaction.guild.id}`).setLabel('üóëÔ∏è Clear Queue').setStyle(ButtonStyle.Danger)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_shuffle') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot shuffle queue in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const success = shuffleQueue(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîÄ Queue Shuffled')\r\n          .setColor(0x9932CC)\r\n          .setDescription('Music queue has been shuffled!');\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Queue is empty or too small to shuffle.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_clear') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot clear queue in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const success = clearQueue(interaction.guild.id);\r\n      if (success) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üóëÔ∏è Queue Cleared')\r\n          .setColor(0xFF4500)\r\n          .setDescription('Music queue has been cleared!');\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Queue is already empty.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_back') {\r\n      const [, targetGuild] = interaction.customId.split(':');\r\n      if (targetGuild && targetGuild !== interaction.guild.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong guild'));\r\n        return interaction.reply({ content: 'You cannot go back in another server.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const previousSong = back(interaction.guild.id);\r\n      if (previousSong) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚¨ÖÔ∏è Back to Previous Song')\r\n          .setColor(0xFFA500)\r\n          .setDescription(`**Now Playing:** ${previousSong.title} by ${previousSong.artist}`)\r\n          .setThumbnail(previousSong.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n        await safeInteractionUpdate(interaction, {\r\n          embeds: [embed],\r\n          components: interaction.message.components\r\n        });\r\n      } else {\r\n        await safeInteractionReply(interaction, { content: '‚ùå No previous song in history.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_play') {\r\n      const [, index, query] = interaction.customId.split(':');\r\n      const songIndex = parseInt(index);\r\n\r\n      // Voice channel validation\r\n      const voiceChannel = interaction.member.voice?.channel;\r\n      if (!voiceChannel) {\r\n        logCommandExecution(interaction, false, new Error('No voice channel'));\r\n        return interaction.reply({\r\n          content: 'üéµ **You must be in a voice channel to play music!**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Bot permissions\r\n      const botPermissions = voiceChannel.permissionsFor(interaction.guild.members.me);\r\n      if (!botPermissions.has('Connect') || !botPermissions.has('Speak')) {\r\n        logCommandExecution(interaction, false, new Error('Missing permissions'));\r\n        return interaction.reply({\r\n          content: '‚ùå **I need \"Connect\" and \"Speak\" permissions in your voice channel.**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      try {\r\n        // Re-search to get the song (since we can't store the full list)\r\n        const songs = await searchSongs(query, 5);\r\n        if (songs.length > songIndex) {\r\n          const song = songs[songIndex];\r\n\r\n          // Play the song\r\n          const result = await play(interaction.guild.id, voiceChannel, song);\r\n          if (!result.success) {\r\n            let errorMessage = `‚ùå **Failed to play music**`;\r\n            switch (result.errorType) {\r\n              case 'validation_failed':\r\n                errorMessage += `\\n\\nüìπ **Video unavailable**\\nThe requested video is no longer available.`;\r\n                break;\r\n              case 'stream_creation':\r\n                errorMessage += `\\n\\nüîä **Audio stream error**\\nThere was an issue creating the audio stream.`;\r\n                break;\r\n              case 'connection_failed':\r\n                errorMessage += `\\n\\nüîó **Voice connection error**\\nFailed to establish connection.`;\r\n                break;\r\n              default:\r\n                errorMessage += `: ${result.error}`;\r\n            }\r\n            await safeInteractionReply(interaction, { content: errorMessage, flags: MessageFlags.Ephemeral });\r\n          } else {\r\n            // Create success embed\r\n            const embed = new EmbedBuilder()\r\n              .setTitle('üéµ Now Playing')\r\n              .setColor(0x00FF00)\r\n              .setDescription(`**${song.title}** by **${song.artist}**`)\r\n              .addFields(\r\n                { name: '‚è±Ô∏è Duration', value: song.duration, inline: true },\r\n                { name: 'üîä Volume', value: `${getMusicStats(interaction.guild.id).volume}%`, inline: true },\r\n                { name: 'üë§ Requested by', value: interaction.user.username, inline: true }\r\n              )\r\n              .setThumbnail(song.thumbnail || 'https://i.imgur.com/SjIgjlE.png');\r\n\r\n            if (song.source === 'spotify') {\r\n              embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing 30-second preview from Spotify', inline: false });\r\n            } else if (song.source === 'youtube') {\r\n              embed.addFields({ name: '‚ÑπÔ∏è Note', value: 'Playing full track from YouTube', inline: false });\r\n            }\r\n\r\n            const row = new ActionRowBuilder().addComponents(\r\n              new ButtonBuilder().setCustomId(`music_pause:${interaction.guild.id}`).setLabel('‚è∏Ô∏è Pause').setStyle(ButtonStyle.Primary),\r\n              new ButtonBuilder().setCustomId(`music_skip:${interaction.guild.id}`).setLabel('‚è≠Ô∏è Skip').setStyle(ButtonStyle.Secondary),\r\n              new ButtonBuilder().setCustomId(`music_stop:${interaction.guild.id}`).setLabel('‚èπÔ∏è Stop').setStyle(ButtonStyle.Danger),\r\n              new ButtonBuilder().setCustomId(`music_queue:${interaction.guild.id}`).setLabel('üìã Queue').setStyle(ButtonStyle.Secondary)\r\n            );\r\n\r\n            await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n          }\r\n        } else {\r\n          // Check interaction state before attempting to reply\r\n          if (interaction.replied || interaction.deferred) {\r\n            console.error(`[MUSIC_PLAY_BUTTON] Interaction already handled, cannot reply`, {\r\n              interactionId: interaction.id,\r\n              replied: interaction.replied,\r\n              deferred: interaction.deferred\r\n            });\r\n            return; // Don't attempt to reply if already handled\r\n          }\r\n          await safeInteractionReply(interaction, { content: '‚ùå **Song no longer available**', flags: MessageFlags.Ephemeral });\r\n        }\r\n      } catch (error) {\r\n        logger.error('[MUSIC] Play button error', error instanceof Error ? error : new Error(String(error)), {\r\n          userId: interaction.user.id,\r\n          query,\r\n          songIndex\r\n        });\r\n        // Check interaction state before attempting to reply\r\n        if (interaction.replied || interaction.deferred) {\r\n          console.error(`[MUSIC_PLAY_BUTTON_ERROR] Interaction already handled, cannot reply`, {\r\n            interactionId: interaction.id,\r\n            replied: interaction.replied,\r\n            deferred: interaction.deferred\r\n          });\r\n          return; // Don't attempt to reply if already handled\r\n        }\r\n        await safeInteractionReply(interaction, { content: '‚ùå **Failed to play song**', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'music_radio_change') {\r\n      const [, stationKey] = interaction.customId.split(':');\r\n\r\n      try {\r\n        const stations = getRadioStations();\r\n        const station = stations[stationKey];\r\n\r\n        if (!station) {\r\n          await safeInteractionReply(interaction, { content: '‚ùå Invalid radio station.', flags: MessageFlags.Ephemeral });\r\n          return;\r\n        }\r\n\r\n        // Voice channel check\r\n        const voiceChannel = interaction.member.voice?.channel;\r\n        if (!voiceChannel) {\r\n          logCommandExecution(interaction, false, new Error('No voice channel'));\r\n          return interaction.reply({ content: 'üéµ You must be in a voice channel to change radio!', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        // Create song object for radio\r\n        const song = {\r\n          title: station.name,\r\n          artist: station.genre,\r\n          duration: 'Live Stream',\r\n          url: station.url,\r\n          thumbnail: 'https://i.imgur.com/SjIgjlE.png',\r\n          requestedBy: interaction.user.username\r\n        };\r\n\r\n        // Play the radio\r\n        const result = await play(interaction.guild.id, voiceChannel, song);\r\n        if (!result.success) {\r\n          let errorMessage = `‚ùå **Failed to change radio station**`;\r\n          switch (result.errorType) {\r\n            case 'validation_failed':\r\n              errorMessage += `\\n\\nüìª **Radio station unavailable**`;\r\n              break;\r\n            case 'stream_creation':\r\n              errorMessage += `\\n\\nüîä **Stream error**`;\r\n              break;\r\n            case 'connection_failed':\r\n              errorMessage += `\\n\\nüîó **Voice connection error**`;\r\n              break;\r\n            default:\r\n              errorMessage += `: ${result.error}`;\r\n          }\r\n          await safeInteractionReply(interaction, { content: errorMessage, flags: MessageFlags.Ephemeral });\r\n        } else {\r\n          const embed = new EmbedBuilder()\r\n            .setTitle(`üìª Changed Station: ${station.name}`)\r\n            .setColor(0xFF9800)\r\n            .setDescription(`**${station.name}** radio is now playing!\\n\\nüéµ *Live streaming activated*`)\r\n            .addFields(\r\n              { name: 'üìª Station', value: station.name, inline: true },\r\n              { name: 'üéµ Genre', value: station.genre, inline: true },\r\n              { name: 'üîä Quality', value: 'Live Stream', inline: true }\r\n            );\r\n\r\n          await safeInteractionUpdate(interaction, { embeds: [embed], components: interaction.message.components });\r\n        }\r\n     catch (error) {\r\n        logger.error('[MUSIC] Radio change button error', error instanceof Error ? error : new Error(String(error)), {\r\n          userId: interaction.user.id,\r\n          stationKey\r\n        });\r\n        await safeInteractionReply(interaction, { content: '‚ùå Failed to change radio station.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Explore unlock button handler\r\n    if (action === 'explore_unlock') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot unlock locations for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Import discoverLocation function\r\n      const { discoverLocation, unlockLocation, getLocations } = await import('./locations.js');\r\n\r\n      const locations = getLocations();\r\n      const locationOrder = ['whispering_woods', 'crystal_caverns', 'volcano_summit', 'forgotten_temple', 'shadow_realm', 'celestial_spire'];\r\n\r\n      // Find the next unlockable location\r\n      let nextLocationId = null;\r\n      for (const locId of locationOrder) {\r\n        const location = locations[locId];\r\n        if (!location || location.unlocked) continue;\r\n\r\n        const discoverResult = await discoverLocation(interaction.user.id, locId);\r\n        if (discoverResult.success && discoverResult.canUnlock) {\r\n          nextLocationId = locId;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!nextLocationId) {\r\n        // No unlockable locations - update embed to show this\r\n        const currentEmbed = interaction.message.embeds[0];\r\n        const updatedEmbed = EmbedBuilder.from(currentEmbed)\r\n          .setDescription('üèïÔ∏è **No new locations available!**\\n\\nYou\\'ve discovered all currently available locations. Check back later for new content!');\r\n\r\n        // Remove the unlock button\r\n        const updatedComponents = interaction.message.components.map(row => ({\r\n          ...row,\r\n          components: row.components.filter(btn => btn.customId !== `explore_unlock:${interaction.user.id}`)\r\n        }));\r\n\r\n        await safeInteractionUpdate(interaction, {\r\n          embeds: [updatedEmbed],\r\n          components: updatedComponents.length > 0 ? updatedComponents : []\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Attempt to unlock the location\r\n      const unlockResult = unlockLocation(interaction.user.id, nextLocationId);\r\n\r\n      if (unlockResult.success) {\r\n        const unlockedLocation = unlockResult.location;\r\n\r\n        // Create success embed\r\n        const successEmbed = new EmbedBuilder()\r\n          .setTitle('üéâ New Location Discovered!')\r\n          .setColor(unlockedLocation.color)\r\n          .setDescription(unlockResult.message)\r\n          .addFields(\r\n            { name: 'üìç Location', value: unlockedLocation.name, inline: true },\r\n            { name: 'üèÜ Level', value: unlockedLocation.level, inline: true },\r\n            { name: 'üéØ Type', value: unlockedLocation.type, inline: true },\r\n            { name: 'üíé Rewards', value: `${unlockedLocation.rewards.xp} XP, ${unlockedLocation.rewards.gold} gold`, inline: false }\r\n          );\r\n\r\n        // Update the original message with the new location added\r\n        const currentEmbed = interaction.message.embeds[0];\r\n        const currentDescription = currentEmbed.description || '';\r\n\r\n        // Add the new location to the embed fields\r\n        const newFields = [...(currentEmbed.fields || [])];\r\n        newFields.push({\r\n          name: `${unlockedLocation.emoji} ${unlockedLocation.name} (Level ${unlockedLocation.level})`,\r\n          value: `**Type:** ${unlockedLocation.type}\\n**Description:** ${unlockedLocation.description}\\n**Rewards:** ${unlockedLocation.rewards.xp} XP, ${unlockedLocation.rewards.gold} gold`,\r\n          inline: false\r\n        });\r\n\r\n        const updatedEmbed = EmbedBuilder.from(currentEmbed)\r\n          .setFields(newFields);\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [updatedEmbed] });\r\n\r\n        // Send success message\r\n        await safeInteractionReply(interaction, { embeds: [successEmbed], flags: MessageFlags.Ephemeral });\r\n      } else {\r\n        // Unlock failed\r\n        const errorEmbed = new EmbedBuilder()\r\n          .setTitle('‚ùå Location Unlock Failed')\r\n          .setColor(0xFF0000)\r\n          .setDescription(`Failed to unlock location: ${unlockResult.reason || 'Unknown error'}`);\r\n\r\n        await safeInteractionReply(interaction, { embeds: [errorEmbed], flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Explore map button handler\r\n    if (action === 'explore_map') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot view map for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const locations = getLocations();\r\n      const availableLocations = Object.values(locations).filter(loc => loc.unlocked);\r\n\r\n      if (availableLocations.length === 0) {\r\n        return safeInteractionReply(interaction, { content: 'üèïÔ∏è No locations available yet. Start your adventure by exploring the Whispering Woods!\\nUse `/explore discover location:whispering_woods`', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Create map representation using text-based layout\r\n      const locationOrder = ['whispering_woods', 'crystal_caverns', 'volcano_summit', 'forgotten_temple', 'shadow_realm', 'celestial_spire'];\r\n      let mapText = '**üåç World Map**\\n\\n';\r\n\r\n      // Create a simple path representation\r\n      const pathSegments = [];\r\n      for (let i = 0; i < locationOrder.length; i++) {\r\n        const locId = locationOrder[i];\r\n        const location = locations[locId];\r\n\r\n        if (location && location.unlocked) {\r\n          // Unlocked location\r\n          pathSegments.push(`${location.emoji} **[${location.name}]**`);\r\n        } else if (location) {\r\n          // Locked location (not discovered yet)\r\n          pathSegments.push(`üîí *[???]*`);\r\n        }\r\n\r\n        // Add connector arrow if not the last location\r\n        if (i < locationOrder.length - 1) {\r\n          pathSegments.push(' ‚Üí ');\r\n        }\r\n      }\r\n\r\n      mapText += pathSegments.join('') + '\\n\\n';\r\n\r\n      // Add location details\r\n      mapText += '**üìç Discovered Locations:**\\n';\r\n      availableLocations.forEach(location => {\r\n        mapText += `${location.emoji} **${location.name}** (Level ${location.level}) - ${location.type}\\n`;\r\n      });\r\n\r\n      const mapEmbed = new EmbedBuilder()\r\n        .setTitle('üó∫Ô∏è World Map')\r\n        .setColor(0x0099FF)\r\n        .setDescription(mapText)\r\n        .setFooter({ text: 'Use /explore locations to view details and rewards for each location' });\r\n\r\n      // Keep the original buttons\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`explore_unlock:${interaction.user.id}`).setLabel('üîì Discover More').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`explore_map:${interaction.user.id}`).setLabel('üó∫Ô∏è View Map').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [mapEmbed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    // RPG/Explore button handlers\r\n    if (action === 'rpg_leaderboard') {\r\n      const [, offset, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot view another user\\'s leaderboard.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const limit = 10;\r\n      const offsetNum = parseInt(offset) || 0;\r\n      let board, total;\r\n      try {\r\n        board = getLeaderboard(limit, offsetNum);\r\n        total = getLeaderboardCount();\r\n      } catch (e) {\r\n        board = [];\r\n        total = 0;\r\n      }\r\n      const totalPages = Math.ceil(total / limit);\r\n      const page = Math.floor(offsetNum / limit) + 1;\r\n\r\n      const list = board.map((p, i) => `${offsetNum + i + 1}. ${p.name} ‚Äî Level ${p.lvl} XP ${p.xp} ATK ${p.atk}`).join('\\n');\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÜ RPG Leaderboard')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`Leaderboard ‚Äî Page ${page}/${totalPages}\\n\\n${list}`);\r\n\r\n      const row = new ActionRowBuilder();\r\n      if (offsetNum > 0) row.addComponents(new ButtonBuilder().setCustomId(`rpg_leaderboard:${Math.max(0, offsetNum - limit)}:${interaction.user.id}`).setLabel('Prev').setStyle(ButtonStyle.Secondary));\r\n      if (offsetNum + limit < total) row.addComponents(new ButtonBuilder().setCustomId(`rpg_leaderboard:${offsetNum + limit}:${interaction.user.id}`).setLabel('Next').setStyle(ButtonStyle.Primary));\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: row.components.length ? [row] : [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'rpg_reset_modal') {\r\n      const [, , targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot reset another user\\'s character.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`rpg_reset_confirm:btn:${interaction.user.id}:${arg3 || 'warrior'}`).setTitle('Confirm Reset');\r\n      const input = new TextInputBuilder().setCustomId('confirm_text').setLabel('Type RESET to confirm').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('RESET');\r\n\r\n      modal.addComponents({ type: 1, components: [input] });\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'explore_investigate') {\r\n      const [, locationId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot explore for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const locations = getLocations();\r\n      const location = locations.find(l => l.id === locationId);\r\n      if (!location) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå Location not found.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Simulate investigation\r\n      const events = ['monster', 'treasure', 'npc'];\r\n      const event = events[Math.floor(Math.random() * events.length)];\r\n\r\n      let result, xpGain = 0, goldGain = 0;\r\n\r\n      if (event === 'monster') {\r\n        const monster = encounterMonster(char.lvl);\r\n        const damage = fightTurn(char, monster);\r\n        if (damage > 0) {\r\n          char.hp -= damage;\r\n          if (char.hp <= 0) {\r\n            char.hp = 1; // Don't let HP go to 0\r\n          }\r\n        }\r\n        result = `üîç You investigate the area and encounter a **${monster.name}**!\\n‚öîÔ∏è You take **${damage}** damage. HP: ${char.hp}/${char.maxHp}`;\r\n        xpGain = 5;\r\n      } else if (event === 'treasure') {\r\n        const gold = Math.floor(Math.random() * 20) + 5;\r\n        char.gold += gold;\r\n        goldGain = gold;\r\n        result = `üîç You discover a hidden treasure chest!\\nüí∞ You find **${gold}** gold!`;\r\n        xpGain = 3;\r\n      } else {\r\n        result = `üîç You meet a friendly traveler who shares some wisdom!\\nüìñ You gain some experience from the conversation.`;\r\n        xpGain = 2;\r\n      }\r\n\r\n      applyXp(interaction.user.id, char, xpGain);\r\n      saveCharacter(interaction.user.id, char);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîç Investigation Results')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(result)\r\n        .addFields(\r\n          { name: 'üìä Stats', value: `Level ${char.lvl} ‚Ä¢ XP ${char.xp} ‚Ä¢ Gold ${char.gold}`, inline: true }\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'explore_search') {\r\n      const [, locationId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot explore for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const locations = getLocations();\r\n      const location = locations.find(l => l.id === locationId);\r\n      if (!location) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå Location not found.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Higher risk, higher reward search\r\n      const events = ['monster', 'monster', 'treasure', 'treasure', 'trap'];\r\n      const event = events[Math.floor(Math.random() * events.length)];\r\n\r\n      let result, xpGain = 0, goldGain = 0, itemGain = null;\r\n\r\n      if (event === 'monster') {\r\n        const monster = encounterMonster(char.lvl + 1);\r\n        const damage = fightTurn(char, monster);\r\n        if (damage > 0) {\r\n          char.hp -= damage;\r\n          if (char.hp <= 0) {\r\n            char.hp = 1;\r\n          }\r\n        }\r\n        result = `‚öîÔ∏è You search aggressively and fight a **${monster.name}**!\\nüí• You take **${damage}** damage. HP: ${char.hp}/${char.maxHp}`;\r\n        xpGain = 8;\r\n      } else if (event === 'treasure') {\r\n        const gold = Math.floor(Math.random() * 50) + 10;\r\n        char.gold += gold;\r\n        goldGain = gold;\r\n        result = `üí∞ You find a valuable treasure hoard!\\nü™ô You gain **${gold}** gold!`;\r\n        xpGain = 5;\r\n      } else if (event === 'trap') {\r\n        const damage = Math.floor(Math.random() * 15) + 5;\r\n        char.hp -= damage;\r\n        if (char.hp <= 0) {\r\n          char.hp = 1;\r\n        }\r\n        result = `‚ö†Ô∏è You trigger a trap!\\nüí• You take **${damage}** damage. HP: ${char.hp}/${char.maxHp}`;\r\n        xpGain = 1;\r\n      }\r\n\r\n      applyXp(interaction.user.id, char, xpGain);\r\n      saveCharacter(interaction.user.id, char);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚öîÔ∏è Search Results')\r\n        .setColor(event === 'trap' ? 0xFF0000 : 0x2196F3)\r\n        .setDescription(result)\r\n        .addFields(\r\n          { name: 'üìä Stats', value: `Level ${char.lvl} ‚Ä¢ XP ${char.xp} ‚Ä¢ Gold ${char.gold}`, inline: true }\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'explore_rest') {\r\n      const [, locationId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot rest for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Rest to recover HP and MP\r\n      const hpGain = Math.floor(char.maxHp * 0.3);\r\n      const mpGain = Math.floor(char.maxMp * 0.2);\r\n      char.hp = Math.min(char.maxHp, char.hp + hpGain);\r\n      char.mp = Math.min(char.maxMp, char.mp + mpGain);\r\n\r\n      saveCharacter(interaction.user.id, char);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üõå Rest Results')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(`You take a peaceful rest in the safety of ${locationId}.\\n‚ù§Ô∏è HP +${hpGain} ‚Üí ${char.hp}/${char.maxHp}\\nüîµ MP +${mpGain} ‚Üí ${char.mp}/${char.maxMp}`)\r\n        .addFields(\r\n          { name: 'üìä Stats', value: `Level ${char.lvl} ‚Ä¢ XP ${char.xp} ‚Ä¢ Gold ${char.gold}`, inline: true }\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'explore_continue') {\r\n      const [, locationName, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot continue adventure for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Simulate continuing adventure\r\n      const event = randomEventType();\r\n      let result, xpGain = 0;\r\n\r\n      if (event === 'monster') {\r\n        const monster = encounterMonster(char.lvl);\r\n        const damage = fightTurn(char, monster);\r\n        if (damage > 0) {\r\n          char.hp -= damage;\r\n          if (char.hp <= 0) {\r\n            char.hp = 1;\r\n          }\r\n        }\r\n        result = `üèÉ You continue your adventure and encounter a **${monster.name}**!\\n‚öîÔ∏è You take **${damage}** damage. HP: ${char.hp}/${char.maxHp}`;\r\n        xpGain = 6;\r\n      } else if (event === 'treasure') {\r\n        const gold = Math.floor(Math.random() * 30) + 10;\r\n        char.gold += gold;\r\n        result = `üèÉ You discover treasure along the way!\\nüí∞ You find **${gold}** gold!`;\r\n        xpGain = 4;\r\n      } else if (event === 'trap') {\r\n        const damage = Math.floor(Math.random() * 10) + 3;\r\n        char.hp -= damage;\r\n        if (char.hp <= 0) {\r\n          char.hp = 1;\r\n        }\r\n        result = `üèÉ You trigger a trap while exploring!\\nüí• You take **${damage}** damage. HP: ${char.hp}/${char.maxHp}`;\r\n        xpGain = 2;\r\n      } else {\r\n        result = `üèÉ You meet helpful travelers who guide you safely!\\nüìñ You learn from their stories.`;\r\n        xpGain = 3;\r\n      }\r\n\r\n      applyXp(interaction.user.id, char, xpGain);\r\n      saveCharacter(interaction.user.id, char);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÉ Continue Adventure')\r\n        .setColor(0x2196F3)\r\n        .setDescription(result)\r\n        .addFields(\r\n          { name: 'üìä Stats', value: `Level ${char.lvl} ‚Ä¢ XP ${char.xp} ‚Ä¢ Gold ${char.gold}`, inline: true }\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'explore_leave') {\r\n      const [, locationName, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot leave for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÉ Leave Location')\r\n        .setColor(0xFF9800)\r\n        .setDescription(`You safely leave ${locationName} and return to town.\\n\\n*Your adventure continues another day!*`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    // Economy button handlers\r\n    if (action === 'economy_transfer') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot transfer for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`economy_transfer_modal:${interaction.user.id}`).setTitle('Transfer Gold');\r\n      const recipientInput = new TextInputBuilder().setCustomId('recipient').setLabel('Recipient (username)').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('username');\r\n      const amountInput = new TextInputBuilder().setCustomId('amount').setLabel('Amount').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('100');\r\n\r\n      modal.addComponents(\r\n        { type: 1, components: [recipientInput] },\r\n        { type: 1, components: [amountInput] }\r\n      );\r\n\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'economy_market') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot access market for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const marketPrices = getMarketPrice();\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üõí Market Prices')\r\n        .setColor(0x4CAF50)\r\n        .setDescription('Current market prices:');\r\n\r\n      for (const [item, price] of Object.entries(marketPrices)) {\r\n        embed.addFields({\r\n          name: item.charAt(0).toUpperCase() + item.slice(1),\r\n          value: `${price} gold`,\r\n          inline: true\r\n        });\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`economy_buy:${interaction.user.id}`).setLabel('üõí Buy').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`economy_sell:${interaction.user.id}`).setLabel('üí∏ Sell').setStyle(ButtonStyle.Success)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'economy_business') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot manage business for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const income = Math.floor(Math.random() * 50) + 10;\r\n      const balanceUpdate = addBalance(interaction.user.id, income);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üè™ Business Income')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(`Your business generated **${income}** gold today!\\nüí∞ New balance: **${balanceUpdate}** gold`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'economy_invest') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot invest for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const currentBalance = getBalance(interaction.user.id);\r\n      if (currentBalance < 100) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå You need at least 100 gold to invest.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const investment = 100;\r\n      const returns = Math.random() > 0.5 ? investment * 1.5 : investment * 0.8;\r\n      const profit = returns - investment;\r\n\r\n      if (profit > 0) {\r\n        addBalance(interaction.user.id, profit);\r\n      } else {\r\n        addBalance(interaction.user.id, profit); // This will subtract\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìà Investment Results')\r\n        .setColor(profit > 0 ? 0x4CAF50 : 0xFF0000)\r\n        .setDescription(`You invested **${investment}** gold.\\n${profit > 0 ? 'üìà Profit' : 'üìâ Loss'}: **${Math.abs(profit)}** gold\\nüí∞ New balance: **${getBalance(interaction.user.id)}** gold`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'economy_buy') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot buy for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const marketPrices = getMarketPrice();\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üõí Buy from Market')\r\n        .setColor(0x2196F3)\r\n        .setDescription('Select an item to buy:');\r\n\r\n      let description = '';\r\n      for (const [item, price] of Object.entries(marketPrices)) {\r\n        description += `‚Ä¢ ${item.charAt(0).toUpperCase() + item.slice(1)}: ${price} gold\\n`;\r\n      }\r\n      description += '\\n*Use the modal to specify what you want to buy.*';\r\n\r\n      embed.setDescription(description);\r\n\r\n      const modal = new ModalBuilder().setCustomId(`economy_buy_modal:${interaction.user.id}`).setTitle('Buy Item');\r\n      const itemInput = new TextInputBuilder().setCustomId('item_name').setLabel('Item Name').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('health_potion');\r\n      const quantityInput = new TextInputBuilder().setCustomId('quantity').setLabel('Quantity').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('1');\r\n\r\n      modal.addComponents(\r\n        { type: 1, components: [itemInput] },\r\n        { type: 1, components: [quantityInput] }\r\n      );\r\n\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'economy_sell') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot sell for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const inventory = getInventory(interaction.user.id);\r\n      if (Object.keys(inventory).length === 0) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Your inventory is empty!', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí∏ Sell Items')\r\n        .setColor(0xFF9800)\r\n        .setDescription('Select items to sell from your inventory:');\r\n\r\n      let description = '';\r\n      for (const [itemId, quantity] of Object.entries(inventory)) {\r\n        const item = getItemInfo(itemId);\r\n        if (item) {\r\n          const sellPrice = Math.floor(item.value * 0.7); // 70% of buy price\r\n          description += `‚Ä¢ ${item.name}: ${quantity}x (${sellPrice} gold each)\\n`;\r\n        }\r\n      }\r\n      description += '\\n*Use the modal to specify what you want to sell.*';\r\n\r\n      embed.setDescription(description);\r\n\r\n      const modal = new ModalBuilder().setCustomId(`economy_sell_modal:${interaction.user.id}`).setTitle('Sell Item');\r\n      const itemInput = new TextInputBuilder().setCustomId('item_name').setLabel('Item Name').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('health_potion');\r\n      const quantityInput = new TextInputBuilder().setCustomId('quantity').setLabel('Quantity').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('1');\r\n\r\n      modal.addComponents(\r\n        { type: 1, components: [itemInput] },\r\n        { type: 1, components: [quantityInput] }\r\n      );\r\n\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    // Other module button handlers\r\n    if (action === 'trade_create_auction') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot create auctions for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`trade_create_auction_modal:${interaction.user.id}`).setTitle('Create Auction');\r\n      const itemInput = new TextInputBuilder().setCustomId('item_name').setLabel('Item Name').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('health_potion');\r\n      const quantityInput = new TextInputBuilder().setCustomId('quantity').setLabel('Quantity').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('1');\r\n      const priceInput = new TextInputBuilder().setCustomId('starting_price').setLabel('Starting Price (gold)').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('50');\r\n\r\n      modal.addComponents(\r\n        { type: 1, components: [itemInput] },\r\n        { type: 1, components: [quantityInput] },\r\n        { type: 1, components: [priceInput] }\r\n      );\r\n\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'trade_view_auctions') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot view auctions for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const auctions = getActiveAuctions();\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîç Active Auctions')\r\n        .setColor(0x2196F3)\r\n        .setDescription(auctions.length > 0 ?\r\n          auctions.slice(0, 10).map(a => `‚Ä¢ ${a.itemName} x${a.quantity} - Starting: ${a.startingPrice} gold - Seller: ${a.seller}`).join('\\n') :\r\n          'No active auctions at the moment.'\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'profile_edit') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot edit another user\\'s profile.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`profile_edit_modal:${interaction.user.id}`).setTitle('Edit Profile');\r\n      const displayNameInput = new TextInputBuilder().setCustomId('display_name').setLabel('Display Name').setStyle(TextInputStyle.Short).setRequired(false).setPlaceholder('Your display name');\r\n\r\n      modal.addComponents({ type: 1, components: [displayNameInput] });\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'profile_refresh') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot refresh another user\\'s profile.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const profile = updateProfile(interaction.user.id, {});\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ Profile Refreshed')\r\n        .setColor(0x4CAF50)\r\n        .setDescription('Profile data has been refreshed!');\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: interaction.message.components });\r\n      return;\r\n    }\r\n\r\n    if (action === 'profile_compare') {\r\n      const [, targetUserId, compareUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot compare profiles for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      validateUserId(compareUserId);\r\n\r\n      // Get both profiles\r\n      const targetProfile = updateProfile(interaction.user.id, {});\r\n      const compareProfile = updateProfile(compareUserId, {});\r\n\r\n      // Find the comparison user\r\n      const compareUser = interaction.guild?.members.cache.get(compareUserId)?.user;\r\n      if (!compareUser) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå Could not find the user to compare with.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Create comparison embed\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚öñÔ∏è Profile Comparison')\r\n        .setColor(0x2196F3)\r\n        .setDescription(`Comparing **${interaction.user.username}** vs **${compareUser.username}**`);\r\n\r\n      // Add comparison fields\r\n      if (targetProfile.level !== undefined && compareProfile.level !== undefined) {\r\n        const levelDiff = targetProfile.level - compareProfile.level;\r\n        embed.addFields({\r\n          name: 'üèÜ Level',\r\n          value: `**${interaction.user.username}:** ${targetProfile.level}\\n**${compareUser.username}:** ${compareProfile.level}\\n${levelDiff > 0 ? `üìà You are ${levelDiff} levels ahead` : levelDiff < 0 ? `üìâ You are ${Math.abs(levelDiff)} levels behind` : '‚öñÔ∏è Same level'}`,\r\n          inline: true\r\n        });\r\n      }\r\n\r\n      if (targetProfile.xp !== undefined && compareProfile.xp !== undefined) {\r\n        const xpDiff = targetProfile.xp - compareProfile.xp;\r\n        embed.addFields({\r\n          name: '‚≠ê Experience',\r\n          value: `**${interaction.user.username}:** ${targetProfile.xp}\\n**${compareUser.username}:** ${compareProfile.xp}\\n${xpDiff > 0 ? `üìà You have ${xpDiff} more XP` : xpDiff < 0 ? `üìâ You have ${Math.abs(xpDiff)} less XP` : '‚öñÔ∏è Same XP'}`,\r\n          inline: true\r\n        });\r\n      }\r\n\r\n      if (targetProfile.gold !== undefined && compareProfile.gold !== undefined) {\r\n        const goldDiff = targetProfile.gold - compareProfile.gold;\r\n        embed.addFields({\r\n          name: 'üí∞ Gold',\r\n          value: `**${interaction.user.username}:** ${targetProfile.gold}\\n**${compareUser.username}:** ${compareProfile.gold}\\n${goldDiff > 0 ? `üìà You have ${goldDiff} more gold` : goldDiff < 0 ? `üìâ You have ${Math.abs(goldDiff)} less gold` : '‚öñÔ∏è Same gold amount'}`,\r\n          inline: true\r\n        });\r\n      }\r\n\r\n      if (targetProfile.achievements !== undefined && compareProfile.achievements !== undefined) {\r\n        const achievementsDiff = targetProfile.achievements - compareProfile.achievements;\r\n        embed.addFields({\r\n          name: 'üèÖ Achievements',\r\n          value: `**${interaction.user.username}:** ${targetProfile.achievements}\\n**${compareUser.username}:** ${compareProfile.achievements}\\n${achievementsDiff > 0 ? `üìà You have ${achievementsDiff} more achievements` : achievementsDiff < 0 ? `üìâ You have ${Math.abs(achievementsDiff)} fewer achievements` : '‚öñÔ∏è Same number of achievements'}`,\r\n          inline: true\r\n        });\r\n      }\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'remind_upcoming') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot view reminders for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìÖ Upcoming Reminders')\r\n        .setColor(0xFF9800)\r\n        .setDescription('No upcoming reminders set.');\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    // Memory game button handlers\r\n    if (action.startsWith('memory_')) {\r\n      const parts = interaction.customId.split('_');\r\n      const cardIndexStr = parts[1];\r\n      const messageId = interaction.message.id;\r\n\r\n      // Handle memory reset (existing implementation)\r\n      if (cardIndexStr === 'reset') {\r\n        const [, , targetUserId] = interaction.customId.split(':');\r\n\r\n        if (targetUserId && targetUserId !== interaction.user.id) {\r\n          logCommandExecution(interaction, false, new Error('Wrong user'));\r\n          return safeInteractionReply(interaction, { content: 'You cannot reset memory for another user.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        const gameState = memoryGames.get(messageId);\r\n        if (!gameState) {\r\n          return safeInteractionReply(interaction, { content: '‚ùå **Memory game not found!**', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        // Reset flipped cards\r\n        gameState.flippedCards = [];\r\n        gameState.moves++;\r\n\r\n        // Update the board display\r\n        const { sendMemoryBoard } = await import('./commands/memory.js');\r\n        await sendMemoryBoard(interaction, gameState);\r\n        return;\r\n      }\r\n\r\n      // Handle card flip\r\n      const cardIndex = parseInt(cardIndexStr);\r\n      if (isNaN(cardIndex) || cardIndex < 0 || cardIndex >= 12) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå **Invalid card!**', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const gameState = memoryGames.get(messageId);\r\n      if (!gameState) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå **Memory game not found!**', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Validate game state\r\n      if (!gameState.gameActive) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå **Game is already completed!**', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const card = gameState.cards[cardIndex];\r\n\r\n      // Check if card is already matched or flipped\r\n      if (card.isMatched) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå **Card is already matched!**', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      if (gameState.flippedCards.includes(cardIndex)) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå **Card is already flipped!**', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Flip the card\r\n      gameState.flippedCards.push(cardIndex);\r\n      gameState.moves++;\r\n\r\n      // Check for matches (if 2 cards are flipped)\r\n      if (gameState.flippedCards.length === 2) {\r\n        const [firstIndex, secondIndex] = gameState.flippedCards;\r\n        const firstCard = gameState.cards[firstIndex];\r\n        const secondCard = gameState.cards[secondIndex];\r\n\r\n        if (firstCard.emoji === secondCard.emoji) {\r\n          // Match found!\r\n          firstCard.isMatched = true;\r\n          secondCard.isMatched = true;\r\n          gameState.matchedPairs++;\r\n\r\n          // Clear flipped cards immediately for matches\r\n          gameState.flippedCards = [];\r\n\r\n          // Check for win condition\r\n          if (gameState.matchedPairs === gameState.totalPairs) {\r\n            gameState.gameActive = false;\r\n            const timeElapsed = Math.round((Date.now() - gameState.startTime) / 1000);\r\n\r\n            const winEmbed = new EmbedBuilder()\r\n              .setTitle('üéâ Memory Master!')\r\n              .setDescription(`Congratulations! You matched all ${gameState.totalPairs} pairs in ${gameState.moves} moves and ${timeElapsed} seconds! üèÜ`)\r\n              .setColor(0x00FF00)\r\n              .addFields(\r\n                {\r\n                  name: 'üìä Stats',\r\n                  value: `**Moves:** ${gameState.moves}\\n**Time:** ${timeElapsed}s\\n**Efficiency:** ${((gameState.totalPairs / gameState.moves) * 100).toFixed(1)}%`,\r\n                  inline: true\r\n                },\r\n                {\r\n                  name: 'üèÜ Rating',\r\n                  value: getPerformanceRating(gameState.moves, gameState.totalPairs, timeElapsed),\r\n                  inline: true\r\n                }\r\n              );\r\n\r\n            // Clean up game state\r\n            memoryGames.delete(messageId);\r\n\r\n            await safeInteractionUpdate(interaction, { embeds: [winEmbed], components: [] });\r\n            return;\r\n          }\r\n        } else {\r\n          // No match - cards will stay flipped temporarily, reset button will be shown\r\n          // The reset button handler above will clear the flipped cards\r\n        }\r\n      }\r\n\r\n      // Update the board display\r\n      const { sendMemoryBoard } = await import('./commands/memory.js');\r\n      await sendMemoryBoard(interaction, gameState);\r\n      return;\r\n    }\r\n\r\n    if (action === 'inventory_refresh') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot refresh inventory for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const inventory = getInventory(interaction.user.id);\r\n      const inventoryValue = getInventoryValue(interaction.user.id);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéí Inventory')\r\n        .setColor(0x8B4513)\r\n        .setDescription(`üí∞ Total Value: ${inventoryValue} gold`);\r\n\r\n      for (const [itemId, quantity] of Object.entries(inventory)) {\r\n        const item = getItemInfo(itemId);\r\n        if (item) {\r\n          embed.addFields({\r\n            name: `${item.name}`,\r\n            value: `Quantity: ${quantity} (${item.value} gold each)`,\r\n            inline: true\r\n          });\r\n        }\r\n      }\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`inventory_random:${interaction.user.id}`).setLabel('üé≤ Get Random Item').setStyle(ButtonStyle.Secondary),\r\n        new ButtonBuilder().setCustomId(`inventory_sell_all:${interaction.user.id}`).setLabel('üí∞ Sell All Junk').setStyle(ButtonStyle.Success)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'inventory_random') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot get random items for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const randomItem = generateRandomItem(char.lvl);\r\n      addItemToInventory(interaction.user.id, randomItem.id, 1);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üé≤ Random Item')\r\n        .setColor(0xFFD700)\r\n        .setDescription(`You found a **${randomItem.name}**!\\n\\n${randomItem.description}`)\r\n        .addFields(\r\n          { name: 'üìä Stats', value: `Rarity: ${randomItem.rarity} ‚Ä¢ Value: ${randomItem.value} gold`, inline: true }\r\n        );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'inventory_sell_all') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot sell items for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const char = getCharacter(interaction.user.id);\r\n      if (!char) {\r\n        return safeInteractionReply(interaction, { content: '‚ùå You need to create a character first!', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const inventory = getInventory(interaction.user.id);\r\n      let totalGold = 0;\r\n      let itemsSold = 0;\r\n\r\n      for (const [itemId, quantity] of Object.entries(inventory)) {\r\n        const item = getItemInfo(itemId);\r\n        if (item && item.rarity === 'common') { // Only sell common items as \"junk\"\r\n          const sellPrice = Math.floor(item.value * 0.5); // 50% of value for junk\r\n          totalGold += sellPrice * quantity;\r\n          itemsSold += quantity;\r\n          removeItemFromInventory(interaction.user.id, itemId, quantity);\r\n        }\r\n      }\r\n\r\n      char.gold += totalGold;\r\n      saveCharacter(interaction.user.id, char);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí∞ Sold Junk Items')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(`Sold ${itemsSold} common items for ${totalGold} gold!\\nüí∞ New balance: ${char.gold} gold`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'guild_contribute') {\r\n      const [, guildName, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot contribute to guild for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`guild_contribute_modal:${guildName}:${interaction.user.id}`).setTitle('Contribute to Guild');\r\n      const amountInput = new TextInputBuilder().setCustomId('amount').setLabel('Gold Amount').setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder('100');\r\n\r\n      modal.addComponents({ type: 1, components: [amountInput] });\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'guild_refresh') {\r\n      const [, guildName, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot refresh guild for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const guildInfo = getUserGuild(interaction.user.id);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ Guild Refreshed')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(`${guildName || guildInfo?.name || 'Guild'} data has been refreshed!`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: interaction.message.components });\r\n      return;\r\n    }\r\n\r\n    if (action === 'party_invite') {\r\n      const [, partyId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot generate invites for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîó Party Invite Generated')\r\n        .setColor(0x2196F3)\r\n        .setDescription(`Invite link for party ${partyId}: \\`/join ${partyId}\\``);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'guess_modal') {\r\n      const [, gameId, min, max] = interaction.customId.split(':');\r\n\r\n      const gameState = guessGames.get(gameId);\r\n      if (!gameState) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Game not found!** The game may have expired.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      if (!gameState.gameActive) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Game is no longer active!**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const modal = new ModalBuilder().setCustomId(`guess_submit:${gameId}`).setTitle('Make Your Guess');\r\n      const guessInput = new TextInputBuilder().setCustomId('guess_number').setLabel(`Guess a number between ${min} and ${max}`).setStyle(TextInputStyle.Short).setRequired(true).setPlaceholder(`${min}-${max}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(guessInput);\r\n      modal.addComponents([row]);\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_joke') {\r\n      const [, category, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get jokes for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const joke = getRandomJoke(category);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üòÇ Joke')\r\n        .setColor(0xFFD700)\r\n        .setDescription(joke);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_joke:${category}:${interaction.user.id}`).setLabel('üòÇ Another Joke').setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_rate') {\r\n      const [, jokeId, ratingStr, targetUserId] = interaction.customId.split(':');\r\n\r\n      // Validate user ID\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot rate jokes for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      // Validate rating\r\n      const rating = parseInt(ratingStr);\r\n      if (isNaN(rating) || rating < 1 || rating > 5) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Invalid rating. Rating must be between 1 and 5 stars.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      // Validate joke ID format (basic check)\r\n      if (!jokeId || jokeId.length < 10) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Invalid joke reference.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Attempt to rate the joke\r\n        const ratingResult = entertainmentManager.rateJoke(jokeId, rating);\r\n\r\n        if (ratingResult !== true) {\r\n          return safeInteractionReply(interaction, { content: '‚ùå Failed to record your rating. Please try again.', flags: MessageFlags.Ephemeral });\r\n        }\r\n\r\n        // Create success response embed\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚≠ê Thanks for your rating!')\r\n          .setColor(0x4CAF50)\r\n          .setDescription(`You rated this joke with **${rating} star${rating !== 1 ? 's' : ''}!** ‚≠ê\\n\\nYour feedback helps improve our joke collection!`)\r\n          .setFooter({ text: 'Rating recorded successfully' });\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n\r\n      } catch (error) {\r\n        logger.error('Error rating joke', error instanceof Error ? error : new Error(String(error)), {\r\n          userId: interaction.user.id,\r\n          jokeId,\r\n          rating\r\n        });\r\n        return safeInteractionReply(interaction, { content: '‚ùå An error occurred while recording your rating. Please try again.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_story') {\r\n      const [, genre, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get stories for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const story = generateStory(genre);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üìñ Story')\r\n        .setColor(0x9932CC)\r\n        .setDescription(`${story}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_story:${genre}:${interaction.user.id}`).setLabel('üìñ Another Story').setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_share') {\r\n      const [, contentId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot share for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      // Validate user ID matches\r\n      if (targetUserId !== interaction.user.id) {\r\n        await safeInteractionReply(interaction, {\r\n          content: '‚ùå **Sharing failed!** User ID mismatch.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Import content retrieval function\r\n      const { getContentForSharing } = await import('./entertainment.js');\r\n      const content = getContentForSharing(contentId);\r\n\r\n      if (!content) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Content not found!** This content may have expired or is no longer available for sharing.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Create shareable message based on content type\r\n      let shareEmbed;\r\n      let shareContent = '';\r\n\r\n      try {\r\n        switch (content.type) {\r\n          case 'story':\r\n            shareEmbed = new EmbedBuilder()\r\n              .setTitle(`üìñ ${content.genre.charAt(0).toUpperCase() + content.genre.slice(1)} Story`)\r\n              .setColor(0x9932CC)\r\n              .setDescription(content.story)\r\n              .addFields({\r\n                name: 'üéØ Prompt',\r\n                value: content.prompt,\r\n                inline: false\r\n              })\r\n              .setFooter({\r\n                text: `Shared by ${interaction.user.username} ‚Ä¢ Originally generated from /fun story`,\r\n                iconURL: interaction.user.displayAvatarURL({ dynamic: true })\r\n              });\r\n            break;\r\n\r\n          case 'fact':\r\n            shareEmbed = new EmbedBuilder()\r\n              .setTitle(`üß† ${content.category === 'random' ? 'Random' : content.category.charAt(0).toUpperCase() + content.category.slice(1)} Fun Fact`)\r\n              .setColor(0x4CAF50)\r\n              .setDescription(content.fact)\r\n              .setFooter({\r\n                text: `Shared by ${interaction.user.username} ‚Ä¢ Originally generated from /fun fact`,\r\n                iconURL: interaction.user.displayAvatarURL({ dynamic: true })\r\n              });\r\n            break;\r\n\r\n          case 'quote':\r\n            shareEmbed = new EmbedBuilder()\r\n              .setTitle(`üí¨ ${content.category.charAt(0).toUpperCase() + content.category.slice(1)} Quote`)\r\n              .setColor(0xE91E63)\r\n              .addFields(\r\n                { name: 'Quote', value: `\"${content.quote}\"`, inline: false },\r\n                { name: 'Author', value: content.author, inline: true },\r\n                { name: 'Category', value: content.category, inline: true }\r\n              )\r\n              .setFooter({\r\n                text: `Shared by ${interaction.user.username} ‚Ä¢ Originally generated from /fun quote`,\r\n                iconURL: interaction.user.displayAvatarURL({ dynamic: true })\r\n              });\r\n            break;\r\n\r\n          default:\r\n            throw new Error(`Unknown content type: ${content.type}`);\r\n        }\r\n\r\n        // Send the shared content to the channel\r\n        await interaction.channel.send({\r\n          content: `üì§ **${interaction.user.username} shared some fun content!**`,\r\n          embeds: [shareEmbed]\r\n        });\r\n\r\n        // Update the original interaction\r\n        const successEmbed = new EmbedBuilder()\r\n          .setTitle('‚úÖ Content Shared Successfully!')\r\n          .setColor(0x4CAF50)\r\n          .setDescription('Your content has been shared with the channel!')\r\n          .setFooter({ text: 'Thanks for spreading the fun!' });\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [successEmbed], components: [] });\r\n\r\n      } catch (error) {\r\n        logger.error('Error sharing fun content', error instanceof Error ? error : new Error(String(error)), {\r\n          userId: interaction.user.id,\r\n          contentId,\r\n          contentType: content.type\r\n        });\r\n\r\n        // Handle sharing failure\r\n        const errorEmbed = new EmbedBuilder()\r\n          .setTitle('‚ùå Sharing Failed')\r\n          .setColor(0xFF0000)\r\n          .setDescription('Sorry, there was an error sharing your content. Please try again.')\r\n          .setFooter({ text: 'If this persists, contact the bot administrator' });\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [errorEmbed], components: [] });\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_riddle') {\r\n      const [, difficulty, riddleId, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot view riddles for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const riddle = getRiddle(difficulty);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí° Riddle')\r\n        .setColor(0xFF9800)\r\n        .setDescription(`**${riddle.question}**\\n\\n${riddle.hint ? `*Hint: ${riddle.hint}*` : ''}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_riddle:${difficulty}:${riddle.id}:${interaction.user.id}`).setLabel('üí° Show Answer').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_riddle_new:${difficulty}:${interaction.user.id}`).setLabel('üß© New Riddle').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_riddle_new') {\r\n      const [, difficulty, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get new riddles for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const riddle = getRiddle(difficulty);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üß© New Riddle')\r\n        .setColor(0xFF9800)\r\n        .setDescription(`**${riddle.question}**\\n\\n${riddle.hint ? `*Hint: ${riddle.hint}*` : ''}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_riddle:${difficulty}:${riddle.id}:${interaction.user.id}`).setLabel('üí° Show Answer').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_riddle_new:${difficulty}:${interaction.user.id}`).setLabel('üß© Another Riddle').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_fact') {\r\n      const [, category, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get facts for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const fact = getFunFact(category);\r\n      // Ensure fact is a valid string for EmbedBuilder.setDescription\r\n      const factText = typeof fact === 'object' && fact.fact ? fact.fact : String(fact || 'No fun fact available.');\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üß† Fun Fact')\r\n        .setColor(0x4CAF50)\r\n        .setDescription(`${factText}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_fact:${category}:${interaction.user.id}`).setLabel('üß† Another Fact').setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_quote') {\r\n      const [, category, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get quotes for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const quote = getRandomQuote(category);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üí¨ Quote')\r\n        .setColor(0x9932CC)\r\n        .setDescription(`\"${quote.text}\"\\n\\n‚Äî ${quote.author}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_quote:${category}:${interaction.user.id}`).setLabel('üí¨ Another Quote').setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_8ball') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot use 8ball for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const answer = magic8Ball();\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÆ Magic 8-Ball')\r\n        .setColor(0x000000)\r\n        .setDescription(`üé± ${answer}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_8ball:${interaction.user.id}`).setLabel('üîÆ Ask Again').setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_name') {\r\n      const [, type, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot generate names for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const name = generateFunName(type);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üé≠ Fun Name')\r\n        .setColor(0xFF69B4)\r\n        .setDescription(`**${name}**`.toString());\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_name:${type}:${interaction.user.id}`).setLabel('üé≠ Another Name').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_name_random:${interaction.user.id}`).setLabel('üé≤ Random Type').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_name_random') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot generate names for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const types = ['hero', 'villain', 'animal', 'object'];\r\n      const randomType = types[Math.floor(Math.random() * types.length)];\r\n      const name = generateFunName(randomType);\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üé≤ Random Fun Name')\r\n        .setColor(0xFF69B4)\r\n        .setDescription(`**${name}** (${randomType})`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_name:${randomType}:${interaction.user.id}`).setLabel('üé≠ Another Name').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_name_random:${interaction.user.id}`).setLabel('üé≤ Random Type').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_challenge') {\r\n      const [, type, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get challenges for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const challenge = createFunChallenge(type);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üéØ Challenge')\r\n        .setColor(0xFF4500)\r\n        .setDescription(`${challenge}`);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_challenge:${type}:${interaction.user.id}`).setLabel('üéØ Accept Challenge').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_challenge_new:${type}:${interaction.user.id}`).setLabel('üîÑ New Challenge').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'fun_challenge_new') {\r\n      const [, type, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot get challenges for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const challenge = createFunChallenge(type);\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ New Challenge')\r\n        .setColor(0xFF4500)\r\n        .setDescription(challenge);\r\n\r\n      const row = new ActionRowBuilder().addComponents(\r\n        new ButtonBuilder().setCustomId(`fun_challenge:${type}:${interaction.user.id}`).setLabel('üéØ Accept Challenge').setStyle(ButtonStyle.Primary),\r\n        new ButtonBuilder().setCustomId(`fun_challenge_new:${type}:${interaction.user.id}`).setLabel('üîÑ Another Challenge').setStyle(ButtonStyle.Secondary)\r\n      );\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [row] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'ai_chat') {\r\n      const [, model, personality, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot continue chat for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      // Show modal for continuing AI chat\r\n      const modal = new ModalBuilder().setCustomId(`ai_chat_continue_modal:${model}:${personality}:${interaction.user.id}`).setTitle('Continue AI Chat');\r\n      const messageInput = new TextInputBuilder().setCustomId('message').setLabel('Your message').setStyle(TextInputStyle.Paragraph).setRequired(true).setPlaceholder('What would you like to say next?');\r\n\r\n      modal.addComponents({ type: 1, components: [messageInput] });\r\n      await interaction.showModal(modal);\r\n      return;\r\n    }\r\n\r\n    if (action === 'ai_clear') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        await safeInteractionReply(interaction, { content: 'You cannot clear history for another user.', flags: MessageFlags.Ephemeral });\r\n        return;\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üóëÔ∏è AI History Cleared')\r\n        .setColor(0xFF0000)\r\n        .setDescription('Chat history has been cleared!');\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'admin_warn') {\r\n      const [, targetUserId, guildId] = interaction.customId.split(':');\r\n\r\n      // Admin permission check would go here\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('‚ö†Ô∏è User Warned')\r\n        .setColor(0xFFA500)\r\n        .setDescription(`User <@${targetUserId}> has been warned.`);\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'admin_mute') {\r\n      const [, targetUserId, guildId] = interaction.customId.split(':');\r\n\r\n      // Admin permission check would go here\r\n      try {\r\n        await muteUser(interaction.guild.id, targetUserId);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîá User Muted')\r\n          .setColor(0xFF0000)\r\n          .setDescription(`User <@${targetUserId}> has been muted.`);\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      } catch (error) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Failed to mute user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'admin_unmute') {\r\n      const [, targetUserId, guildId] = interaction.customId.split(':');\r\n\r\n      // Admin permission check would go here\r\n      try {\r\n        await unmuteUser(interaction.guild.id, targetUserId);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üîä User Unmuted')\r\n          .setColor(0x4CAF50)\r\n          .setDescription(`User <@${targetUserId}> has been unmuted.`);\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      } catch (error) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Failed to unmute user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'admin_unban') {\r\n      const [, targetUserId, guildId] = interaction.customId.split(':');\r\n\r\n      // Admin permission check would go here\r\n      try {\r\n        await unbanUser(interaction.guild.id, targetUserId);\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('‚úÖ User Unbanned')\r\n          .setColor(0x4CAF50)\r\n          .setDescription(`User <@${targetUserId}> has been unbanned.`);\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      } catch (error) {\r\n        await safeInteractionReply(interaction, { content: '‚ùå Failed to unban user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n      return;\r\n    }\r\n\r\n    if (action === 'achievements_refresh') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot refresh achievements for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üîÑ Achievements Refreshed')\r\n        .setColor(0x4CAF50)\r\n        .setDescription('Achievement data has been refreshed!');\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: interaction.message.components });\r\n      return;\r\n    }\r\n\r\n    if (action === 'achievements_leaderboard') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot view leaderboard for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      // Import achievement functions\r\n      const { getAchievementLeaderboard } = await import('./achievements.js');\r\n      const leaderboard = getAchievementLeaderboard(10);\r\n\r\n      if (!leaderboard || leaderboard.length === 0) {\r\n        const embed = new EmbedBuilder()\r\n          .setTitle('üèÖ Achievement Leaderboard')\r\n          .setColor(0xFFD700)\r\n          .setDescription('No achievement data available yet.\\n\\nComplete achievements to appear on the leaderboard!');\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n        return;\r\n      }\r\n\r\n      const description = leaderboard.map((entry, index) => {\r\n        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `**${index + 1}.**`;\r\n        return `${medal} **${entry.username}** - ${entry.totalAchievements} achievements, ${entry.totalPoints} points`;\r\n      }).join('\\n');\r\n\r\n      const embed = new EmbedBuilder()\r\n        .setTitle('üèÖ Achievement Leaderboard')\r\n        .setColor(0xFFD700)\r\n        .setDescription(description)\r\n        .setFooter({ text: 'Top achievers this month' });\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [embed], components: [] });\r\n      return;\r\n    }\r\n\r\n    if (action === 'wordle_guess') {\r\n      const [, targetUserId] = interaction.customId.split(':');\r\n\r\n      if (targetUserId && targetUserId !== interaction.user.id) {\r\n        logCommandExecution(interaction, false, new Error('Wrong user'));\r\n        return safeInteractionReply(interaction, { content: 'You cannot guess for another user.', flags: MessageFlags.Ephemeral });\r\n      }\r\n\r\n      sendWordleGuessModal(interaction, interaction.user.id);\r\n      return;\r\n    }\r\n\r\n    // Connect4 button handler\r\n    if (action === 'c4') {\r\n      const [, colStr, gameId] = interaction.customId.split('_');\r\n\r\n      const gameState = connect4Games.get(gameId);\r\n      if (!gameState) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Game not found!** The game may have expired or been completed.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Validate user turn\r\n      if (interaction.user.id !== gameState.players[gameState.currentPlayer]?.id) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Not your turn!** Please wait for the other player.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const column = parseInt(colStr);\r\n      if (isNaN(column) || column < 0 || column > 6) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Invalid column!** Please select a valid column (1-7).',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Make the move\r\n      const moveResult = await makeConnect4Move(gameState, column);\r\n      if (!moveResult) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Invalid move!** That column is full.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      await sendConnect4Board(interaction, gameState);\r\n      return;\r\n    }\r\n\r\n    // Tic-Tac-Toe button handler\r\n    if (action === 'ttt') {\r\n      const [, positionStr, gameId] = interaction.customId.split('_');\r\n\r\n      const gameState = tttGames.get(gameId);\r\n      if (!gameState) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Game not found!** The game may have expired or been completed.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Validate user turn\r\n      const currentPlayerId = gameState.players[gameState.currentPlayer]?.id;\r\n      if (interaction.user.id !== currentPlayerId) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Not your turn!** Please wait for the other player.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const position = parseInt(positionStr);\r\n      if (isNaN(position) || position < 0 || position > 8) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Invalid position!** Please select a valid board position.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Check if position is empty\r\n      if (gameState.board[position] !== null) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Position already taken!** Please choose an empty square.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Make the move\r\n      gameState.board[position] = gameState.currentPlayer;\r\n\r\n      // Check for winner\r\n      const winner = checkWinner(gameState.board);\r\n      if (winner) {\r\n        gameState.status = 'completed';\r\n\r\n        if (winner !== 'tie') {\r\n          const winnerPlayer = gameState.players[winner];\r\n          if (winnerPlayer.id !== 'ai') {\r\n            await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n          }\r\n        }\r\n\r\n        // Update statistics for both players\r\n        if (gameState.players.X.id !== 'ai') {\r\n          await updateUserStats(gameState.players.X.id, { games: { tictactoe_games: 1 } });\r\n        }\r\n        if (gameState.players.O.id !== 'ai') {\r\n          await updateUserStats(gameState.players.O.id, { games: { tictactoe_games: 1 } });\r\n        }\r\n\r\n        const resultEmbed = new EmbedBuilder()\r\n          .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n          .setColor(winner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n          .setDescription(winner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${gameState.players[winner].name} wins!**`)\r\n          .addFields({\r\n            name: 'Final Board',\r\n            value: formatBoard(gameState.board),\r\n            inline: false\r\n          });\r\n\r\n        // Clean up game state\r\n        tttGames.delete(gameId);\r\n\r\n        await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n        return;\r\n      }\r\n\r\n      // Switch turns if game continues\r\n      gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';\r\n\r\n      // Handle AI move if playing against AI\r\n      if (gameState.isAI && gameState.currentPlayer === 'O' && gameState.status === 'active') {\r\n        // Import AI move function\r\n        const { getAIMove } = await import('./commands/tictactoe.js');\r\n        const aiMove = getAIMove(gameState.board, gameState.difficulty);\r\n        if (aiMove !== null) {\r\n          gameState.board[aiMove] = 'O';\r\n          gameState.currentPlayer = 'X';\r\n\r\n          // Check for AI win\r\n          const aiWinner = checkWinner(gameState.board);\r\n          if (aiWinner) {\r\n            gameState.status = 'completed';\r\n\r\n            if (aiWinner !== 'tie') {\r\n              const winnerPlayer = gameState.players[aiWinner];\r\n              if (winnerPlayer.id !== 'ai') {\r\n                await updateUserStats(winnerPlayer.id, { games: { tictactoe_wins: 1 } });\r\n              }\r\n            }\r\n\r\n            // Update statistics for both players\r\n            if (gameState.players.X.id !== 'ai') {\r\n              await updateUserStats(gameState.players.X.id, { games: { tictactoe_games: 1 } });\r\n            }\r\n            if (gameState.players.O.id !== 'ai') {\r\n              await updateUserStats(gameState.players.O.id, { games: { tictactoe_games: 1 } });\r\n            }\r\n\r\n            const resultEmbed = new EmbedBuilder()\r\n              .setTitle('‚≠ï Tic-Tac-Toe - Game Over!')\r\n              .setColor(aiWinner === 'tie' ? 0xFFA500 : 0x00FF00)\r\n              .setDescription(aiWinner === 'tie' ? 'ü§ù **It\\'s a tie!**' : `üéâ **${gameState.players[aiWinner].name} wins!**`)\r\n              .addFields({\r\n                name: 'Final Board',\r\n                value: formatBoard(gameState.board),\r\n                inline: false\r\n              });\r\n\r\n            // Clean up game state\r\n            tttGames.delete(gameId);\r\n\r\n            await safeInteractionUpdate(interaction, { embeds: [resultEmbed], components: [] });\r\n            return;\r\n          }\r\n\r\n          gameState.currentPlayer = 'X';\r\n        }\r\n      }\r\n\r\n      // Update the board display\r\n      const { sendTicTacToeBoard } = await import('./commands/tictactoe.js');\r\n      await sendTicTacToeBoard(interaction, gameState);\r\n\r\n      return;\r\n    }\r\n\r\n    // Poll button handler\r\n    if (action === 'poll') {\r\n      const [, optionIndexStr] = interaction.customId.split('_');\r\n      const optionIndex = parseInt(optionIndexStr);\r\n\r\n      // Get message ID to find the poll data\r\n      const messageId = interaction.message.id;\r\n      const pollData = pollGames.get(messageId);\r\n\r\n      if (!pollData) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Poll not found!** This poll may have expired or been completed.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Check if poll has expired\r\n      if (Date.now() > pollData.endTime) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Poll has expired!** You can no longer vote on this poll.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Validate option index\r\n      if (isNaN(optionIndex) || optionIndex < 0 || optionIndex >= pollData.options.length) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Invalid poll option!**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const userId = interaction.user.id;\r\n      const previousVote = pollData.votes.get(userId);\r\n\r\n      // Handle vote based on poll type (currently only single choice)\r\n      if (pollData.pollType === 'single') {\r\n        // Remove previous vote if exists\r\n        if (previousVote !== undefined) {\r\n          pollData.totalVotes--;\r\n        }\r\n\r\n        // Add new vote\r\n        pollData.votes.set(userId, optionIndex);\r\n        pollData.totalVotes++;\r\n      }\r\n\r\n      // Update embed with current results\r\n      const emojis = ['1Ô∏è‚É£', '2Ô∏è‚É£', '3Ô∏è‚É£', '4Ô∏è‚É£'];\r\n      const updatedEmbed = new EmbedBuilder()\r\n        .setTitle(`üìä ${pollData.question}`)\r\n        .setColor(0x0099FF)\r\n        .setDescription(\r\n          pollData.options.map((option, index) => {\r\n            const voteCount = Array.from(pollData.votes.values()).filter(v => v === index).length;\r\n            const percentage = pollData.totalVotes > 0 ? Math.round((voteCount / pollData.totalVotes) * 100) : 0;\r\n            return `${emojis[index]} ${option}\\n${'‚ñà'.repeat(Math.max(1, percentage / 5))}${voteCount > 0 ? ` **${voteCount}** (${percentage}%)` : ''}`;\r\n          }).join('\\n\\n')\r\n        )\r\n        .setFooter({ text: `Total votes: ${pollData.totalVotes} ‚Ä¢ Poll ends` })\r\n        .setTimestamp(pollData.endTime);\r\n\r\n      // Create updated button rows\r\n      const buttons = pollData.options.map((option, index) =>\r\n        new ButtonBuilder()\r\n          .setCustomId(`poll_${index}`)\r\n          .setLabel(`${emojis[index]} ${option.length > 15 ? option.substring(0, 15) + '...' : option}`)\r\n          .setStyle(ButtonStyle.Primary)\r\n      );\r\n\r\n      const rows = [];\r\n      for (let i = 0; i < buttons.length; i += 2) {\r\n        const row = new ActionRowBuilder().addComponents(buttons.slice(i, i + 2));\r\n        rows.push(row);\r\n      }\r\n\r\n      await safeInteractionUpdate(interaction, { embeds: [updatedEmbed], components: rows });\r\n      return;\r\n    }\r\n\r\n    // Trivia button handler\r\n    if (action === 'trivia') {\r\n      const [, indexStr] = interaction.customId.split('_');\r\n      const selectedAnswer = parseInt(indexStr);\r\n\r\n      // Find the active trivia game for this user\r\n      let gameState = null;\r\n      let gameId = null;\r\n      for (const [id, state] of triviaGames.entries()) {\r\n        if (state.userId === interaction.user.id && state.gameActive) {\r\n          gameState = state;\r\n          gameId = id;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!gameState) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **No active trivia game found!** Please start a new game with `/trivia`.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      // Validate answer index\r\n      if (isNaN(selectedAnswer) || selectedAnswer < 0 || selectedAnswer >= 4) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Invalid answer selection!**',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const currentQuestion = gameState.questions[gameState.currentQuestion];\r\n\r\n      if (!currentQuestion) {\r\n        return safeInteractionReply(interaction, {\r\n          content: '‚ùå **Game error!** No current question available.',\r\n          flags: MessageFlags.Ephemeral\r\n        });\r\n      }\r\n\r\n      const isCorrect = selectedAnswer === currentQuestion.correct;\r\n\r\n      if (isCorrect) {\r\n        gameState.score++;\r\n      }\r\n\r\n      // Record the answer\r\n      gameState.answers.push({\r\n        question: currentQuestion.question,\r\n        selectedAnswer: selectedAnswer,\r\n        correctAnswer: currentQuestion.correct,\r\n        isCorrect: isCorrect,\r\n        userChoice: currentQuestion.options[selectedAnswer],\r\n        correctChoice: currentQuestion.options[currentQuestion.correct]\r\n      });\r\n\r\n      gameState.currentQuestion++;\r\n\r\n      // Send feedback\r\n      const feedbackEmbed = new EmbedBuilder()\r\n        .setTitle(isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect!')\r\n        .setDescription(`**${currentQuestion.question}**\\n\\nYour answer: **${currentQuestion.options[selectedAnswer]}**\\nCorrect answer: **${currentQuestion.options[currentQuestion.correct]}**`)\r\n        .setColor(isCorrect ? 0x00FF00 : 0xFF0000)\r\n        .setFooter({ text: `Score: ${gameState.score}/${gameState.currentQuestion}` });\r\n\r\n      await safeInteractionReply(interaction, { embeds: [feedbackEmbed], flags: MessageFlags.Ephemeral });\r\n\r\n      // Check if quiz is complete\r\n      if (gameState.currentQuestion >= gameState.questions.length) {\r\n        // Send final results\r\n        const totalTime = Math.round((Date.now() - gameState.startTime) / 1000);\r\n        const percentage = Math.round((gameState.score / gameState.questions.length) * 100);\r\n\r\n        let resultMessage = '';\r\n        if (percentage >= 90) resultMessage = 'üèÜ Outstanding! You\\'re a trivia master!';\r\n        else if (percentage >= 70) resultMessage = 'ü•á Great job! You know your stuff!';\r\n        else if (percentage >= 50) resultMessage = 'ü•à Not bad! Keep practicing!';\r\n        else resultMessage = 'üìö Keep learning and try again!';\r\n\r\n        // Update achievements\r\n        try {\r\n          const { updateUserStats } = await import('./achievements.js');\r\n          const correctAnswers = gameState.answers.filter(a => a.isCorrect).length;\r\n          updateUserStats(interaction.user.id, {\r\n            trivia_correct: correctAnswers,\r\n            features_tried: 1\r\n          });\r\n        } catch (error) {\r\n          console.warn('Failed to update trivia achievements:', error.message);\r\n        }\r\n\r\n        const resultEmbed = new EmbedBuilder()\r\n          .setTitle('üéØ Trivia Quiz Complete!')\r\n          .setDescription(`${resultMessage}\\n\\n**Final Score: ${gameState.score}/${gameState.questions.length} (${percentage}%)**\\n‚è±Ô∏è Time: ${totalTime}s`)\r\n          .setColor(percentage >= 70 ? 0x00FF00 : percentage >= 50 ? 0xFFA500 : 0xFF0000)\r\n          .setTimestamp();\r\n\r\n        // Add detailed results\r\n        gameState.answers.forEach((answer, index) => {\r\n          const emoji = answer.isCorrect ? '‚úÖ' : '‚ùå';\r\n          const status = answer.isCorrect ? 'Correct' : 'Incorrect';\r\n          resultEmbed.addFields({\r\n            name: `Q${index + 1}: ${status}`,\r\n            value: `${emoji} **${answer.question}**\\n${answer.isCorrect ? 'Your answer: ' + answer.userChoice : `Your answer: ${answer.userChoice}\\nCorrect: ${answer.correctChoice}`}`,\r\n            inline: false\r\n          });\r\n        });\r\n\r\n        // Clean up game state\r\n        triviaGames.delete(gameId);\r\n\r\n        setTimeout(async () => {\r\n          await safeInteractionReply(interaction, { embeds: [resultEmbed], flags: MessageFlags.Ephemeral });\r\n        }, 2000);\r\n      } else {\r\n        // Send next question after delay\r\n        setTimeout(async () => {\r\n          const nextQuestion = gameState.questions[gameState.currentQuestion];\r\n\r\n          if (!nextQuestion) {\r\n            return safeInteractionReply(interaction, {\r\n              content: '‚ùå **Game error!** No next question available.',\r\n              flags: MessageFlags.Ephemeral\r\n            });\r\n          }\r\n\r\n          const embed = new EmbedBuilder()\r\n            .setTitle(`üß† Trivia Quiz - Question ${gameState.currentQuestion + 1}/${gameState.questions.length}`)\r\n            .setDescription(`**${nextQuestion.question}**`)\r\n            .setColor(0x0099FF)\r\n            .addFields({\r\n              name: 'Category',\r\n              value: nextQuestion.category,\r\n              inline: true\r\n            })\r\n            .setFooter({ text: `Score: ${gameState.score}/${gameState.currentQuestion}` })\r\n            .setTimestamp();\r\n\r\n          const buttons = nextQuestion.options.map((option, index) =>\r\n            new ButtonBuilder()\r\n              .setCustomId(`trivia_${index}`)\r\n              .setLabel(`${String.fromCharCode(65 + index)}) ${option}`)\r\n              .setStyle(ButtonStyle.Primary)\r\n          );\r\n\r\n          const rows = [];\r\n          for (let i = 0; i < buttons.length; i += 2) {\r\n            const row = new ActionRowBuilder().addComponents(buttons.slice(i, i + 2));\r\n            rows.push(row);\r\n          }\r\n\r\n          await safeInteractionReply(interaction, { embeds: [embed], components: rows, flags: MessageFlags.Ephemeral });\r\n        }, 2000);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // Unrecognized button action with comprehensive logging\r\n    logger.warn(`Unrecognized button action: ${action}`, {\r\n      userId: interaction.user.id,\r\n      username: interaction.user.username,\r\n      customId: interaction.customId,\r\n      guild: interaction.guild?.name || 'DM',\r\n      guildId: interaction.guild?.id || 'N/A'\r\n    });\r\n    logCommandExecution(interaction, false, new Error(`Unrecognized button action: ${action}`));\r\n    await safeInteractionReply(interaction, {\r\n      content: `‚ùå **Unknown button action: ${action}**\\n\\nThis button is not implemented yet. Please contact the bot administrator if this is unexpected.`,\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n}\r\n\r\n  } catch (error) {\r\n    logger.error(`Error handling button action ${action}`, error, {\r\n      userId: interaction.user.id,\r\n      action,\r\n      customId: interaction.customId\r\n    });\r\n    logCommandExecution(interaction, false, error);\r\n    await safeInteractionReply(interaction, {\r\n      content: '‚ùå **An error occurred while processing the button.**\\n\\nPlease try again later.',\r\n      flags: MessageFlags.Ephemeral\r\n    });\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\locations.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":25,"column":63,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":25,"endColumn":69,"fix":{"range":[640,648],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":27,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":27,"endColumn":6,"fix":{"range":[688,688],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":28,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":28,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[712,762],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":35,"column":71,"nodeType":"Literal","messageId":"error","endLine":35,"endColumn":75,"suggestions":[{"messageId":"replace","fix":{"range":[908,912],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":36,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":36,"endColumn":6,"fix":{"range":[925,925],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":37,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":37,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[949,999],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'getLocations' has too many lines (88). Maximum allowed is 50.","line":42,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":129,"endColumn":4},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":54,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":54,"endColumn":24,"fix":{"range":[1653,1661],"text":"0x22_8B_22"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":68,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":68,"endColumn":24,"fix":{"range":[2276,2284],"text":"0x93_70_DB"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":82,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":82,"endColumn":24,"fix":{"range":[2878,2886],"text":"0xFF_45_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":96,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":96,"endColumn":24,"fix":{"range":[3490,3498],"text":"0xDA_A5_20"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":110,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":110,"endColumn":24,"fix":{"range":[4087,4095],"text":"0x2F_2F_4F"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":124,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":124,"endColumn":24,"fix":{"range":[4709,4717],"text":"0xFF_D7_00"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":134,"column":22,"nodeType":"MemberExpression","endLine":134,"endColumn":43},{"ruleId":"no-unused-vars","severity":1,"message":"'level' is defined but never used.","line":167,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":47},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":170,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":170,"endColumn":106,"fix":{"range":[5975,6058],"text":"'A wise traveler offers guidance and shares ancient knowledge from their journeys.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":171,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":171,"endColumn":110,"fix":{"range":[6083,6170],"text":"'Crystal-clear water glows with restorative magic, healing wounds and granting wisdom.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":172,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":172,"endColumn":107,"fix":{"range":[6197,6279],"text":"'A sacred altar radiates divine energy, offering blessings to worthy adventurers.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":175,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":175,"endColumn":91,"fix":{"range":[6334,6402],"text":"'A curious forest creature emerges, more frightened than dangerous.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":176,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":176,"endColumn":100,"fix":{"range":[6428,6504],"text":"'Animated crystals form a humanoid shape, defending the cavern\\'s treasures.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":177,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":177,"endColumn":102,"fix":{"range":[6531,6608],"text":"'Living flames dance with destructive beauty, born from the volcano\\'s heart.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":178,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":178,"endColumn":92,"fix":{"range":[6635,6702],"text":"'An ancient statue awakens, sworn to protect the temple\\'s secrets.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":179,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":179,"endColumn":95,"fix":{"range":[6727,6799],"text":"'Darkness coalesces into a terrifying creature from your deepest fears.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":180,"column":29,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":180,"endColumn":90,"fix":{"range":[6830,6891],"text":"'A being of pure starlight descends to test your worthiness.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":183,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":183,"endColumn":97,"fix":{"range":[6950,7022],"text":"'An ornate chest glows with magical energy, promising valuable rewards.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":184,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":184,"endColumn":88,"fix":{"range":[7048,7112],"text":"'A chamber filled with precious artifacts and forgotten wealth.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":185,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":185,"endColumn":88,"fix":{"range":[7138,7202],"text":"'A mystical altar holds offerings from civilizations long past.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":188,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":188,"endColumn":77,"fix":{"range":[7254,7312],"text":"'A seemingly bottomless pit exhales cold, malevolent air.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":189,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":189,"endColumn":77,"fix":{"range":[7337,7391],"text":"'Glowing runes form a perfect circle of arcane power.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":190,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":190,"endColumn":89,"fix":{"range":[7416,7482],"text":"'A magnificent nest made of golden flames and precious materials.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":191,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":191,"endColumn":70,"fix":{"range":[7507,7554],"text":"'A holy artifact pulses with celestial energy.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":192,"column":22,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":192,"endColumn":89,"fix":{"range":[7578,7645],"text":"'A swirling vortex connects to realms beyond mortal comprehension.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":193,"column":26,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":193,"endColumn":78,"fix":{"range":[7673,7725],"text":"'An otherworldly object defies the laws of reality.'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":196,"column":12,"nodeType":"MemberExpression","endLine":196,"endColumn":39},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":196,"column":43,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":196,"endColumn":93,"fix":{"range":[7779,7829],"text":"'An mysterious encounter awaits in this location.'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":231,"column":22,"nodeType":"MemberExpression","endLine":231,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":256,"column":22,"nodeType":"MemberExpression","endLine":256,"endColumn":43},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":268,"column":36,"nodeType":"CallExpression","messageId":"substr","endLine":268,"endColumn":75,"fix":{"range":[10094,10105],"text":"slice(2, 11"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (454). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":454,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":308,"column":12,"nodeType":"MemberExpression","endLine":308,"endColumn":34},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":315,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":315,"endColumn":21,"fix":{"range":[11689,11947],"text":" {\r\n        return {\r\n          type: 'monster',\r\n          name: `Dungeon Guardian (Level ${level})`,\r\n          hp: 50 + (level * 10),\r\n          atk: 8 + level,\r\n          def: 2 + Math.floor(level / 3),\r\n          spd: 2 + Math.floor(level / 4)\r\n        };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":325,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":325,"endColumn":21,"fix":{"range":[11971,12117],"text":" {\r\n        return {\r\n          type: 'riddle',\r\n          riddle: this.generateRiddle(level),\r\n          answer: this.getRiddleAnswer()\r\n        };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":332,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":332,"endColumn":23,"fix":{"range":[12143,12276],"text":" {\r\n        return {\r\n          type: 'lock',\r\n          difficulty: level,\r\n          trap_chance: Math.min(50, level * 5)\r\n        };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":339,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":339,"endColumn":15,"fix":{"range":[12294,12328],"text":" {\r\n        return { type: 'none' };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":348,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":348,"endColumn":21,"fix":{"range":[12489,12566],"text":" {\r\n        return { xp: level * 10, gold: level * 5, items: ['random_item'] };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":350,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":350,"endColumn":23,"fix":{"range":[12590,12679],"text":" {\r\n        return { xp: level * 5, gold: level * 15, items: ['rare_item', 'gold_bonus'] };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":352,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":352,"endColumn":21,"fix":{"range":[12701,12777],"text":" {\r\n        return { xp: level * 20, gold: level * 8, items: ['skill_book'] };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":354,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":354,"endColumn":19,"fix":{"range":[12797,12891],"text":" {\r\n        return { xp: level * 50, gold: level * 30, items: ['legendary_item', 'boss_loot'] };\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":356,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":356,"endColumn":15,"fix":{"range":[12907,12959],"text":" {\r\n        return { xp: level * 3, gold: level * 2 };\n      }"}},{"ruleId":"no-unused-vars","severity":1,"message":"'level' is defined but never used.","line":361,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":361,"endColumn":23},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":363,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":363,"endColumn":114,"fix":{"range":[13031,13138],"text":"'I speak without a mouth and hear without ears. I have no body, but I come alive with the wind. What am I?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":365,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":365,"endColumn":65,"fix":{"range":[13261,13319],"text":"'The more you take, the more you leave behind. What am I?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":367,"column":7,"nodeType":"Literal","messageId":"wrongQuotes","endLine":367,"endColumn":108,"fix":{"range":[13455,13556],"text":"'I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":375,"column":12,"nodeType":"Literal","messageId":"wrongQuotes","endLine":375,"endColumn":18,"fix":{"range":[13743,13749],"text":"'echo'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":381,"column":22,"nodeType":"MemberExpression","endLine":381,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":409,"column":12,"nodeType":"MemberExpression","endLine":409,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'getUserAchievements' is assigned a value but never used.","line":414,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":414,"endColumn":46}],"suppressedMessages":[],"errorCount":47,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":44,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst LOCATIONS_FILE = path.join(process.cwd(), 'data', 'locations.json');\r\n\r\n// Epic RPG Locations and Dungeons System\r\nclass LocationManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadLocations();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(LOCATIONS_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(LOCATIONS_FILE)) {\r\n      fs.writeFileSync(LOCATIONS_FILE, JSON.stringify({}));\r\n    }\r\n  }\r\n\r\n  loadLocations() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(LOCATIONS_FILE, 'utf8'));\r\n      this.locations = data;\r\n    } catch (error) {\r\n      console.error('Failed to load locations:', error);\r\n      this.locations = {};\r\n    }\r\n  }\r\n\r\n  saveLocations() {\r\n    try {\r\n      fs.writeFileSync(LOCATIONS_FILE, JSON.stringify(this.locations, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save locations:', error);\r\n    }\r\n  }\r\n\r\n  // Epic Location Definitions\r\n  getLocations() {\r\n    return {\r\n      // Starting Areas\r\n      'whispering_woods': {\r\n        id: 'whispering_woods',\r\n        name: 'üå≤ Whispering Woods',\r\n        description: 'Ancient trees whisper secrets of old magic',\r\n        type: 'exploration',\r\n        level: 1,\r\n        encounters: ['friendly_npc', 'easy_monster', 'treasure_chest', 'magic_spring'],\r\n        ai_prompt: 'Describe a mystical forest with ancient trees that seem to whisper secrets. Include ambient sounds and magical elements.',\r\n        rewards: { xp: 5, gold: 10, items: ['health_potion', 'magic_crystal'] },\r\n        color: 0x228B22,\r\n        emoji: 'üå≤',\r\n        unlocked: true\r\n      },\r\n\r\n      'crystal_caverns': {\r\n        id: 'crystal_caverns',\r\n        name: 'üíé Crystal Caverns',\r\n        description: 'Shimmering crystals light the underground passages',\r\n        type: 'dungeon',\r\n        level: 3,\r\n        encounters: ['crystal_golem', 'treasure_room', 'dark_pit', 'magic_circle'],\r\n        ai_prompt: 'Describe a breathtaking cavern filled with glowing crystals of various colors. Include echoes and mystical energies.',\r\n        rewards: { xp: 15, gold: 25, items: ['mana_potion', 'magic_staff', 'crystal_shard'] },\r\n        color: 0x9370DB,\r\n        emoji: 'üíé',\r\n        unlocked: false\r\n      },\r\n\r\n      'volcano_summit': {\r\n        id: 'volcano_summit',\r\n        name: 'üåã Volcano Summit',\r\n        description: 'The peak where fire and earth meet the sky',\r\n        type: 'raid',\r\n        level: 8,\r\n        encounters: ['fire_elemental', 'lava_golem', 'phoenix_nest', 'ancient_altar'],\r\n        ai_prompt: 'Describe a dramatic volcanic landscape with rivers of lava, intense heat, and the raw power of nature.',\r\n        rewards: { xp: 50, gold: 100, items: ['fire_sword', 'phoenix_feather', 'dragon_scale'] },\r\n        color: 0xFF4500,\r\n        emoji: 'üåã',\r\n        unlocked: false\r\n      },\r\n\r\n      'forgotten_temple': {\r\n        id: 'forgotten_temple',\r\n        name: 'üèõÔ∏è Forgotten Temple',\r\n        description: 'Ancient ruins holding divine secrets',\r\n        type: 'dungeon',\r\n        level: 12,\r\n        encounters: ['stone_guardian', 'curse_trap', 'blessed_shrine', 'divine_relic'],\r\n        ai_prompt: 'Describe mysterious ancient ruins overgrown with vines, filled with mystical symbols and divine energy.',\r\n        rewards: { xp: 75, gold: 150, items: ['holy_amulet', 'ancient_scroll', 'divine_blessing'] },\r\n        color: 0xDAA520,\r\n        emoji: 'üèõÔ∏è',\r\n        unlocked: false\r\n      },\r\n\r\n      'shadow_realm': {\r\n        id: 'shadow_realm',\r\n        name: 'üåë Shadow Realm',\r\n        description: 'A dimension where light fears to tread',\r\n        type: 'raid',\r\n        level: 20,\r\n        encounters: ['shadow_beast', 'void_walker', 'dark_portal', 'essence_crystal'],\r\n        ai_prompt: 'Describe a terrifying realm of pure darkness where shadows come alive and whisper forbidden knowledge.',\r\n        rewards: { xp: 200, gold: 500, items: ['shadow_blade', 'void_crystal', 'legendary_blade'] },\r\n        color: 0x2F2F4F,\r\n        emoji: 'üåë',\r\n        unlocked: false\r\n      },\r\n\r\n      'celestial_spire': {\r\n        id: 'celestial_spire',\r\n        name: '‚≠ê Celestial Spire',\r\n        description: 'The highest point where mortals meet the divine',\r\n        type: 'legendary',\r\n        level: 25,\r\n        encounters: ['celestial_guardian', 'star_dragon', 'divine_trial', 'cosmic_artifact'],\r\n        ai_prompt: 'Describe a breathtaking tower reaching into the heavens, surrounded by stars and cosmic phenomena.',\r\n        rewards: { xp: 500, gold: 1000, items: ['celestial_armor', 'star_fragment', 'godly_relic'] },\r\n        color: 0xFFD700,\r\n        emoji: '‚≠ê',\r\n        unlocked: false\r\n      }\r\n    };\r\n  }\r\n\r\n  // Advanced Exploration System\r\n  exploreLocation(userId, locationId) {\r\n    const locations = this.getLocations();\r\n    const location = locations[locationId];\r\n\r\n    if (!location) {\r\n      return { success: false, reason: 'location_not_found' };\r\n    }\r\n\r\n    if (!location.unlocked) {\r\n      return { success: false, reason: 'location_locked' };\r\n    }\r\n\r\n    // Generate random encounter based on location\r\n    const encounter = this.generateEncounter(location);\r\n\r\n    return {\r\n      success: true,\r\n      location,\r\n      encounter,\r\n      narrative: this.generateLocationNarrative(location, encounter)\r\n    };\r\n  }\r\n\r\n  generateEncounter(location) {\r\n    const encounters = location.encounters;\r\n    const randomEncounter = encounters[Math.floor(Math.random() * encounters.length)];\r\n\r\n    return {\r\n      type: randomEncounter,\r\n      difficulty: location.level,\r\n      rewards: this.calculateEncounterRewards(randomEncounter, location.level),\r\n      description: this.getEncounterDescription(randomEncounter, location.level)\r\n    };\r\n  }\r\n\r\n  getEncounterDescription(encounterType, level) {\r\n    const descriptions = {\r\n      // Friendly encounters\r\n      'friendly_npc': `A wise traveler offers guidance and shares ancient knowledge from their journeys.`,\r\n      'magic_spring': `Crystal-clear water glows with restorative magic, healing wounds and granting wisdom.`,\r\n      'blessed_shrine': `A sacred altar radiates divine energy, offering blessings to worthy adventurers.`,\r\n\r\n      // Combat encounters\r\n      'easy_monster': `A curious forest creature emerges, more frightened than dangerous.`,\r\n      'crystal_golem': `Animated crystals form a humanoid shape, defending the cavern's treasures.`,\r\n      'fire_elemental': `Living flames dance with destructive beauty, born from the volcano's heart.`,\r\n      'stone_guardian': `An ancient statue awakens, sworn to protect the temple's secrets.`,\r\n      'shadow_beast': `Darkness coalesces into a terrifying creature from your deepest fears.`,\r\n      'celestial_guardian': `A being of pure starlight descends to test your worthiness.`,\r\n\r\n      // Treasure encounters\r\n      'treasure_chest': `An ornate chest glows with magical energy, promising valuable rewards.`,\r\n      'treasure_room': `A chamber filled with precious artifacts and forgotten wealth.`,\r\n      'ancient_altar': `A mystical altar holds offerings from civilizations long past.`,\r\n\r\n      // Special encounters\r\n      'dark_pit': `A seemingly bottomless pit exhales cold, malevolent air.`,\r\n      'magic_circle': `Glowing runes form a perfect circle of arcane power.`,\r\n      'phoenix_nest': `A magnificent nest made of golden flames and precious materials.`,\r\n      'divine_relic': `A holy artifact pulses with celestial energy.`,\r\n      'dark_portal': `A swirling vortex connects to realms beyond mortal comprehension.`,\r\n      'cosmic_artifact': `An otherworldly object defies the laws of reality.`\r\n    };\r\n\r\n    return descriptions[encounterType] || `An mysterious encounter awaits in this location.`;\r\n  }\r\n\r\n  calculateEncounterRewards(encounterType, level) {\r\n    const baseRewards = {\r\n      xp: level * 5,\r\n      gold: level * 3,\r\n      items: []\r\n    };\r\n\r\n    // Add special rewards based on encounter type\r\n    if (encounterType.includes('treasure') || encounterType.includes('altar') || encounterType.includes('relic')) {\r\n      baseRewards.items.push('random_item');\r\n      baseRewards.gold *= 2;\r\n    }\r\n\r\n    if (encounterType.includes('magic') || encounterType.includes('divine') || encounterType.includes('celestial')) {\r\n      baseRewards.xp *= 2;\r\n    }\r\n\r\n    return baseRewards;\r\n  }\r\n\r\n  generateLocationNarrative(location, encounter) {\r\n    // This would typically use AI to generate dynamic narratives\r\n    return {\r\n      entry: `You arrive at ${location.name}. ${location.description}`,\r\n      encounter: `As you explore deeper, you encounter: ${encounter.description}`,\r\n      rewards: `Completing this encounter may reward: ${encounter.rewards.xp} XP and ${encounter.rewards.gold} gold.`\r\n    };\r\n  }\r\n\r\n  // Location Unlocking System\r\n  unlockLocation(userId, locationId) {\r\n    const locations = this.getLocations();\r\n    const location = locations[locationId];\r\n\r\n    if (!location) {\r\n      return { success: false, reason: 'location_not_found' };\r\n    }\r\n\r\n    if (location.unlocked) {\r\n      return { success: false, reason: 'already_unlocked' };\r\n    }\r\n\r\n    // Check if user meets requirements\r\n    // This would integrate with character stats and achievements\r\n    location.unlocked = true;\r\n    this.saveLocations();\r\n\r\n    return {\r\n      success: true,\r\n      location,\r\n      message: `üèÜ **Location Unlocked!** ${location.emoji} ${location.name}\\n${location.description}`\r\n    };\r\n  }\r\n\r\n  // Dungeon Progression System\r\n  enterDungeon(userId, locationId) {\r\n    const locations = this.getLocations();\r\n    const location = locations[locationId];\r\n\r\n    if (!location || location.type !== 'dungeon') {\r\n      return { success: false, reason: 'not_a_dungeon' };\r\n    }\r\n\r\n    if (!location.unlocked) {\r\n      return { success: false, reason: 'dungeon_locked' };\r\n    }\r\n\r\n    // Generate dungeon instance with multiple floors/rooms\r\n    const dungeonInstance = {\r\n      id: `dungeon_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      locationId,\r\n      userId,\r\n      currentFloor: 1,\r\n      maxFloors: Math.min(10, location.level + 3),\r\n      completed: false,\r\n      startTime: Date.now(),\r\n      progress: []\r\n    };\r\n\r\n    return {\r\n      success: true,\r\n      dungeon: dungeonInstance,\r\n      location,\r\n      firstRoom: this.generateDungeonRoom(location, 1)\r\n    };\r\n  }\r\n\r\n  generateDungeonRoom(location, floor) {\r\n    const roomTypes = ['combat', 'treasure', 'puzzle', 'rest', 'boss'];\r\n    const roomType = roomTypes[Math.floor(Math.random() * roomTypes.length)];\r\n\r\n    return {\r\n      floor,\r\n      type: roomType,\r\n      description: this.getRoomDescription(roomType, location, floor),\r\n      challenge: this.generateRoomChallenge(roomType, location.level, floor),\r\n      rewards: this.calculateRoomRewards(roomType, location.level, floor)\r\n    };\r\n  }\r\n\r\n  getRoomDescription(roomType, location, floor) {\r\n    const descriptions = {\r\n      combat: `Floor ${floor} contains hostile creatures defending their territory.`,\r\n      treasure: `Floor ${floor} holds ancient treasures waiting to be discovered.`,\r\n      puzzle: `Floor ${floor} presents a mystical puzzle that must be solved.`,\r\n      rest: `Floor ${floor} offers a safe haven to recover and prepare.`,\r\n      boss: `Floor ${floor} - The final challenge! A powerful guardian awaits.`\r\n    };\r\n\r\n    return descriptions[roomType] || `Floor ${floor} presents an unknown challenge.`;\r\n  }\r\n\r\n  generateRoomChallenge(roomType, baseLevel, floor) {\r\n    const level = baseLevel + (floor - 1);\r\n\r\n    switch (roomType) {\r\n      case 'combat':\r\n        return {\r\n          type: 'monster',\r\n          name: `Dungeon Guardian (Level ${level})`,\r\n          hp: 50 + (level * 10),\r\n          atk: 8 + level,\r\n          def: 2 + Math.floor(level / 3),\r\n          spd: 2 + Math.floor(level / 4)\r\n        };\r\n\r\n      case 'puzzle':\r\n        return {\r\n          type: 'riddle',\r\n          riddle: this.generateRiddle(level),\r\n          answer: this.getRiddleAnswer()\r\n        };\r\n\r\n      case 'treasure':\r\n        return {\r\n          type: 'lock',\r\n          difficulty: level,\r\n          trap_chance: Math.min(50, level * 5)\r\n        };\r\n\r\n      default:\r\n        return { type: 'none' };\r\n    }\r\n  }\r\n\r\n  calculateRoomRewards(roomType, baseLevel, floor) {\r\n    const level = baseLevel + (floor - 1);\r\n\r\n    switch (roomType) {\r\n      case 'combat':\r\n        return { xp: level * 10, gold: level * 5, items: ['random_item'] };\r\n      case 'treasure':\r\n        return { xp: level * 5, gold: level * 15, items: ['rare_item', 'gold_bonus'] };\r\n      case 'puzzle':\r\n        return { xp: level * 20, gold: level * 8, items: ['skill_book'] };\r\n      case 'boss':\r\n        return { xp: level * 50, gold: level * 30, items: ['legendary_item', 'boss_loot'] };\r\n      default:\r\n        return { xp: level * 3, gold: level * 2 };\r\n    }\r\n  }\r\n\r\n  generateRiddle(level) {\r\n    const riddles = [\r\n      \"I speak without a mouth and hear without ears. I have no body, but I come alive with the wind. What am I?\",\r\n      \"I have keys but no locks. I have space but no room. You can enter, but you can't go outside. What am I?\",\r\n      \"The more you take, the more you leave behind. What am I?\",\r\n      \"I am not alive, but I grow; I don't have lungs, but I need air; I don't have a mouth, but water kills me. What am I?\",\r\n      \"I have cities, but no houses. I have mountains, but no trees. I have water, but no fish. What am I?\"\r\n    ];\r\n\r\n    return riddles[Math.floor(Math.random() * riddles.length)];\r\n  }\r\n\r\n  getRiddleAnswer() {\r\n    // This would return the correct answer for riddle verification\r\n    return \"echo\";\r\n  }\r\n\r\n  // Location Discovery System\r\n  async discoverLocation(userId, locationId) {\r\n    const locations = this.getLocations();\r\n    const location = locations[locationId];\r\n\r\n    if (!location) {\r\n      return { success: false, reason: 'location_not_found' };\r\n    }\r\n\r\n    // Check discovery requirements\r\n    const requirements = this.getDiscoveryRequirements(locationId);\r\n\r\n    const canUnlock = await this.checkRequirements(userId, requirements);\r\n\r\n    return {\r\n      success: true,\r\n      location,\r\n      requirements,\r\n      canUnlock\r\n    };\r\n  }\r\n\r\n  getDiscoveryRequirements(locationId) {\r\n    const requirements = {\r\n      'crystal_caverns': { level: 3, achievements: ['first_character'] },\r\n      'volcano_summit': { level: 8, achievements: ['dragon_slayer'] },\r\n      'forgotten_temple': { level: 12, achievements: ['treasure_hunter'] },\r\n      'shadow_realm': { level: 20, achievements: ['class_master'] },\r\n      'celestial_spire': { level: 25, achievements: ['bot_friend'] }\r\n    };\r\n\r\n    return requirements[locationId] || {};\r\n  }\r\n\r\n  async checkRequirements(userId, requirements) {\r\n    // Check if user meets the requirements\r\n    const { getCharacter, getUserAchievements } = await import('./rpg.js');\r\n    const { getUserAchievements: getAch } = await import('./achievements.js');\r\n\r\n    const char = getCharacter(userId);\r\n    if (!char) return false;\r\n\r\n    if (requirements.level && char.lvl < requirements.level) return false;\r\n\r\n    if (requirements.achievements && requirements.achievements.length > 0) {\r\n      const userAch = getAch(userId);\r\n      const hasRequired = requirements.achievements.every(achId => userAch.find(a => a.id === achId));\r\n      if (!hasRequired) return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const locationManager = new LocationManager();\r\n\r\n// Convenience functions\r\nexport function exploreLocation(userId, locationId) {\r\n  return locationManager.exploreLocation(userId, locationId);\r\n}\r\n\r\nexport function unlockLocation(userId, locationId) {\r\n  return locationManager.unlockLocation(userId, locationId);\r\n}\r\n\r\nexport function enterDungeon(userId, locationId) {\r\n  return locationManager.enterDungeon(userId, locationId);\r\n}\r\n\r\nexport async function discoverLocation(userId, locationId) {\r\n  return await locationManager.discoverLocation(userId, locationId);\r\n}\r\n\r\nexport function getLocations() {\r\n  return locationManager.getLocations();\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\logger.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":6,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":6,"endColumn":20,"fix":{"range":[148,148],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":7,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":7,"endColumn":24,"fix":{"range":[172,172],"text":"node:"}},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":21,"column":9,"nodeType":"Literal","messageId":"escape-case","endLine":21,"endColumn":19,"fix":{"range":[478,488],"text":"'\\x1B[36m'"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":21,"column":9,"nodeType":"Literal","messageId":"no-hex-escape","endLine":21,"endColumn":19,"fix":{"range":[478,488],"text":"'\\u001b[36m'"}},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":22,"column":9,"nodeType":"Literal","messageId":"escape-case","endLine":22,"endColumn":19,"fix":{"range":[510,520],"text":"'\\x1B[33m'"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":22,"column":9,"nodeType":"Literal","messageId":"no-hex-escape","endLine":22,"endColumn":19,"fix":{"range":[510,520],"text":"'\\u001b[33m'"}},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":23,"column":10,"nodeType":"Literal","messageId":"escape-case","endLine":23,"endColumn":20,"fix":{"range":[545,555],"text":"'\\x1B[31m'"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":23,"column":10,"nodeType":"Literal","messageId":"no-hex-escape","endLine":23,"endColumn":20,"fix":{"range":[545,555],"text":"'\\u001b[31m'"}},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":24,"column":12,"nodeType":"Literal","messageId":"escape-case","endLine":24,"endColumn":22,"fix":{"range":[578,588],"text":"'\\x1B[32m'"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":24,"column":12,"nodeType":"Literal","messageId":"no-hex-escape","endLine":24,"endColumn":22,"fix":{"range":[578,588],"text":"'\\u001b[32m'"}},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":25,"column":10,"nodeType":"Literal","messageId":"escape-case","endLine":25,"endColumn":20,"fix":{"range":[609,619],"text":"'\\x1B[35m'"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":25,"column":10,"nodeType":"Literal","messageId":"no-hex-escape","endLine":25,"endColumn":20,"fix":{"range":[609,619],"text":"'\\u001b[35m'"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found appendFileSync from package \"fs\" with non literal argument at index 0","line":79,"column":7,"nodeType":"CallExpression","endLine":79,"endColumn":49},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":80,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":80,"endColumn":6,"fix":{"range":[2189,2189],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":81,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":81,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2213,2266],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":95,"column":19,"nodeType":"MemberExpression","endLine":95,"endColumn":40},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":96,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":96,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2709,2759],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/escape-case","severity":2,"message":"Use uppercase characters for the value of the escape sequence.","line":96,"column":44,"nodeType":"TemplateElement","messageId":"escape-case","endLine":96,"endColumn":53,"fix":{"range":[2749,2756],"text":"\\x1B[0m"}},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":96,"column":44,"nodeType":"TemplateElement","messageId":"no-hex-escape","endLine":96,"endColumn":53,"fix":{"range":[2749,2756],"text":"\\u001b[0m"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":141,"column":26,"nodeType":"Literal","messageId":"error","endLine":141,"endColumn":30,"suggestions":[{"messageId":"replace","fix":{"range":[4016,4020],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":195,"column":51,"nodeType":"Literal","messageId":"error","endLine":195,"endColumn":55,"suggestions":[{"messageId":"replace","fix":{"range":[5545,5549],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":201,"column":41,"nodeType":"Literal","messageId":"error","endLine":201,"endColumn":45,"suggestions":[{"messageId":"replace","fix":{"range":[5817,5821],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":208,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":208,"endColumn":6,"fix":{"range":[6006,6006],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":257,"column":74,"nodeType":"Literal","messageId":"error","endLine":257,"endColumn":78,"suggestions":[{"messageId":"replace","fix":{"range":[7434,7438],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (307). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":307,"endColumn":2}],"suppressedMessages":[],"errorCount":22,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":16,"fixableWarningCount":0,"source":"/**\r\n * Logger module for Discord bot application.\r\n * Provides structured logging with file output and console formatting.\r\n */\r\n\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n/**\r\n * Configuration constants for logging.\r\n */\r\nconst LOG_DIR = path.join(process.cwd(), 'logs');\r\nconst FLUSH_INTERVAL_MS = 5000;\r\nconst MAX_BUFFER_SIZE = 100;\r\nconst KEEP_RECENT_ENTRIES = 50;\r\n\r\n/**\r\n * ANSI color codes for console output formatting.\r\n */\r\nconst CONSOLE_COLORS = {\r\n  info: '\\x1b[36m',    // Cyan\r\n  warn: '\\x1b[33m',    // Yellow\r\n  error: '\\x1b[31m',   // Red\r\n  success: '\\x1b[32m', // Green\r\n  debug: '\\x1b[35m'    // Magenta\r\n};\r\n\r\n/**\r\n * Logger class providing structured logging capabilities.\r\n */\r\nclass Logger {\r\n  /**\r\n   * Creates a new Logger instance.\r\n   */\r\n  constructor() {\r\n    this.logBuffer = [];\r\n    this.flushInterval = setInterval(() => this.flushLogs(), FLUSH_INTERVAL_MS);\r\n    this.ensureLogDirectory();\r\n  }\r\n\r\n  /**\r\n   * Ensures the log directory exists.\r\n   */\r\n  ensureLogDirectory() {\r\n    if (!fs.existsSync(LOG_DIR)) {\r\n      fs.mkdirSync(LOG_DIR, { recursive: true });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets the current log file path based on today's date.\r\n   * @returns {string} The full path to the current log file.\r\n   */\r\n  getLogFilePath() {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    return path.join(LOG_DIR, `bot-${today}.log`);\r\n  }\r\n\r\n  /**\r\n   * Formats a log message with timestamp and metadata.\r\n   * @param {string} level - Log level (info, warn, error, etc.)\r\n   * @param {string} message - Log message\r\n   * @param {object} meta - Additional metadata\r\n   * @returns {string} Formatted log message\r\n   */\r\n  formatMessage(level, message, meta = {}) {\r\n    const timestamp = new Date().toISOString();\r\n    const metaStr = Object.keys(meta).length > 0 ? ` | ${JSON.stringify(meta)}` : '';\r\n    return `[${timestamp}] [${level.toUpperCase()}] ${message}${metaStr}`;\r\n  }\r\n\r\n  /**\r\n   * Writes a message to the log file.\r\n   * @param {string} message - The message to write\r\n   */\r\n  writeToFile(message) {\r\n    try {\r\n      const logFile = this.getLogFilePath();\r\n      fs.appendFileSync(logFile, message + '\\n');\r\n    } catch (error) {\r\n      console.error('Failed to write to log file:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs a message with specified level and metadata.\r\n   * @param {string} level - Log level\r\n   * @param {string} message - Log message\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  log(level, message, meta = {}) {\r\n    const formattedMessage = this.formatMessage(level, message, meta);\r\n\r\n    // Console output with color formatting\r\n    const color = CONSOLE_COLORS[level] || CONSOLE_COLORS.info;\r\n    console.log(`${color}${formattedMessage}\\x1b[0m`);\r\n\r\n    // File output (only for important levels to reduce I/O)\r\n    if (['error', 'warn', 'info', 'success'].includes(level)) {\r\n      this.writeToFile(formattedMessage);\r\n    }\r\n\r\n    // Buffer for potential batch processing and recent log retrieval\r\n    this.logBuffer.push({\r\n      level,\r\n      message: formattedMessage,\r\n      timestamp: Date.now(),\r\n      meta\r\n    });\r\n\r\n    // Prevent memory leaks by limiting buffer size\r\n    if (this.logBuffer.length > MAX_BUFFER_SIZE) {\r\n      this.logBuffer = this.logBuffer.slice(-KEEP_RECENT_ENTRIES);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs an info-level message.\r\n   * @param {string} message - The message to log\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  info(message, meta = {}) {\r\n    this.log('info', message, meta);\r\n  }\r\n\r\n  /**\r\n   * Logs a warning message.\r\n   * @param {string} message - The message to log\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  warn(message, meta = {}) {\r\n    this.log('warn', message, meta);\r\n  }\r\n\r\n  /**\r\n   * Logs an error message with optional error details.\r\n   * @param {string} message - The error message\r\n   * @param {Error|null} error - The error object\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  error(message, error = null, meta = {}) {\r\n    const errorInfo = error ? {\r\n      ...meta,\r\n      error: error.message,\r\n      stack: error.stack\r\n    } : meta;\r\n    this.log('error', message, errorInfo);\r\n  }\r\n\r\n  /**\r\n   * Logs a success message.\r\n   * @param {string} message - The message to log\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  success(message, meta = {}) {\r\n    this.log('success', message, meta);\r\n  }\r\n\r\n  /**\r\n   * Logs a debug message (only if DEBUG=true).\r\n   * @param {string} message - The message to log\r\n   * @param {object} meta - Additional metadata\r\n   */\r\n  debug(message, meta = {}) {\r\n    if (process.env.DEBUG === 'true') {\r\n      this.log('debug', message, meta);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Flushes buffered logs and manages buffer size.\r\n   */\r\n  flushLogs() {\r\n    // Maintain buffer size to prevent memory leaks\r\n    if (this.logBuffer.length > MAX_BUFFER_SIZE) {\r\n      this.logBuffer = this.logBuffer.slice(-KEEP_RECENT_ENTRIES);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieves recent log entries.\r\n   * @param {number} count - Number of recent entries to retrieve\r\n   * @returns {Array} Array of recent log entries\r\n   */\r\n  getRecentLogs(count = 10) {\r\n    return this.logBuffer.slice(-count);\r\n  }\r\n\r\n  /**\r\n   * Logs command execution results.\r\n   * @param {object} interaction - Discord interaction object\r\n   * @param {boolean} success - Whether the command executed successfully\r\n   * @param {Error|null} error - Error object if command failed\r\n   */\r\n  logCommand(interaction, success = true, error = null) {\r\n    const meta = {\r\n      command: interaction.commandName,\r\n      user: `${interaction.user.username}#${interaction.user.discriminator}`,\r\n      userId: interaction.user.id,\r\n      guild: interaction.guild?.name || 'DM',\r\n      guildId: interaction.guild?.id || null,\r\n      channel: interaction.channel?.name || 'Unknown',\r\n      success\r\n    };\r\n\r\n    if (success) {\r\n      this.success(`Command executed: /${interaction.commandName}`, meta);\r\n    } else {\r\n      this.error(`Command failed: /${interaction.commandName}`, error, meta);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logs RPG-related events.\r\n   * @param {string} event - Event type\r\n   * @param {object} details - Event details\r\n   * @param {string} userId - User ID associated with the event\r\n   */\r\n  logRPGEvent(event, details, userId) {\r\n    this.info(`RPG Event: ${event}`, { ...details, userId });\r\n  }\r\n\r\n  /**\r\n   * Logs achievement unlocks.\r\n   * @param {object} achievement - Achievement object with id, name, points\r\n   * @param {string} userId - User ID who unlocked the achievement\r\n   */\r\n  logAchievement(achievement, userId) {\r\n    this.success(`Achievement Unlocked: ${achievement.name}`, {\r\n      achievement: achievement.id,\r\n      points: achievement.points,\r\n      userId\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources on shutdown.\r\n   */\r\n  cleanup() {\r\n    if (this.flushInterval) {\r\n      clearInterval(this.flushInterval);\r\n    }\r\n    this.flushLogs();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const logger = new Logger();\r\n\r\n// Convenience functions for common logging patterns\r\n/**\r\n * Convenience function for logging command execution.\r\n * @param {object} interaction - Discord interaction object\r\n * @param {boolean} success - Whether the command succeeded\r\n * @param {Error|null} error - Error object if failed\r\n */\r\nexport function logCommandExecution(interaction, success = true, error = null) {\r\n  logger.logCommand(interaction, success, error);\r\n}\r\n\r\n/**\r\n * Convenience function for logging errors.\r\n * @param {string} message - Error message\r\n * @param {Error} error - Error object\r\n * @param {object} context - Additional context\r\n */\r\nexport function logError(message, error, context = {}) {\r\n  logger.error(message, error, context);\r\n}\r\n\r\n/**\r\n * Convenience function for logging RPG events.\r\n * @param {string} event - Event type\r\n * @param {object} details - Event details\r\n * @param {string} userId - User ID\r\n */\r\nexport function logRPGEvent(event, details, userId) {\r\n  logger.logRPGEvent(event, details, userId);\r\n}\r\n\r\n/**\r\n * Convenience function for logging achievements.\r\n * @param {object} achievement - Achievement object\r\n * @param {string} userId - User ID\r\n */\r\nexport function logAchievement(achievement, userId) {\r\n  logger.logAchievement(achievement, userId);\r\n}\r\n\r\n// Graceful shutdown handlers - only register once\r\nlet shutdownHandlersRegistered = false;\r\n\r\nif (!shutdownHandlersRegistered) {\r\n  shutdownHandlersRegistered = true;\r\n\r\n  process.on('SIGTERM', () => {\r\n    logger.info('Received SIGTERM, shutting down gracefully...');\r\n    logger.cleanup();\r\n    process.exit(0);\r\n  });\r\n\r\n  process.on('SIGINT', () => {\r\n    logger.info('Received SIGINT, shutting down gracefully...');\r\n    logger.cleanup();\r\n    process.exit(0);\r\n  });\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\minigames\\typing.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":3,"column":69,"nodeType":"Literal","messageId":"error","endLine":3,"endColumn":73,"suggestions":[{"messageId":"replace","fix":{"range":[99,103],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":17,"column":18,"nodeType":"Literal","messageId":"error","endLine":17,"endColumn":22,"suggestions":[{"messageId":"remove","fix":{"range":[717,721],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[717,721],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":18,"column":29,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":18,"endColumn":30,"fix":{"range":[753,753],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":18,"column":56,"nodeType":"ReturnStatement","messageId":"exceed","endLine":18,"endColumn":96},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":18,"column":97,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":18,"endColumn":98,"fix":{"range":[820,820],"text":"\n"}}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"const sessions = new Map();\r\n\r\nexport function startTypingGame(userId, durationSec = 5, sentence = null) {\r\n  const sentencePool = ['quick brown fox', 'lorem ipsum dolor', 'hello world', 'discord bot game', 'type this fast'];\r\n  const chosen = sentence || sentencePool[Math.floor(Math.random() * sentencePool.length)];\r\n  const endAt = Date.now() + durationSec * 1000;\r\n  sessions.set(userId, { sentence: chosen, endAt });\r\n  return { sentence: chosen, endAt };\r\n}\r\n\r\nexport function startTypingGameWithSentence(userId, sentence, durationSec = 6) {\r\n  return startTypingGame(userId, durationSec, sentence);\r\n}\r\n\r\nexport function checkTypingAttempt(userId, text) {\r\n  const s = sessions.get(userId);\r\n  if (!s) return null;\r\n  if (Date.now() > s.endAt) { sessions.delete(userId); return { ok: false, reason: 'timeout' }; }\r\n  const success = text.trim().toLowerCase() === s.sentence.toLowerCase();\r\n  sessions.delete(userId);\r\n  return { ok: success, expected: s.sentence };\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\model-client.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `modelClient.js` or `ModelClient.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":38,"fix":{"range":[235,235],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`rate-limiter-flexible` import should occur before import of `./storage.js`","line":9,"column":1,"nodeType":"ImportDeclaration","endLine":9,"endColumn":59,"fix":{"range":[156,297],"text":"import { RateLimiterMemory } from 'rate-limiter-flexible';\r\nimport { getGuild } from './storage.js';\r\nimport { logger } from './logger.js';\r\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":21,"column":28,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":21,"endColumn":33,"fix":{"range":[719,724],"text":"30_000"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'callLocalModel' has too many lines (108). Maximum allowed is 50.","line":44,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":151,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Async function 'callLocalModel' has too many statements (44). Maximum allowed is 30.","line":44,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":151,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'callLocalModel' has a complexity of 23. Maximum allowed is 10.","line":44,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":151,"endColumn":2},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":52,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":52,"endColumn":4,"fix":{"range":[1711,1711],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `rejRes` should be named `error`.","line":52,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":52,"endColumn":18,"fix":{"range":[1719,1768],"text":"error) {\r\n    const waitTime = Math.round(error"}},{"ruleId":"security/detect-possible-timing-attacks","severity":1,"message":"Potential timing attack, left side: true","line":63,"column":5,"nodeType":"IfStatement","endLine":94,"endColumn":6},{"ruleId":"security/detect-possible-timing-attacks","severity":1,"message":"Potential timing attack, left side: true","line":96,"column":5,"nodeType":"IfStatement","endLine":116,"endColumn":6},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":141,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":141,"endColumn":4,"fix":{"range":[4799,4799],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":141,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":141,"endColumn":15,"fix":{"range":[4807,5096],"text":"error) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (error.name === 'AbortError') {\r\n      throw new Error(`Local model request timed out after ${REQUEST_TIMEOUT_MS / 1000} seconds`);\r\n    }\r\n\r\n    logger.error('Local model error', error);\r\n    throw new Error(`Local model connection failed: ${error"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'callOpenAI' has too many lines (60). Maximum allowed is 50.","line":158,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":217,"endColumn":2},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":166,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":166,"endColumn":4,"fix":{"range":[5522,5522],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `rejRes` should be named `error`.","line":166,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":166,"endColumn":18,"fix":{"range":[5530,5579],"text":"error) {\r\n    const waitTime = Math.round(error"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":207,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":207,"endColumn":4,"fix":{"range":[6884,6884],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":207,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":207,"endColumn":15,"fix":{"range":[6892,7170],"text":"error) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (error.name === 'AbortError') {\r\n      throw new Error(`OpenAI request timed out after ${REQUEST_TIMEOUT_MS / 1000} seconds`);\r\n    }\r\n\r\n    logger.error('OpenAI API error', error);\r\n    throw new Error(`OpenAI connection failed: ${error"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async function 'generate' has too many lines (62). Maximum allowed is 50.","line":225,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":286,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Async function 'generate' has a complexity of 14. Maximum allowed is 10.","line":225,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":286,"endColumn":2},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":230,"column":50,"nodeType":"Literal","messageId":"error","endLine":230,"endColumn":54,"suggestions":[{"messageId":"replace","fix":{"range":[7659,7663],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":244,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":244,"endColumn":6,"fix":{"range":[8159,8159],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":244,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":244,"endColumn":17,"fix":{"range":[8167,8242],"text":"error) {\r\n      logger.warn('Local model failed, trying OpenAI fallback', error"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":268,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":268,"endColumn":6,"fix":{"range":[8861,8861],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":268,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":268,"endColumn":17,"fix":{"range":[8869,8925],"text":"error) {\r\n      logger.error('OpenAI fallback failed', error"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":275,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":275,"endColumn":75,"fix":{"range":[9026,9096],"text":"'In the mystical realm, ancient forces stir as our hero approaches...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":276,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":276,"endColumn":75,"fix":{"range":[9103,9173],"text":"'The adventure continues with unexpected twists and hidden dangers...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":277,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":277,"endColumn":71,"fix":{"range":[9180,9246],"text":"'Legends speak of great treasures waiting for worthy champions...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":278,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":278,"endColumn":74,"fix":{"range":[9253,9322],"text":"'Dark magic swirls as the hero faces their greatest challenge yet...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":279,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":279,"endColumn":58,"fix":{"range":[9329,9382],"text":"'The gods watch as fate unfolds in this epic tale...'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":280,"column":5,"nodeType":"Literal","messageId":"wrongQuotes","endLine":280,"endColumn":80,"fix":{"range":[9389,9464],"text":"'Mysterious energies pulse through the air, revealing new possibilities...'"}}],"suppressedMessages":[],"errorCount":27,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":21,"fixableWarningCount":0,"source":"/**\r\n * Model client for AI-powered content generation.\r\n * Supports local models and OpenAI API with fallback mechanisms.\r\n */\r\n\r\nimport 'dotenv/config';\r\nimport { getGuild } from './storage.js';\r\nimport { logger } from './logger.js';\r\nimport { RateLimiterMemory } from 'rate-limiter-flexible';\r\n\r\n/**\r\n * Configuration constants for model clients.\r\n */\r\nconst OPENAI_KEY = process.env.OPENAI_API_KEY;\r\nconst DEFAULT_LOCAL_URL = process.env.LOCAL_MODEL_URL;\r\nconst DEFAULT_LOCAL_API = process.env.LOCAL_MODEL_API || 'openai-compatible';\r\nconst OPENWEBUI_BASE = process.env.OPENWEBUI_BASE;\r\nconst OPENWEBUI_PATH = process.env.OPENWEBUI_PATH || '/api/chat';\r\n\r\n// Request limits and timeouts\r\nconst REQUEST_TIMEOUT_MS = 30000;\r\nconst MAX_RESPONSE_LENGTH = 2000;\r\n\r\n// Rate limiters for external API calls\r\nconst openAIRateLimiter = new RateLimiterMemory({\r\n  keyPrefix: 'openai_api',\r\n  points: 100, // 100 requests per hour\r\n  duration: 3600,\r\n});\r\n\r\nconst localModelRateLimiter = new RateLimiterMemory({\r\n  keyPrefix: 'local_model_api',\r\n  points: 500, // 500 requests per hour (higher for local)\r\n  duration: 3600,\r\n});\r\n\r\n/**\r\n * Calls a local AI model with the given prompt.\r\n * @param {string} prompt - The prompt to send to the model\r\n * @param {string} url - The model API URL\r\n * @param {string} api - The API type ('openai-compatible', 'openwebui', or 'generic')\r\n * @returns {Promise<string>} The model's response\r\n */\r\nasync function callLocalModel(prompt, url = DEFAULT_LOCAL_URL, api = DEFAULT_LOCAL_API) {\r\n  if (!url) {\r\n    throw new Error('No local model URL configured');\r\n  }\r\n\r\n  // Rate limiting for local model API\r\n  try {\r\n    await localModelRateLimiter.consume('local_model_api');\r\n  } catch (rejRes) {\r\n    const waitTime = Math.round(rejRes.msBeforeNext / 1000);\r\n    throw new Error(`Rate limit exceeded. Try again in ${waitTime} seconds.`);\r\n  }\r\n\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT_MS);\r\n\r\n  try {\r\n    logger.debug('Calling local model', { url, api, promptLength: prompt.length });\r\n\r\n    if (api === 'openai-compatible') {\r\n      const response = await fetch(`${url.replace(/\\/$/, '')}/v1/chat/completions`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${process.env.LOCAL_MODEL_TOKEN || 'not-needed'}`\r\n        },\r\n        body: JSON.stringify({\r\n          model: process.env.LOCAL_MODEL_NAME || 'default-model',\r\n          messages: [{ role: 'user', content: prompt }],\r\n          max_tokens: 512,\r\n          temperature: 0.7\r\n        }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`Local model API error (${response.status}): ${errorText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      const content = data.choices?.[0]?.message?.content ??\r\n                     data.result ??\r\n                     data.response ??\r\n                     'No response generated from local model';\r\n\r\n      logger.debug('Local model response received', { contentLength: content.length });\r\n      return content;\r\n    }\r\n\r\n    if (api === 'openwebui') {\r\n      const base = OPENWEBUI_BASE || url;\r\n      const endpoint = `${base.replace(/\\/$/, '')}${OPENWEBUI_PATH}`;\r\n      const response = await fetch(endpoint, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ prompt }),\r\n        signal: controller.signal\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`OpenWebUI API error (${response.status}): ${await response.text()}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      const content = data.response ?? data.output ?? data.result ?? 'No response from OpenWebUI';\r\n      logger.debug('OpenWebUI response received', { contentLength: content.length });\r\n      return content;\r\n    }\r\n\r\n    // Generic endpoint fallback\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        prompt,\r\n        max_tokens: 512,\r\n        temperature: 0.7\r\n      }),\r\n      signal: controller.signal\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Generic API error (${response.status}): ${await response.text()}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    const content = data.result ?? data.output ?? data.response ?? data.text ?? 'No response from generic API';\r\n    logger.debug('Generic API response received', { contentLength: content.length });\r\n    return content;\r\n\r\n  } catch (err) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (err.name === 'AbortError') {\r\n      throw new Error(`Local model request timed out after ${REQUEST_TIMEOUT_MS / 1000} seconds`);\r\n    }\r\n\r\n    logger.error('Local model error', err);\r\n    throw new Error(`Local model connection failed: ${err.message}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Calls OpenAI API with the given messages.\r\n * @param {Array} messages - Array of message objects with role and content\r\n * @returns {Promise<string>} The AI response\r\n */\r\nasync function callOpenAI(messages) {\r\n  if (!OPENAI_KEY) {\r\n    throw new Error('OpenAI API key not configured');\r\n  }\r\n\r\n  // Rate limiting for OpenAI API\r\n  try {\r\n    await openAIRateLimiter.consume('openai_api');\r\n  } catch (rejRes) {\r\n    const waitTime = Math.round(rejRes.msBeforeNext / 1000);\r\n    throw new Error(`Rate limit exceeded. Try again in ${waitTime} seconds.`);\r\n  }\r\n\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), REQUEST_TIMEOUT_MS);\r\n\r\n  try {\r\n    logger.debug('Calling OpenAI API', { messageCount: messages.length });\r\n\r\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${OPENAI_KEY}`\r\n      },\r\n      body: JSON.stringify({\r\n        model: 'gpt-4o-mini',\r\n        messages: messages,\r\n        max_tokens: 512,\r\n        temperature: 0.8,\r\n        presence_penalty: 0.1,\r\n        frequency_penalty: 0.1\r\n      }),\r\n      signal: controller.signal\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      throw new Error(`OpenAI API error (${response.status}): ${errorText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    const content = data.choices?.[0]?.message?.content?.trim() ?? 'No response generated';\r\n\r\n    logger.debug('OpenAI response received', { contentLength: content.length });\r\n    return content.slice(0, MAX_RESPONSE_LENGTH); // Limit response length\r\n\r\n  } catch (err) {\r\n    clearTimeout(timeoutId);\r\n\r\n    if (err.name === 'AbortError') {\r\n      throw new Error(`OpenAI request timed out after ${REQUEST_TIMEOUT_MS / 1000} seconds`);\r\n    }\r\n\r\n    logger.error('OpenAI API error', err);\r\n    throw new Error(`OpenAI connection failed: ${err.message}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Generates AI content using available models with fallback mechanisms.\r\n * @param {string} guildId - Guild ID for configuration lookup\r\n * @param {string} prompt - The prompt to generate content for\r\n * @returns {Promise<string>} Generated content\r\n */\r\nexport async function generate(guildId, prompt) {\r\n  if (!prompt || typeof prompt !== 'string') {\r\n    throw new Error('Invalid prompt provided');\r\n  }\r\n\r\n  const guildCfg = guildId ? getGuild(guildId) : null;\r\n  const url = guildCfg?.modelUrl || DEFAULT_LOCAL_URL;\r\n  const api = guildCfg?.modelApi || DEFAULT_LOCAL_API;\r\n\r\n  logger.debug('Generating content', { guildId, promptLength: prompt.length, url, api });\r\n\r\n  // Try local model first if configured\r\n  if (url) {\r\n    try {\r\n      const response = await callLocalModel(prompt, url, api);\r\n      if (response && response.length > 0) {\r\n        logger.info('Local model response generated successfully');\r\n        return response;\r\n      }\r\n    } catch (err) {\r\n      logger.warn('Local model failed, trying OpenAI fallback', err);\r\n    }\r\n  }\r\n\r\n  // Try OpenAI if available\r\n  if (OPENAI_KEY) {\r\n    try {\r\n      const messages = [\r\n        {\r\n          role: 'system',\r\n          content: 'You are ULTRA, an advanced AI Discord bot. Provide creative, engaging responses for RPG narration and storytelling. Keep responses under 500 characters.'\r\n        },\r\n        {\r\n          role: 'user',\r\n          content: prompt\r\n        }\r\n      ];\r\n\r\n      const response = await callOpenAI(messages);\r\n      if (response && response.length > 0) {\r\n        logger.info('OpenAI response generated successfully');\r\n        return response;\r\n      }\r\n    } catch (err) {\r\n      logger.error('OpenAI fallback failed', err);\r\n    }\r\n  }\r\n\r\n  // Enhanced fallback with creative responses\r\n  const fallbackResponses = [\r\n    \"In the mystical realm, ancient forces stir as our hero approaches...\",\r\n    \"The adventure continues with unexpected twists and hidden dangers...\",\r\n    \"Legends speak of great treasures waiting for worthy champions...\",\r\n    \"Dark magic swirls as the hero faces their greatest challenge yet...\",\r\n    \"The gods watch as fate unfolds in this epic tale...\",\r\n    \"Mysterious energies pulse through the air, revealing new possibilities...\"\r\n  ];\r\n\r\n  const fallback = fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];\r\n  logger.info('Using fallback response for content generation');\r\n  return fallback;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\moderation.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":40,"column":64,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":40,"endColumn":70,"fix":{"range":[1035,1043],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":42,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":42,"endColumn":6,"fix":{"range":[1088,1088],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":43,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":43,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1112,1168],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":56,"column":77,"nodeType":"Literal","messageId":"error","endLine":56,"endColumn":81,"suggestions":[{"messageId":"replace","fix":{"range":[1445,1449],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":57,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":57,"endColumn":6,"fix":{"range":[1462,1462],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":58,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":58,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1486,1542],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-params","severity":1,"message":"Method 'warnUser' has too many parameters (5). Maximum allowed is 4.","line":63,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":63,"endColumn":11},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":64,"column":10,"nodeType":"MemberExpression","endLine":64,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":65,"column":7,"nodeType":"MemberExpression","endLine":65,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":67,"column":10,"nodeType":"MemberExpression","endLine":67,"endColumn":55},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":67,"column":10,"nodeType":"MemberExpression","endLine":67,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":68,"column":7,"nodeType":"MemberExpression","endLine":68,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":68,"column":7,"nodeType":"MemberExpression","endLine":68,"endColumn":44},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":72,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":72,"endColumn":72,"fix":{"range":[1979,1990],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":81,"column":5,"nodeType":"MemberExpression","endLine":81,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":81,"column":5,"nodeType":"MemberExpression","endLine":81,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":91,"column":12,"nodeType":"MemberExpression","endLine":91,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":91,"column":12,"nodeType":"MemberExpression","endLine":91,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":95,"column":22,"nodeType":"MemberExpression","endLine":95,"endColumn":69},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":95,"column":22,"nodeType":"MemberExpression","endLine":95,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":101,"column":5,"nodeType":"MemberExpression","endLine":101,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":102,"column":5,"nodeType":"MemberExpression","endLine":102,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":103,"column":5,"nodeType":"MemberExpression","endLine":103,"endColumn":27},{"ruleId":"max-params","severity":1,"message":"Method 'muteUser' has too many parameters (5). Maximum allowed is 4.","line":111,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":111,"endColumn":11},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":111,"column":61,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":111,"endColumn":68,"fix":{"range":[3149,3156],"text":"3_600_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":112,"column":10,"nodeType":"MemberExpression","endLine":112,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":113,"column":7,"nodeType":"MemberExpression","endLine":113,"endColumn":41},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":117,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":117,"endColumn":72,"fix":{"range":[3363,3374],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":127,"column":5,"nodeType":"MemberExpression","endLine":127,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":127,"column":5,"nodeType":"MemberExpression","endLine":127,"endColumn":39},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":128,"column":97,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":128,"endColumn":102,"fix":{"range":[3698,3703],"text":"60_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":135,"column":18,"nodeType":"MemberExpression","endLine":135,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":135,"column":18,"nodeType":"MemberExpression","endLine":135,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":149,"column":18,"nodeType":"MemberExpression","endLine":149,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":149,"column":18,"nodeType":"MemberExpression","endLine":149,"endColumn":52},{"ruleId":"max-params","severity":1,"message":"Method 'banUser' has too many parameters (5). Maximum allowed is 4.","line":167,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":167,"endColumn":10},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":167,"column":60,"nodeType":"Literal","messageId":"error","endLine":167,"endColumn":64,"suggestions":[{"messageId":"replace","fix":{"range":[4710,4714],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":168,"column":10,"nodeType":"MemberExpression","endLine":168,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":169,"column":7,"nodeType":"MemberExpression","endLine":169,"endColumn":40},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":173,"column":32,"nodeType":"CallExpression","messageId":"substr","endLine":173,"endColumn":71,"fix":{"range":[4919,4930],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":179,"column":51,"nodeType":"Literal","messageId":"error","endLine":179,"endColumn":55,"suggestions":[{"messageId":"replace","fix":{"range":[5083,5087],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":184,"column":5,"nodeType":"MemberExpression","endLine":184,"endColumn":46},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":184,"column":5,"nodeType":"MemberExpression","endLine":184,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":17,"nodeType":"MemberExpression","endLine":192,"endColumn":60},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":17,"nodeType":"MemberExpression","endLine":192,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":206,"column":17,"nodeType":"MemberExpression","endLine":206,"endColumn":60},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":206,"column":17,"nodeType":"MemberExpression","endLine":206,"endColumn":50},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":219,"column":59,"nodeType":"Literal","messageId":"error","endLine":219,"endColumn":63,"suggestions":[{"messageId":"replace","fix":{"range":[6187,6191],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":225,"column":10,"nodeType":"MemberExpression","endLine":225,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":226,"column":7,"nodeType":"MemberExpression","endLine":226,"endColumn":41},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":228,"column":10,"nodeType":"MemberExpression","endLine":228,"endColumn":52},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":228,"column":10,"nodeType":"MemberExpression","endLine":228,"endColumn":44},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":229,"column":7,"nodeType":"MemberExpression","endLine":229,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":229,"column":7,"nodeType":"MemberExpression","endLine":229,"endColumn":41},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":233,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":233,"endColumn":72,"fix":{"range":[6581,6592],"text":"slice(2, 11"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":240,"column":5,"nodeType":"MemberExpression","endLine":240,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":240,"column":5,"nodeType":"MemberExpression","endLine":240,"endColumn":39},{"ruleId":"max-params","severity":1,"message":"Method 'logModAction' has too many parameters (5). Maximum allowed is 4.","line":248,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":248,"endColumn":15},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":250,"column":32,"nodeType":"CallExpression","messageId":"substr","endLine":250,"endColumn":71,"fix":{"range":[7061,7072],"text":"slice(2, 11"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (534). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":534,"endColumn":19},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":314,"column":64,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":314,"endColumn":69,"fix":{"range":[8918,8923],"text":"10_000"}},{"ruleId":"max-params","severity":1,"message":"Method 'assignRole' has too many parameters (5). Maximum allowed is 4.","line":370,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":370,"endColumn":13},{"ruleId":"max-params","severity":1,"message":"Method 'removeRole' has too many parameters (5). Maximum allowed is 4.","line":374,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":374,"endColumn":13},{"ruleId":"max-params","severity":1,"message":"Method 'deleteMessage' has too many parameters (5). Maximum allowed is 4.","line":379,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":379,"endColumn":16},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":380,"column":57,"nodeType":"Literal","messageId":"error","endLine":380,"endColumn":61,"suggestions":[{"messageId":"replace","fix":{"range":[10827,10831],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":386,"column":19,"nodeType":"MemberExpression","endLine":386,"endColumn":63},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":386,"column":19,"nodeType":"MemberExpression","endLine":386,"endColumn":53},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":19,"nodeType":"MemberExpression","endLine":387,"endColumn":63},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":387,"column":19,"nodeType":"MemberExpression","endLine":387,"endColumn":53},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":388,"column":8,"nodeType":"MemberExpression","endLine":388,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":388,"column":8,"nodeType":"MemberExpression","endLine":388,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":389,"column":18,"nodeType":"MemberExpression","endLine":389,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":389,"column":18,"nodeType":"MemberExpression","endLine":389,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":390,"column":8,"nodeType":"MemberExpression","endLine":390,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":390,"column":8,"nodeType":"MemberExpression","endLine":390,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'guildId' is defined but never used.","line":417,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":417,"endColumn":39},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 19 to the 15 allowed.","line":435,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":435,"endColumn":10},{"ruleId":"complexity","severity":2,"message":"Method 'cleanup' has a complexity of 14. Maximum allowed is 10.","line":435,"column":10,"nodeType":"FunctionExpression","messageId":"complex","endLine":476,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":440,"column":28,"nodeType":"MemberExpression","endLine":440,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":441,"column":22,"nodeType":"MemberExpression","endLine":441,"endColumn":64},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":441,"column":22,"nodeType":"MemberExpression","endLine":441,"endColumn":56},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":450,"column":28,"nodeType":"MemberExpression","endLine":450,"endColumn":61},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":451,"column":21,"nodeType":"MemberExpression","endLine":451,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":451,"column":21,"nodeType":"MemberExpression","endLine":451,"endColumn":54},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":464,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":464,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13856,13925],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":465,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":465,"endColumn":8,"fix":{"range":[13934,13934],"text":"\n"}},{"ruleId":"max-params","severity":1,"message":"Function 'warnUser' has too many parameters (5). Maximum allowed is 4.","line":483,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":483,"endColumn":25},{"ruleId":"max-params","severity":1,"message":"Function 'muteUser' has too many parameters (5). Maximum allowed is 4.","line":487,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":487,"endColumn":25},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":487,"column":75,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":487,"endColumn":82,"fix":{"range":[14638,14645],"text":"3_600_000"}},{"ruleId":"max-params","severity":1,"message":"Function 'banUser' has too many parameters (5). Maximum allowed is 4.","line":491,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":491,"endColumn":24},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":491,"column":74,"nodeType":"Literal","messageId":"error","endLine":491,"endColumn":78,"suggestions":[{"messageId":"replace","fix":{"range":[14814,14818],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]}],"suppressedMessages":[],"errorCount":25,"fatalErrorCount":0,"warningCount":70,"fixableErrorCount":15,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst MODERATION_FILE = path.join(process.cwd(), 'data', 'moderation.json');\r\n\r\n// Advanced Moderation and Administration System\r\nclass ModerationManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadModerationData();\r\n    this.warningCache = new Map();\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(MODERATION_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(MODERATION_FILE)) {\r\n      fs.writeFileSync(MODERATION_FILE, JSON.stringify({\r\n        warnings: {},\r\n        bans: {},\r\n        mutes: {},\r\n        kicks: {},\r\n        mod_actions: [],\r\n        auto_mod: {\r\n          enabled: true,\r\n          spam_detection: true,\r\n          caps_detection: true,\r\n          link_detection: false,\r\n          invite_detection: true,\r\n          bad_words: []\r\n        }\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadModerationData() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(MODERATION_FILE, 'utf8'));\r\n      this.moderationData = data;\r\n    } catch (error) {\r\n      console.error('Failed to load moderation data:', error);\r\n      this.moderationData = {\r\n        warnings: {},\r\n        bans: {},\r\n        mutes: {},\r\n        kicks: {},\r\n        mod_actions: []\r\n      };\r\n    }\r\n  }\r\n\r\n  saveModerationData() {\r\n    try {\r\n      fs.writeFileSync(MODERATION_FILE, JSON.stringify(this.moderationData, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save moderation data:', error);\r\n    }\r\n  }\r\n\r\n  // Advanced Warning System\r\n  warnUser(guildId, userId, moderatorId, reason, severity = 'medium') {\r\n    if (!this.moderationData.warnings[guildId]) {\r\n      this.moderationData.warnings[guildId] = {};\r\n    }\r\n    if (!this.moderationData.warnings[guildId][userId]) {\r\n      this.moderationData.warnings[guildId][userId] = [];\r\n    }\r\n\r\n    const warning = {\r\n      id: `warn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      userId,\r\n      moderatorId,\r\n      reason,\r\n      severity,\r\n      timestamp: Date.now(),\r\n      active: true\r\n    };\r\n\r\n    this.moderationData.warnings[guildId][userId].push(warning);\r\n\r\n    // Log moderation action\r\n    this.logModAction(guildId, 'warn', userId, moderatorId, reason);\r\n\r\n    this.saveModerationData();\r\n    return warning;\r\n  }\r\n\r\n  getUserWarnings(guildId, userId) {\r\n    return this.moderationData.warnings[guildId]?.[userId] || [];\r\n  }\r\n\r\n  removeWarning(guildId, userId, warningId, moderatorId) {\r\n    const warnings = this.moderationData.warnings[guildId]?.[userId];\r\n    if (!warnings) return false;\r\n\r\n    const warningIndex = warnings.findIndex(w => w.id === warningId);\r\n    if (warningIndex === -1) return false;\r\n\r\n    warnings[warningIndex].active = false;\r\n    warnings[warningIndex].removedBy = moderatorId;\r\n    warnings[warningIndex].removedAt = Date.now();\r\n\r\n    this.logModAction(guildId, 'remove_warning', userId, moderatorId, `Removed warning: ${warningId}`);\r\n    this.saveModerationData();\r\n    return true;\r\n  }\r\n\r\n  // Advanced Mute System\r\n  muteUser(guildId, userId, moderatorId, reason, duration = 3600000) { // 1 hour default\r\n    if (!this.moderationData.mutes[guildId]) {\r\n      this.moderationData.mutes[guildId] = {};\r\n    }\r\n\r\n    const mute = {\r\n      id: `mute_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      userId,\r\n      moderatorId,\r\n      reason,\r\n      duration,\r\n      startTime: Date.now(),\r\n      endTime: Date.now() + duration,\r\n      active: true\r\n    };\r\n\r\n    this.moderationData.mutes[guildId][userId] = mute;\r\n    this.logModAction(guildId, 'mute', userId, moderatorId, `${reason} (${Math.round(duration / 60000)}m)`);\r\n\r\n    this.saveModerationData();\r\n    return mute;\r\n  }\r\n\r\n  unmuteUser(guildId, userId, moderatorId, reason = 'Manual unmute') {\r\n    const mute = this.moderationData.mutes[guildId]?.[userId];\r\n    if (!mute) return false;\r\n\r\n    mute.active = false;\r\n    mute.unmutedBy = moderatorId;\r\n    mute.unmutedAt = Date.now();\r\n    mute.unmuteReason = reason;\r\n\r\n    this.logModAction(guildId, 'unmute', userId, moderatorId, reason);\r\n    this.saveModerationData();\r\n    return true;\r\n  }\r\n\r\n  isUserMuted(guildId, userId) {\r\n    const mute = this.moderationData.mutes[guildId]?.[userId];\r\n    if (!mute || !mute.active) return false;\r\n\r\n    if (Date.now() > mute.endTime) {\r\n      mute.active = false;\r\n      this.saveModerationData();\r\n      return false;\r\n    }\r\n\r\n    return {\r\n      muted: true,\r\n      endTime: mute.endTime,\r\n      reason: mute.reason,\r\n      remaining: mute.endTime - Date.now()\r\n    };\r\n  }\r\n\r\n  // Advanced Ban System\r\n  banUser(guildId, userId, moderatorId, reason, duration = null) { // null = permanent\r\n    if (!this.moderationData.bans[guildId]) {\r\n      this.moderationData.bans[guildId] = {};\r\n    }\r\n\r\n    const ban = {\r\n      id: `ban_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      userId,\r\n      moderatorId,\r\n      reason,\r\n      duration,\r\n      startTime: Date.now(),\r\n      endTime: duration ? Date.now() + duration : null,\r\n      permanent: !duration,\r\n      active: true\r\n    };\r\n\r\n    this.moderationData.bans[guildId][userId] = ban;\r\n    this.logModAction(guildId, 'ban', userId, moderatorId, reason);\r\n\r\n    this.saveModerationData();\r\n    return ban;\r\n  }\r\n\r\n  unbanUser(guildId, userId, moderatorId, reason = 'Manual unban') {\r\n    const ban = this.moderationData.bans[guildId]?.[userId];\r\n    if (!ban) return false;\r\n\r\n    ban.active = false;\r\n    ban.unbannedBy = moderatorId;\r\n    ban.unbannedAt = Date.now();\r\n    ban.unbanReason = reason;\r\n\r\n    this.logModAction(guildId, 'unban', userId, moderatorId, reason);\r\n    this.saveModerationData();\r\n    return true;\r\n  }\r\n\r\n  isUserBanned(guildId, userId) {\r\n    const ban = this.moderationData.bans[guildId]?.[userId];\r\n    if (!ban || !ban.active) return false;\r\n\r\n    if (ban.endTime && Date.now() > ban.endTime) {\r\n      ban.active = false;\r\n      this.saveModerationData();\r\n      return false;\r\n    }\r\n\r\n    return {\r\n      banned: true,\r\n      permanent: ban.permanent,\r\n      reason: ban.reason,\r\n      remaining: ban.endTime ? ban.endTime - Date.now() : null\r\n    };\r\n  }\r\n\r\n  // Kick System\r\n  kickUser(guildId, userId, moderatorId, reason) {\r\n    if (!this.moderationData.kicks[guildId]) {\r\n      this.moderationData.kicks[guildId] = {};\r\n    }\r\n    if (!this.moderationData.kicks[guildId][userId]) {\r\n      this.moderationData.kicks[guildId][userId] = [];\r\n    }\r\n\r\n    const kick = {\r\n      id: `kick_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      userId,\r\n      moderatorId,\r\n      reason,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.moderationData.kicks[guildId][userId].push(kick);\r\n    this.logModAction(guildId, 'kick', userId, moderatorId, reason);\r\n\r\n    this.saveModerationData();\r\n    return kick;\r\n  }\r\n\r\n  // Moderation Action Logging\r\n  logModAction(guildId, action, targetUserId, moderatorId, reason) {\r\n    const modAction = {\r\n      id: `mod_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      guildId,\r\n      action,\r\n      targetUserId,\r\n      moderatorId,\r\n      reason,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.moderationData.mod_actions.push(modAction);\r\n\r\n    // Keep only last 1000 actions\r\n    if (this.moderationData.mod_actions.length > 1000) {\r\n      this.moderationData.mod_actions = this.moderationData.mod_actions.slice(-1000);\r\n    }\r\n\r\n    this.saveModerationData();\r\n    return modAction;\r\n  }\r\n\r\n  getModActions(guildId, limit = 50) {\r\n    return this.moderationData.mod_actions\r\n      .filter(action => action.guildId === guildId)\r\n      .sort((a, b) => b.timestamp - a.timestamp)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // Advanced Auto-Moderation\r\n  checkAutoMod(guildId, message, userId) {\r\n    const autoMod = this.moderationData.auto_mod;\r\n    if (!autoMod.enabled) return { triggered: false };\r\n\r\n    const violations = [];\r\n\r\n    // Spam detection\r\n    if (autoMod.spam_detection) {\r\n      const spamCheck = this.checkSpam(message, userId);\r\n      if (spamCheck.triggered) violations.push(spamCheck);\r\n    }\r\n\r\n    // Caps detection\r\n    if (autoMod.caps_detection) {\r\n      const capsCheck = this.checkCaps(message);\r\n      if (capsCheck.triggered) violations.push(capsCheck);\r\n    }\r\n\r\n    // Bad words detection\r\n    if (autoMod.bad_words.length > 0) {\r\n      const badWordsCheck = this.checkBadWords(message, autoMod.bad_words);\r\n      if (badWordsCheck.triggered) violations.push(badWordsCheck);\r\n    }\r\n\r\n    return {\r\n      triggered: violations.length > 0,\r\n      violations\r\n    };\r\n  }\r\n\r\n  checkSpam(message, userId) {\r\n    const now = Date.now();\r\n    const recentMessages = this.warningCache.get(`${userId}_messages`) || [];\r\n\r\n    // Check for repeated messages\r\n    const repeatedMessages = recentMessages.filter(msg =>\r\n      msg.content === message.content && now - msg.timestamp < 10000\r\n    );\r\n\r\n    if (repeatedMessages.length >= 3) {\r\n      return {\r\n        triggered: true,\r\n        type: 'spam',\r\n        severity: 'medium',\r\n        reason: 'Repeated messages detected'\r\n      };\r\n    }\r\n\r\n    // Add current message to cache\r\n    recentMessages.push({ content: message.content, timestamp: now });\r\n    if (recentMessages.length > 10) {\r\n      recentMessages.shift(); // Keep only last 10 messages\r\n    }\r\n    this.warningCache.set(`${userId}_messages`, recentMessages);\r\n\r\n    return { triggered: false };\r\n  }\r\n\r\n  checkCaps(message) {\r\n    const content = typeof message === 'string' ? message : message.content;\r\n    const capsRatio = (content.match(/[A-Z]/g) || []).length / content.length;\r\n\r\n    if (capsRatio > 0.7 && content.length > 10) {\r\n      return {\r\n        triggered: true,\r\n        type: 'caps',\r\n        severity: 'low',\r\n        reason: 'Excessive capital letters'\r\n      };\r\n    }\r\n\r\n    return { triggered: false };\r\n  }\r\n\r\n  checkBadWords(message, badWords) {\r\n    const lowerMessage = message.toLowerCase();\r\n\r\n    for (const word of badWords) {\r\n      if (lowerMessage.includes(word.toLowerCase())) {\r\n        return {\r\n          triggered: true,\r\n          type: 'bad_words',\r\n          severity: 'high',\r\n          reason: `Inappropriate language: ${word}`\r\n        };\r\n      }\r\n    }\r\n\r\n    return { triggered: false };\r\n  }\r\n\r\n  // Role Management\r\n  assignRole(guildId, userId, roleId, moderatorId, reason) {\r\n    return this.logModAction(guildId, 'role_assign', userId, moderatorId, `${reason} (Role: ${roleId})`);\r\n  }\r\n\r\n  removeRole(guildId, userId, roleId, moderatorId, reason) {\r\n    return this.logModAction(guildId, 'role_remove', userId, moderatorId, `${reason} (Role: ${roleId})`);\r\n  }\r\n\r\n  // Message Management\r\n  deleteMessage(guildId, channelId, messageId, moderatorId, reason) {\r\n    return this.logModAction(guildId, 'message_delete', null, moderatorId, `${reason} (Channel: ${channelId})`);\r\n  }\r\n\r\n  // User Statistics for Moderation\r\n  getUserModStats(guildId, userId) {\r\n    const warnings = this.getUserWarnings(guildId, userId).filter(w => w.active);\r\n    const kicks = this.moderationData.kicks[guildId]?.[userId]?.length || 0;\r\n    const mutes = this.moderationData.mutes[guildId]?.[userId] ?\r\n      (this.moderationData.mutes[guildId][userId].active ? 1 : 0) : 0;\r\n    const bans = this.moderationData.bans[guildId]?.[userId] ?\r\n      (this.moderationData.bans[guildId][userId].active ? 1 : 0) : 0;\r\n\r\n    return {\r\n      warnings: warnings.length,\r\n      kicks,\r\n      mutes,\r\n      bans,\r\n      total_actions: warnings.length + kicks + mutes + bans,\r\n      risk_level: this.calculateRiskLevel(warnings, kicks, mutes, bans)\r\n    };\r\n  }\r\n\r\n  calculateRiskLevel(warnings, kicks, mutes, bans) {\r\n    let riskScore = 0;\r\n    riskScore += warnings * 1;  // 1 point per warning\r\n    riskScore += kicks * 3;     // 3 points per kick\r\n    riskScore += mutes * 2;     // 2 points per mute\r\n    riskScore += bans * 5;      // 5 points per ban\r\n\r\n    if (riskScore >= 15) return 'critical';\r\n    if (riskScore >= 10) return 'high';\r\n    if (riskScore >= 5) return 'medium';\r\n    if (riskScore >= 1) return 'low';\r\n    return 'none';\r\n  }\r\n\r\n  // Advanced Filtering System\r\n  shouldFilterMessage(message, guildId) {\r\n    const autoMod = this.moderationData.auto_mod;\r\n\r\n    // Check for Discord invites\r\n    if (autoMod.invite_detection && /discord\\.gg\\/\\w+/.test(message.content)) {\r\n      return { filter: true, reason: 'Discord invite detected' };\r\n    }\r\n\r\n    // Check for excessive mentions\r\n    const mentionCount = (message.content.match(/<@!?(\\d+)>/g) || []).length;\r\n    if (mentionCount > 5) {\r\n      return { filter: true, reason: 'Excessive mentions' };\r\n    }\r\n\r\n    return { filter: false };\r\n  }\r\n\r\n  // Cleanup expired punishments and caches\r\n  cleanup() {\r\n    const now = Date.now();\r\n\r\n    // Clean up expired mutes\r\n    for (const guildId in this.moderationData.mutes) {\r\n      for (const userId in this.moderationData.mutes[guildId]) {\r\n        const mute = this.moderationData.mutes[guildId][userId];\r\n        if (mute.active && mute.endTime && now > mute.endTime) {\r\n          mute.active = false;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Clean up expired bans\r\n    for (const guildId in this.moderationData.bans) {\r\n      for (const userId in this.moderationData.bans[guildId]) {\r\n        const ban = this.moderationData.bans[guildId][userId];\r\n        if (ban.active && ban.endTime && now > ban.endTime) {\r\n          ban.active = false;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Clean up warning cache for inactive users (older than 1 hour)\r\n    const cleanupThreshold = 60 * 60 * 1000; // 1 hour\r\n    for (const [key, messages] of this.warningCache.entries()) {\r\n      const recentMessages = messages.filter(msg => now - msg.timestamp < cleanupThreshold);\r\n      if (recentMessages.length === 0) {\r\n        this.warningCache.delete(key);\r\n        console.log(`[MODERATION] Cleaned up warning cache for key: ${key}`);\r\n      } else {\r\n        this.warningCache.set(key, recentMessages);\r\n      }\r\n    }\r\n\r\n    // Clean up old moderation actions (keep only last 500)\r\n    if (this.moderationData.mod_actions.length > 500) {\r\n      this.moderationData.mod_actions = this.moderationData.mod_actions.slice(-500);\r\n    }\r\n\r\n    this.saveModerationData();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const moderationManager = new ModerationManager();\r\n\r\n// Convenience functions\r\nexport function warnUser(guildId, userId, moderatorId, reason, severity = 'medium') {\r\n  return moderationManager.warnUser(guildId, userId, moderatorId, reason, severity);\r\n}\r\n\r\nexport function muteUser(guildId, userId, moderatorId, reason, duration = 3600000) {\r\n  return moderationManager.muteUser(guildId, userId, moderatorId, reason, duration);\r\n}\r\n\r\nexport function banUser(guildId, userId, moderatorId, reason, duration = null) {\r\n  return moderationManager.banUser(guildId, userId, moderatorId, reason, duration);\r\n}\r\n\r\nexport function kickUser(guildId, userId, moderatorId, reason) {\r\n  return moderationManager.kickUser(guildId, userId, moderatorId, reason);\r\n}\r\n\r\nexport function isUserMuted(guildId, userId) {\r\n  return moderationManager.isUserMuted(guildId, userId);\r\n}\r\n\r\nexport function isUserBanned(guildId, userId) {\r\n  return moderationManager.isUserBanned(guildId, userId);\r\n}\r\n\r\nexport function getUserWarnings(guildId, userId) {\r\n  return moderationManager.getUserWarnings(guildId, userId);\r\n}\r\n\r\nexport function checkAutoMod(guildId, message, userId) {\r\n  return moderationManager.checkAutoMod(guildId, message, userId);\r\n}\r\n\r\nexport function getModActions(guildId, limit = 50) {\r\n  return moderationManager.getModActions(guildId, limit);\r\n}\r\n\r\nexport function getUserModStats(guildId, userId) {\r\n  return moderationManager.getUserModStats(guildId, userId);\r\n}\r\n\r\nexport function unmuteUser(guildId, userId, moderatorId, reason = 'Manual unmute') {\r\n  return moderationManager.unmuteUser(guildId, userId, moderatorId, reason);\r\n}\r\n\r\nexport function unbanUser(guildId, userId, moderatorId, reason = 'Manual unban') {\r\n  return moderationManager.unbanUser(guildId, userId, moderatorId, reason);\r\n}\r\n\r\n// Auto-cleanup every 5 minutes\r\nsetInterval(() => {\r\n  moderationManager.cleanup();\r\n}, 5 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\music.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":38,"fix":{"range":[39,39],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`./logger.js` import should occur after import of `libsodium-wrappers`","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":38},{"ruleId":"import/order","severity":2,"message":"`@discordjs/voice` import should occur after import of `path`","line":4,"column":1,"nodeType":"ImportDeclaration","endLine":4,"endColumn":202,"fix":{"range":[66,514],"text":"import ytdl from '@distube/ytdl-core';\r\nimport axios from 'axios';\r\nimport yts from 'yt-search';\r\nimport ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport { joinVoiceChannel, createAudioPlayer, createAudioResource, AudioPlayerStatus, getVoiceConnection, StreamType, NoSubscriberBehavior, entersState, VoiceConnectionStatus } from '@discordjs/voice';\r\n"}},{"ruleId":"import/order","severity":2,"message":"`@distube/ytdl-core` import should occur after import of `path`","line":5,"column":1,"nodeType":"ImportDeclaration","endLine":5,"endColumn":39,"fix":{"range":[269,514],"text":"import axios from 'axios';\r\nimport yts from 'yt-search';\r\nimport ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport ytdl from '@distube/ytdl-core';\r\n"}},{"ruleId":"import/order","severity":2,"message":"`axios` import should occur after import of `path`","line":6,"column":1,"nodeType":"ImportDeclaration","endLine":6,"endColumn":27,"fix":{"range":[309,514],"text":"import yts from 'yt-search';\r\nimport ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport axios from 'axios';\r\n"}},{"ruleId":"import/order","severity":2,"message":"`yt-search` import should occur after import of `path`","line":7,"column":1,"nodeType":"ImportDeclaration","endLine":7,"endColumn":29,"fix":{"range":[337,514],"text":"import ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport yts from 'yt-search';\r\n"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":36,"fix":{"range":[402,402],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`ffmpeg-static` import should occur after import of `path`","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":36,"fix":{"range":[367,514],"text":"import { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport ffmpeg from 'ffmpeg-static';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:child_process` over `child_process`.","line":9,"column":33,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":9,"endColumn":48,"fix":{"range":[437,437],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":10,"column":28,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":10,"endColumn":32,"fix":{"range":[482,482],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":11,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":11,"endColumn":24,"fix":{"range":[506,506],"text":"node:"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":15,"column":35,"nodeType":"CallExpression","endLine":15,"endColumn":53},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":17,"column":1,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":17,"endColumn":2,"fix":{"range":[673,673],"text":"\n"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":21,"column":25,"nodeType":"CallExpression","endLine":21,"endColumn":47},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":25,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":25,"endColumn":4,"fix":{"range":[1025,1025],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `e`.","line":25,"column":12,"nodeType":"Identifier","messageId":"with-name","endLine":25,"endColumn":13,"fix":{"range":[1032,1036],"text":""}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":25,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":25,"endColumn":13,"fix":{"range":[1033,1034],"text":"error"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":37,"column":63,"nodeType":"CallExpression","endLine":37,"endColumn":85},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":41,"column":17,"nodeType":"CallExpression","endLine":41,"endColumn":39},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":45,"column":1,"nodeType":"ImportDeclaration","endLine":45,"endColumn":59,"fix":{"range":[1690,1690],"text":""}},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":46,"column":1,"nodeType":"ImportDeclaration","endLine":46,"endColumn":50,"fix":{"range":[1741,1741],"text":""}},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":47,"column":1,"nodeType":"ImportDeclaration","endLine":47,"endColumn":38,"fix":{"range":[1780,1780],"text":""}},{"ruleId":"import/newline-after-import","severity":2,"message":"Expected 1 empty line after import statement not followed by another import.","line":47,"column":1,"nodeType":null,"fix":{"range":[1780,1780],"text":"\n"}},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":51,"column":1,"nodeType":"ImportDeclaration","endLine":51,"endColumn":81,"fix":{"range":[1933,1933],"text":""}},{"ruleId":"no-unused-vars","severity":1,"message":"'inputValidator' is defined but never used.","line":51,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'validateString' is defined but never used.","line":51,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":55},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":52,"column":1,"nodeType":"ImportDeclaration","endLine":52,"endColumn":70,"fix":{"range":[0,2004],"text":"\r\nimport { logger } from './logger.js';\r\nimport 'dotenv/config';\r\nimport { joinVoiceChannel, createAudioPlayer, createAudioResource, AudioPlayerStatus, getVoiceConnection, StreamType, NoSubscriberBehavior, entersState, VoiceConnectionStatus } from '@discordjs/voice';\r\nimport ytdl from '@distube/ytdl-core';\r\nimport axios from 'axios';\r\nimport yts from 'yt-search';\r\nimport ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\nimport { RateLimiterMemory } from 'rate-limiter-flexible';\r\nimport SpotifyWebApi from 'spotify-web-api-node';\r\nimport pkg from 'libsodium-wrappers';\r\n\r\n// Import validation utilities\r\nimport { inputValidator, sanitizeInput, validateString } from './validation.js';\r\nimport { CommandError, handleCommandError } from './errorHandler.js';\r\n\r\n// FFmpeg binary path resolution and validation\r\nlet ffmpegPath = ffmpeg;\r\nif (typeof ffmpeg === 'string' && existsSync(ffmpeg)) {\r\n  ffmpegPath = ffmpeg;\r\n} else {\r\n  // Fallback: try to find ffmpeg in system PATH\r\n  try {\r\n    ffmpegPath = execSync('where ffmpeg 2>nul || which ffmpeg 2>/dev/null || echo \"\"', { encoding: 'utf8' }).trim();\r\n    if (!ffmpegPath || !existsSync(ffmpegPath)) {\r\n      // Last resort: use the static binary directly\r\n      ffmpegPath = path.resolve('ffmpeg-static');\r\n    }\r\n  } catch (e) {\r\n    ffmpegPath = path.resolve('ffmpeg-static');\r\n  }\r\n}\r\n\r\n// Ensure absolute path\r\nif (ffmpegPath && !path.isAbsolute(ffmpegPath)) {\r\n  ffmpegPath = path.resolve(ffmpegPath);\r\n}\r\n\r\n// Diagnostic logs for debugging\r\nlogger.info('FFmpeg path resolved', { ffmpegPath });\r\nlogger.info('FFmpeg exists at resolved path', { ffmpegExists: existsSync(ffmpegPath) });\r\nlogger.info('MusicManager initialization diagnostics', {\r\n  originalFfmpegPath: ffmpeg,\r\n  resolvedFfmpegPath: ffmpegPath,\r\n  ffmpegExists: existsSync(ffmpegPath),\r\n  nodeVersion: process.version,\r\n  platform: process.platform\r\n});\r\nconst { ready: sodiumReady } = pkg;"}},{"ruleId":"no-unused-vars","severity":1,"message":"'handleCommandError' is defined but never used.","line":52,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":42},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":91,"column":15,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":91,"endColumn":20,"fix":{"range":[3464,3469],"text":"10_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":92,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":92,"endColumn":22,"fix":{"range":[3488,3493],"text":"86_400"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'performCleanup' has too many lines (62). Maximum allowed is 50.","line":105,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":166,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 24 to the 15 allowed.","line":105,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":105,"endColumn":17},{"ruleId":"max-statements","severity":1,"message":"Method 'performCleanup' has too many statements (31). Maximum allowed is 30.","line":105,"column":17,"nodeType":"FunctionExpression","messageId":"exceed","endLine":166,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'performCleanup' has a complexity of 19. Maximum allowed is 10.","line":105,"column":17,"nodeType":"FunctionExpression","messageId":"complex","endLine":166,"endColumn":4},{"ruleId":"unicorn/prefer-at","severity":2,"message":"Prefer `.at(‚Ä¶)` over `[‚Ä¶.length - index]`.","line":123,"column":50,"nodeType":"BinaryExpression","messageId":"negative-index","endLine":123,"endColumn":68,"fix":{"range":[4471,4491],"text":".at(-1)"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":186,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":186,"endColumn":6,"fix":{"range":[6849,6849],"text":"\n"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":202,"column":33,"nodeType":"CallExpression","messageId":"substr","endLine":202,"endColumn":72,"fix":{"range":[7395,7406],"text":"slice(2, 11"}},{"ruleId":"no-unused-vars","severity":1,"message":"'currentVolume' is assigned a value but never used.","line":261,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":261,"endColumn":26},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":264,"column":43,"nodeType":"Literal","messageId":"error","endLine":264,"endColumn":47,"suggestions":[{"messageId":"replace","fix":{"range":[8905,8909],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":266,"column":11,"nodeType":"IfStatement","messageId":"thenShouldReturnOrThrow","endLine":270,"endColumn":12},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":267,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":267,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9036,9129],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":273,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":273,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[9278,9350],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":273,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":273,"endColumn":74,"fix":{"range":[9292,9341],"text":"'[MUSIC] Unexpected error playing previous song:'"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":289,"column":8,"nodeType":"MemberExpression","endLine":289,"endColumn":16},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":289,"column":18,"nodeType":"MemberExpression","endLine":289,"endColumn":26},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":289,"column":31,"nodeType":"MemberExpression","endLine":289,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":289,"column":41,"nodeType":"MemberExpression","endLine":289,"endColumn":49},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":298,"column":50,"nodeType":"CallExpression","messageId":"substr","endLine":298,"endColumn":89,"fix":{"range":[10030,10041],"text":"slice(2, 11"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (2607). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":2608,"endColumn":1},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":326,"column":42,"nodeType":"CallExpression","messageId":"substr","endLine":326,"endColumn":81,"fix":{"range":[10795,10806],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":336,"column":52,"nodeType":"Literal","messageId":"error","endLine":336,"endColumn":56,"suggestions":[{"messageId":"replace","fix":{"range":[11035,11039],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":339,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":339,"endColumn":4,"fix":{"range":[11049,11052],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":340,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":340,"endColumn":4,"fix":{"range":[11143,11146],"text":"  "}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'searchSongs' has too many lines (348). Maximum allowed is 50.","line":340,"column":4,"nodeType":"MethodDefinition","messageId":"exceed","endLine":687,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 97 to the 15 allowed.","line":340,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":340,"endColumn":21},{"ruleId":"max-statements","severity":1,"message":"Async method 'searchSongs' has too many statements (128). Maximum allowed is 30.","line":340,"column":21,"nodeType":"FunctionExpression","messageId":"exceed","endLine":687,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'searchSongs' has a complexity of 76. Maximum allowed is 10.","line":340,"column":21,"nodeType":"FunctionExpression","messageId":"complex","endLine":687,"endColumn":4},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":341,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":341,"endColumn":6,"fix":{"range":[11186,11191],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":342,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":342,"endColumn":8,"fix":{"range":[11198,11205],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":343,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":343,"endColumn":8,"fix":{"range":[11237,11244],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":344,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":344,"endColumn":10,"fix":{"range":[11288,11297],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":345,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":345,"endColumn":8,"fix":{"range":[11385,11392],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":347,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":347,"endColumn":8,"fix":{"range":[11397,11404],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":348,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":348,"endColumn":8,"fix":{"range":[11457,11464],"text":"      "}},{"ruleId":"unicorn/explicit-length-check","severity":2,"message":"Use `.length === 0` when checking length is zero.","line":348,"column":12,"nodeType":"BinaryExpression","messageId":"zero","endLine":348,"endColumn":37,"fix":{"range":[11468,11493],"text":"sanitizedQuery.length === 0"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":349,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":349,"endColumn":10,"fix":{"range":[11498,11507],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":350,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":350,"endColumn":8,"fix":{"range":[11581,11588],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":352,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":352,"endColumn":8,"fix":{"range":[11593,11600],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":353,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":353,"endColumn":10,"fix":{"range":[11632,11641],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":354,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":354,"endColumn":8,"fix":{"range":[11684,11691],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":356,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":356,"endColumn":8,"fix":{"range":[11696,11703],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":357,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":357,"endColumn":8,"fix":{"range":[11770,11777],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":358,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":358,"endColumn":8,"fix":{"range":[11825,11832],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":359,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":359,"endColumn":8,"fix":{"range":[11881,11888],"text":"      "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":359,"column":56,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":359,"endColumn":62,"fix":{"range":[11936,11942],"text":"300_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":360,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":360,"endColumn":10,"fix":{"range":[11965,11974],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":361,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":361,"endColumn":8,"fix":{"range":[11998,12005],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":363,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":363,"endColumn":8,"fix":{"range":[12010,12017],"text":"      "}},{"ruleId":"no-unused-vars","severity":1,"message":"'results' is assigned a value but never used.","line":363,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":363,"endColumn":21},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":365,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":365,"endColumn":8,"fix":{"range":[12040,12047],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":366,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":366,"endColumn":8,"fix":{"range":[12083,12090],"text":"      "}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/(?:spotify\\.com\\/track\\/|spotify:track:)([a-zA-Z0-9]{22})/ can be optimized to /(?:spotify\\.com\\/track\\/|spotify:track:)([\\dA-Za-z]{22})/.","line":366,"column":50,"nodeType":"Literal","messageId":"better-regex","endLine":366,"endColumn":109,"fix":{"range":[12132,12191],"text":"/(?:spotify\\.com\\/track\\/|spotify:track:)([\\dA-Za-z]{22})/"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":367,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":367,"endColumn":8,"fix":{"range":[12195,12202],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":368,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":368,"endColumn":10,"fix":{"range":[12223,12232],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":369,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":369,"endColumn":12,"fix":{"range":[12239,12250],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":370,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":370,"endColumn":12,"fix":{"range":[12298,12309],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":371,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":371,"endColumn":12,"fix":{"range":[12343,12354],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":372,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":372,"endColumn":12,"fix":{"range":[12409,12420],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":374,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":374,"endColumn":12,"fix":{"range":[12448,12459],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":375,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":375,"endColumn":14,"fix":{"range":[12487,12500],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":376,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":376,"endColumn":16,"fix":{"range":[12519,12534],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":377,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":377,"endColumn":16,"fix":{"range":[12569,12584],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":378,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":378,"endColumn":16,"fix":{"range":[12651,12666],"text":"              "}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":378,"column":80,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":378,"endColumn":85,"fix":{"range":[12730,12735],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":378,"column":122,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":378,"endColumn":127,"fix":{"range":[12772,12777],"text":"60_000"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":379,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":379,"endColumn":16,"fix":{"range":[12831,12846],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":380,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":380,"endColumn":16,"fix":{"range":[12868,12883],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":381,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":381,"endColumn":16,"fix":{"range":[12932,12947],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":382,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":382,"endColumn":16,"fix":{"range":[12967,12982],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":383,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":383,"endColumn":16,"fix":{"range":[13004,13019],"text":"              "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":383,"column":46,"nodeType":"Literal","messageId":"error","endLine":383,"endColumn":50,"suggestions":[{"messageId":"replace","fix":{"range":[13049,13053],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":384,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":384,"endColumn":14,"fix":{"range":[13055,13068],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":386,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":386,"endColumn":14,"fix":{"range":[13075,13088],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":387,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":387,"endColumn":14,"fix":{"range":[13109,13122],"text":"            "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":387,"column":14,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":387,"endColumn":66},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":388,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":388,"endColumn":14,"fix":{"range":[13176,13189],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":390,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":390,"endColumn":14,"fix":{"range":[13268,13281],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":391,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":391,"endColumn":12,"fix":{"range":[13297,13308],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":392,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":392,"endColumn":10,"fix":{"range":[13311,13320],"text":"        "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":392,"column":10,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":392,"endColumn":11,"fix":{"range":[13321,13321],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":393,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":393,"endColumn":12,"fix":{"range":[13342,13353],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":394,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":394,"endColumn":10,"fix":{"range":[13438,13447],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":395,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":395,"endColumn":8,"fix":{"range":[13450,13457],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 16.","line":403,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":403,"endColumn":17,"fix":{"range":[13693,13709],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 16.","line":404,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":404,"endColumn":17,"fix":{"range":[13720,13736],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 18.","line":405,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":405,"endColumn":19,"fix":{"range":[13786,13804],"text":"            "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":405,"column":19,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":444,"endColumn":20},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":406,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":406,"endColumn":21,"fix":{"range":[13811,13831],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":407,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":407,"endColumn":23,"fix":{"range":[13856,13878],"text":"                "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":407,"column":37,"nodeType":"Literal","endLine":407,"endColumn":150},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":408,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":408,"endColumn":23,"fix":{"range":[14008,14030],"text":"                "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":408,"column":33,"nodeType":"Literal","endLine":408,"endColumn":170},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":409,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":409,"endColumn":23,"fix":{"range":[14180,14202],"text":"                "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":409,"column":42,"nodeType":"Literal","endLine":409,"endColumn":58},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":410,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":410,"endColumn":23,"fix":{"range":[14240,14262],"text":"                "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":410,"column":42,"nodeType":"Literal","endLine":410,"endColumn":61},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":411,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":411,"endColumn":23,"fix":{"range":[14303,14325],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":412,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":412,"endColumn":23,"fix":{"range":[14356,14378],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":413,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":413,"endColumn":23,"fix":{"range":[14409,14431],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":414,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":414,"endColumn":23,"fix":{"range":[14462,14484],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":415,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":415,"endColumn":23,"fix":{"range":[14511,14533],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":416,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":416,"endColumn":23,"fix":{"range":[14558,14580],"text":"                "}},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 3 times.","line":416,"column":36,"nodeType":"Literal","endLine":416,"endColumn":103},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":417,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":417,"endColumn":23,"fix":{"range":[14663,14685],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":418,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":418,"endColumn":23,"fix":{"range":[14712,14734],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":419,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":419,"endColumn":23,"fix":{"range":[14770,14792],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":420,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":420,"endColumn":21,"fix":{"range":[14826,14846],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":422,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":422,"endColumn":21,"fix":{"range":[14852,14872],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":423,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":423,"endColumn":23,"fix":{"range":[14935,14957],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":424,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":424,"endColumn":23,"fix":{"range":[14967,14989],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":425,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":425,"endColumn":23,"fix":{"range":[14997,15019],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":426,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":426,"endColumn":21,"fix":{"range":[15059,15079],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":428,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":428,"endColumn":21,"fix":{"range":[15086,15106],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":429,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":429,"endColumn":23,"fix":{"range":[15142,15164],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 24.","line":430,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":430,"endColumn":25,"fix":{"range":[15183,15207],"text":"                  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":431,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":431,"endColumn":23,"fix":{"range":[15231,15253],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":432,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":432,"endColumn":21,"fix":{"range":[15256,15276],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":433,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":433,"endColumn":21,"fix":{"range":[15281,15301],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 18.","line":434,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":434,"endColumn":19,"fix":{"range":[15337,15355],"text":"            "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":434,"column":19,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":434,"endColumn":20,"fix":{"range":[15356,15356],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":435,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":435,"endColumn":21,"fix":{"range":[15379,15399],"text":"              "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":435,"column":21,"nodeType":"MemberExpression","messageId":"unexpected","endLine":435,"endColumn":32,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[15399,15492],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":436,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":436,"endColumn":21,"fix":{"range":[15494,15514],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":437,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":437,"endColumn":23,"fix":{"range":[15561,15583],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":438,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":438,"endColumn":23,"fix":{"range":[15593,15615],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":439,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":439,"endColumn":23,"fix":{"range":[15623,15645],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 22.","line":440,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":440,"endColumn":23,"fix":{"range":[15673,15695],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":441,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":441,"endColumn":21,"fix":{"range":[15720,15740],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":442,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":442,"endColumn":21,"fix":{"range":[15745,15765],"text":"              "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":442,"column":21,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":442,"endColumn":57},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 20.","line":443,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":443,"endColumn":21,"fix":{"range":[15803,15823],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 18.","line":444,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":444,"endColumn":19,"fix":{"range":[15919,15937],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 16.","line":445,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":445,"endColumn":17,"fix":{"range":[15940,15956],"text":"          "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":450,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":450,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[16139,16214],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":463,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":463,"endColumn":10,"fix":{"range":[16682,16682],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":464,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":464,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16713,16800],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":469,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":480,"endColumn":14},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":470,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":470,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[17064,17137],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":481,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":481,"endColumn":12,"fix":{"range":[17530,17530],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":482,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":482,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[17568,17641],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":482,"column":27,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":482,"endColumn":61,"fix":{"range":[17582,17616],"text":"'[MUSIC] YouTube fallback failed:'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":503,"column":41,"nodeType":"Literal","messageId":"error","endLine":503,"endColumn":45,"suggestions":[{"messageId":"replace","fix":{"range":[18514,18518],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":506,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":506,"endColumn":10,"fix":{"range":[18559,18559],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":507,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":507,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[18590,18676],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":522,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":542,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":524,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":541,"endColumn":16},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (7). Maximum allowed is 4.","line":526,"column":17,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":538,"endColumn":18},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":539,"column":15,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":539,"endColumn":16,"fix":{"range":[20055,20055],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":543,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":543,"endColumn":12,"fix":{"range":[20190,20190],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":564,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":564,"endColumn":8,"fix":{"range":[20846,20846],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":574,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":587,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":597,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":597,"endColumn":65},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":602,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":602,"endColumn":10,"fix":{"range":[22423,22423],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":624,"column":77,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":624,"endColumn":82,"fix":{"range":[23477,23482],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":624,"column":119,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":624,"endColumn":124,"fix":{"range":[23519,23524],"text":"60_000"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":629,"column":43,"nodeType":"Literal","messageId":"error","endLine":629,"endColumn":47,"suggestions":[{"messageId":"replace","fix":{"range":[23794,23798],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":643,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":643,"endColumn":8,"fix":{"range":[24192,24192],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":646,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":646,"endColumn":10,"fix":{"range":[24422,24422],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":663,"column":39,"nodeType":"Literal","messageId":"error","endLine":663,"endColumn":43,"suggestions":[{"messageId":"replace","fix":{"range":[25346,25350],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":677,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":677,"endColumn":8,"fix":{"range":[25741,25741],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":683,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":683,"endColumn":6,"fix":{"range":[25955,25955],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'validateSongUrl' has too many lines (172). Maximum allowed is 50.","line":690,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":861,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 55 to the 15 allowed.","line":690,"column":9,"nodeType":null,"messageId":"refactorFunction","endLine":690,"endColumn":24},{"ruleId":"max-statements","severity":1,"message":"Async method 'validateSongUrl' has too many statements (69). Maximum allowed is 30.","line":690,"column":24,"nodeType":"FunctionExpression","messageId":"exceed","endLine":861,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'validateSongUrl' has a complexity of 37. Maximum allowed is 10.","line":690,"column":24,"nodeType":"FunctionExpression","messageId":"complex","endLine":861,"endColumn":4},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":706,"column":53,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":706,"endColumn":59,"fix":{"range":[26853,26859],"text":"600_000"}},{"ruleId":"unicorn/better-regex","severity":2,"message":"/spotify\\.com\\/track\\/([a-zA-Z0-9]{22})/ can be optimized to /spotify\\.com\\/track\\/([\\dA-Za-z]{22})/.","line":715,"column":55,"nodeType":"Literal","messageId":"better-regex","endLine":715,"endColumn":95,"fix":{"range":[27162,27202],"text":"/spotify\\.com\\/track\\/([\\dA-Za-z]{22})/"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":718,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":727,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":724,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":724,"endColumn":75},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":730,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":730,"endColumn":10,"fix":{"range":[27796,27796],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":738,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":738,"endColumn":8,"fix":{"range":[28040,28040],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":744,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":750,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":747,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":747,"endColumn":75},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":753,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":753,"endColumn":10,"fix":{"range":[28779,28779],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":761,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":761,"endColumn":8,"fix":{"range":[29022,29022],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":766,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":766,"endColumn":12,"fix":{"range":[29213,29224],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":767,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":767,"endColumn":12,"fix":{"range":[29235,29246],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":768,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":768,"endColumn":14,"fix":{"range":[29296,29309],"text":"            "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":768,"column":14,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":818,"endColumn":15},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":769,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":769,"endColumn":16,"fix":{"range":[29316,29331],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":770,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":770,"endColumn":18,"fix":{"range":[29356,29373],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":771,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":771,"endColumn":18,"fix":{"range":[29503,29520],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":772,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":772,"endColumn":18,"fix":{"range":[29670,29687],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":773,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":773,"endColumn":18,"fix":{"range":[29725,29742],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":774,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":774,"endColumn":18,"fix":{"range":[29783,29800],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":775,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":775,"endColumn":18,"fix":{"range":[29831,29848],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":776,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":776,"endColumn":18,"fix":{"range":[29879,29896],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":777,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":777,"endColumn":18,"fix":{"range":[29927,29944],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":778,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":778,"endColumn":18,"fix":{"range":[29971,29988],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":779,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":779,"endColumn":18,"fix":{"range":[30013,30030],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":780,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":780,"endColumn":18,"fix":{"range":[30113,30130],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":781,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":781,"endColumn":18,"fix":{"range":[30157,30174],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":782,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":782,"endColumn":18,"fix":{"range":[30210,30227],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":783,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":783,"endColumn":16,"fix":{"range":[30261,30276],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":785,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":785,"endColumn":16,"fix":{"range":[30282,30297],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":786,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":786,"endColumn":18,"fix":{"range":[30371,30388],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":787,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":787,"endColumn":18,"fix":{"range":[30398,30415],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":788,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":788,"endColumn":18,"fix":{"range":[30423,30440],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":789,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":789,"endColumn":18,"fix":{"range":[30446,30463],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":790,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":790,"endColumn":16,"fix":{"range":[30503,30518],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":792,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":792,"endColumn":16,"fix":{"range":[30525,30540],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":793,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":793,"endColumn":18,"fix":{"range":[30574,30591],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 19.","line":794,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":794,"endColumn":20,"fix":{"range":[30610,30629],"text":"                  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 17.","line":795,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":795,"endColumn":18,"fix":{"range":[30653,30670],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":796,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":796,"endColumn":16,"fix":{"range":[30673,30688],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":797,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":797,"endColumn":16,"fix":{"range":[30693,30708],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":798,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":798,"endColumn":14,"fix":{"range":[30744,30757],"text":"            "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":798,"column":14,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":798,"endColumn":15,"fix":{"range":[30758,30758],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 11.","line":799,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":799,"endColumn":12,"fix":{"range":[30781,30792],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 13.","line":800,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":800,"endColumn":14,"fix":{"range":[30856,30869],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 13.","line":801,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":801,"endColumn":14,"fix":{"range":[30877,30890],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 13.","line":802,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":802,"endColumn":14,"fix":{"range":[30896,30909],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 13.","line":803,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":803,"endColumn":14,"fix":{"range":[30937,30950],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 11.","line":804,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":804,"endColumn":12,"fix":{"range":[30978,30989],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 11.","line":806,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":806,"endColumn":12,"fix":{"range":[30996,31007],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 11.","line":807,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":807,"endColumn":12,"fix":{"range":[31082,31093],"text":"              "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":807,"column":12,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":816,"endColumn":55},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 15.","line":808,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":808,"endColumn":16,"fix":{"range":[31184,31199],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 15.","line":809,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":809,"endColumn":16,"fix":{"range":[31310,31325],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 15.","line":810,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":810,"endColumn":16,"fix":{"range":[31392,31407],"text":"                "}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (7). Maximum allowed is 4.","line":810,"column":16,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":815,"endColumn":17},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 19.","line":811,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":811,"endColumn":20,"fix":{"range":[31429,31448],"text":"                  "}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 153. Maximum allowed is 120.","line":812,"column":1,"nodeType":"Program","messageId":"max","endLine":812,"endColumn":154},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 19.","line":812,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":812,"endColumn":20,"fix":{"range":[31486,31505],"text":"                  "}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":812,"column":48,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":812,"endColumn":152,"fix":{"range":[31533,31637],"text":"'YouTube search temporarily unavailable due to API changes. Please try again later or use a direct URL.'"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 19.","line":813,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":813,"endColumn":20,"fix":{"range":[31641,31660],"text":"                  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 18 spaces but found 19.","line":814,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":814,"endColumn":20,"fix":{"range":[31699,31718],"text":"                  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 16 spaces but found 15.","line":815,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":815,"endColumn":16,"fix":{"range":[31736,31751],"text":"                "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 11.","line":816,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":816,"endColumn":12,"fix":{"range":[31754,31765],"text":"              "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":816,"column":12,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":816,"endColumn":13,"fix":{"range":[31766,31766],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":817,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":817,"endColumn":16,"fix":{"range":[31810,31825],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":818,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":818,"endColumn":14,"fix":{"range":[31921,31934],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":819,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":819,"endColumn":12,"fix":{"range":[31937,31948],"text":"          "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":836,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":836,"endColumn":10,"fix":{"range":[32624,32624],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":853,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":853,"endColumn":6,"fix":{"range":[33194,33194],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'playWithErrorHandling' has too many lines (706). Maximum allowed is 50.","line":864,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":1569,"endColumn":4},{"ruleId":"max-params","severity":1,"message":"Async method 'playWithErrorHandling' has too many parameters (5). Maximum allowed is 4.","line":864,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":864,"endColumn":30},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 39 to the 15 allowed.","line":864,"column":9,"nodeType":null,"messageId":"refactorFunction","endLine":864,"endColumn":30},{"ruleId":"max-statements","severity":1,"message":"Async method 'playWithErrorHandling' has too many statements (136). Maximum allowed is 30.","line":864,"column":30,"nodeType":"FunctionExpression","messageId":"exceed","endLine":1569,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'playWithErrorHandling' has a complexity of 22. Maximum allowed is 10.","line":864,"column":30,"nodeType":"FunctionExpression","messageId":"complex","endLine":1569,"endColumn":4},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":879,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":879,"endColumn":6,"fix":{"range":[34048,34048],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":879,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":879,"endColumn":15,"fix":{"range":[34056,34099],"text":"error) {\r\n      logger.debug(`Sodium error: ${error"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":885,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":885,"endColumn":6,"fix":{"range":[34268,34268],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":885,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":885,"endColumn":15,"fix":{"range":[34276,34322],"text":"error) {\r\n      logger.debug(`TweetNaCl error: ${error"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":891,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":891,"endColumn":6,"fix":{"range":[34435,34435],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `e` should be named `error`.","line":891,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":891,"endColumn":15,"fix":{"range":[34443,34498],"text":"error) {\r\n      logger.debug(`libsodium-wrappers error: ${error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":900,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":900,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[34770,34836],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 6 times.","line":918,"column":13,"nodeType":"Literal","endLine":918,"endColumn":27},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 4 times.","line":920,"column":13,"nodeType":"Literal","endLine":920,"endColumn":25},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 4 times.","line":921,"column":13,"nodeType":"Literal","endLine":921,"endColumn":34},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 4 times.","line":922,"column":13,"nodeType":"Literal","endLine":922,"endColumn":35},{"ruleId":"sonarjs/no-duplicate-string","severity":1,"message":"Define a constant instead of duplicating this literal 5 times.","line":924,"column":13,"nodeType":"Literal","endLine":924,"endColumn":31},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":933,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":933,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[35869,35949],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":942,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":942,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[36191,36282],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":960,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":960,"endColumn":10,"fix":{"range":[36849,36849],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":962,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":962,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[36944,37045],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":994,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":994,"endColumn":8,"fix":{"range":[38313,38313],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":995,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":995,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[38345,38433],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1008,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1008,"endColumn":6,"fix":{"range":[38819,38819],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1017,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1017,"endColumn":8,"fix":{"range":[39170,39170],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1030,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1030,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[39600,39672],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1062,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1062,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[40562,40641],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1072,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1072,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[40903,40993],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1091,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1091,"endColumn":8,"fix":{"range":[41530,41530],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1092,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1092,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[41562,41649],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":1108,"column":52,"nodeType":"Literal","messageId":"error","endLine":1108,"endColumn":56,"suggestions":[{"messageId":"replace","fix":{"range":[42231,42235],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1118,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1118,"endColumn":6,"fix":{"range":[42538,42538],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1119,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1119,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[42585,42660],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1133,"column":25,"nodeType":"CallExpression","endLine":1133,"endColumn":47},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1145,"column":14,"nodeType":"CallExpression","endLine":1145,"endColumn":36},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1161,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1161,"endColumn":12,"fix":{"range":[43973,43984],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1162,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1162,"endColumn":12,"fix":{"range":[44006,44017],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1163,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1163,"endColumn":12,"fix":{"range":[44042,44053],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1164,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1164,"endColumn":12,"fix":{"range":[44070,44081],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1165,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1165,"endColumn":12,"fix":{"range":[44096,44107],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1166,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1166,"endColumn":12,"fix":{"range":[44132,44143],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1167,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1167,"endColumn":14,"fix":{"range":[44162,44175],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1168,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1168,"endColumn":16,"fix":{"range":[44187,44202],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1169,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1169,"endColumn":16,"fix":{"range":[44332,44347],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1170,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1170,"endColumn":16,"fix":{"range":[44497,44512],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1171,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1171,"endColumn":16,"fix":{"range":[44550,44565],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1172,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1172,"endColumn":16,"fix":{"range":[44606,44621],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1173,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1173,"endColumn":16,"fix":{"range":[44652,44667],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1174,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1174,"endColumn":16,"fix":{"range":[44696,44711],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1175,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1175,"endColumn":16,"fix":{"range":[44742,44757],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1176,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1176,"endColumn":16,"fix":{"range":[44788,44803],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1177,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1177,"endColumn":16,"fix":{"range":[44830,44845],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1178,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1178,"endColumn":16,"fix":{"range":[44870,44885],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1179,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1179,"endColumn":16,"fix":{"range":[44968,44983],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1180,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1180,"endColumn":16,"fix":{"range":[45010,45025],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 14 spaces but found 15.","line":1181,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1181,"endColumn":16,"fix":{"range":[45061,45076],"text":"              "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1182,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1182,"endColumn":14,"fix":{"range":[45110,45123],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1183,"endColumn":12,"fix":{"range":[45126,45137],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":1184,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1184,"endColumn":10,"fix":{"range":[45140,45149],"text":"        "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":1187,"column":27,"nodeType":"Literal","messageId":"error","endLine":1187,"endColumn":31,"suggestions":[{"messageId":"remove","fix":{"range":[45243,45250],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[45246,45250],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1192,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1192,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[45416,45512],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":1214,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1214,"endColumn":10,"fix":{"range":[46159,46168],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1215,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1215,"endColumn":12,"fix":{"range":[46233,46244],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1216,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1216,"endColumn":12,"fix":{"range":[46254,46265],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1217,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1217,"endColumn":12,"fix":{"range":[46289,46300],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1218,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1218,"endColumn":12,"fix":{"range":[46325,46336],"text":"          "}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1218,"column":26,"nodeType":"CallExpression","endLine":1218,"endColumn":48},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1219,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1219,"endColumn":12,"fix":{"range":[46375,46386],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1220,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1220,"endColumn":14,"fix":{"range":[46401,46414],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1221,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1221,"endColumn":14,"fix":{"range":[46431,46444],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1222,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1222,"endColumn":14,"fix":{"range":[46467,46480],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1223,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1223,"endColumn":14,"fix":{"range":[46506,46519],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1224,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1224,"endColumn":14,"fix":{"range":[46536,46549],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1225,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1225,"endColumn":14,"fix":{"range":[46565,46578],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1226,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1226,"endColumn":14,"fix":{"range":[46595,46608],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 12 spaces but found 13.","line":1227,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1227,"endColumn":14,"fix":{"range":[46621,46634],"text":"            "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1228,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1228,"endColumn":12,"fix":{"range":[46644,46655],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":1229,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1229,"endColumn":10,"fix":{"range":[46658,46667],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":1230,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":1230,"endColumn":10,"fix":{"range":[46672,46681],"text":"        "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1231,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1231,"endColumn":12,"fix":{"range":[46724,46735],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1232,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1232,"endColumn":12,"fix":{"range":[46752,46763],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1233,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1233,"endColumn":12,"fix":{"range":[46786,46797],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1234,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1234,"endColumn":12,"fix":{"range":[46823,46834],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1235,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1235,"endColumn":12,"fix":{"range":[46851,46862],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1236,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1236,"endColumn":12,"fix":{"range":[46878,46889],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1237,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1237,"endColumn":12,"fix":{"range":[46906,46917],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 10 spaces but found 11.","line":1238,"column":1,"nodeType":"String","messageId":"wrongIndentation","endLine":1238,"endColumn":12,"fix":{"range":[46930,46941],"text":"          "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 8 spaces but found 9.","line":1239,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1239,"endColumn":10,"fix":{"range":[46951,46960],"text":"        "}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1244,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1244,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[47116,47188],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1248,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1248,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[47365,47446],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1254,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1254,"endColumn":12,"fix":{"range":[47634,47634],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1261,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1261,"endColumn":12,"fix":{"range":[47899,47899],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1268,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1268,"endColumn":12,"fix":{"range":[48157,48157],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1278,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1278,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[48406,48480],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1285,"column":27,"nodeType":"CallExpression","endLine":1285,"endColumn":49},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1292,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1292,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[48900,48983],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1300,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1300,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[49230,49311],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1313,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1313,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[49642,49725],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1322,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1322,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[49970,50040],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":1377,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":1377,"endColumn":27,"fix":{"range":[51866,51871],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":1380,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":1380,"endColumn":17,"fix":{"range":[51949,51954],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":1398,"column":30,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":1398,"endColumn":35,"fix":{"range":[52614,52619],"text":"30_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":1403,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":1403,"endColumn":17,"fix":{"range":[52776,52781],"text":"30_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1413,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1413,"endColumn":8,"fix":{"range":[52972,52972],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 122. Maximum allowed is 120.","line":1415,"column":1,"nodeType":"Program","messageId":"max","endLine":1415,"endColumn":123},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1415,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1415,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[53059,53173],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1422,"column":29,"nodeType":"CallExpression","endLine":1422,"endColumn":51},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":1434,"column":27,"nodeType":"CallExpression","endLine":1434,"endColumn":49},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1446,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1446,"endColumn":6,"fix":{"range":[54245,54245],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1448,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1448,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[54306,54375],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1495,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1495,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[55792,55871],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1499,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1499,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[56042,56115],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1506,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1506,"endColumn":12,"fix":{"range":[56334,56334],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1517,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1517,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[56621,56711],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1541,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1541,"endColumn":8,"fix":{"range":[57406,57406],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1542,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1542,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[57438,57525],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'play' has too many lines (278). Maximum allowed is 50.","line":1572,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":1849,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 29 to the 15 allowed.","line":1572,"column":9,"nodeType":null,"messageId":"refactorFunction","endLine":1572,"endColumn":13},{"ruleId":"max-statements","severity":1,"message":"Async method 'play' has too many statements (81). Maximum allowed is 30.","line":1572,"column":13,"nodeType":"FunctionExpression","messageId":"exceed","endLine":1849,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Async method 'play' has a complexity of 23. Maximum allowed is 10.","line":1572,"column":13,"nodeType":"FunctionExpression","messageId":"complex","endLine":1849,"endColumn":4},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1573,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1573,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[58543,58622],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1586,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1586,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[59040,59133],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1594,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1594,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[59459,59526],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1605,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1605,"endColumn":10,"fix":{"range":[59904,59904],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `_`.","line":1605,"column":18,"nodeType":"Identifier","messageId":"with-name","endLine":1605,"endColumn":19,"fix":{"range":[59911,59915],"text":""}},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":1605,"column":21,"nodeType":"BlockStatement","messageId":"unexpected","endLine":1605,"endColumn":23,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[59916,59916],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1606,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1606,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[59927,60018],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1607,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1607,"endColumn":8,"fix":{"range":[60027,60027],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1618,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1618,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[60512,60580],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":1618,"column":21,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":1618,"endColumn":75,"fix":{"range":[60524,60578],"text":"'[MUSIC] Connection unstable, attempting reconnection'"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1647,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1647,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[61697,61786],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1656,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1656,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[62038,62113],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1662,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1662,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[62307,62375],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1675,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1675,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[62783,62856],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1694,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1694,"endColumn":8,"fix":{"range":[63520,63520],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1717,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1717,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[64233,64322],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1738,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1738,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[65102,65174],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1746,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1746,"endColumn":14,"fix":{"range":[65481,65481],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1757,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1757,"endColumn":12,"fix":{"range":[65919,65919],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1758,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1758,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[65957,66029],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1770,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1770,"endColumn":10,"fix":{"range":[66437,66437],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1782,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1782,"endColumn":8,"fix":{"range":[66831,66831],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":1797,"column":19,"nodeType":"Literal","messageId":"error","endLine":1797,"endColumn":23,"suggestions":[{"messageId":"replace","fix":{"range":[67330,67334],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1818,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1818,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[68013,68094],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1827,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1827,"endColumn":8,"fix":{"range":[68401,68401],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1838,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1838,"endColumn":6,"fix":{"range":[68778,68778],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1839,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1839,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[68802,68873],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'handlePlaybackError' has too many lines (82). Maximum allowed is 50.","line":1852,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":1933,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'handlePlaybackError' has a complexity of 11. Maximum allowed is 10.","line":1852,"column":22,"nodeType":"FunctionExpression","messageId":"complex","endLine":1933,"endColumn":4},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1853,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1853,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[69321,69407],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1874,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1874,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[70092,70171],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":1874,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":1874,"endColumn":43,"fix":{"range":[70106,70130],"text":"'[MUSIC] Error details:'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":1874,"column":74,"nodeType":"Literal","messageId":"error","endLine":1874,"endColumn":78,"suggestions":[{"messageId":"replace","fix":{"range":[70161,70165],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1896,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1896,"endColumn":10,"fix":{"range":[71010,71010],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1908,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1908,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[71329,71396],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":1908,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":1908,"endColumn":72,"fix":{"range":[71341,71394],"text":"'[MUSIC] Skipping to next song in queue due to error'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1920,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1920,"endColumn":6,"fix":{"range":[71800,71800],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1921,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1921,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[71815,71875],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":1921,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":1921,"endColumn":65,"fix":{"range":[71827,71873],"text":"'[MUSIC] No songs in queue, stopping playback'"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1939,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1939,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[72361,72431],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1945,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1945,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[72583,72665],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1955,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1955,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[73059,73136],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1966,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1966,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[73397,73462],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1973,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1973,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[73665,73740],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1978,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1978,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[73874,73963],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Async method 'reconnectToVoice' has too many lines (87). Maximum allowed is 50.","line":1987,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":2073,"endColumn":4},{"ruleId":"max-statements","severity":1,"message":"Async method 'reconnectToVoice' has too many statements (31). Maximum allowed is 30.","line":1987,"column":25,"nodeType":"FunctionExpression","messageId":"exceed","endLine":2073,"endColumn":4},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":1988,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":1988,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[74190,74275],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2025,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2025,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[75594,75681],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2031,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2031,"endColumn":8,"fix":{"range":[75865,75865],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2032,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2032,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[75896,75989],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2032,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2032,"endColumn":80,"fix":{"range":[75910,75967],"text":"'[MUSIC] Failed to reach ready state after reconnection:'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2039,"column":16,"nodeType":"Literal","messageId":"error","endLine":2039,"endColumn":20,"suggestions":[{"messageId":"remove","fix":{"range":[76232,76236],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[76232,76236],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2041,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2041,"endColumn":6,"fix":{"range":[76253,76253],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2042,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2042,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[76277,76347],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2042,"column":21,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2042,"endColumn":68,"fix":{"range":[76291,76338],"text":"'[MUSIC] Failed to reconnect to voice channel:'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2064,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2064,"endColumn":8,"fix":{"range":[77207,77207],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2071,"column":14,"nodeType":"Literal","messageId":"error","endLine":2071,"endColumn":18,"suggestions":[{"messageId":"remove","fix":{"range":[77384,77388],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[77384,77388],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-multiple-empty-lines","severity":2,"message":"More than 1 blank line not allowed.","line":2075,"column":1,"nodeType":"Program","messageId":"consecutiveBlank","endLine":2076,"endColumn":1,"fix":{"range":[77403,77405],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2104,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2104,"endColumn":8,"fix":{"range":[78252,78252],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2111,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2111,"endColumn":6,"fix":{"range":[78428,78428],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2129,"column":26,"nodeType":"Literal","messageId":"error","endLine":2129,"endColumn":30,"suggestions":[{"messageId":"replace","fix":{"range":[78969,78973],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2148,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2148,"endColumn":8,"fix":{"range":[79490,79490],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2155,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2155,"endColumn":6,"fix":{"range":[79667,79667],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2184,"column":45,"nodeType":"Literal","messageId":"error","endLine":2184,"endColumn":49,"suggestions":[{"messageId":"replace","fix":{"range":[80465,80469],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":2186,"column":13,"nodeType":"IfStatement","messageId":"thenShouldReturnOrThrow","endLine":2190,"endColumn":14},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2187,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2187,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[80581,80664],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2193,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2193,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[80825,80892],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2193,"column":27,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2193,"endColumn":71,"fix":{"range":[80839,80883],"text":"'[MUSIC] Unexpected error skipping to song:'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2196,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2196,"endColumn":8,"fix":{"range":[80953,80953],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2197,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2197,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[80970,81034],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2197,"column":23,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2197,"endColumn":71,"fix":{"range":[80984,81032],"text":"'[MUSIC] No voice connection available for skip'"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'playNext' has too many lines (62). Maximum allowed is 50.","line":2223,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":2284,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'playNext' has a complexity of 11. Maximum allowed is 10.","line":2223,"column":11,"nodeType":"FunctionExpression","messageId":"complex","endLine":2284,"endColumn":4},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2235,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2235,"endColumn":6,"fix":{"range":[81918,81918],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2240,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2240,"endColumn":8,"fix":{"range":[82139,82139],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2245,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2245,"endColumn":6,"fix":{"range":[82278,82278],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2263,"column":43,"nodeType":"Literal","messageId":"error","endLine":2263,"endColumn":47,"suggestions":[{"messageId":"replace","fix":{"range":[82803,82807],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":2265,"column":11,"nodeType":"IfStatement","messageId":"thenShouldReturnOrThrow","endLine":2269,"endColumn":12},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2266,"column":13,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2266,"endColumn":26,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[82913,82998],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2272,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2272,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[83171,83239],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2272,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2272,"endColumn":70,"fix":{"range":[83185,83230],"text":"'[MUSIC] Unexpected error playing next song:'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2276,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2276,"endColumn":6,"fix":{"range":[83364,83364],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2277,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2277,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[83379,83451],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2277,"column":21,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2277,"endColumn":77,"fix":{"range":[83393,83449],"text":"'[MUSIC] No player or connection available for playNext'"}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 21 to the 15 allowed.","line":2286,"column":9,"nodeType":null,"messageId":"refactorFunction","endLine":2286,"endColumn":18},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2302,"column":74,"nodeType":"Literal","messageId":"error","endLine":2302,"endColumn":78,"suggestions":[{"messageId":"replace","fix":{"range":[84396,84400],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":2303,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":2311,"endColumn":14},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (6). Maximum allowed is 4.","line":2306,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":2308,"endColumn":16},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2309,"column":13,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2309,"endColumn":14,"fix":{"range":[84732,84732],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2310,"column":15,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2310,"endColumn":28,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[84755,84850],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2313,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2313,"endColumn":10,"fix":{"range":[84889,84889],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2314,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2314,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[84917,84972],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2314,"column":25,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2314,"endColumn":57,"fix":{"range":[84931,84963],"text":"'[MUSIC] Error updating volume:'"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2353,"column":11,"nodeType":"Literal","messageId":"error","endLine":2353,"endColumn":15,"suggestions":[{"messageId":"replace","fix":{"range":[86081,86085],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2376,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2376,"endColumn":8,"fix":{"range":[86830,86830],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `apiError`.","line":2376,"column":16,"nodeType":"Identifier","messageId":"with-name","endLine":2376,"endColumn":24,"fix":{"range":[86837,86848],"text":""}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2377,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2377,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[86859,86916],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2385,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2385,"endColumn":72,"fix":{"range":[87147,87202],"text":"'Lyrics are not currently available for this song.\\n\\n'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2386,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2386,"endColumn":45,"fix":{"range":[87222,87250],"text":"'**To find lyrics, try:**\\n'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2389,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2389,"endColumn":72,"fix":{"range":[87555,87610],"text":"'‚Ä¢ üéß Use Spotify or YouTube Music for synced lyrics\\n'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2390,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2390,"endColumn":69,"fix":{"range":[87630,87682],"text":"'‚Ä¢ üì± Check the official music video on YouTube\\n\\n'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":2391,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":2391,"endColumn":115,"fix":{"range":[87702,87800],"text":"'üí° *Full lyrics integration would require API keys from Genius, Musixmatch, or similar services*'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":2395,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":2395,"endColumn":6,"fix":{"range":[87937,87937],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":2396,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":2396,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[87961,88005],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'queue' is assigned a value but never used.","line":2419,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":2419,"endColumn":16},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2453,"column":23,"nodeType":"Literal","messageId":"error","endLine":2453,"endColumn":27,"suggestions":[{"messageId":"replace","fix":{"range":[90005,90009],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":2469,"column":25,"nodeType":"Literal","messageId":"error","endLine":2469,"endColumn":29,"suggestions":[{"messageId":"replace","fix":{"range":[90383,90387],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":2505,"column":21,"nodeType":"CallExpression","endLine":2505,"endColumn":43}],"suppressedMessages":[],"errorCount":378,"fatalErrorCount":0,"warningCount":118,"fixableErrorCount":320,"fixableWarningCount":0,"source":"\r\nimport { logger } from './logger.js';\r\nimport 'dotenv/config';\r\nimport { joinVoiceChannel, createAudioPlayer, createAudioResource, AudioPlayerStatus, getVoiceConnection, StreamType, NoSubscriberBehavior, entersState, VoiceConnectionStatus } from '@discordjs/voice';\r\nimport ytdl from '@distube/ytdl-core';\r\nimport axios from 'axios';\r\nimport yts from 'yt-search';\r\nimport ffmpeg from 'ffmpeg-static';\r\nimport { spawn, execSync } from 'child_process';\r\nimport { existsSync } from 'fs';\r\nimport path from 'path';\r\n\r\n// FFmpeg binary path resolution and validation\r\nlet ffmpegPath = ffmpeg;\r\nif (typeof ffmpeg === 'string' && existsSync(ffmpeg)) {\r\n  ffmpegPath = ffmpeg;\r\n} else {\r\n  // Fallback: try to find ffmpeg in system PATH\r\n  try {\r\n    ffmpegPath = execSync('where ffmpeg 2>nul || which ffmpeg 2>/dev/null || echo \"\"', { encoding: 'utf8' }).trim();\r\n    if (!ffmpegPath || !existsSync(ffmpegPath)) {\r\n      // Last resort: use the static binary directly\r\n      ffmpegPath = path.resolve('ffmpeg-static');\r\n    }\r\n  } catch (e) {\r\n    ffmpegPath = path.resolve('ffmpeg-static');\r\n  }\r\n}\r\n\r\n// Ensure absolute path\r\nif (ffmpegPath && !path.isAbsolute(ffmpegPath)) {\r\n  ffmpegPath = path.resolve(ffmpegPath);\r\n}\r\n\r\n// Diagnostic logs for debugging\r\nlogger.info('FFmpeg path resolved', { ffmpegPath });\r\nlogger.info('FFmpeg exists at resolved path', { ffmpegExists: existsSync(ffmpegPath) });\r\nlogger.info('MusicManager initialization diagnostics', {\r\n  originalFfmpegPath: ffmpeg,\r\n  resolvedFfmpegPath: ffmpegPath,\r\n  ffmpegExists: existsSync(ffmpegPath),\r\n  nodeVersion: process.version,\r\n  platform: process.platform\r\n});\r\nimport { RateLimiterMemory } from 'rate-limiter-flexible';\r\nimport SpotifyWebApi from 'spotify-web-api-node';\r\nimport pkg from 'libsodium-wrappers';\r\nconst { ready: sodiumReady } = pkg;\r\n\r\n// Import validation utilities\r\nimport { inputValidator, sanitizeInput, validateString } from './validation.js';\r\nimport { CommandError, handleCommandError } from './errorHandler.js';\r\n\r\n// Enhanced Music System with YouTube & Spotify Priority\r\nclass MusicManager {\r\n  constructor() {\r\n    this.queue = new Map(); // guildId -> queue array\r\n    this.currentlyPlaying = new Map(); // guildId -> current song\r\n    this.musicSettings = new Map(); // guildId -> settings\r\n    this.isPlaying = new Map(); // guildId -> boolean\r\n    this.voiceChannels = new Map(); // guildId -> voice channel info\r\n    this.audioPlayers = new Map(); // guildId -> audio player\r\n    this.history = new Map(); // guildId -> history array\r\n\r\n    // Performance optimization caches\r\n    this.searchCache = new Map(); // Cache recent search results\r\n    this.validationCache = new Map(); // Cache URL validation results\r\n\r\n    // Start periodic cleanup to prevent memory leaks\r\n    this.startPeriodicCleanup();\r\n\r\n    // Initialize Spotify API\r\n    this.spotifyApi = new SpotifyWebApi({\r\n      clientId: process.env.SPOTIFY_CLIENT_ID,\r\n      clientSecret: process.env.SPOTIFY_CLIENT_SECRET,\r\n    });\r\n\r\n    // Refresh Spotify token periodically\r\n    this.refreshSpotifyToken();\r\n\r\n    // Rate limiter for Spotify API (1000 requests per hour - higher limit than Deezer)\r\n    this.rateLimiter = new RateLimiterMemory({\r\n      keyPrefix: 'spotify_api',\r\n      points: 1000,\r\n      duration: 3600,\r\n    });\r\n\r\n    // Rate limiter for YouTube API (10000 requests per day)\r\n    this.youtubeRateLimiter = new RateLimiterMemory({\r\n      keyPrefix: 'youtube_api',\r\n      points: 10000,\r\n      duration: 86400,\r\n    });\r\n  }\r\n\r\n  // Periodic cleanup to prevent memory leaks\r\n  startPeriodicCleanup() {\r\n    // Clean up every 30 minutes\r\n    setInterval(() => {\r\n      this.performCleanup();\r\n    }, 30 * 60 * 1000); // 30 minutes\r\n  }\r\n\r\n  // Perform cleanup of stale data with enhanced cache management\r\n  performCleanup() {\r\n    const now = Date.now();\r\n    const cleanupThreshold = 60 * 60 * 1000; // 1 hour of inactivity\r\n\r\n    logger.info('Starting periodic cleanup of Maps and caches');\r\n\r\n    let cleanedCount = 0;\r\n\r\n    // Clean up music settings for inactive guilds\r\n    for (const [guildId, settings] of this.musicSettings.entries()) {\r\n      if (!settings.lastActivity || (now - settings.lastActivity) > cleanupThreshold) {\r\n        this.musicSettings.delete(guildId);\r\n        cleanedCount++;\r\n      }\r\n    }\r\n\r\n    // Clean up history maps for inactive guilds\r\n    for (const [guildId, history] of this.history.entries()) {\r\n      if (history.length === 0 || (now - history[history.length - 1]?.playedAt) > cleanupThreshold) {\r\n        this.history.delete(guildId);\r\n        cleanedCount++;\r\n      }\r\n    }\r\n\r\n    // Clean up voice channel info for disconnected guilds\r\n    for (const [guildId, voiceInfo] of this.voiceChannels.entries()) {\r\n      if (!voiceInfo || (now - voiceInfo.joinedAt) > cleanupThreshold) {\r\n        this.voiceChannels.delete(guildId);\r\n        cleanedCount++;\r\n      }\r\n    }\r\n\r\n    // Clean up audio players for guilds without active connections\r\n    for (const [guildId, player] of this.audioPlayers.entries()) {\r\n      if (!player || player.state.status === 'idle') {\r\n        this.audioPlayers.delete(guildId);\r\n        cleanedCount++;\r\n      }\r\n    }\r\n\r\n    // Clean up search cache (remove entries older than 30 minutes)\r\n    if (this.searchCache) {\r\n      for (const [key, entry] of this.searchCache.entries()) {\r\n        if ((now - entry.timestamp) > 30 * 60 * 1000) { // 30 minutes\r\n          this.searchCache.delete(key);\r\n          cleanedCount++;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Clean up validation cache (remove entries older than 15 minutes)\r\n    if (this.validationCache) {\r\n      for (const [key, entry] of this.validationCache.entries()) {\r\n        if ((now - entry.timestamp) > 15 * 60 * 1000) { // 15 minutes\r\n          this.validationCache.delete(key);\r\n          cleanedCount++;\r\n        }\r\n      }\r\n    }\r\n\r\n    logger.info('Periodic cleanup completed', { itemsCleaned: cleanedCount });\r\n  }\r\n\r\n  // Spotify Authentication Management\r\n  async refreshSpotifyToken() {\r\n    try {\r\n      // Check if credentials are provided\r\n      if (!process.env.SPOTIFY_CLIENT_ID || !process.env.SPOTIFY_CLIENT_SECRET ||\r\n          process.env.SPOTIFY_CLIENT_ID === 'your-spotify-client-id-here' ||\r\n          process.env.SPOTIFY_CLIENT_SECRET === 'your-spotify-client-secret-here') {\r\n        logger.info('Spotify credentials not configured, skipping token refresh');\r\n        return;\r\n      }\r\n\r\n      const data = await this.spotifyApi.clientCredentialsGrant();\r\n      this.spotifyApi.setAccessToken(data.body['access_token']);\r\n\r\n      // Refresh token before it expires\r\n      const refreshTime = Math.max((data.body['expires_in'] - 60) * 1000, 60 * 1000); // At least 1 minute\r\n      setTimeout(() => this.refreshSpotifyToken(), refreshTime);\r\n      logger.info('Spotify token refreshed successfully');\r\n    } catch (error) {\r\n      logger.error('Failed to refresh Spotify token', error);\r\n      logger.warn('Please check Spotify API credentials in .env file');\r\n      // Retry in 10 minutes for credential issues\r\n      setTimeout(() => this.refreshSpotifyToken(), 10 * 60 * 1000);\r\n    }\r\n  }\r\n\r\n  // Queue Management\r\n  addToQueue(guildId, song) {\r\n    if (!this.queue.has(guildId)) {\r\n      this.queue.set(guildId, []);\r\n    }\r\n\r\n    const queue = this.queue.get(guildId);\r\n    queue.push({\r\n      id: `song_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      ...song,\r\n      addedBy: song.addedBy,\r\n      addedAt: Date.now()\r\n    });\r\n\r\n    return queue;\r\n  }\r\n\r\n  getQueue(guildId) {\r\n    return this.queue.get(guildId) || [];\r\n  }\r\n\r\n  removeFromQueue(guildId, songIndex) {\r\n    const queue = this.queue.get(guildId);\r\n    if (!queue || songIndex < 0 || songIndex >= queue.length) {\r\n      return false;\r\n    }\r\n\r\n    const removed = queue.splice(songIndex, 1);\r\n    return removed[0];\r\n  }\r\n\r\n  clearQueue(guildId) {\r\n    this.queue.set(guildId, []);\r\n    return true;\r\n  }\r\n\r\n  // History Management\r\n  addToHistory(guildId, song) {\r\n    if (!this.history.has(guildId)) {\r\n      this.history.set(guildId, []);\r\n    }\r\n    const history = this.history.get(guildId);\r\n    history.push(song);\r\n    // Limit history to last 10 songs\r\n    if (history.length > 10) {\r\n      history.shift();\r\n    }\r\n  }\r\n\r\n  getHistory(guildId) {\r\n    return this.history.get(guildId) || [];\r\n  }\r\n\r\n  back(guildId) {\r\n    const history = this.getHistory(guildId);\r\n    if (history.length === 0) return false;\r\n\r\n    const previousSong = history.pop();\r\n    this.currentlyPlaying.set(guildId, {\r\n      ...previousSong,\r\n      startedAt: Date.now(),\r\n      status: 'playing'\r\n    });\r\n\r\n    // Play the previous song using enhanced error handling\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player) {\r\n      const currentVolume = this.getVolume(guildId) / 100;\r\n\r\n      // Use the enhanced playback method\r\n      this.playWithErrorHandling(guildId, null, previousSong, player, getVoiceConnection(guildId))\r\n        .then(result => {\r\n          if (!result.success) {\r\n            console.error(`[MUSIC] Failed to play previous song \"${previousSong.title}\":`, result.error);\r\n            // Try to play next available song\r\n            this.playNext(guildId);\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.error(`[MUSIC] Unexpected error playing previous song:`, error);\r\n          this.playNext(guildId);\r\n        });\r\n    }\r\n\r\n    return previousSong;\r\n  }\r\n\r\n  shuffleQueue(guildId) {\r\n    const queue = this.queue.get(guildId);\r\n    if (!queue || queue.length < 2) return false;\r\n\r\n    // Keep current song in place, shuffle the rest\r\n    const currentSong = queue.shift();\r\n    for (let i = queue.length - 1; i > 0; i--) {\r\n      const j = Math.floor(Math.random() * (i + 1));\r\n      [queue[i], queue[j]] = [queue[j], queue[i]];\r\n    }\r\n    queue.unshift(currentSong);\r\n\r\n    return true;\r\n  }\r\n\r\n  // Playlist Management\r\n  createPlaylist(guildId, name, creatorId) {\r\n    const playlistId = `playlist_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const playlist = {\r\n      id: playlistId,\r\n      name,\r\n      creator: creatorId,\r\n      songs: [],\r\n      created: Date.now(),\r\n      isPublic: true,\r\n      playCount: 0\r\n    };\r\n\r\n    if (!this.musicSettings.has(guildId)) {\r\n      this.musicSettings.set(guildId, { playlists: new Map() });\r\n    }\r\n\r\n    this.musicSettings.get(guildId).playlists.set(playlistId, playlist);\r\n    return playlist;\r\n  }\r\n\r\n  addToPlaylist(guildId, playlistId, song) {\r\n    const settings = this.musicSettings.get(guildId);\r\n    if (!settings?.playlists) return false;\r\n\r\n    const playlist = settings.playlists.get(playlistId);\r\n    if (!playlist) return false;\r\n\r\n    playlist.songs.push({\r\n      id: `playlist_song_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      ...song,\r\n      addedAt: Date.now()\r\n    });\r\n\r\n    return true;\r\n  }\r\n\r\n  getPlaylist(guildId, playlistId) {\r\n    const settings = this.musicSettings.get(guildId);\r\n    return settings?.playlists?.get(playlistId) || null;\r\n  }\r\n\r\n   // Search and Discovery - YouTube & Spotify Priority with enhanced validation and caching\r\n   async searchSongs(query, limit = 10) {\r\n     try {\r\n       // Validate and sanitize input\r\n       if (!query || typeof query !== 'string') {\r\n         throw new CommandError('Search query must be a non-empty string', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       const sanitizedQuery = sanitizeInput(query.trim());\r\n       if (sanitizedQuery.length < 1) {\r\n         throw new CommandError('Search query is too short', 'INVALID_ARGUMENT');\r\n       }\r\n\r\n       if (limit < 1 || limit > 50) {\r\n         limit = Math.max(1, Math.min(50, limit));\r\n       }\r\n\r\n       // Check cache first (simple in-memory cache for recent searches)\r\n       const cacheKey = `${sanitizedQuery}_${limit}`;\r\n       const cached = this.searchCache?.get(cacheKey);\r\n       if (cached && (Date.now() - cached.timestamp) < 300000) { // 5 minute cache\r\n         return cached.results;\r\n       }\r\n\r\n       const results = [];\r\n\r\n       // Check if query is a Spotify URL\r\n       const spotifyMatch = sanitizedQuery.match(/(?:spotify\\.com\\/track\\/|spotify:track:)([a-zA-Z0-9]{22})/);\r\n       if (spotifyMatch) {\r\n         try {\r\n           await this.rateLimiter.consume('spotify_api');\r\n           const trackId = spotifyMatch[1];\r\n           const data = await this.spotifyApi.getTrack(trackId);\r\n           const track = data.body;\r\n\r\n           if (track && track.name) {\r\n             const result = [{\r\n               title: sanitizeInput(track.name),\r\n               artist: sanitizeInput(track.artists.map(a => a.name).join(', ')),\r\n               duration: track.duration_ms ? `${Math.floor(track.duration_ms / 60000)}:${Math.floor((track.duration_ms % 60000) / 1000).toString().padStart(2, '0')}` : 'Unknown',\r\n               url: sanitizedQuery,\r\n               thumbnail: track.album?.images?.[0]?.url || '',\r\n               source: 'spotify',\r\n               spotifyId: track.id,\r\n               preview: track.preview_url || null\r\n             }];\r\n\r\n             // Cache the result\r\n             if (!this.searchCache) this.searchCache = new Map();\r\n             this.searchCache.set(cacheKey, { results: result, timestamp: Date.now() });\r\n\r\n             return result;\r\n           }\r\n         } catch (urlError) {\r\n           logger.error('Spotify URL validation failed', urlError, { query: sanitizedQuery });\r\n         }\r\n       }\r\n\r\n      // Check if query is a YouTube URL (high priority)\r\n      if (ytdl.validateURL(query)) {\r\n        try {\r\n          await this.youtubeRateLimiter.consume('youtube_api');\r\n\r\n          // Add retry logic for YouTube API issues\r\n                let info;\r\n                for (let attempt = 1; attempt <= 3; attempt++) {\r\n                  try {\r\n                    const modernHeaders = {\r\n                      'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',\r\n                      'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\r\n                      'Accept-Language': 'en-US,en;q=0.9',\r\n                      'Accept-Encoding': 'gzip, deflate, br',\r\n                      'Cache-Control': 'max-age=0',\r\n                      'Sec-Fetch-Dest': 'document',\r\n                      'Sec-Fetch-Mode': 'navigate',\r\n                      'Sec-Fetch-Site': 'none',\r\n                      'Sec-Fetch-User': '?1',\r\n                      'Sec-Ch-Ua': '\"Google Chrome\";v=\"131\", \"Chromium\";v=\"131\", \"Not_A Brand\";v=\"24\"',\r\n                      'Sec-Ch-Ua-Mobile': '?0',\r\n                      'Sec-Ch-Ua-Platform': '\"Windows\"',\r\n                      'Upgrade-Insecure-Requests': '1'\r\n                    };\r\n\r\n                    logger.debug('YouTube getInfo attempt with modern headers', {\r\n                      attempt,\r\n                      query,\r\n                      userAgent: modernHeaders['User-Agent']\r\n                    });\r\n\r\n                    info = await ytdl.getInfo(query, {\r\n                      requestOptions: {\r\n                        headers: modernHeaders\r\n                      }\r\n                    });\r\n                    break; // Success, exit retry loop\r\n                  } catch (retryError) {\r\n                    console.log(`[MUSIC] YouTube attempt ${attempt} failed for ${query}: ${retryError.message}`);\r\n                    logger.warn('YouTube getInfo retry failed', {\r\n                      attempt,\r\n                      query,\r\n                      error: retryError.message,\r\n                      stack: retryError.stack\r\n                    });\r\n                    if (attempt === 3) throw retryError;\r\n                    await new Promise(resolve => setTimeout(resolve, 2000 * attempt)); // Wait longer before retry\r\n                  }\r\n                }\r\n\r\n          const video = info.videoDetails;\r\n\r\n          if (video.isPrivate || !video.title || video.title === 'Deleted video' || video.title === 'Private video') {\r\n            console.log(`[MUSIC] Video unavailable: ${query} (Title: ${video.title})`);\r\n            return [];\r\n          }\r\n\r\n          return [{\r\n            title: video.title,\r\n            artist: video.author.name,\r\n            duration: video.lengthSeconds ? `${Math.floor(video.lengthSeconds / 60)}:${(video.lengthSeconds % 60).toString().padStart(2, '0')}` : 'Unknown',\r\n            url: query,\r\n            thumbnail: video.thumbnails[0]?.url || '',\r\n            source: 'youtube',\r\n            youtubeId: video.videoId\r\n          }];\r\n        } catch (urlError) {\r\n          console.error(`[MUSIC] YouTube URL validation failed for ${query}:`, urlError.message);\r\n          // Try to extract basic info without full validation\r\n          try {\r\n            const urlObj = new URL(query);\r\n            const videoId = urlObj.searchParams.get('v') || urlObj.pathname.split('/').pop();\r\n            if (videoId) {\r\n              console.log(`[MUSIC] Falling back to basic YouTube info for ${videoId}`);\r\n              return [{\r\n                title: `YouTube Video ${videoId}`,\r\n                artist: 'Unknown Artist',\r\n                duration: 'Unknown',\r\n                url: query,\r\n                thumbnail: `https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`,\r\n                source: 'youtube',\r\n                youtubeId: videoId\r\n              }];\r\n            }\r\n          } catch (fallbackError) {\r\n            console.error(`[MUSIC] YouTube fallback failed:`, fallbackError.message);\r\n          }\r\n          return [];\r\n        }\r\n      }\r\n\r\n      // Check if query is a Deezer URL (legacy support)\r\n      const deezerMatch = query.match(/deezer\\.com\\/track\\/(\\d+)/);\r\n      if (deezerMatch) {\r\n        try {\r\n          const trackId = deezerMatch[1];\r\n          const response = await axios.get(`https://api.deezer.com/track/${trackId}`);\r\n          if (response.data && response.data.title) {\r\n            const track = response.data;\r\n            return [{\r\n              title: track.title,\r\n              artist: track.artist?.name || 'Unknown',\r\n              duration: track.duration ? `${Math.floor(track.duration / 60)}:${(track.duration % 60).toString().padStart(2, '0')}` : 'Unknown',\r\n              url: query,\r\n              thumbnail: track.album?.cover_medium || '',\r\n              source: 'deezer',\r\n              preview: track.preview || null\r\n            }];\r\n          }\r\n        } catch (urlError) {\r\n          console.error(`[MUSIC] Deezer URL validation failed for ${query}:`, urlError.message);\r\n          return [];\r\n        }\r\n      }\r\n\r\n      // For text queries, try YouTube first (primary)\r\n      try {\r\n        await this.youtubeRateLimiter.consume('youtube_api');\r\n        const searchResults = await yts(sanitizedQuery);\r\n        const videos = searchResults.videos.slice(0, limit);\r\n\r\n        const validVideos = [];\r\n        for (const video of videos) {\r\n          try {\r\n            // Quick validation without full info fetch with enhanced checks\r\n            if (video.title && video.author && video.duration && video.author.name) {\r\n              // Validate URL format to ensure it's a proper YouTube URL\r\n              if (ytdl.validateURL(video.url)) {\r\n                // Additional validation for video availability\r\n                if (!video.title.toLowerCase().includes('deleted') &&\r\n                    !video.title.toLowerCase().includes('private') &&\r\n                    video.duration.seconds > 0) {\r\n                  validVideos.push({\r\n                    title: sanitizeInput(video.title),\r\n                    artist: sanitizeInput(video.author.name),\r\n                    duration: video.duration.timestamp,\r\n                    url: video.url,\r\n                    thumbnail: video.thumbnail,\r\n                    source: 'youtube',\r\n                    youtubeId: video.videoId\r\n                  });\r\n                }\r\n              } else {\r\n                logger.debug('Skipping invalid YouTube URL', { url: video.url });\r\n              }\r\n            }\r\n          } catch (videoError) {\r\n            logger.debug('Skipping unavailable video', {\r\n              title: video.title,\r\n              url: video.url,\r\n              error: videoError.message\r\n            });\r\n          }\r\n        }\r\n\r\n        if (validVideos.length > 0) {\r\n          logger.info('YouTube search successful', {\r\n            query: sanitizedQuery,\r\n            results: validVideos.length\r\n          });\r\n\r\n          // Cache the result\r\n          if (!this.searchCache) this.searchCache = new Map();\r\n          this.searchCache.set(cacheKey, { results: validVideos, timestamp: Date.now() });\r\n\r\n          return validVideos;\r\n        }\r\n      } catch (error) {\r\n        logger.error('YouTube search failed', error, { query: sanitizedQuery });\r\n        // Try with different search options\r\n        try {\r\n          logger.debug('Retrying YouTube search with different options');\r\n          const searchResults = await yts(sanitizedQuery, { pages: 1 });\r\n          const videos = searchResults.videos.slice(0, limit);\r\n\r\n          const validVideos = [];\r\n          for (const video of videos) {\r\n            if (video.title && video.author && video.duration &&\r\n                video.author.name && ytdl.validateURL(video.url) &&\r\n                !video.title.toLowerCase().includes('deleted') &&\r\n                !video.title.toLowerCase().includes('private')) {\r\n              validVideos.push({\r\n                title: sanitizeInput(video.title),\r\n                artist: sanitizeInput(video.author.name),\r\n                duration: video.duration.timestamp,\r\n                url: video.url,\r\n                thumbnail: video.thumbnail,\r\n                source: 'youtube',\r\n                youtubeId: video.videoId\r\n              });\r\n            }\r\n          }\r\n\r\n          if (validVideos.length > 0) {\r\n            logger.info('YouTube retry search successful', {\r\n              query: sanitizedQuery,\r\n              results: validVideos.length\r\n            });\r\n\r\n            // Cache the result\r\n            if (!this.searchCache) this.searchCache = new Map();\r\n            this.searchCache.set(cacheKey, { results: validVideos, timestamp: Date.now() });\r\n\r\n            return validVideos;\r\n          }\r\n        } catch (retryError) {\r\n          logger.error('YouTube retry search failed', retryError, { query: sanitizedQuery });\r\n        }\r\n      }\r\n\r\n      // If YouTube fails, try Spotify before Deezer\r\n      try {\r\n        await this.rateLimiter.consume('spotify_api');\r\n\r\n        // Check if we have a valid token\r\n        if (!this.spotifyApi.getAccessToken()) {\r\n          logger.debug('No Spotify token available, attempting to refresh');\r\n          await this.refreshSpotifyToken();\r\n          await new Promise(resolve => setTimeout(resolve, 1000)); // Wait a moment for token refresh\r\n        }\r\n\r\n        const data = await this.spotifyApi.searchTracks(sanitizedQuery, { limit });\r\n        if (data.body.tracks && data.body.tracks.items.length > 0) {\r\n          const tracks = data.body.tracks.items;\r\n          const results = tracks.map(track => ({\r\n            title: sanitizeInput(track.name),\r\n            artist: sanitizeInput(track.artists.map(a => a.name).join(', ')),\r\n            duration: track.duration_ms ? `${Math.floor(track.duration_ms / 60000)}:${Math.floor((track.duration_ms % 60000) / 1000).toString().padStart(2, '0')}` : 'Unknown',\r\n            url: track.external_urls.spotify,\r\n            thumbnail: track.album?.images?.[0]?.url || '',\r\n            source: 'spotify',\r\n            spotifyId: track.id,\r\n            preview: track.preview_url || null\r\n          }));\r\n\r\n          logger.info('Spotify fallback search successful', {\r\n            query: sanitizedQuery,\r\n            results: results.length\r\n          });\r\n\r\n          // Cache the result\r\n          if (!this.searchCache) this.searchCache = new Map();\r\n          this.searchCache.set(cacheKey, { results, timestamp: Date.now() });\r\n\r\n          return results;\r\n        }\r\n      } catch (error) {\r\n        if (error.message.includes('No token provided') || error.message.includes('invalid_client')) {\r\n          logger.debug('Spotify credentials not configured or invalid, skipping Spotify search');\r\n        } else {\r\n          logger.error('Spotify search failed', error, { query: sanitizedQuery });\r\n        }\r\n      }\r\n\r\n      // Final fallback to Deezer (legacy support)\r\n      try {\r\n        const response = await axios.get(`https://api.deezer.com/search?q=${encodeURIComponent(sanitizedQuery)}&limit=${limit}`);\r\n        if (response.data && response.data.data && response.data.data.length > 0) {\r\n          const tracks = response.data.data.slice(0, limit);\r\n          const results = tracks.map(track => ({\r\n            title: sanitizeInput(track.title),\r\n            artist: sanitizeInput(track.artist?.name || 'Unknown'),\r\n            duration: track.duration ? `${Math.floor(track.duration / 60)}:${(track.duration % 60).toString().padStart(2, '0')}` : 'Unknown',\r\n            url: track.link,\r\n            thumbnail: track.album?.cover_medium || '',\r\n            source: 'deezer',\r\n            preview: track.preview || null\r\n          }));\r\n\r\n          logger.info('Deezer legacy search successful', {\r\n            query: sanitizedQuery,\r\n            results: results.length\r\n          });\r\n\r\n          // Cache the result\r\n          if (!this.searchCache) this.searchCache = new Map();\r\n          this.searchCache.set(cacheKey, { results, timestamp: Date.now() });\r\n\r\n          return results;\r\n        }\r\n      } catch (error) {\r\n        logger.error('Deezer legacy search failed', error, { query: sanitizedQuery });\r\n      }\r\n\r\n      logger.warn('No search results found', { query: sanitizedQuery });\r\n      return [];\r\n    } catch (error) {\r\n      logger.error('Music search error', error, { query: typeof query === 'string' ? query : 'invalid' });\r\n      throw new CommandError('Failed to search for songs. Please try again.', 'API_ERROR');\r\n    }\r\n  }\r\n\r\n  // Enhanced URL validation before playback with caching and better error handling\r\n  async validateSongUrl(song) {\r\n    // Validate song object\r\n    if (!song || typeof song !== 'object') {\r\n      return { valid: false, error: 'Invalid song object', canFallback: false };\r\n    }\r\n\r\n    const title = song.title || 'Unknown';\r\n    const url = song.url;\r\n\r\n    if (!url || typeof url !== 'string') {\r\n      return { valid: false, error: 'Invalid song URL', canFallback: false };\r\n    }\r\n\r\n    // Check cache first\r\n    const cacheKey = `validate_${url}`;\r\n    const cached = this.validationCache?.get(cacheKey);\r\n    if (cached && (Date.now() - cached.timestamp) < 600000) { // 10 minute cache\r\n      return cached.result;\r\n    }\r\n\r\n    try {\r\n      if (song.source === 'spotify') {\r\n        // For Spotify, check if track exists and has preview\r\n        try {\r\n          await this.rateLimiter.consume('spotify_api');\r\n          const trackId = song.spotifyId || url.match(/spotify\\.com\\/track\\/([a-zA-Z0-9]{22})/)?.[1];\r\n          if (trackId) {\r\n            const data = await this.spotifyApi.getTrack(trackId);\r\n            if (data.body && data.body.name) {\r\n              const result = {\r\n                valid: true,\r\n                hasPreview: !!data.body.preview_url\r\n              };\r\n              // Cache the result\r\n              if (!this.validationCache) this.validationCache = new Map();\r\n              this.validationCache.set(cacheKey, { result, timestamp: Date.now() });\r\n              return result;\r\n            }\r\n          }\r\n          throw new Error('Track not found');\r\n        } catch (error) {\r\n          logger.error('Spotify URL validation failed', error, { title, url });\r\n          return {\r\n            valid: false,\r\n            error: error.message,\r\n            canFallback: true\r\n          };\r\n        }\r\n      } else if (song.source === 'deezer') {\r\n        // For Deezer, check if track exists (legacy support)\r\n        try {\r\n          const trackId = url.match(/deezer\\.com\\/track\\/(\\d+)/)?.[1];\r\n          if (trackId) {\r\n            const response = await axios.get(`https://api.deezer.com/track/${trackId}`, { timeout: 5000 });\r\n            if (response.data && response.data.title) {\r\n              const result = { valid: true };\r\n              // Cache the result\r\n              if (!this.validationCache) this.validationCache = new Map();\r\n              this.validationCache.set(cacheKey, { result, timestamp: Date.now() });\r\n              return result;\r\n            }\r\n          }\r\n          throw new Error('Track not found');\r\n        } catch (error) {\r\n          logger.error('Deezer URL validation failed', error, { title, url });\r\n          return {\r\n            valid: false,\r\n            error: error.message,\r\n            canFallback: true\r\n          };\r\n        }\r\n      } else if (ytdl.validateURL(url)) {\r\n        try {\r\n          await this.youtubeRateLimiter.consume('youtube_api');\r\n\r\n          // Add retry logic for YouTube validation with modern headers\r\n           let info;\r\n           for (let attempt = 1; attempt <= 3; attempt++) {\r\n             try {\r\n               const modernHeaders = {\r\n                 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',\r\n                 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\r\n                 'Accept-Language': 'en-US,en;q=0.9',\r\n                 'Accept-Encoding': 'gzip, deflate, br',\r\n                 'Cache-Control': 'max-age=0',\r\n                 'Sec-Fetch-Dest': 'document',\r\n                 'Sec-Fetch-Mode': 'navigate',\r\n                 'Sec-Fetch-Site': 'none',\r\n                 'Sec-Fetch-User': '?1',\r\n                 'Sec-Ch-Ua': '\"Google Chrome\";v=\"131\", \"Chromium\";v=\"131\", \"Not_A Brand\";v=\"24\"',\r\n                 'Sec-Ch-Ua-Mobile': '?0',\r\n                 'Sec-Ch-Ua-Platform': '\"Windows\"',\r\n                 'Upgrade-Insecure-Requests': '1'\r\n               };\r\n\r\n               logger.debug('YouTube validation getInfo attempt with modern headers', {\r\n                 attempt,\r\n                 title,\r\n                 url,\r\n                 userAgent: modernHeaders['User-Agent']\r\n               });\r\n\r\n               info = await ytdl.getInfo(url, {\r\n                 requestOptions: {\r\n                   headers: modernHeaders\r\n                 }\r\n               });\r\n               break; // Success, exit retry loop\r\n             } catch (retryError) {\r\n           logger.debug(`YouTube validation attempt ${attempt} failed`, {\r\n             title,\r\n             url,\r\n             error: retryError.message,\r\n             errorCode: retryError.code\r\n           });\r\n\r\n           // Check if it's the specific YouTube parsing error and handle gracefully\r\n           if (retryError.message && retryError.message.includes('Error when parsing watch.html')) {\r\n               logger.warn('YouTube parsing error detected - this may be due to YouTube API changes. Attempting fallback.');\r\n               // Continue to next attempt or throw if this was the last attempt\r\n               if (attempt === 3) {\r\n                   // Create a more user-friendly error\r\n                   const userError = new Error(`YouTube search temporarily unavailable due to API changes. Please try again later or use a direct URL.`);\r\n                   userError.code = 'YOUTUBE_API_ERROR';\r\n                   throw userError;\r\n               }\r\n           } else if (attempt === 3) throw retryError;\r\n               await new Promise(resolve => setTimeout(resolve, 2000 * attempt)); // Wait longer before retry\r\n             }\r\n           }\r\n\r\n          const video = info.videoDetails;\r\n\r\n          // Check if video is available with enhanced validation\r\n          if (video.isPrivate || !video.title ||\r\n              video.title.toLowerCase().includes('deleted') ||\r\n              video.title.toLowerCase().includes('private') ||\r\n              video.isUnlisted) {\r\n            throw new Error(`Video unavailable: ${video.title}`);\r\n          }\r\n\r\n          const result = { valid: true };\r\n          // Cache the result\r\n          if (!this.validationCache) this.validationCache = new Map();\r\n          this.validationCache.set(cacheKey, { result, timestamp: Date.now() });\r\n          return result;\r\n        } catch (error) {\r\n          logger.error('YouTube URL validation failed', error, { title, url });\r\n          return {\r\n            valid: false,\r\n            error: error.message,\r\n            canFallback: true\r\n          };\r\n        }\r\n      }\r\n\r\n      // Non-YouTube/Spotify/Deezer URLs are assumed valid (like radio streams)\r\n      const result = { valid: true };\r\n      // Cache the result\r\n      if (!this.validationCache) this.validationCache = new Map();\r\n      this.validationCache.set(cacheKey, { result, timestamp: Date.now() });\r\n      return result;\r\n\r\n    } catch (error) {\r\n      logger.error('Song URL validation error', error, { title, url, source: song.source });\r\n      return {\r\n        valid: false,\r\n        error: 'Validation service unavailable',\r\n        canFallback: false\r\n      };\r\n    }\r\n  }\r\n\r\n  // Enhanced playback with comprehensive error handling\r\n  async playWithErrorHandling(guildId, voiceChannel, song, player, connection) {\r\n    const startTime = Date.now();\r\n\r\n    logger.debug('Starting playWithErrorHandling', {\r\n      guildId,\r\n      songTitle: song.title,\r\n      songSource: song.source,\r\n      songUrl: song.url,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n\r\n    logger.debug('Checking encryption packages in playWithErrorHandling');\r\n    try {\r\n      const sodiumModule = await import('sodium');\r\n      logger.debug(`Sodium available: ${!!sodiumModule.default}`);\r\n    } catch (e) {\r\n      logger.debug(`Sodium error: ${e.message}`);\r\n    }\r\n    try {\r\n      const tweetnaclModule = await import('tweetnacl');\r\n      logger.debug(`TweetNaCl available: ${!!tweetnaclModule.default}`);\r\n    } catch (e) {\r\n      logger.debug(`TweetNaCl error: ${e.message}`);\r\n    }\r\n    try {\r\n      await sodiumReady;\r\n      logger.debug('libsodium-wrappers loaded');\r\n    } catch (e) {\r\n      logger.debug(`libsodium-wrappers error: ${e.message}`);\r\n    }\r\n\r\n    const currentVolume = this.getVolume(guildId) / 100;\r\n    logger.debug('Current volume for playback', { guildId, volume: currentVolume });\r\n\r\n    if (song.source === 'spotify') {\r\n      // For Spotify tracks, use preview URL if available\r\n      console.log(`[MUSIC] Creating Spotify stream for: ${song.title}`);\r\n      logger.debug('Creating Spotify stream', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        hasPreview: !!song.preview,\r\n        previewUrl: song.preview\r\n      });\r\n\r\n      try {\r\n        if (song.preview) {\r\n          // Use Spotify preview URL (30-second clip)\r\n          logger.debug('Spawning FFmpeg for Spotify preview', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            previewUrl: song.preview,\r\n            ffmpegPath: ffmpegPath\r\n          });\r\n          const ffmpegProcess = spawn(ffmpegPath, [\r\n            '-hide_banner',\r\n            '-loglevel', 'error',\r\n            '-reconnect', '1',\r\n            '-reconnect_streamed', '1',\r\n            '-reconnect_delay_max', '5',\r\n            '-i', song.preview,\r\n            '-analyzeduration', '0',\r\n            '-f', 's16le',\r\n            '-ar', '48000',\r\n            '-ac', '2',\r\n            'pipe:1'\r\n          ]);\r\n\r\n          ffmpegProcess.stderr.on('data', (data) => {\r\n            const errorMsg = data.toString();\r\n            console.error(`[MUSIC] FFmpeg Spotify stderr for \"${song.title}\": ${errorMsg}`);\r\n            logger.warn('FFmpeg Spotify stderr', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              error: errorMsg\r\n            });\r\n          });\r\n\r\n          ffmpegProcess.on('close', (code) => {\r\n            console.log(`[MUSIC] FFmpeg Spotify process exited with code ${code} for \"${song.title}\"`);\r\n            logger.info('FFmpeg Spotify process exited', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              exitCode: code\r\n            });\r\n          });\r\n\r\n          const resource = createAudioResource(ffmpegProcess.stdout, {\r\n            inputType: StreamType.Raw,\r\n            inlineVolume: true\r\n          });\r\n\r\n          resource.volume.setVolume(currentVolume);\r\n          logger.debug(`About to play resource for Spotify song: ${song.title}`);\r\n          player.play(resource);\r\n\r\n          return { success: true };\r\n        } else {\r\n          // No preview available, try to find YouTube version as fallback\r\n          console.log(`[MUSIC] No Spotify preview available for \"${song.title}\", attempting YouTube fallback`);\r\n          logger.info('No Spotify preview, attempting YouTube fallback', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            artist: song.artist\r\n          });\r\n          const fallbackQuery = `${song.title} ${song.artist}`;\r\n          const fallbackResults = await this.searchSongs(fallbackQuery, 1);\r\n\r\n          if (fallbackResults.length > 0 && fallbackResults[0].source === 'youtube') {\r\n            const youtubeSong = fallbackResults[0];\r\n            youtubeSong.isFallback = true;\r\n            logger.info('Using YouTube fallback for Spotify song', {\r\n              guildId,\r\n              originalSong: song.title,\r\n              fallbackSong: youtubeSong.title,\r\n              fallbackUrl: youtubeSong.url\r\n            });\r\n            return this.playWithErrorHandling(guildId, voiceChannel, youtubeSong, player, connection);\r\n          }\r\n\r\n          logger.error('No YouTube fallback available for Spotify song', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            fallbackResultsCount: fallbackResults.length\r\n          });\r\n          return {\r\n            success: false,\r\n            error: 'No preview available for this Spotify track',\r\n            errorType: 'no_preview'\r\n          };\r\n        }\r\n      } catch (streamError) {\r\n        console.error(`[MUSIC] Spotify stream error for \"${song.title}\":`, streamError.message);\r\n        logger.error('Spotify stream creation failed', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          error: streamError.message,\r\n          stack: streamError.stack\r\n        });\r\n        return {\r\n          success: false,\r\n          error: `Failed to play Spotify track: ${streamError.message}`,\r\n          errorType: 'spotify_stream'\r\n        };\r\n      }\r\n    } else if (song.source === 'deezer') {\r\n      // For Deezer tracks, try to use preview URL if available, fallback to test audio\r\n      let streamUrl;\r\n      if (song.preview) {\r\n        streamUrl = song.preview;\r\n        logger.debug(`Using Deezer preview URL: ${streamUrl}`, {\r\n          guildId,\r\n          songTitle: song.title\r\n        });\r\n      } else {\r\n        streamUrl = 'https://www.soundjay.com/misc/sounds/bell-ringing-05.wav';\r\n        logger.debug(`Stream URL for Deezer (TEST MODE - no preview): ${streamUrl}`, {\r\n          guildId,\r\n          songTitle: song.title\r\n        });\r\n        logger.warn('Using test audio URL for Deezer (no preview available)', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          streamUrl\r\n        });\r\n      }\r\n\r\n      console.log(`[MUSIC] Creating direct stream for Deezer: ${song.title}`);\r\n      try {\r\n        logger.debug('Spawning FFmpeg for Deezer test audio', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          streamUrl\r\n        });\r\n        const ffmpegArgs = [\r\n          '-hide_banner',\r\n          '-loglevel', 'error',\r\n          '-reconnect', '1',\r\n          '-reconnect_streamed', '1',\r\n          '-reconnect_delay_max', '5',\r\n          '-i', streamUrl,\r\n          '-analyzeduration', '0',\r\n          '-f', 's16le',\r\n          '-ar', '48000',\r\n          '-ac', '2',\r\n          'pipe:1'\r\n        ];\r\n\r\n        logger.debug('Spawning FFmpeg for Deezer with args', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          streamUrl,\r\n          ffmpegArgs\r\n        });\r\n\r\n        const ffmpegProcess = spawn(ffmpegPath, ffmpegArgs);\r\n\r\n        ffmpegProcess.stderr.on('data', (data) => {\r\n          const errorMsg = data.toString();\r\n          console.error(`[MUSIC] FFmpeg Deezer stderr for \"${song.title}\": ${errorMsg}`);\r\n          logger.warn('FFmpeg Deezer stderr', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            error: errorMsg,\r\n            ffmpegPath: ffmpegPath\r\n          });\r\n        });\r\n\r\n        ffmpegProcess.on('close', (code) => {\r\n          console.log(`[MUSIC] FFmpeg Deezer process exited with code ${code} for \"${song.title}\"`);\r\n          logger.info('FFmpeg Deezer process exited', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            exitCode: code\r\n          });\r\n        });\r\n\r\n        const resource = createAudioResource(ffmpegProcess.stdout, {\r\n          inputType: StreamType.Raw,\r\n          inlineVolume: true\r\n        });\r\n\r\n        resource.volume.setVolume(currentVolume);\r\n        logger.debug(`About to play resource for Deezer song: ${song.title}`);\r\n        player.play(resource);\r\n\r\n        return { success: true };\r\n\r\n      } catch (streamError) {\r\n        console.error(`[MUSIC] Deezer stream error for \"${song.title}\":`, streamError.message);\r\n        logger.error('Deezer stream creation failed', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          error: streamError.message,\r\n          stack: streamError.stack,\r\n          streamUrl,\r\n          ffmpegPath: ffmpegPath\r\n        });\r\n\r\n        // If preview URL failed, try fallback to test audio\r\n        if (song.preview && streamUrl === song.preview) {\r\n          logger.info('Deezer preview failed, trying fallback test audio', {\r\n            guildId,\r\n            songTitle: song.title\r\n          });\r\n          const fallbackSong = { ...song, preview: null };\r\n          return this.playWithErrorHandling(guildId, voiceChannel, fallbackSong, player, connection);\r\n        }\r\n\r\n        return {\r\n          success: false,\r\n          error: `Failed to play Deezer track: ${streamError.message}`,\r\n          errorType: 'deezer_stream'\r\n        };\r\n      }\r\n    } else if (ytdl.validateURL(song.url)) {\r\n      console.log(`[MUSIC] Creating ytdl stream for YouTube URL: ${song.title}`);\r\n      logger.debug(`Stream URL for YouTube: ${song.url}`);\r\n      logger.info('Starting YouTube stream creation', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        songUrl: song.url,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n\r\n      try {\r\n        logger.debug('Creating ytdl stream', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          ffmpegPath: ffmpegPath,\r\n          ffmpegExists: existsSync(ffmpegPath),\r\n          options: {\r\n            filter: 'audioonly',\r\n            highWaterMark: 1 << 62,\r\n            dlChunkSize: 0,\r\n            bitrate: 128,\r\n            quality: 'lowestaudio'\r\n          },\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        // Check for FFmpeg availability before attempting stream\r\n        if (!existsSync(ffmpegPath)) {\r\n          logger.error('FFmpeg binary not found', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            ffmpegPath: ffmpegPath,\r\n            resolvedPath: path.resolve(ffmpegPath),\r\n            timestamp: new Date().toISOString()\r\n          });\r\n          return {\r\n            success: false,\r\n            error: `FFmpeg binary not found at ${ffmpegPath}`,\r\n            errorType: 'ffmpeg_missing'\r\n          };\r\n        }\r\n\r\n        const ytdlStream = ytdl(song.url, {\r\n           filter: 'audioonly',\r\n           highWaterMark: 1 << 62,\r\n           dlChunkSize: 0,\r\n           bitrate: 128,\r\n           quality: 'lowestaudio',\r\n           requestOptions: {\r\n             headers: {\r\n               'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36',\r\n               'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\r\n               'Accept-Language': 'en-US,en;q=0.9',\r\n               'Accept-Encoding': 'gzip, deflate, br',\r\n               'Cache-Control': 'max-age=0',\r\n               'Connection': 'keep-alive',\r\n               'Sec-Fetch-Dest': 'document',\r\n               'Sec-Fetch-Mode': 'navigate',\r\n               'Sec-Fetch-Site': 'none',\r\n               'Sec-Fetch-User': '?1',\r\n               'Sec-Ch-Ua': '\"Google Chrome\";v=\"131\", \"Chromium\";v=\"131\", \"Not_A Brand\";v=\"24\"',\r\n               'Sec-Ch-Ua-Mobile': '?0',\r\n               'Sec-Ch-Ua-Platform': '\"Windows\"',\r\n               'Upgrade-Insecure-Requests': '1'\r\n             }\r\n           }\r\n         });\r\n\r\n        // Set up comprehensive error handling for ytdl stream\r\n        let streamError = null;\r\n        let streamStartTime = Date.now();\r\n\r\n        ytdlStream.on('error', (error) => {\r\n          const errorDuration = Date.now() - streamStartTime;\r\n          console.error(`[MUSIC] YTDL stream error for \"${song.title}\" after ${errorDuration}ms:`, error);\r\n          logger.error('YTDL stream error', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            error: error.message,\r\n            stack: error.stack,\r\n            errorDuration,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n          streamError = error;\r\n        });\r\n\r\n        ytdlStream.on('info', (info) => {\r\n          logger.debug('YTDL stream info received', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            videoId: info.videoDetails.videoId,\r\n            duration: info.videoDetails.lengthSeconds\r\n          });\r\n        });\r\n\r\n        // Transcode to Opus using ffmpeg\r\n         logger.debug('Spawning FFmpeg for YouTube audio transcoding', {\r\n           guildId,\r\n           songTitle: song.title,\r\n           ffmpegPath: ffmpegPath,\r\n           ffmpegExists: existsSync(ffmpegPath),\r\n           ffmpegArgs: [\r\n             '-hide_banner',\r\n             '-loglevel', 'error',\r\n             '-analyzeduration', '0',\r\n             '-i', 'pipe:0',\r\n             '-f', 's16le',\r\n             '-ar', '48000',\r\n             '-ac', '2',\r\n             'pipe:1'\r\n           ]\r\n         });\r\n         const ffmpegProcess = spawn(ffmpegPath, [\r\n           '-hide_banner',\r\n           '-loglevel', 'error',\r\n           '-analyzeduration', '0',\r\n           '-i', 'pipe:0',\r\n           '-f', 's16le',\r\n           '-ar', '48000',\r\n           '-ac', '2',\r\n           'pipe:1'\r\n         ]);\r\n\r\n        // Handle ffmpeg process errors\r\n        ffmpegProcess.stderr.on('data', (data) => {\r\n          const errorMsg = data.toString();\r\n          console.error(`[MUSIC] FFmpeg stderr for \"${song.title}\": ${errorMsg}`);\r\n\r\n          // Check for specific error patterns\r\n          if (errorMsg.includes('410') || errorMsg.includes('404') || errorMsg.includes('Video unavailable')) {\r\n            console.error(`[MUSIC] Video became unavailable during playback: ${song.title}`);\r\n            logger.error('Video became unavailable during playback', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              errorMsg\r\n            });\r\n          } else if (errorMsg.includes('No such file or directory')) {\r\n            logger.error('FFmpeg binary not found', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              ffmpegPath: ffmpeg,\r\n              errorMsg\r\n            });\r\n          } else if (errorMsg.includes('Permission denied')) {\r\n            logger.error('FFmpeg permission denied', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              ffmpegPath: ffmpeg,\r\n              errorMsg\r\n            });\r\n          } else {\r\n            logger.warn('FFmpeg stderr output', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              errorMsg\r\n            });\r\n          }\r\n        });\r\n\r\n        ffmpegProcess.on('error', (error) => {\r\n          console.error(`[MUSIC] FFmpeg process error for \"${song.title}\":`, error);\r\n          logger.error('FFmpeg process error', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            error: error.message,\r\n            stack: error.stack,\r\n            ffmpegPath: ffmpegPath,\r\n            ffmpegExists: existsSync(ffmpegPath),\r\n            errorCode: error.code\r\n          });\r\n          streamError = error;\r\n        });\r\n\r\n        ffmpegProcess.on('close', (code) => {\r\n          console.log(`[MUSIC] FFmpeg process exited with code ${code} for \"${song.title}\"`);\r\n          logger.info('FFmpeg process exited', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            exitCode: code,\r\n            hadError: !!streamError\r\n          });\r\n          if (code !== 0 && streamError) {\r\n            console.error(`[MUSIC] FFmpeg failed for \"${song.title}\":`, streamError.message);\r\n          }\r\n        });\r\n\r\n        // Pipe ytdl stream to ffmpeg\r\n        logger.debug('Piping ytdl stream to ffmpeg', {\r\n          guildId,\r\n          songTitle: song.title\r\n        });\r\n        ytdlStream.pipe(ffmpegProcess.stdin);\r\n\r\n        // Handle ytdl stream events\r\n        ytdlStream.on('error', (err) => {\r\n          console.error(`[MUSIC] YTDL stream error during piping for \"${song.title}\":`, err);\r\n          logger.error('YTDL stream error during piping', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            error: err.message\r\n          });\r\n        });\r\n\r\n        ffmpegProcess.stdin.on('error', (err) => {\r\n          console.error(`[MUSIC] FFmpeg stdin error for \"${song.title}\":`, err);\r\n          logger.error('FFmpeg stdin pipe error', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            error: err.message,\r\n            ffmpegPath: ffmpegPath\r\n          });\r\n        });\r\n\r\n        // Handle successful piping\r\n        ffmpegProcess.stdin.on('finish', () => {\r\n          logger.debug('Successfully piped ytdl stream to ffmpeg', {\r\n            guildId,\r\n            songTitle: song.title\r\n          });\r\n        });\r\n\r\n        // Monitor stream flow\r\n        let bytesReceived = 0;\r\n        ytdlStream.on('data', (chunk) => {\r\n          bytesReceived += chunk.length;\r\n          if (bytesReceived % (1024 * 1024) === 0) { // Log every 1MB\r\n            logger.debug('YTDL stream progress', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              bytesReceived: `${(bytesReceived / (1024 * 1024)).toFixed(2)}MB`\r\n            });\r\n          }\r\n        });\r\n\r\n        const resource = createAudioResource(ffmpegProcess.stdout, {\r\n          inputType: StreamType.Raw,\r\n          inlineVolume: true\r\n        });\r\n\r\n        resource.volume.setVolume(currentVolume);\r\n        logger.debug(`About to play resource for YouTube song: ${song.title}`, {\r\n          guildId,\r\n          songTitle: song.title,\r\n          volume: currentVolume,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n        logger.info('Starting YouTube audio playback', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          volume: currentVolume,\r\n          ffmpegPath: ffmpegPath,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        // Add timeout for playback start\r\n        const playbackTimeout = setTimeout(() => {\r\n          logger.warn('YouTube playback start timeout', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            timeout: 30000,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n        }, 30000);\r\n\r\n        player.once(AudioPlayerStatus.Playing, () => {\r\n          clearTimeout(playbackTimeout);\r\n          const playbackStartTime = Date.now() - startTime;\r\n          logger.info('YouTube playback successfully started', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            startupTime: playbackStartTime,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n        });\r\n\r\n        // Add error handler for playback timeout\r\n        const timeoutId = setTimeout(() => {\r\n          logger.error('YouTube playback timeout exceeded', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            timeoutDuration: 30000,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n          // Stop the player to prevent hanging\r\n          player.stop(true);\r\n        }, 30000);\r\n\r\n        player.once(AudioPlayerStatus.Playing, () => {\r\n          clearTimeout(timeoutId);\r\n        });\r\n\r\n        player.play(resource);\r\n\r\n        return { success: true };\r\n\r\n      } catch (streamError) {\r\n        const errorDuration = Date.now() - startTime;\r\n        console.error(`[MUSIC] Stream creation error for \"${song.title}\" after ${errorDuration}ms:`, streamError.message);\r\n        logger.error('YouTube stream creation failed', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          error: streamError.message,\r\n          stack: streamError.stack,\r\n          ffmpegPath: ffmpegPath,\r\n          ffmpegAccessible: existsSync(ffmpegPath),\r\n          errorDuration,\r\n          timestamp: new Date().toISOString()\r\n        });\r\n\r\n        // Check if it's an FFmpeg issue\r\n        if (streamError.message.includes('spawn') || streamError.message.includes('ENOENT')) {\r\n          logger.error('FFmpeg spawn/access issue detected', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            ffmpegPath: ffmpegPath,\r\n            resolvedPath: path.resolve(ffmpegPath),\r\n            ffmpegExists: existsSync(ffmpegPath),\r\n            errorCode: streamError.code,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n        }\r\n\r\n        return {\r\n          success: false,\r\n          error: `Failed to create audio stream: ${streamError.message}`,\r\n          errorType: 'stream_creation'\r\n        };\r\n      }\r\n    } else {\r\n      // For direct stream URLs (like radio)\r\n      console.log(`[MUSIC] Creating direct stream for URL: ${song.title}`);\r\n      logger.debug(`Stream URL for direct: ${song.url}`);\r\n      logger.info('Starting direct stream creation', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        songUrl: song.url\r\n      });\r\n\r\n      try {\r\n        // Use alternative FFmpeg arguments if this is a retry attempt\r\n        const useAlternativeArgs = song.retryAttempted;\r\n        const ffmpegArgs = useAlternativeArgs ? [\r\n          '-hide_banner',\r\n          '-loglevel', 'error',\r\n          '-reconnect', '1',\r\n          '-reconnect_streamed', '1',\r\n          '-reconnect_delay_max', '5',\r\n          '-i', song.url,\r\n          '-c:a', 'libmp3lame',\r\n          '-f', 'mp3',\r\n          'pipe:1'\r\n        ] : [\r\n          '-hide_banner',\r\n          '-loglevel', 'error',\r\n          '-reconnect', '1',\r\n          '-reconnect_streamed', '1',\r\n          '-reconnect_delay_max', '5',\r\n          '-i', song.url,\r\n          '-analyzeduration', '0',\r\n          '-f', 's16le',\r\n          '-ar', '48000',\r\n          '-ac', '2',\r\n          'pipe:1'\r\n        ];\r\n\r\n        logger.debug('Spawning FFmpeg for direct stream', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          streamUrl: song.url,\r\n          useAlternativeArgs,\r\n          ffmpegArgs\r\n        });\r\n\r\n        const ffmpegProcess = spawn(ffmpegPath, ffmpegArgs);\r\n\r\n        ffmpegProcess.stderr.on('data', (data) => {\r\n          const errorMsg = data.toString();\r\n          console.error(`[MUSIC] FFmpeg direct stderr for \"${song.title}\": ${errorMsg}`);\r\n\r\n          // Check for specific error patterns\r\n          if (errorMsg.includes('410') || errorMsg.includes('404') || errorMsg.includes('unavailable')) {\r\n            console.error(`[MUSIC] Direct stream became unavailable: ${song.title}`);\r\n            logger.error('Direct stream became unavailable', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              errorMsg,\r\n              ffmpegPath: ffmpegPath\r\n            });\r\n          } else {\r\n            logger.warn('FFmpeg direct stderr', {\r\n              guildId,\r\n              songTitle: song.title,\r\n              errorMsg,\r\n              ffmpegPath: ffmpegPath\r\n            });\r\n          }\r\n        });\r\n\r\n        ffmpegProcess.on('close', (code) => {\r\n          console.log(`[MUSIC] FFmpeg direct process exited with code ${code} for \"${song.title}\"`);\r\n          logger.info('FFmpeg direct process exited', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            exitCode: code\r\n          });\r\n        });\r\n\r\n        const resource = createAudioResource(ffmpegProcess.stdout, {\r\n          inputType: StreamType.Raw,\r\n          inlineVolume: true\r\n        });\r\n\r\n        resource.volume.setVolume(currentVolume);\r\n        logger.debug(`About to play resource for direct song: ${song.title}`);\r\n        logger.info('Starting direct stream playback', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          volume: currentVolume\r\n        });\r\n        player.play(resource);\r\n\r\n        return { success: true };\r\n\r\n      } catch (streamError) {\r\n        console.error(`[MUSIC] Direct stream error for \"${song.title}\":`, streamError.message);\r\n        logger.error('Direct stream creation failed', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          error: streamError.message,\r\n          stack: streamError.stack,\r\n          streamUrl: song.url,\r\n          ffmpegPath: ffmpegPath\r\n        });\r\n\r\n        // For direct streams, try alternative FFmpeg arguments if the first attempt fails\r\n        if (!song.retryAttempted) {\r\n          logger.info('Attempting direct stream with alternative FFmpeg arguments', {\r\n            guildId,\r\n            songTitle: song.title\r\n          });\r\n          const retrySong = { ...song, retryAttempted: true };\r\n          return this.playWithErrorHandling(guildId, voiceChannel, retrySong, player, connection);\r\n        }\r\n\r\n        return {\r\n          success: false,\r\n          error: `Failed to play stream: ${streamError.message}`,\r\n          errorType: 'direct_stream'\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  // Real Music Playback with Voice Integration\r\n  async play(guildId, voiceChannel, song) {\r\n    console.log(`[MUSIC] Starting play for guild ${guildId}, song: ${song.title}`);\r\n    logger.debug('Play initiated', {\r\n      guildId,\r\n      songTitle: song.title,\r\n      songSource: song.source,\r\n      songUrl: song.url,\r\n      voiceChannelId: voiceChannel?.id,\r\n      voiceChannelName: voiceChannel?.name\r\n    });\r\n    try {\r\n      // Check if already connected to a voice channel\r\n      const existingConnection = getVoiceConnection(guildId);\r\n      let connection = existingConnection;\r\n      console.log(`[MUSIC] Existing connection: ${connection ? connection.state.status : 'none'}`);\r\n      logger.debug('Voice connection status', {\r\n        guildId,\r\n        existingConnection: !!existingConnection,\r\n        connectionState: existingConnection?.state?.status || 'none'\r\n      });\r\n\r\n      if (!connection || connection.state.status === 'disconnected' || connection.state.status === 'destroyed') {\r\n        console.log(`[MUSIC] Joining voice channel: ${voiceChannel.name}`);\r\n        // Join voice channel\r\n        connection = joinVoiceChannel({\r\n          channelId: voiceChannel.id,\r\n          guildId: guildId,\r\n          adapterCreator: voiceChannel.guild.voiceAdapterCreator,\r\n          selfDeaf: true,\r\n          selfMute: false,\r\n        });\r\n        try {\r\n          await entersState(connection, VoiceConnectionStatus.Ready, 5000);\r\n        } catch (_) {}\r\n        console.log(`[MUSIC] Joined voice channel, connection status: ${connection.state.status}`);\r\n      } else if (connection.state.status === 'connecting') {\r\n        // Wait a moment for connection to stabilize\r\n        await new Promise(resolve => setTimeout(resolve, 2000));\r\n        const updatedConnection = getVoiceConnection(guildId);\r\n        if (updatedConnection && updatedConnection.state.status === 'ready') {\r\n          connection = updatedConnection;\r\n        }\r\n      }\r\n\r\n      // Ensure connection stability\r\n      if (!this.ensureConnectionStability(guildId)) {\r\n        console.log(`[MUSIC] Connection unstable, attempting reconnection`);\r\n        logger.warn('Connection instability detected, attempting reconnection', {\r\n          guildId,\r\n          voiceChannelId: voiceChannel.id,\r\n          voiceChannelName: voiceChannel.name\r\n        });\r\n        connection = await this.reconnectToVoice(guildId, voiceChannel);\r\n        if (!connection) {\r\n          logger.error('Failed to establish stable voice connection', {\r\n            guildId,\r\n            voiceChannelId: voiceChannel.id,\r\n            voiceChannelName: voiceChannel.name\r\n          });\r\n          return {\r\n            success: false,\r\n            error: 'Failed to establish stable voice connection',\r\n            errorType: 'connection_failed'\r\n          };\r\n        }\r\n      }\r\n\r\n      // Create audio player if not exists\r\n      let player = this.audioPlayers.get(guildId);\r\n      if (!player) {\r\n        logger.debug('Creating new audio player', { guildId });\r\n        player = createAudioPlayer({ behaviors: { noSubscriber: NoSubscriberBehavior.Play } });\r\n        this.audioPlayers.set(guildId, player);\r\n\r\n        connection.on('stateChange', (oldState, newState) => {\r\n          console.log(`[MUSIC] Connection state change: ${oldState.status} -> ${newState.status}`);\r\n          logger.info('Voice connection state change', {\r\n            guildId,\r\n            oldState: oldState.status,\r\n            newState: newState.status\r\n          });\r\n        });\r\n\r\n        player.on(AudioPlayerStatus.Idle, () => {\r\n          console.log(`[MUSIC] Player idle for guild ${guildId}, playing next song`);\r\n          logger.debug('Audio player idle, playing next song', { guildId });\r\n          this.playNext(guildId);\r\n        });\r\n\r\n        player.on(AudioPlayerStatus.Playing, () => {\r\n          console.log(`[MUSIC] Audio player is playing for guild ${guildId}`);\r\n          logger.debug('Audio player started playing', { guildId });\r\n        });\r\n\r\n        player.on(AudioPlayerStatus.Buffering, () => {\r\n          logger.debug('Audio player buffering', { guildId });\r\n        });\r\n\r\n        player.on(AudioPlayerStatus.AutoPaused, () => {\r\n          logger.warn('Audio player auto-paused', { guildId });\r\n        });\r\n\r\n        player.on('error', error => {\r\n          console.error(`[MUSIC] Audio player error for guild ${guildId}:`, error);\r\n          logger.error('Audio player error', {\r\n            guildId,\r\n            error: error.message,\r\n            resource: error.resource?.playbackDuration,\r\n            stack: error.stack\r\n          });\r\n          this.handlePlaybackError(guildId, error);\r\n        });\r\n\r\n        // Subscribe to connection\r\n        logger.debug('Subscribing audio player to voice connection', { guildId });\r\n        connection.subscribe(player);\r\n      }\r\n\r\n      // Ensure subscription before each playback attempt (handles reconnections)\r\n      try {\r\n        connection.subscribe(player);\r\n        logger.debug('Ensured audio player subscription', { guildId });\r\n      } catch (subscriptionError) {\r\n        logger.error('Failed to subscribe audio player to connection', {\r\n          guildId,\r\n          error: subscriptionError.message\r\n        });\r\n      }\r\n\r\n      // Store voice channel info\r\n      this.voiceChannels.set(guildId, {\r\n        id: voiceChannel.id,\r\n        name: voiceChannel.name,\r\n        joinedAt: Date.now()\r\n      });\r\n\r\n      // Validate song URL before attempting playback\r\n      logger.debug('Validating song URL before playback', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        songUrl: song.url,\r\n        songSource: song.source\r\n      });\r\n      const validation = await this.validateSongUrl(song);\r\n      if (!validation.valid) {\r\n        console.error(`[MUSIC] Song validation failed for \"${song.title}\": ${validation.error}`);\r\n        logger.error('Song validation failed', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          songUrl: song.url,\r\n          songSource: song.source,\r\n          validationError: validation.error,\r\n          canFallback: validation.canFallback\r\n        });\r\n\r\n        if (validation.canFallback) {\r\n          // Try fallback search\r\n          try {\r\n            const fallbackQuery = song.title + ' ' + song.artist;\r\n            logger.debug('Attempting fallback search', {\r\n              guildId,\r\n              originalSong: song.title,\r\n              fallbackQuery\r\n            });\r\n            const fallbackResults = await this.searchSongs(fallbackQuery, 1);\r\n            if (fallbackResults.length > 0 && !fallbackResults[0].isFallback) {\r\n              console.log(`[MUSIC] Using fallback song: ${fallbackResults[0].title}`);\r\n              logger.info('Using fallback song', {\r\n                guildId,\r\n                originalSong: song.title,\r\n                fallbackSong: fallbackResults[0].title,\r\n                fallbackUrl: fallbackResults[0].url\r\n              });\r\n              song = fallbackResults[0];\r\n            } else {\r\n              logger.error('No suitable fallback found', {\r\n                guildId,\r\n                fallbackResultsCount: fallbackResults.length\r\n              });\r\n              return {\r\n                success: false,\r\n                error: `Video unavailable and no suitable fallback found. Original error: ${validation.error}`,\r\n                errorType: 'validation_failed'\r\n              };\r\n            }\r\n          } catch (fallbackError) {\r\n            console.error('[MUSIC] Fallback search failed:', fallbackError.message);\r\n            logger.error('Fallback search failed', {\r\n              guildId,\r\n              fallbackError: fallbackError.message,\r\n              originalValidationError: validation.error\r\n            });\r\n            return {\r\n              success: false,\r\n              error: `Video unavailable: ${validation.error}`,\r\n              errorType: 'validation_failed'\r\n            };\r\n          }\r\n        } else {\r\n          logger.error('Song validation failed with no fallback possible', {\r\n            guildId,\r\n            songTitle: song.title,\r\n            validationError: validation.error\r\n          });\r\n          return {\r\n            success: false,\r\n            error: `Video unavailable: ${validation.error}`,\r\n            errorType: 'validation_failed'\r\n          };\r\n        }\r\n      } else {\r\n        logger.debug('Song validation successful', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          hasPreview: validation.hasPreview\r\n        });\r\n      }\r\n\r\n      // Set currently playing\r\n      logger.debug('Setting currently playing song', { guildId, songTitle: song.title, duration: song.duration });\r\n      this.currentlyPlaying.set(guildId, {\r\n        ...song,\r\n        startedAt: Date.now(),\r\n        status: 'playing',\r\n        totalPaused: 0,\r\n        pausedAt: null\r\n      });\r\n\r\n      // Mark as playing\r\n      this.isPlaying.set(guildId, true);\r\n\r\n      // Update last activity timestamp\r\n      const settings = this.musicSettings.get(guildId) || {};\r\n      settings.lastActivity = Date.now();\r\n      this.musicSettings.set(guildId, settings);\r\n\r\n      // Attempt playback with enhanced error handling\r\n      logger.debug('Attempting playback with error handling', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        songUrl: song.url,\r\n        songSource: song.source\r\n      });\r\n      const playResult = await this.playWithErrorHandling(guildId, voiceChannel, song, player, connection);\r\n\r\n      if (playResult.success) {\r\n        console.log(`[MUSIC] Play successful for guild ${guildId}, song: ${song.title}`);\r\n        logger.info('Playback successful', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          songSource: song.source,\r\n          audioPlayerStatus: player.state.status,\r\n          voiceConnectionState: connection.state.status\r\n        });\r\n        return { success: true, song };\r\n      } else {\r\n        // Handle playback failure\r\n        logger.error('Playback failed in playWithErrorHandling', {\r\n          guildId,\r\n          songTitle: song.title,\r\n          error: playResult.error,\r\n          errorType: playResult.errorType\r\n        });\r\n        return this.handlePlaybackError(guildId, new Error(playResult.error), playResult.errorType);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(`[MUSIC] Play music error for guild ${guildId}:`, error);\r\n      logger.error('Unexpected error in play method', {\r\n        guildId,\r\n        songTitle: song.title,\r\n        error: error.message,\r\n        stack: error.stack,\r\n        voiceConnectionState: getVoiceConnection(guildId)?.state?.status || 'unknown'\r\n      });\r\n      return this.handlePlaybackError(guildId, error);\r\n    }\r\n  }\r\n\r\n  // Enhanced error handling and recovery\r\n  handlePlaybackError(guildId, error, errorType = 'unknown') {\r\n    console.error(`[MUSIC] Handling playback error for guild ${guildId}:`, error.message);\r\n    logger.error('Handling playback error', {\r\n      guildId,\r\n      error: error.message,\r\n      errorType,\r\n      stack: error.stack,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n\r\n    // Log detailed error information\r\n    const errorDetails = {\r\n      guildId,\r\n      error: error.message,\r\n      errorType,\r\n      timestamp: new Date().toISOString(),\r\n      connectionStatus: getVoiceConnection(guildId)?.state?.status || 'no_connection',\r\n      queueLength: this.getQueue(guildId).length,\r\n      currentlyPlaying: this.currentlyPlaying.get(guildId)?.title || 'none',\r\n      audioPlayerStatus: this.audioPlayers.get(guildId)?.state?.status || 'no_player'\r\n    };\r\n\r\n    console.error(`[MUSIC] Error details:`, JSON.stringify(errorDetails, null, 2));\r\n    logger.error('Detailed playback error information', errorDetails);\r\n\r\n    // Attempt to recover from FFmpeg issues\r\n    if (error.message.includes('spawn') || error.message.includes('ENOENT') || errorType === 'stream_creation') {\r\n      logger.warn('FFmpeg-related error detected, attempting recovery', {\r\n        guildId,\r\n        errorType,\r\n        ffmpegPath: ffmpegPath\r\n      });\r\n\r\n      // Try to restart the player and connection\r\n      const player = this.audioPlayers.get(guildId);\r\n      const connection = getVoiceConnection(guildId);\r\n\r\n      if (player && connection) {\r\n        try {\r\n          // Reset player state\r\n          player.stop(true);\r\n          // Re-subscribe connection\r\n          connection.subscribe(player);\r\n          logger.info('Player and connection reset for recovery', { guildId });\r\n        } catch (resetError) {\r\n          logger.error('Failed to reset player/connection', {\r\n            guildId,\r\n            resetError: resetError.message\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check if we should skip to next song\r\n    const queue = this.getQueue(guildId);\r\n    if (queue.length > 0) {\r\n      console.log(`[MUSIC] Skipping to next song in queue due to error`);\r\n      logger.info('Skipping to next song due to playback error', {\r\n        guildId,\r\n        errorType,\r\n        queueLength: queue.length\r\n      });\r\n      // The player's error event handler will trigger playNext automatically\r\n      return {\r\n        success: false,\r\n        error: `Playback failed: ${error.message}. Skipping to next song.`,\r\n        errorType: 'skipped_to_next'\r\n      };\r\n    } else {\r\n      console.log(`[MUSIC] No songs in queue, stopping playback`);\r\n      logger.info('Stopping playback due to error with no queue', {\r\n        guildId,\r\n        errorType\r\n      });\r\n      this.stop(guildId);\r\n      return {\r\n        success: false,\r\n        error: `Playback failed: ${error.message}. No more songs in queue.`,\r\n        errorType: 'stopped'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Voice connection stability management\r\n  ensureConnectionStability(guildId) {\r\n    const connection = getVoiceConnection(guildId);\r\n    if (!connection) {\r\n      console.log(`[MUSIC] No voice connection found for guild ${guildId}`);\r\n      logger.warn('No voice connection found', { guildId });\r\n      return false;\r\n    }\r\n\r\n    const connectionState = connection.state.status;\r\n    console.log(`[MUSIC] Connection status for guild ${guildId}: ${connectionState}`);\r\n    logger.debug('Voice connection stability check', {\r\n      guildId,\r\n      connectionState,\r\n      connectionDestroyed: connection.state.status === 'destroyed',\r\n      connectionDisconnected: connection.state.status === 'disconnected'\r\n    });\r\n\r\n    // Check if connection is in a problematic state\r\n    if (connectionState === 'disconnected' || connectionState === 'destroyed') {\r\n      console.log(`[MUSIC] Connection is ${connectionState}, attempting recovery`);\r\n      logger.warn('Voice connection in problematic state', {\r\n        guildId,\r\n        connectionState,\r\n        needsRecovery: true\r\n      });\r\n      return false;\r\n    }\r\n\r\n    // Check if connection is ready\r\n    if (connectionState === 'ready') {\r\n      console.log(`[MUSIC] Connection is stable for guild ${guildId}`);\r\n      logger.debug('Voice connection is stable', { guildId });\r\n      return true;\r\n    }\r\n\r\n    // For connecting state, wait a bit and check again\r\n    if (connectionState === 'connecting') {\r\n      console.log(`[MUSIC] Connection is still connecting for guild ${guildId}`);\r\n      logger.debug('Voice connection still connecting', { guildId });\r\n      return true; // Assume it's okay for now\r\n    }\r\n\r\n    console.log(`[MUSIC] Unknown connection state for guild ${guildId}: ${connectionState}`);\r\n    logger.warn('Unknown voice connection state', {\r\n      guildId,\r\n      connectionState\r\n    });\r\n    return false;\r\n  }\r\n\r\n  // Reconnect to voice channel if needed\r\n  async reconnectToVoice(guildId, voiceChannel) {\r\n    console.log(`[MUSIC] Attempting to reconnect to voice channel for guild ${guildId}`);\r\n    logger.info('Attempting voice channel reconnection', {\r\n      guildId,\r\n      voiceChannelId: voiceChannel.id,\r\n      voiceChannelName: voiceChannel.name\r\n    });\r\n\r\n    try {\r\n      const connection = getVoiceConnection(guildId);\r\n      if (connection) {\r\n        logger.debug('Destroying existing connection before reconnect', { guildId });\r\n        connection.destroy();\r\n      }\r\n\r\n      // Wait a moment before reconnecting\r\n      logger.debug('Waiting before reconnection attempt', { guildId, delay: 1000 });\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      logger.debug('Joining voice channel for reconnection', {\r\n        guildId,\r\n        channelId: voiceChannel.id,\r\n        adapterCreator: !!voiceChannel.adapterCreator || !!voiceChannel.guild?.voiceAdapterCreator\r\n      });\r\n      const newConnection = joinVoiceChannel({\r\n        channelId: voiceChannel.id,\r\n        guildId: guildId,\r\n        adapterCreator: voiceChannel.adapterCreator || voiceChannel.guild?.voiceAdapterCreator,\r\n        selfDeaf: true,\r\n        selfMute: false,\r\n      });\r\n\r\n      try {\r\n        logger.debug('Waiting for connection to reach ready state', {\r\n          guildId,\r\n          timeout: 5000\r\n        });\r\n        await entersState(newConnection, VoiceConnectionStatus.Ready, 5000);\r\n        console.log(`[MUSIC] Successfully reconnected to voice channel: ${voiceChannel.name}`);\r\n        logger.info('Voice channel reconnection successful', {\r\n          guildId,\r\n          voiceChannelName: voiceChannel.name\r\n        });\r\n        return newConnection;\r\n      } catch (stateError) {\r\n        console.error(`[MUSIC] Failed to reach ready state after reconnection:`, stateError.message);\r\n        logger.error('Failed to reach ready state after reconnection', {\r\n          guildId,\r\n          voiceChannelName: voiceChannel.name,\r\n          error: stateError.message\r\n        });\r\n        newConnection.destroy();\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      console.error(`[MUSIC] Failed to reconnect to voice channel:`, error);\r\n      logger.error('Voice channel reconnection failed', {\r\n        guildId,\r\n        voiceChannelId: voiceChannel.id,\r\n        error: error.message,\r\n        stack: error.stack\r\n      });\r\n\r\n      // Try alternative reconnection method\r\n      try {\r\n        logger.info('Attempting alternative reconnection method', { guildId });\r\n        const altConnection = joinVoiceChannel({\r\n          channelId: voiceChannel.id,\r\n          guildId: guildId,\r\n          adapterCreator: voiceChannel.adapterCreator || voiceChannel.guild?.voiceAdapterCreator,\r\n          selfDeaf: false, // Try without selfDeaf first\r\n          selfMute: false,\r\n        });\r\n\r\n        await entersState(altConnection, VoiceConnectionStatus.Ready, 3000); // Shorter timeout\r\n        logger.info('Alternative reconnection successful', { guildId });\r\n        return altConnection;\r\n      } catch (altError) {\r\n        logger.error('Alternative reconnection also failed', {\r\n          guildId,\r\n          error: altError.message\r\n        });\r\n      }\r\n\r\n      return null;\r\n    }\r\n  }\r\n\r\n\r\n  // Simplified Music Controls\r\n  pause(guildId) {\r\n    logger.debug('Attempting to pause music', { guildId });\r\n    const isPlaying = this.isPlaying.get(guildId);\r\n    if (!isPlaying) {\r\n      logger.debug('Cannot pause - nothing is playing', { guildId });\r\n      return false;\r\n    }\r\n\r\n    const current = this.currentlyPlaying.get(guildId);\r\n    if (current) {\r\n      current.status = 'paused';\r\n      current.pausedAt = Date.now();\r\n      logger.info('Song paused', {\r\n        guildId,\r\n        songTitle: current.title,\r\n        pausedAt: current.pausedAt\r\n      });\r\n    }\r\n\r\n    this.isPlaying.set(guildId, false);\r\n\r\n    // Pause the audio player\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player) {\r\n      try {\r\n        player.pause();\r\n        logger.debug('Audio player paused successfully', { guildId });\r\n      } catch (error) {\r\n        logger.error('Failed to pause audio player', {\r\n          guildId,\r\n          error: error.message\r\n        });\r\n        return false;\r\n      }\r\n    } else {\r\n      logger.warn('No audio player found to pause', { guildId });\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  resume(guildId) {\r\n    logger.debug('Attempting to resume music', { guildId });\r\n    const current = this.currentlyPlaying.get(guildId);\r\n    if (!current || current.status !== 'paused') {\r\n      logger.debug('Cannot resume - nothing is paused', { guildId });\r\n      return false;\r\n    }\r\n\r\n    if (current.pausedAt) {\r\n      current.totalPaused += (Date.now() - current.pausedAt);\r\n      current.pausedAt = null;\r\n      logger.debug('Updated pause timing', {\r\n        guildId,\r\n        totalPaused: current.totalPaused\r\n      });\r\n    }\r\n    current.status = 'playing';\r\n    this.isPlaying.set(guildId, true);\r\n    logger.info('Song resumed', {\r\n      guildId,\r\n      songTitle: current.title\r\n    });\r\n\r\n    // Resume the audio player\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player) {\r\n      try {\r\n        player.unpause();\r\n        logger.debug('Audio player resumed successfully', { guildId });\r\n      } catch (error) {\r\n        logger.error('Failed to resume audio player', {\r\n          guildId,\r\n          error: error.message\r\n        });\r\n        return false;\r\n      }\r\n    } else {\r\n      logger.warn('No audio player found to resume', { guildId });\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  skip(guildId) {\r\n    const currentSong = this.currentlyPlaying.get(guildId);\r\n    if (currentSong) {\r\n      this.addToHistory(guildId, currentSong);\r\n    }\r\n\r\n    const queue = this.getQueue(guildId);\r\n    if (queue.length === 0) return false;\r\n\r\n    const nextSong = queue.shift();\r\n    this.currentlyPlaying.set(guildId, {\r\n      ...nextSong,\r\n      startedAt: Date.now(),\r\n      status: 'playing'\r\n    });\r\n\r\n    // Play the next song using enhanced error handling\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player) {\r\n      const connection = getVoiceConnection(guildId);\r\n      if (connection) {\r\n        this.playWithErrorHandling(guildId, null, nextSong, player, connection)\r\n          .then(result => {\r\n            if (!result.success) {\r\n              console.error(`[MUSIC] Failed to skip to song \"${nextSong.title}\":`, result.error);\r\n              // Try to play next available song\r\n              this.playNext(guildId);\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.error(`[MUSIC] Unexpected error skipping to song:`, error);\r\n            this.playNext(guildId);\r\n          });\r\n      } else {\r\n        console.error(`[MUSIC] No voice connection available for skip`);\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return nextSong;\r\n  }\r\n\r\n  stop(guildId) {\r\n    const connection = getVoiceConnection(guildId);\r\n    if (connection) {\r\n      connection.destroy();\r\n    }\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player) {\r\n      player.stop();\r\n      this.audioPlayers.delete(guildId);\r\n    }\r\n    this.currentlyPlaying.delete(guildId);\r\n    this.clearQueue(guildId);\r\n    this.isPlaying.delete(guildId);\r\n    this.voiceChannels.delete(guildId);\r\n\r\n    return true;\r\n  }\r\n\r\n  playNext(guildId) {\r\n    const currentSong = this.currentlyPlaying.get(guildId);\r\n    if (currentSong) {\r\n      this.addToHistory(guildId, currentSong);\r\n    }\r\n\r\n    const queue = this.getQueue(guildId);\r\n    const loopMode = this.getLoop(guildId);\r\n\r\n    let nextSong;\r\n    if (loopMode === 'single' && currentSong) {\r\n      nextSong = currentSong;\r\n    } else if (queue.length === 0) {\r\n      if (loopMode === 'queue' && currentSong) {\r\n        // Add current back to queue and play it\r\n        this.addToQueue(guildId, currentSong);\r\n        nextSong = currentSong;\r\n      } else {\r\n        this.currentlyPlaying.delete(guildId);\r\n        this.isPlaying.set(guildId, false);\r\n        return false;\r\n      }\r\n    } else {\r\n      nextSong = queue.shift();\r\n      if (loopMode === 'queue' && currentSong) {\r\n        this.addToQueue(guildId, currentSong);\r\n      }\r\n    }\r\n\r\n    this.currentlyPlaying.set(guildId, {\r\n      ...nextSong,\r\n      startedAt: Date.now(),\r\n      status: 'playing'\r\n    });\r\n\r\n    // Play the next song using enhanced error handling\r\n    const player = this.audioPlayers.get(guildId);\r\n    const connection = getVoiceConnection(guildId);\r\n\r\n    if (player && connection) {\r\n      this.playWithErrorHandling(guildId, null, nextSong, player, connection)\r\n        .then(result => {\r\n          if (!result.success) {\r\n            console.error(`[MUSIC] Failed to play next song \"${nextSong.title}\":`, result.error);\r\n            // Try to play the song after next\r\n            setTimeout(() => this.playNext(guildId), 1000);\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.error(`[MUSIC] Unexpected error playing next song:`, error);\r\n          // Try to play the song after next\r\n          setTimeout(() => this.playNext(guildId), 1000);\r\n        });\r\n    } else {\r\n      console.error(`[MUSIC] No player or connection available for playNext`);\r\n      this.currentlyPlaying.delete(guildId);\r\n      this.isPlaying.set(guildId, false);\r\n      return false;\r\n    }\r\n\r\n    return nextSong;\r\n  }\r\n\r\n  async setVolume(guildId, volume) {\r\n    const settings = this.musicSettings.get(guildId) || {};\r\n    settings.volume = Math.max(0, Math.min(200, volume)); // Discord.js voice supports 0-200%\r\n    this.musicSettings.set(guildId, settings);\r\n\r\n    // Apply volume to current player if exists\r\n    const player = this.audioPlayers.get(guildId);\r\n    if (player && player.state.status === AudioPlayerStatus.Playing) {\r\n      const currentSong = this.currentlyPlaying.get(guildId);\r\n      if (currentSong) {\r\n        try {\r\n          // Use enhanced playback method with new volume\r\n          const newVolume = settings.volume / 100;\r\n          const connection = getVoiceConnection(guildId);\r\n\r\n          if (connection) {\r\n            const playResult = await this.playWithErrorHandling(guildId, null, currentSong, player, connection);\r\n            if (playResult.success) {\r\n              // Find the current resource and update its volume\r\n              const resource = player.state.resource;\r\n              if (resource && resource.volume) {\r\n                resource.volume.setVolume(newVolume);\r\n              }\r\n            } else {\r\n              console.error(`[MUSIC] Failed to update volume for \"${currentSong.title}\":`, playResult.error);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error(`[MUSIC] Error updating volume:`, error);\r\n          // Don't fail the volume change, just log the error\r\n        }\r\n      }\r\n    }\r\n\r\n    return settings.volume;\r\n  }\r\n\r\n  getVolume(guildId) {\r\n    return this.musicSettings.get(guildId)?.volume || 50;\r\n  }\r\n\r\n  setLoop(guildId, mode) {\r\n    if (!['none', 'single', 'queue'].includes(mode)) return false;\r\n    const settings = this.musicSettings.get(guildId) || {};\r\n    settings.loop = mode;\r\n    this.musicSettings.set(guildId, settings);\r\n    return true;\r\n  }\r\n\r\n  getLoop(guildId) {\r\n    return this.musicSettings.get(guildId)?.loop || 'none';\r\n  }\r\n\r\n  // Music Statistics\r\n  getMusicStats(guildId) {\r\n    const queue = this.getQueue(guildId);\r\n    const current = this.currentlyPlaying.get(guildId);\r\n    const settings = this.musicSettings.get(guildId);\r\n\r\n    return {\r\n      queueLength: queue.length,\r\n      currentlyPlaying: current ? {\r\n        title: current.title,\r\n        artist: current.artist,\r\n        duration: current.duration,\r\n        progress: current.startedAt ? (Date.now() - current.startedAt) - (current.totalPaused || 0) : 0,\r\n        status: current.status\r\n      } : null,\r\n      volume: settings?.volume || 50,\r\n      playlists: settings?.playlists?.size || 0\r\n    };\r\n  }\r\n\r\n  // Lyrics and Song Info\r\n  async getLyrics(songTitle, artist) {\r\n    try {\r\n      // Use multiple lyrics APIs for better coverage\r\n      const searchQuery = `${songTitle} ${artist}`.trim();\r\n\r\n      // Try Genius API (lyrics.ovh uses this as backend)\r\n      try {\r\n        const response = await axios.get(`https://api.lyrics.ovh/v1/${encodeURIComponent(artist)}/${encodeURIComponent(songTitle)}`, { timeout: 5000 });\r\n        if (response.data.lyrics) {\r\n          return {\r\n            title: songTitle,\r\n            artist,\r\n            lyrics: response.data.lyrics,\r\n            source: 'Lyrics.ovh'\r\n          };\r\n        }\r\n      } catch (apiError) {\r\n        console.log('Lyrics.ovh API failed, trying alternative');\r\n      }\r\n\r\n      // Alternative: Return formatted message with search suggestion\r\n      return {\r\n        title: songTitle,\r\n        artist,\r\n        lyrics: `üéµ **Lyrics for \"${songTitle}\" by ${artist}**\\n\\n` +\r\n                `Lyrics are not currently available for this song.\\n\\n` +\r\n                `**To find lyrics, try:**\\n` +\r\n                `‚Ä¢ üé§ Search on Genius: https://genius.com/search?q=${encodeURIComponent(searchQuery)}\\n` +\r\n                `‚Ä¢ üìù Search on AZLyrics: https://www.azlyrics.com/lyrics/${encodeURIComponent(artist.toLowerCase())}/${encodeURIComponent(songTitle.toLowerCase())}.html\\n` +\r\n                `‚Ä¢ üéß Use Spotify or YouTube Music for synced lyrics\\n` +\r\n                `‚Ä¢ üì± Check the official music video on YouTube\\n\\n` +\r\n                `üí° *Full lyrics integration would require API keys from Genius, Musixmatch, or similar services*`,\r\n        source: 'Search Suggestions',\r\n        note: 'Consider upgrading to premium music services for synced lyrics'\r\n      };\r\n    } catch (error) {\r\n      console.error('Lyrics fetch error:', error);\r\n      return {\r\n        title: songTitle,\r\n        artist,\r\n        lyrics: 'Lyrics not available. Please check Genius or AZLyrics for this song.',\r\n        source: 'Error'\r\n      };\r\n    }\r\n  }\r\n\r\n  // Radio Stations\r\n  getRadioStations() {\r\n    return {\r\n      'lofi_hip_hop': { name: 'Lo-fi Hip Hop', genre: 'Lo-fi', url: 'https://streams.ilovemusic.de/iloveradio17.mp3' },\r\n      'electronic': { name: 'Electronic Beats', genre: 'Electronic', url: 'https://streams.radiomast.io/electronic-radio' },\r\n      'rock_classics': { name: 'Rock Classics', genre: 'Rock', url: 'https://streams.radiomast.io/rock-radio' },\r\n      'jazz': { name: 'Smooth Jazz', genre: 'Jazz', url: 'https://streams.radiomast.io/jazz-radio' },\r\n      'classical': { name: 'Classical Music', genre: 'Classical', url: 'https://streams.radiomast.io/classical-radio' }\r\n    };\r\n  }\r\n\r\n  // Music Recommendations\r\n  getRecommendations(guildId, basedOnRecent = true) {\r\n    const queue = this.getQueue(guildId);\r\n    const current = this.currentlyPlaying.get(guildId);\r\n\r\n    // Simple recommendation algorithm\r\n    const genres = ['pop', 'rock', 'electronic', 'jazz', 'classical', 'hip-hop'];\r\n    const recommendations = [];\r\n\r\n    if (current && basedOnRecent) {\r\n      // Recommend based on current song\r\n      recommendations.push({\r\n        title: `More ${current.genre || 'popular'} songs`,\r\n        artist: 'Various Artists',\r\n        reason: `Similar to \"${current.title}\"`\r\n      });\r\n    }\r\n\r\n    // Add some variety\r\n    for (let i = 0; i < 3; i++) {\r\n      const randomGenre = genres[Math.floor(Math.random() * genres.length)];\r\n      recommendations.push({\r\n        title: `Popular ${randomGenre} songs`,\r\n        artist: 'Various Artists',\r\n        reason: `Discover ${randomGenre} music`\r\n      });\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  // Music Events and DJ Mode\r\n  startDJMode(guildId, settings = {}) {\r\n    const djSettings = {\r\n      autoPlay: true,\r\n      crossfade: true,\r\n      requestChannel: null,\r\n      maxRequestsPerUser: 3,\r\n      ...settings\r\n    };\r\n\r\n    if (!this.musicSettings.has(guildId)) {\r\n      this.musicSettings.set(guildId, {});\r\n    }\r\n\r\n    this.musicSettings.get(guildId).djMode = djSettings;\r\n    return djSettings;\r\n  }\r\n\r\n  stopDJMode(guildId) {\r\n    const settings = this.musicSettings.get(guildId);\r\n    if (settings) {\r\n      settings.djMode = null;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // Song Request System\r\n  requestSong(guildId, userId, song) {\r\n    const settings = this.musicSettings.get(guildId);\r\n    if (!settings?.djMode) {\r\n      return { success: false, reason: 'dj_mode_disabled' };\r\n    }\r\n\r\n    const queue = this.getQueue(guildId);\r\n    const userRequests = queue.filter(s => s.requestedBy === userId);\r\n\r\n    if (userRequests.length >= settings.djMode.maxRequestsPerUser) {\r\n      return { success: false, reason: 'max_requests_reached' };\r\n    }\r\n\r\n    // Add the song request to the queue\r\n    queue.push({ ...song, requestedBy: userId });\r\n    return { success: true };\r\n  }\r\n}\r\n\r\n// Export the music manager instance\r\nexport const musicManager = new MusicManager();\r\n\r\n// Debug: Log initialization\r\nlogger.info('MusicManager initialized', {\r\n  initializationTime: new Date().toISOString(),\r\n  hasSpotifyCredentials: !!(process.env.SPOTIFY_CLIENT_ID && process.env.SPOTIFY_CLIENT_SECRET),\r\n  hasYouTubeAccess: true, // ytdl-core always available\r\n  hasDeezzerAccess: true, // axios available\r\n  ffmpegStaticAvailable: !!ffmpeg,\r\n  resolvedFfmpegPath: ffmpegPath,\r\n  ffmpegPathExists: existsSync(ffmpegPath)\r\n});\r\n\r\n// Convenience functions for external use\r\nexport async function searchSongs(query, limit = 10) {\r\n  return musicManager.searchSongs(query, limit);\r\n}\r\n\r\nexport function addToQueue(guildId, song) {\r\n  return musicManager.addToQueue(guildId, song);\r\n}\r\n\r\nexport function getQueue(guildId) {\r\n  return musicManager.getQueue(guildId);\r\n}\r\n\r\nexport async function play(guildId, voiceChannel, song) {\r\n  return musicManager.play(guildId, voiceChannel, song);\r\n}\r\n\r\nexport async function pause(guildId) {\r\n  return musicManager.pause(guildId);\r\n}\r\n\r\nexport async function resume(guildId) {\r\n  return musicManager.resume(guildId);\r\n}\r\n\r\nexport async function skip(guildId) {\r\n  return musicManager.skip(guildId);\r\n}\r\n\r\nexport async function stop(guildId) {\r\n  return musicManager.stop(guildId);\r\n}\r\n\r\nexport async function setVolume(guildId, volume) {\r\n  return await musicManager.setVolume(guildId, volume);\r\n}\r\n\r\nexport function getVolume(guildId) {\r\n  return musicManager.getVolume(guildId);\r\n}\r\n\r\nexport function getMusicStats(guildId) {\r\n  return musicManager.getMusicStats(guildId);\r\n}\r\n\r\nexport async function getLyrics(songTitle, artist) {\r\n  return musicManager.getLyrics(songTitle, artist);\r\n}\r\n\r\nexport function getRadioStations() {\r\n  return musicManager.getRadioStations();\r\n}\r\n\r\nexport function getRecommendations(guildId, basedOnRecent = true) {\r\n  return musicManager.getRecommendations(guildId, basedOnRecent);\r\n}\r\n\r\nexport function createPlaylist(guildId, name, creatorId) {\r\n  return musicManager.createPlaylist(guildId, name, creatorId);\r\n}\r\n\r\nexport function addToPlaylist(guildId, playlistId, song) {\r\n  return musicManager.addToPlaylist(guildId, playlistId, song);\r\n}\r\n\r\nexport function getPlaylist(guildId, playlistId) {\r\n  return musicManager.getPlaylist(guildId, playlistId);\r\n}\r\n\r\nexport function shuffleQueue(guildId) {\r\n  return musicManager.shuffleQueue(guildId);\r\n}\r\n\r\nexport function clearQueue(guildId) {\r\n  return musicManager.clearQueue(guildId);\r\n}\r\n\r\nexport function back(guildId) {\r\n  return musicManager.back(guildId);\r\n}\r\n\r\nexport function addToHistory(guildId, song) {\r\n  return musicManager.addToHistory(guildId, song);\r\n}\r\n\r\nexport function getHistory(guildId) {\r\n  return musicManager.getHistory(guildId);\r\n}\r\n\r\nexport function setLoop(guildId, mode) {\r\n  return musicManager.setLoop(guildId, mode);\r\n}\r\n\r\nexport function getLoop(guildId) {\r\n  return musicManager.getLoop(guildId);\r\n}\r\n\r\nexport async function validateSongUrl(song) {\r\n  return musicManager.validateSongUrl(song);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\novel.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":25,"fix":{"range":[46,46],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 121. Maximum allowed is 120.","line":7,"column":1,"nodeType":"Program","messageId":"max","endLine":7,"endColumn":122},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":7,"column":22,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":7,"endColumn":23,"fix":{"range":[184,184],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":7,"column":56,"nodeType":"IfStatement","messageId":"exceed","endLine":7,"endColumn":120},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":7,"column":121,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":7,"endColumn":122,"fix":{"range":[282,282],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":9,"column":20,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":9,"endColumn":21,"fix":{"range":[307,307],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 6 statements. Maximum allowed is 2.","line":9,"column":35,"nodeType":"IfStatement","messageId":"exceed","endLine":9,"endColumn":71},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":9,"column":76,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":9,"endColumn":77,"fix":{"range":[363,363],"text":"\n"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":9,"column":118,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":9,"endColumn":124,"fix":{"range":[402,410],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":9,"column":134,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":9,"endColumn":135,"fix":{"range":[421,421],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":9,"column":134,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":9,"endColumn":135,"fix":{"range":[420,420],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `error`.","line":9,"column":143,"nodeType":"Identifier","messageId":"with-name","endLine":9,"endColumn":148,"fix":{"range":[428,436],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":9,"column":150,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":9,"endColumn":151,"fix":{"range":[437,437],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":9,"column":163,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":9,"endColumn":164,"fix":{"range":[449,449],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":9,"column":165,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":9,"endColumn":166,"fix":{"range":[451,451],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":10,"column":24,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":10,"endColumn":25,"fix":{"range":[478,478],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":10,"column":39,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":10,"endColumn":100},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":10,"column":82,"nodeType":"Literal","messageId":"error","endLine":10,"endColumn":86,"suggestions":[{"messageId":"replace","fix":{"range":[535,539],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":10,"column":101,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":10,"endColumn":102,"fix":{"range":[554,554],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":12,"column":30,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":12,"endColumn":31,"fix":{"range":[589,589],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":12,"column":63,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":12,"endColumn":64,"fix":{"range":[621,621],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":17,"column":3,"nodeType":"MemberExpression","endLine":17,"endColumn":10},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":19,"column":10,"nodeType":"MemberExpression","endLine":19,"endColumn":17},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":22,"column":30,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":22,"endColumn":31,"fix":{"range":[931,931],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":22,"column":55,"nodeType":"ReturnStatement","messageId":"exceed","endLine":22,"endColumn":78},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":22,"column":62,"nodeType":"MemberExpression","endLine":22,"endColumn":69},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":22,"column":73,"nodeType":"Literal","messageId":"error","endLine":22,"endColumn":77,"suggestions":[{"messageId":"replace","fix":{"range":[973,977],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":22,"column":79,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":22,"endColumn":80,"fix":{"range":[979,979],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":26,"column":22,"nodeType":"Literal","messageId":"error","endLine":26,"endColumn":26,"suggestions":[{"messageId":"remove","fix":{"range":[1100,1104],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[1100,1104],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":28,"column":1,"nodeType":"Program","messageId":"max","endLine":28,"endColumn":145},{"ruleId":"max-len","severity":2,"message":"This line has a length of 213. Maximum allowed is 120.","line":33,"column":1,"nodeType":"Program","messageId":"max","endLine":33,"endColumn":214},{"ruleId":"max-len","severity":2,"message":"This line has a length of 175. Maximum allowed is 120.","line":34,"column":1,"nodeType":"Program","messageId":"max","endLine":34,"endColumn":176},{"ruleId":"max-len","severity":2,"message":"This line has a length of 152. Maximum allowed is 120.","line":35,"column":1,"nodeType":"Program","messageId":"max","endLine":35,"endColumn":153},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":40,"column":28,"nodeType":"MemberExpression","endLine":40,"endColumn":40},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":40,"column":50,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":40,"endColumn":64},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":45,"column":26,"nodeType":"MemberExpression","endLine":45,"endColumn":38},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":45,"column":48,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":45,"endColumn":62}],"suppressedMessages":[],"errorCount":36,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":20,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { generate } from './model-client.js';\r\n\r\nconst FILE = path.join(process.cwd(), 'data', 'novels.json');\r\n\r\nfunction ensureDir() { const dir = path.dirname(FILE); if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true }); }\r\n\r\nfunction readAll() { ensureDir(); if (!fs.existsSync(FILE)) return {}; try { return JSON.parse(fs.readFileSync(FILE, 'utf8')) || {}; } catch (error) { return {}; } }\r\nfunction writeAll(obj) { ensureDir(); fs.writeFileSync(FILE, JSON.stringify(obj, null, 2), 'utf8'); }\r\n\r\nexport function listNovels() { return Object.keys(readAll()); }\r\n\r\nexport function createNovel(ownerId, title, prompt) {\r\n  const all = readAll();\r\n  const id = `novel-${Date.now()}`;\r\n  all[id] = { id, title: title || `Untitled ${Date.now()}`, owner: ownerId, prompt: prompt || '', chapters: [] };\r\n  writeAll(all);\r\n  return all[id];\r\n}\r\n\r\nexport function getNovel(id) { const all = readAll(); return all[id] || null; }\r\n\r\nexport async function generateChapter(guildId, novelId) {\r\n  const novel = getNovel(novelId);\r\n  if (!novel) return null;\r\n  const chapIndex = novel.chapters.length + 1;\r\n  const prompt = `Write chapter ${chapIndex} of the light novel titled \"${novel.title}\". Context: ${novel.prompt}. Keep it short (~300 words).`;\r\n  const text = await generate(guildId, prompt);\r\n  if (!text) {\r\n    // Fallback to a template-based chapter\r\n    const templates = [\r\n      `Chapter ${chapIndex}: The Journey Begins\\n\\nIn the world of ${novel.title}, our hero embarks on an epic adventure. Guided by the context of ${novel.prompt}, they face challenges and discover new horizons.`,\r\n      `Chapter ${chapIndex}: Unexpected Twists\\n\\nAs the story unfolds in ${novel.title}, surprises await. Building on ${novel.prompt}, the narrative takes a thrilling turn.`,\r\n      `Chapter ${chapIndex}: Deep Reflections\\n\\nOur characters in ${novel.title} pause to reflect. Drawing from ${novel.prompt}, they grow and evolve.`\r\n    ];\r\n    const fallbackText = templates[chapIndex % templates.length];\r\n    const chapter = { index: chapIndex, text: fallbackText };\r\n    novel.chapters.push(chapter);\r\n    const all = readAll(); all[novelId] = novel; writeAll(all);\r\n    return chapter;\r\n  }\r\n  const chapter = { index: chapIndex, text };\r\n  novel.chapters.push(chapter);\r\n  const all = readAll(); all[novelId] = novel; writeAll(all);\r\n  return chapter;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\profiles.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":28,"column":33,"nodeType":"CallExpression","endLine":28,"endColumn":87},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":28,"column":80,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":28,"endColumn":86,"fix":{"range":[789,797],"text":""}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":30,"column":11,"nodeType":"MemberExpression","endLine":30,"endColumn":32},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":32,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":32,"endColumn":8,"fix":{"range":[898,898],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":33,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":33,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[924,986],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found writeFileSync from package \"fs\" with non literal argument at index 0","line":47,"column":7,"nodeType":"CallExpression","endLine":47,"endColumn":64},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":47,"column":55,"nodeType":"Literal","messageId":"error","endLine":47,"endColumn":59,"suggestions":[{"messageId":"replace","fix":{"range":[1297,1301],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":48,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":48,"endColumn":6,"fix":{"range":[1314,1314],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":49,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":49,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1338,1400],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'getOrCreateProfile' has too many lines (104). Maximum allowed is 50.","line":59,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":162,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":60,"column":10,"nodeType":"MemberExpression","endLine":60,"endColumn":31},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":64,"column":11,"nodeType":"CallExpression","endLine":64,"endColumn":34},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":66,"column":35,"nodeType":"CallExpression","endLine":66,"endColumn":68},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":66,"column":61,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":66,"endColumn":67,"fix":{"range":[1953,1961],"text":""}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":68,"column":13,"nodeType":"MemberExpression","endLine":68,"endColumn":34},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":70,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":70,"endColumn":10,"fix":{"range":[2070,2070],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":71,"column":11,"nodeType":"MemberExpression","messageId":"unexpected","endLine":71,"endColumn":24,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2098,2160],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":76,"column":10,"nodeType":"MemberExpression","endLine":76,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":77,"column":7,"nodeType":"MemberExpression","endLine":77,"endColumn":28},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":82,"column":17,"nodeType":"Literal","messageId":"error","endLine":82,"endColumn":21,"suggestions":[{"messageId":"replace","fix":{"range":[2361,2365],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":134,"column":31,"nodeType":"Literal","messageId":"error","endLine":134,"endColumn":35,"suggestions":[{"messageId":"replace","fix":{"range":[3891,3895],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":139,"column":18,"nodeType":"Literal","messageId":"error","endLine":139,"endColumn":22,"suggestions":[{"messageId":"replace","fix":{"range":[3994,3998],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":141,"column":27,"nodeType":"Literal","messageId":"error","endLine":141,"endColumn":31,"suggestions":[{"messageId":"replace","fix":{"range":[4063,4067],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":155,"column":9,"nodeType":"MemberExpression","endLine":155,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":156,"column":7,"nodeType":"MemberExpression","endLine":156,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":157,"column":7,"nodeType":"MemberExpression","endLine":157,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Function Call Object Injection Sink","line":158,"column":32,"nodeType":"MemberExpression","endLine":158,"endColumn":53},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":161,"column":12,"nodeType":"MemberExpression","endLine":161,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":11,"nodeType":"MemberExpression","endLine":191,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":50,"nodeType":"MemberExpression","endLine":191,"endColumn":84},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":50,"nodeType":"MemberExpression","endLine":191,"endColumn":78},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":9,"nodeType":"MemberExpression","endLine":192,"endColumn":43},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":9,"nodeType":"MemberExpression","endLine":192,"endColumn":37},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":206,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":206,"endColumn":18,"fix":{"range":[5973,6219],"text":" {\r\n        if (stat === 'characters_created') {\r\n          // Update total characters across all classes\r\n        }\r\n        if (stat === 'bosses_defeated') {\r\n          profile.statistics.social.reputation += value * 2;\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":215,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":215,"endColumn":20,"fix":{"range":[6242,6551],"text":" {\r\n        if (stat === 'trivia_correct') {\r\n          const totalGames = profile.statistics.games.trivia_games_played;\r\n          if (totalGames > 0) {\r\n            profile.statistics.games.trivia_accuracy = (profile.statistics.games.trivia_correct / totalGames) * 100;\r\n          }\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":224,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":224,"endColumn":21,"fix":{"range":[6575,6704],"text":" {\r\n        if (stat === 'trades_completed') {\r\n          profile.statistics.social.reputation += value;\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/prefer-array-some","severity":2,"message":"Prefer `.some(‚Ä¶)` over `.find(‚Ä¶)`.","line":236,"column":25,"nodeType":"Identifier","messageId":"some","endLine":236,"endColumn":29,"suggestions":[{"messageId":"some-suggestion","fix":{"range":[6863,6867],"text":"some"},"data":{"method":"find"},"desc":"Replace `.find(‚Ä¶)` with `.some(‚Ä¶)`."}]},{"ruleId":"max-len","severity":2,"message":"This line has a length of 122. Maximum allowed is 120.","line":282,"column":1,"nodeType":"Program","messageId":"max","endLine":282,"endColumn":123},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":293,"column":69,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":293,"endColumn":76,"fix":{"range":[8653,8660],"text":"3_600_000"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (650). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":650,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":338,"column":18,"nodeType":"MemberExpression","endLine":338,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":338,"column":54,"nodeType":"MemberExpression","endLine":338,"endColumn":66},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":339,"column":9,"nodeType":"MemberExpression","endLine":339,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":340,"column":18,"nodeType":"MemberExpression","endLine":340,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":341,"column":18,"nodeType":"MemberExpression","endLine":341,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":342,"column":23,"nodeType":"MemberExpression","endLine":342,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":342,"column":38,"nodeType":"MemberExpression","endLine":342,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":395,"column":21,"nodeType":"MemberExpression","endLine":395,"endColumn":57},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":395,"column":21,"nodeType":"MemberExpression","endLine":395,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":437,"column":5,"nodeType":"MemberExpression","endLine":437,"endColumn":26},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":474,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":474,"endColumn":6,"fix":{"range":[14023,14023],"text":"\n"}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":479,"column":5,"nodeType":null,"messageId":"prefer-switch","endLine":479,"endColumn":49,"fix":{"range":[14162,14503],"text":"switch (analytics.mostActiveCategory) {\n    case 'rpg': {\r\n      insights.push(\"‚öîÔ∏è You love RPG adventures!\");\r\n    \n    break;\n    }\n    case 'games': {\r\n      insights.push(\"üéÆ Games are your passion!\");\r\n    \n    break;\n    }\n    case 'social': {\r\n      insights.push(\"ü§ù You thrive on social interactions!\");\r\n    \n    break;\n    }\n    // No default\n    }"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":480,"column":21,"nodeType":"Literal","messageId":"wrongQuotes","endLine":480,"endColumn":50,"fix":{"range":[14229,14258],"text":"'‚öîÔ∏è You love RPG adventures!'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":481,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":481,"endColumn":6,"fix":{"range":[14267,14267],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":482,"column":21,"nodeType":"Literal","messageId":"wrongQuotes","endLine":482,"endColumn":49,"fix":{"range":[14342,14370],"text":"'üéÆ Games are your passion!'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":483,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":483,"endColumn":6,"fix":{"range":[14379,14379],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":484,"column":21,"nodeType":"Literal","messageId":"wrongQuotes","endLine":484,"endColumn":60,"fix":{"range":[14455,14494],"text":"'ü§ù You thrive on social interactions!'"}},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":515,"column":7,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":515,"endColumn":9},{"ruleId":"unicorn/prefer-array-some","severity":2,"message":"Prefer `.some(‚Ä¶)` over `.find(‚Ä¶)`.","line":515,"column":31,"nodeType":"Identifier","messageId":"some","endLine":515,"endColumn":35,"suggestions":[{"messageId":"some-suggestion","fix":{"range":[15868,15872],"text":"some"},"data":{"method":"find"},"desc":"Replace `.find(‚Ä¶)` with `.some(‚Ä¶)`."}]},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":517,"column":9,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":525,"endColumn":10,"fix":{"range":[15847,16336],"text":"(!profile.milestones.find(m => m.id === milestone.id) && // Simple requirement check (in real implementation, use more sophisticated evaluation)\r\n        this.evaluateRequirement(profile, milestone.requirement)) {\r\n          profile.milestones.push({\r\n            id: milestone.id,\r\n            name: milestone.name,\r\n            description: milestone.description,\r\n            achieved: Date.now()\r\n          });\r\n          newMilestones.push(milestone);\r\n        }"}},{"ruleId":"unicorn/prefer-string-replace-all","severity":2,"message":"Prefer `String#replaceAll()` over `String#replace()`.","line":543,"column":38,"nodeType":"Identifier","messageId":"method","endLine":543,"endColumn":45,"fix":{"range":[16824,16824],"text":"All"}},{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":543,"column":46,"nodeType":"Literal","endLine":543,"endColumn":64},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":547,"column":19,"nodeType":"MemberExpression","endLine":547,"endColumn":31},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":554,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":554,"endColumn":6,"fix":{"range":[17184,17184],"text":"\n"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":565,"column":17,"nodeType":"Identifier","messageId":"error","endLine":565,"endColumn":25,"fix":{"range":[17524,17532],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":566,"column":17,"nodeType":"Identifier","messageId":"error","endLine":566,"endColumn":25,"fix":{"range":[17557,17565],"text":"Number.parseInt"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":568,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":568,"endColumn":19,"fix":{"range":[17614,17629],"text":" { return l == r;\n        }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":569,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":569,"endColumn":19,"fix":{"range":[17649,17664],"text":" { return l != r;\n        }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":570,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":570,"endColumn":19,"fix":{"range":[17684,17699],"text":" { return l >= r;\n        }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":571,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":571,"endColumn":19,"fix":{"range":[17719,17734],"text":" { return l <= r;\n        }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":572,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":572,"endColumn":18,"fix":{"range":[17753,17767],"text":" { return l > r;\n        }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":573,"column":9,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":573,"endColumn":18,"fix":{"range":[17786,17800],"text":" { return l < r;\n        }"}}],"suppressedMessages":[],"errorCount":41,"fatalErrorCount":0,"warningCount":35,"fixableErrorCount":29,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst PROFILES_DIR = path.join(process.cwd(), 'data', 'players');\r\n\r\n// Advanced User Profile and Statistics System\r\nclass ProfileManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadProfiles();\r\n    this.profileCache = new Map();\r\n  }\r\n\r\n  ensureStorage() {\r\n    if (!fs.existsSync(PROFILES_DIR)) {\r\n      fs.mkdirSync(PROFILES_DIR, { recursive: true });\r\n    }\r\n  }\r\n\r\n  loadProfiles() {\r\n    this.profiles = {};\r\n    if (!fs.existsSync(PROFILES_DIR)) return;\r\n\r\n    const files = fs.readdirSync(PROFILES_DIR).filter(f => f.endsWith('.json'));\r\n    for (const file of files) {\r\n      const userId = path.basename(file, '.json');\r\n      try {\r\n        const data = JSON.parse(fs.readFileSync(path.join(PROFILES_DIR, file), 'utf8'));\r\n        if (data.profile) {\r\n          this.profiles[userId] = data.profile;\r\n        }\r\n      } catch (error) {\r\n        console.error(`Failed to load profile for ${userId}:`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  saveProfile(userId, profile) {\r\n    this.ensureStorage();\r\n    const filePath = path.join(PROFILES_DIR, `${userId}.json`);\r\n    const data = {\r\n      profile,\r\n      exported: Date.now(),\r\n      version: '1.0'\r\n    };\r\n    try {\r\n      fs.writeFileSync(filePath, JSON.stringify(data, null, 2));\r\n    } catch (error) {\r\n      console.error(`Failed to save profile for ${userId}:`, error);\r\n    }\r\n  }\r\n\r\n  saveProfiles() {\r\n    // Profiles are now saved individually by saveProfile\r\n    // This method can be kept for compatibility but doesn't need to do anything\r\n  }\r\n\r\n  // Advanced Profile Creation and Management\r\n  getOrCreateProfile(userId, username) {\r\n    if (!this.profiles[userId]) {\r\n      // Try to load from file first\r\n      this.ensureStorage();\r\n      const filePath = path.join(PROFILES_DIR, `${userId}.json`);\r\n      if (fs.existsSync(filePath)) {\r\n        try {\r\n          const data = JSON.parse(fs.readFileSync(filePath, 'utf8'));\r\n          if (data.profile) {\r\n            this.profiles[userId] = data.profile;\r\n          }\r\n        } catch (error) {\r\n          console.error(`Failed to load profile for ${userId}:`, error);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!this.profiles[userId]) {\r\n      this.profiles[userId] = {\r\n        userId,\r\n        username,\r\n        displayName: username,\r\n        bio: '',\r\n        avatar: null,\r\n        badges: [],\r\n        preferences: {\r\n          theme: 'default',\r\n          privacy: 'public',\r\n          notifications: true,\r\n          language: 'en'\r\n        },\r\n        statistics: {\r\n          // RPG Stats\r\n          rpg: {\r\n            characters_created: 0,\r\n            total_level: 0,\r\n            highest_level: 0,\r\n            bosses_defeated: 0,\r\n            items_collected: 0,\r\n            gold_earned: 0,\r\n            quests_completed: 0,\r\n            locations_unlocked: 0,\r\n            guild_memberships: 0\r\n          },\r\n          // Game Stats\r\n          games: {\r\n            trivia_correct: 0,\r\n            trivia_games_played: 0,\r\n            hangman_wins: 0,\r\n            hangman_games_played: 0,\r\n            memory_games_completed: 0,\r\n            memory_best_score: 0,\r\n            coin_flips: 0,\r\n            coin_heads_streak: 0,\r\n            polls_created: 0,\r\n            polls_votes_received: 0\r\n          },\r\n          // Social Stats\r\n          social: {\r\n            guilds_created: 0,\r\n            guilds_joined: 0,\r\n            parties_created: 0,\r\n            trades_completed: 0,\r\n            achievements_earned: 0,\r\n            friends_added: 0,\r\n            reputation: 0\r\n          },\r\n          // Activity Stats\r\n          activity: {\r\n            commands_used: 0,\r\n            messages_sent: 0,\r\n            buttons_clicked: 0,\r\n            first_seen: Date.now(),\r\n            last_seen: Date.now(),\r\n            total_session_time: 0,\r\n            favorite_command: null,\r\n            streak_days: 0\r\n          }\r\n        },\r\n        customization: {\r\n          title: null,\r\n          border_color: '#0099FF',\r\n          profile_banner: null,\r\n          card_style: 'modern',\r\n          show_statistics: true,\r\n          show_badges: true,\r\n          show_activity: false\r\n        },\r\n        achievements: [],\r\n        milestones: [],\r\n        created: Date.now(),\r\n        updated: Date.now()\r\n      };\r\n    }\r\n\r\n    // Update username if changed\r\n    if (this.profiles[userId].username !== username) {\r\n      this.profiles[userId].username = username;\r\n      this.profiles[userId].updated = Date.now();\r\n      this.saveProfile(userId, this.profiles[userId]);\r\n    }\r\n\r\n    return this.profiles[userId];\r\n  }\r\n\r\n  updateProfile(userId, updates) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n\r\n    // Deep merge updates\r\n    if (updates.preferences) {\r\n      profile.preferences = { ...profile.preferences, ...updates.preferences };\r\n    }\r\n    if (updates.customization) {\r\n      profile.customization = { ...profile.customization, ...updates.customization };\r\n    }\r\n    if (updates.displayName !== undefined) {\r\n      profile.displayName = updates.displayName;\r\n    }\r\n    if (updates.bio !== undefined) {\r\n      profile.bio = updates.bio;\r\n    }\r\n\r\n    profile.updated = Date.now();\r\n    this.saveProfile(userId, profile);\r\n    return profile;\r\n  }\r\n\r\n  // Statistics Tracking\r\n  updateStatistics(userId, category, statUpdates) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n\r\n    for (const [stat, value] of Object.entries(statUpdates)) {\r\n      if (profile.statistics[category] && typeof profile.statistics[category][stat] === 'number') {\r\n        profile.statistics[category][stat] += value;\r\n\r\n        // Update derived statistics\r\n        this.updateDerivedStats(profile, category, stat, value);\r\n      }\r\n    }\r\n\r\n    profile.updated = Date.now();\r\n    this.saveProfile(userId, profile);\r\n    return profile;\r\n  }\r\n\r\n  updateDerivedStats(profile, category, stat, value) {\r\n    switch (category) {\r\n      case 'rpg':\r\n        if (stat === 'characters_created') {\r\n          // Update total characters across all classes\r\n        }\r\n        if (stat === 'bosses_defeated') {\r\n          profile.statistics.social.reputation += value * 2;\r\n        }\r\n        break;\r\n\r\n      case 'games':\r\n        if (stat === 'trivia_correct') {\r\n          const totalGames = profile.statistics.games.trivia_games_played;\r\n          if (totalGames > 0) {\r\n            profile.statistics.games.trivia_accuracy = (profile.statistics.games.trivia_correct / totalGames) * 100;\r\n          }\r\n        }\r\n        break;\r\n\r\n      case 'social':\r\n        if (stat === 'trades_completed') {\r\n          profile.statistics.social.reputation += value;\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  // Badge System\r\n  awardBadge(userId, badgeId, badgeData) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n\r\n    if (!profile.badges.find(b => b.id === badgeId)) {\r\n      profile.badges.push({\r\n        id: badgeId,\r\n        ...badgeData,\r\n        awarded: Date.now()\r\n      });\r\n\r\n      this.saveProfile(userId, profile);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  removeBadge(userId, badgeId) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n    const badgeIndex = profile.badges.findIndex(b => b.id === badgeId);\r\n\r\n    if (badgeIndex !== -1) {\r\n      profile.badges.splice(badgeIndex, 1);\r\n      this.saveProfile(userId, profile);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // Profile Analytics\r\n  getProfileAnalytics(userId) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n    const stats = profile.statistics;\r\n\r\n    // Calculate activity score\r\n    const activityScore = Math.min(100,\r\n      (stats.activity.commands_used * 2) +\r\n      (stats.activity.messages_sent * 1) +\r\n      (stats.activity.buttons_clicked * 0.5) +\r\n      (stats.social.reputation * 0.1)\r\n    );\r\n\r\n    // Calculate engagement level\r\n    const engagementLevel = this.calculateEngagementLevel(stats);\r\n\r\n    // Find most active category\r\n    const categoryActivity = {\r\n      rpg: stats.rpg.total_level + (stats.rpg.bosses_defeated * 10) + (stats.rpg.items_collected * 2),\r\n      games: (stats.games.trivia_correct * 3) + (stats.games.hangman_wins * 5) + (stats.games.memory_games_completed * 4),\r\n      social: (stats.social.guilds_created * 20) + (stats.social.trades_completed * 8) + stats.social.reputation\r\n    };\r\n\r\n    const mostActiveCategory = Object.entries(categoryActivity)\r\n      .sort(([,a], [,b]) => b - a)[0]?.[0] || 'none';\r\n\r\n    return {\r\n      activityScore,\r\n      engagementLevel,\r\n      mostActiveCategory,\r\n      totalPlayTime: Math.round(stats.activity.total_session_time / 3600000), // Convert to hours\r\n      accountAge: Math.round((Date.now() - stats.activity.first_seen) / (24 * 60 * 60 * 1000)), // Days\r\n      favoriteCommand: stats.activity.favorite_command,\r\n      streakDays: stats.activity.streak_days\r\n    };\r\n  }\r\n\r\n  calculateEngagementLevel(stats) {\r\n    const totalActions = stats.activity.commands_used + stats.activity.messages_sent + stats.activity.buttons_clicked;\r\n\r\n    if (totalActions > 1000) return 'Legendary';\r\n    if (totalActions > 500) return 'Expert';\r\n    if (totalActions > 200) return 'Advanced';\r\n    if (totalActions > 100) return 'Intermediate';\r\n    if (totalActions > 50) return 'Active';\r\n    if (totalActions > 10) return 'Casual';\r\n    return 'Newcomer';\r\n  }\r\n\r\n  // Profile Comparison System\r\n  compareProfiles(userId1, userId2) {\r\n    const profile1 = this.getOrCreateProfile(userId1);\r\n    const profile2 = this.getOrCreateProfile(userId2);\r\n\r\n    const stats1 = profile1.statistics;\r\n    const stats2 = profile2.statistics;\r\n\r\n    const comparison = {\r\n      rpg: this.compareCategory(stats1.rpg, stats2.rpg),\r\n      games: this.compareCategory(stats1.games, stats2.games),\r\n      social: this.compareCategory(stats1.social, stats2.social),\r\n      activity: this.compareCategory(stats1.activity, stats2.activity)\r\n    };\r\n\r\n    return {\r\n      profiles: [profile1, profile2],\r\n      comparison,\r\n      winner: this.determineWinner(comparison)\r\n    };\r\n  }\r\n\r\n  compareCategory(stats1, stats2) {\r\n    const comparison = {};\r\n\r\n    for (const stat of Object.keys(stats1)) {\r\n      if (typeof stats1[stat] === 'number' && typeof stats2[stat] === 'number') {\r\n        comparison[stat] = {\r\n          user1: stats1[stat],\r\n          user2: stats2[stat],\r\n          difference: stats1[stat] - stats2[stat]\r\n        };\r\n      }\r\n    }\r\n\r\n    return comparison;\r\n  }\r\n\r\n  determineWinner(comparison) {\r\n    let score1 = 0;\r\n    let score2 = 0;\r\n\r\n    for (const category of Object.values(comparison)) {\r\n      for (const stat of Object.values(category)) {\r\n        if (stat.difference > 0) score1++;\r\n        else if (stat.difference < 0) score2++;\r\n      }\r\n    }\r\n\r\n    if (score1 > score2) return 'user1';\r\n    if (score2 > score1) return 'user2';\r\n    return 'tie';\r\n  }\r\n\r\n  // Profile Search and Discovery\r\n  searchProfiles(searchTerm, limit = 10) {\r\n    const matchingProfiles = [];\r\n\r\n    for (const profile of Object.values(this.profiles)) {\r\n      if (profile.preferences.privacy === 'private') continue;\r\n\r\n      // Search in username, display name, and bio\r\n      const searchFields = [\r\n        profile.username,\r\n        profile.displayName,\r\n        profile.bio\r\n      ].join(' ').toLowerCase();\r\n\r\n      if (searchFields.includes(searchTerm.toLowerCase())) {\r\n        matchingProfiles.push(profile);\r\n      }\r\n    }\r\n\r\n    return matchingProfiles.slice(0, limit);\r\n  }\r\n\r\n  // Profile Leaderboards\r\n  getLeaderboard(category, stat, limit = 10) {\r\n    const leaderboard = [];\r\n\r\n    for (const profile of Object.values(this.profiles)) {\r\n      if (profile.preferences.privacy === 'private') continue;\r\n\r\n      const value = profile.statistics[category]?.[stat];\r\n      if (typeof value === 'number' && value > 0) {\r\n        leaderboard.push({\r\n          userId: profile.userId,\r\n          username: profile.username,\r\n          displayName: profile.displayName,\r\n          value,\r\n          level: this.getUserLevel(profile)\r\n        });\r\n      }\r\n    }\r\n\r\n    return leaderboard\r\n      .sort((a, b) => b.value - a.value)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  getUserLevel(profile) {\r\n    const totalPoints = profile.achievements.length * 10 +\r\n                       profile.statistics.rpg.total_level +\r\n                       profile.statistics.games.trivia_correct +\r\n                       profile.statistics.social.reputation;\r\n\r\n    return Math.floor(totalPoints / 100) + 1;\r\n  }\r\n\r\n  // Profile Export and Backup\r\n  exportProfile(userId) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n\r\n    return {\r\n      profile: profile,\r\n      exported: Date.now(),\r\n      version: '1.0'\r\n    };\r\n  }\r\n\r\n  importProfile(userId, profileData) {\r\n    if (profileData.version !== '1.0') {\r\n      return { success: false, reason: 'incompatible_version' };\r\n    }\r\n\r\n    this.profiles[userId] = profileData.profile;\r\n    this.saveProfile(userId, profileData.profile);\r\n\r\n    return { success: true };\r\n  }\r\n\r\n  // Profile Privacy and Security\r\n  setPrivacySettings(userId, privacySettings) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n\r\n    if (privacySettings.privacy) {\r\n      profile.preferences.privacy = privacySettings.privacy;\r\n    }\r\n\r\n    if (privacySettings.show_statistics !== undefined) {\r\n      profile.customization.show_statistics = privacySettings.show_statistics;\r\n    }\r\n\r\n    if (privacySettings.show_badges !== undefined) {\r\n      profile.customization.show_badges = privacySettings.show_badges;\r\n    }\r\n\r\n    profile.updated = Date.now();\r\n    this.saveProfile(userId, profile);\r\n    return profile;\r\n  }\r\n\r\n  // Advanced Profile Features\r\n  generateProfileInsights(userId) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n    const analytics = this.getProfileAnalytics(userId);\r\n\r\n    const insights = [];\r\n\r\n    // Activity insights\r\n    if (analytics.activityScore > 80) {\r\n      insights.push(\"üåü You're incredibly active in the community!\");\r\n    } else if (analytics.activityScore > 50) {\r\n      insights.push(\"üéØ You're a dedicated bot user!\");\r\n    }\r\n\r\n    // Category insights\r\n    if (analytics.mostActiveCategory === 'rpg') {\r\n      insights.push(\"‚öîÔ∏è You love RPG adventures!\");\r\n    } else if (analytics.mostActiveCategory === 'games') {\r\n      insights.push(\"üéÆ Games are your passion!\");\r\n    } else if (analytics.mostActiveCategory === 'social') {\r\n      insights.push(\"ü§ù You thrive on social interactions!\");\r\n    }\r\n\r\n    // Achievement insights\r\n    const achievementCount = profile.achievements.length;\r\n    if (achievementCount >= 10) {\r\n      insights.push(`üèÜ Achievement Hunter! You've earned ${achievementCount} achievements!`);\r\n    }\r\n\r\n    // Streak insights\r\n    if (analytics.streakDays > 7) {\r\n      insights.push(`üî• ${analytics.streakDays} day streak! You're on fire!`);\r\n    }\r\n\r\n    return insights;\r\n  }\r\n\r\n  // Profile Milestones\r\n  checkMilestones(userId) {\r\n    const profile = this.getOrCreateProfile(userId);\r\n    const newMilestones = [];\r\n\r\n    const milestones = [\r\n      { id: 'first_command', name: 'üöÄ First Steps', description: 'Used your first command', requirement: 'activity.commands_used >= 1' },\r\n      { id: 'social_butterfly', name: 'ü¶ã Social Butterfly', description: 'Joined 5 guilds', requirement: 'social.guilds_joined >= 5' },\r\n      { id: 'rpg_master', name: 'üèÖ RPG Master', description: 'Reached level 50 in RPG', requirement: 'rpg.highest_level >= 50' },\r\n      { id: 'trivia_expert', name: 'üß† Trivia Expert', description: 'Answered 1000 questions correctly', requirement: 'games.trivia_correct >= 1000' },\r\n      { id: 'trading_mogul', name: 'üíé Trading Mogul', description: 'Completed 100 trades', requirement: 'social.trades_completed >= 100' }\r\n    ];\r\n\r\n    for (const milestone of milestones) {\r\n      if (!profile.milestones.find(m => m.id === milestone.id)) {\r\n        // Simple requirement check (in real implementation, use more sophisticated evaluation)\r\n        if (this.evaluateRequirement(profile, milestone.requirement)) {\r\n          profile.milestones.push({\r\n            id: milestone.id,\r\n            name: milestone.name,\r\n            description: milestone.description,\r\n            achieved: Date.now()\r\n          });\r\n          newMilestones.push(milestone);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (newMilestones.length > 0) {\r\n      profile.updated = Date.now();\r\n      this.saveProfile(userId, profile);\r\n    }\r\n\r\n    return newMilestones;\r\n  }\r\n\r\n  evaluateRequirement(profile, requirement) {\r\n    try {\r\n      // Improved requirement evaluator with basic expression parsing\r\n      const stats = profile.statistics;\r\n\r\n      // Replace stat paths with actual values, e.g., 'rpg.highest_level' -> stats.rpg.highest_level\r\n      const expression = requirement.replace(/(\\w+(?:\\.\\w+)*)/g, (match) => {\r\n        const keys = match.split('.');\r\n        let value = stats;\r\n        for (const key of keys) {\r\n          value = value?.[key];\r\n        }\r\n        return typeof value === 'number' ? value : `'${value}'`;\r\n      });\r\n\r\n      // Use a safe evaluator for basic comparisons\r\n      return this.safeEval(expression);\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  safeEval(expr) {\r\n    // Basic safe evaluator for simple expressions like '>= 5', '== 100', etc.\r\n    // This is still limited but safer than full eval\r\n    const match = expr.match(/^(\\d+)(==|!=|>=|<=|>|<)(\\d+)$/);\r\n    if (match) {\r\n      const [, left, op, right] = match;\r\n      const l = parseInt(left);\r\n      const r = parseInt(right);\r\n      switch (op) {\r\n        case '==': return l == r;\r\n        case '!=': return l != r;\r\n        case '>=': return l >= r;\r\n        case '<=': return l <= r;\r\n        case '>': return l > r;\r\n        case '<': return l < r;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Profile Customization\r\n  setProfileTheme(userId, theme) {\r\n    const validThemes = ['default', 'dark', 'light', 'colorful', 'minimal'];\r\n    if (!validThemes.includes(theme)) {\r\n      return { success: false, reason: 'invalid_theme' };\r\n    }\r\n\r\n    return this.updateProfile(userId, {\r\n      customization: { theme }\r\n    });\r\n  }\r\n\r\n  setProfileTitle(userId, title) {\r\n    if (title.length > 50) {\r\n      return { success: false, reason: 'title_too_long' };\r\n    }\r\n\r\n    return this.updateProfile(userId, { title });\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const profileManager = new ProfileManager();\r\n\r\n// Convenience functions\r\nexport function getOrCreateProfile(userId, username) {\r\n  return profileManager.getOrCreateProfile(userId, username);\r\n}\r\n\r\nexport function updateProfile(userId, updates) {\r\n  return profileManager.updateProfile(userId, updates);\r\n}\r\n\r\nexport function updateStatistics(userId, category, statUpdates) {\r\n  return profileManager.updateStatistics(userId, category, statUpdates);\r\n}\r\n\r\nexport function awardBadge(userId, badgeId, badgeData) {\r\n  return profileManager.awardBadge(userId, badgeId, badgeData);\r\n}\r\n\r\nexport function getProfileAnalytics(userId) {\r\n  return profileManager.getProfileAnalytics(userId);\r\n}\r\n\r\nexport function compareProfiles(userId1, userId2) {\r\n  return profileManager.compareProfiles(userId1, userId2);\r\n}\r\n\r\nexport function searchProfiles(searchTerm, limit = 10) {\r\n  return profileManager.searchProfiles(searchTerm, limit);\r\n}\r\n\r\nexport function getLeaderboard(category, stat, limit = 10) {\r\n  return profileManager.getLeaderboard(category, stat, limit);\r\n}\r\n\r\nexport function exportProfile(userId) {\r\n  return profileManager.exportProfile(userId);\r\n}\r\n\r\nexport function importProfile(userId, profileData) {\r\n  return profileManager.importProfile(userId, profileData);\r\n}\r\n\r\nexport function generateProfileInsights(userId) {\r\n  return profileManager.generateProfileInsights(userId);\r\n}\r\n\r\nexport function checkMilestones(userId) {\r\n  return profileManager.checkMilestones(userId);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\rpg.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":25,"fix":{"range":[46,46],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"no-unused-vars","severity":1,"message":"'inputValidator' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":24},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":11,"column":13,"nodeType":"Literal","messageId":"error","endLine":11,"endColumn":17,"suggestions":[{"messageId":"remove","fix":{"range":[408,415],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[411,415],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":23,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":23,"endColumn":20,"fix":{"range":[928,936],"text":"0xFF_00_00"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":31,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":31,"endColumn":20,"fix":{"range":[1268,1276],"text":"0x99_33_FF"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":39,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":39,"endColumn":20,"fix":{"range":[1601,1609],"text":"0x33_33_33"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":47,"column":12,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":47,"endColumn":20,"fix":{"range":[1955,1963],"text":"0xFF_D7_00"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'readAll' has too many lines (89). Maximum allowed is 50.","line":55,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":143,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Function 'readAll' has too many statements (70). Maximum allowed is 30.","line":55,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":143,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'readAll' has a complexity of 56. Maximum allowed is 10.","line":55,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":143,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 140 to the 15 allowed.","line":55,"column":10,"nodeType":null,"messageId":"refactorFunction","endLine":55,"endColumn":17},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":63,"column":59,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":63,"endColumn":65,"fix":{"range":[2363,2371],"text":""}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":64,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":64,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2388,2485],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":67,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":67,"endColumn":19,"fix":{"range":[2590,2620],"text":"char.xp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":68,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":68,"endColumn":19,"fix":{"range":[2648,2679],"text":"char.lvl === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":69,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":69,"endColumn":19,"fix":{"range":[2727,2766],"text":"char.skillPoints === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":70,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":70,"endColumn":19,"fix":{"range":[2803,2833],"text":"char.hp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":71,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":71,"endColumn":19,"fix":{"range":[2862,2895],"text":"char.maxHp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":72,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":72,"endColumn":19,"fix":{"range":[2927,2957],"text":"char.mp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":73,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":73,"endColumn":19,"fix":{"range":[2986,3019],"text":"char.maxMp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":74,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":74,"endColumn":19,"fix":{"range":[3051,3082],"text":"char.atk === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":75,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":75,"endColumn":19,"fix":{"range":[3111,3142],"text":"char.def === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":76,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":76,"endColumn":19,"fix":{"range":[3171,3202],"text":"char.spd === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":77,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":77,"endColumn":19,"fix":{"range":[3231,3264],"text":"char.class === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":78,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":78,"endColumn":19,"fix":{"range":[3303,3340],"text":"char.abilities === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":79,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":79,"endColumn":19,"fix":{"range":[3453,3486],"text":"char.color === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":80,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":80,"endColumn":19,"fix":{"range":[3587,3624],"text":"char.inventory === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":81,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":81,"endColumn":19,"fix":{"range":[3660,3703],"text":"char.equipped_weapon === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":81,"column":81,"nodeType":"Literal","messageId":"error","endLine":81,"endColumn":85,"suggestions":[{"messageId":"replace","fix":{"range":[3728,3732],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":82,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":82,"endColumn":19,"fix":{"range":[3747,3789],"text":"char.equipped_armor === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":82,"column":79,"nodeType":"Literal","messageId":"error","endLine":82,"endColumn":83,"suggestions":[{"messageId":"replace","fix":{"range":[3813,3817],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":83,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":83,"endColumn":19,"fix":{"range":[3832,3864],"text":"char.gold === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":84,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":84,"endColumn":19,"fix":{"range":[3894,3939],"text":"char.dailyExplorations === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":85,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":85,"endColumn":19,"fix":{"range":[3982,4024],"text":"char.lastDailyReset === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":86,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":86,"endColumn":19,"fix":{"range":[4073,4116],"text":"char.sessionXpGained === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":87,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":87,"endColumn":19,"fix":{"range":[4157,4201],"text":"char.lastSessionReset === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":88,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":88,"endColumn":19,"fix":{"range":[4252,4289],"text":"char.createdAt === undefined"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":89,"column":9,"nodeType":"MemberExpression","endLine":89,"endColumn":20},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found writeFileSync from package \"fs\" with non literal argument at index 0","line":93,"column":9,"nodeType":"CallExpression","endLine":93,"endColumn":69},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":93,"column":52,"nodeType":"Literal","messageId":"error","endLine":93,"endColumn":56,"suggestions":[{"messageId":"replace","fix":{"range":[4545,4549],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found renameSync from package \"fs\" with non literal argument at index 0,1","line":94,"column":9,"nodeType":"CallExpression","endLine":94,"endColumn":37},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":99,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":99,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4738,4805],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":99,"column":19,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":99,"endColumn":72,"fix":{"range":[4750,4803],"text":"'[RPG DEBUG] Migration completed, old file backed up'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":100,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":100,"endColumn":6,"fix":{"range":[4812,4812],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":100,"column":14,"nodeType":"Identifier","messageId":"catch-error-name","endLine":100,"endColumn":17,"fix":{"range":[4820,4886],"text":"error) {\r\n      console.error('Failed to migrate old RPG data:', error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":101,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":101,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[4834,4888],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":111,"column":33,"nodeType":"CallExpression","endLine":111,"endColumn":86},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":111,"column":79,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":111,"endColumn":85,"fix":{"range":[5243,5251],"text":""}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":113,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":113,"endColumn":19,"fix":{"range":[5333,5363],"text":"char.xp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":114,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":114,"endColumn":19,"fix":{"range":[5391,5422],"text":"char.lvl === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":115,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":115,"endColumn":19,"fix":{"range":[5470,5509],"text":"char.skillPoints === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":116,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":116,"endColumn":19,"fix":{"range":[5546,5576],"text":"char.hp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":117,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":117,"endColumn":19,"fix":{"range":[5605,5638],"text":"char.maxHp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":118,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":118,"endColumn":19,"fix":{"range":[5670,5700],"text":"char.mp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":119,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":119,"endColumn":19,"fix":{"range":[5729,5762],"text":"char.maxMp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":120,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":120,"endColumn":19,"fix":{"range":[5794,5825],"text":"char.atk === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":121,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":121,"endColumn":19,"fix":{"range":[5854,5885],"text":"char.def === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":122,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":122,"endColumn":19,"fix":{"range":[5914,5945],"text":"char.spd === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":123,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":123,"endColumn":19,"fix":{"range":[5974,6007],"text":"char.class === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":124,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":124,"endColumn":19,"fix":{"range":[6046,6083],"text":"char.abilities === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":125,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":125,"endColumn":19,"fix":{"range":[6196,6229],"text":"char.color === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":126,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":126,"endColumn":19,"fix":{"range":[6330,6367],"text":"char.inventory === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":127,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":127,"endColumn":19,"fix":{"range":[6403,6446],"text":"char.equipped_weapon === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":127,"column":81,"nodeType":"Literal","messageId":"error","endLine":127,"endColumn":85,"suggestions":[{"messageId":"replace","fix":{"range":[6471,6475],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":128,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":128,"endColumn":19,"fix":{"range":[6490,6532],"text":"char.equipped_armor === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":128,"column":79,"nodeType":"Literal","messageId":"error","endLine":128,"endColumn":83,"suggestions":[{"messageId":"replace","fix":{"range":[6556,6560],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":129,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":129,"endColumn":19,"fix":{"range":[6575,6607],"text":"char.gold === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":130,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":130,"endColumn":19,"fix":{"range":[6637,6682],"text":"char.dailyExplorations === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":131,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":131,"endColumn":19,"fix":{"range":[6725,6767],"text":"char.lastDailyReset === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":132,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":132,"endColumn":19,"fix":{"range":[6816,6859],"text":"char.sessionXpGained === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":133,"column":13,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":133,"endColumn":19,"fix":{"range":[6900,6944],"text":"char.lastSessionReset === undefined"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":134,"column":9,"nodeType":"MemberExpression","endLine":134,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":135,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":135,"endColumn":8,"fix":{"range":[7019,7019],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":135,"column":16,"nodeType":"Identifier","messageId":"catch-error-name","endLine":135,"endColumn":19,"fix":{"range":[7027,7104],"text":"error) {\r\n        console.error(`Failed to read player data for ${userId}`, error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":136,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":136,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7043,7106],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":152,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":152,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7435,7495],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found writeFileSync from package \"fs\" with non literal argument at index 0","line":153,"column":7,"nodeType":"CallExpression","endLine":153,"endColumn":67},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":153,"column":50,"nodeType":"Literal","messageId":"error","endLine":153,"endColumn":54,"suggestions":[{"messageId":"replace","fix":{"range":[7546,7550],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found renameSync from package \"fs\" with non literal argument at index 0,1","line":154,"column":7,"nodeType":"CallExpression","endLine":154,"endColumn":35},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":157,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":157,"endColumn":4,"fix":{"range":[7631,7631],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":157,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":157,"endColumn":15,"fix":{"range":[7639,7901],"text":"error) {\r\n    console.error('Failed to write RPG data:', error);\r\n    // Attempt to restore from cache if available\r\n    if (cache) {\r\n      console.log('Restoring from cache after write failure');\r\n    } else {\r\n      throw new Error(`Failed to save RPG data: ${error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":158,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":158,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7651,7699],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":161,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":161,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[7776,7832],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":162,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":162,"endColumn":6,"fix":{"range":[7839,7839],"text":"\n"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'createCharacter' has too many lines (58). Maximum allowed is 50.","line":168,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":225,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'createCharacter' has a complexity of 11. Maximum allowed is 10.","line":168,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":225,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":169,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":169,"endColumn":4,"fix":{"range":[8004,8007],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":170,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":170,"endColumn":4,"fix":{"range":[8027,8030],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":171,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":171,"endColumn":6,"fix":{"range":[8076,8081],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":172,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":172,"endColumn":4,"fix":{"range":[8145,8148],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":174,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":174,"endColumn":4,"fix":{"range":[8153,8156],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":175,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":175,"endColumn":4,"fix":{"range":[8232,8235],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":176,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":176,"endColumn":4,"fix":{"range":[8323,8326],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":177,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":177,"endColumn":6,"fix":{"range":[8356,8361],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":178,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":178,"endColumn":4,"fix":{"range":[8429,8432],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":180,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":180,"endColumn":4,"fix":{"range":[8437,8440],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":181,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":181,"endColumn":4,"fix":{"range":[8469,8472],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":182,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":182,"endColumn":6,"fix":{"range":[8524,8529],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":183,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":183,"endColumn":4,"fix":{"range":[8601,8604],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":185,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":185,"endColumn":4,"fix":{"range":[8609,8612],"text":"  "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":185,"column":22,"nodeType":"MemberExpression","endLine":185,"endColumn":50},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":186,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":186,"endColumn":4,"fix":{"range":[8661,8664],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":187,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":187,"endColumn":6,"fix":{"range":[8683,8688],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":188,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":188,"endColumn":4,"fix":{"range":[8824,8827],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":190,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":190,"endColumn":4,"fix":{"range":[8832,8835],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":191,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":191,"endColumn":6,"fix":{"range":[8861,8866],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":192,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":192,"endColumn":4,"fix":{"range":[8949,8952],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":194,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":194,"endColumn":4,"fix":{"range":[8957,8960],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":195,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":195,"endColumn":4,"fix":{"range":[8980,8983],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":196,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":196,"endColumn":6,"fix":{"range":[8990,8995],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":197,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":197,"endColumn":6,"fix":{"range":[9028,9033],"text":"    "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":197,"column":10,"nodeType":"MemberExpression","endLine":197,"endColumn":21},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":198,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":198,"endColumn":8,"fix":{"range":[9053,9060],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":199,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":199,"endColumn":6,"fix":{"range":[9145,9150],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":201,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":201,"endColumn":6,"fix":{"range":[9155,9160],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":202,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":202,"endColumn":8,"fix":{"range":[9176,9183],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":203,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":203,"endColumn":8,"fix":{"range":[9205,9212],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":204,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":204,"endColumn":8,"fix":{"range":[9231,9238],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":205,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":205,"endColumn":8,"fix":{"range":[9263,9270],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":206,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":206,"endColumn":8,"fix":{"range":[9279,9286],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":207,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":207,"endColumn":8,"fix":{"range":[9294,9301],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":208,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":208,"endColumn":8,"fix":{"range":[9318,9325],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":209,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":209,"endColumn":8,"fix":{"range":[9363,9370],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":210,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":210,"endColumn":8,"fix":{"range":[9395,9402],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":211,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":211,"endColumn":8,"fix":{"range":[9418,9425],"text":"      "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":211,"column":25,"nodeType":"Literal","messageId":"error","endLine":211,"endColumn":29,"suggestions":[{"messageId":"replace","fix":{"range":[9442,9446],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":212,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":212,"endColumn":8,"fix":{"range":[9449,9456],"text":"      "}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":212,"column":24,"nodeType":"Literal","messageId":"error","endLine":212,"endColumn":28,"suggestions":[{"messageId":"replace","fix":{"range":[9472,9476],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":213,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":213,"endColumn":8,"fix":{"range":[9479,9486],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 7.","line":214,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":214,"endColumn":8,"fix":{"range":[9496,9503],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":215,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":215,"endColumn":6,"fix":{"range":[9526,9531],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":217,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":217,"endColumn":6,"fix":{"range":[9537,9542],"text":"    "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":6,"nodeType":"MemberExpression","endLine":217,"endColumn":17},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":218,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":218,"endColumn":6,"fix":{"range":[9563,9568],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":220,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":220,"endColumn":6,"fix":{"range":[9586,9591],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":221,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":221,"endColumn":6,"fix":{"range":[9677,9682],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":222,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":222,"endColumn":4,"fix":{"range":[9696,9699],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":222,"column":4,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":222,"endColumn":5,"fix":{"range":[9700,9700],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 5.","line":223,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":223,"endColumn":6,"fix":{"range":[9712,9717],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":224,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":224,"endColumn":4,"fix":{"range":[9740,9743],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":247,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":247,"endColumn":4,"fix":{"range":[10530,10530],"text":"\n"}},{"ruleId":"max-statements","severity":1,"message":"Function 'getCharacter' has too many statements (34). Maximum allowed is 30.","line":258,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":306,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'getCharacter' has a complexity of 30. Maximum allowed is 10.","line":258,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":306,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 27 to the 15 allowed.","line":258,"column":17,"nodeType":null,"messageId":"refactorFunction","endLine":258,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":260,"column":16,"nodeType":"MemberExpression","endLine":260,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":261,"column":12,"nodeType":"MemberExpression","endLine":261,"endColumn":25},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":267,"column":8,"nodeType":"CallExpression","endLine":267,"endColumn":31},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":267,"column":40,"nodeType":"Literal","messageId":"error","endLine":267,"endColumn":44,"suggestions":[{"messageId":"remove","fix":{"range":[11109,11113],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[11109,11113],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":270,"column":29,"nodeType":"CallExpression","endLine":270,"endColumn":62},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":270,"column":55,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":270,"endColumn":61,"fix":{"range":[11179,11187],"text":""}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":272,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":272,"endColumn":15,"fix":{"range":[11261,11291],"text":"char.xp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":273,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":273,"endColumn":15,"fix":{"range":[11315,11346],"text":"char.lvl === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":274,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":274,"endColumn":15,"fix":{"range":[11390,11429],"text":"char.skillPoints === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":275,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":275,"endColumn":15,"fix":{"range":[11462,11492],"text":"char.hp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":276,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":276,"endColumn":15,"fix":{"range":[11517,11550],"text":"char.maxHp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":277,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":277,"endColumn":15,"fix":{"range":[11578,11608],"text":"char.mp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":278,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":278,"endColumn":15,"fix":{"range":[11633,11666],"text":"char.maxMp === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":279,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":279,"endColumn":15,"fix":{"range":[11694,11725],"text":"char.atk === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":280,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":280,"endColumn":15,"fix":{"range":[11750,11781],"text":"char.def === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":281,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":281,"endColumn":15,"fix":{"range":[11806,11837],"text":"char.spd === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":282,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":282,"endColumn":15,"fix":{"range":[11862,11895],"text":"char.class === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":283,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":283,"endColumn":15,"fix":{"range":[11930,11967],"text":"char.abilities === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":284,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":284,"endColumn":15,"fix":{"range":[12076,12109],"text":"char.color === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":285,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":285,"endColumn":15,"fix":{"range":[12206,12243],"text":"char.inventory === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":286,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":286,"endColumn":15,"fix":{"range":[12275,12318],"text":"char.equipped_weapon === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":286,"column":77,"nodeType":"Literal","messageId":"error","endLine":286,"endColumn":81,"suggestions":[{"messageId":"replace","fix":{"range":[12343,12347],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":287,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":287,"endColumn":15,"fix":{"range":[12358,12400],"text":"char.equipped_armor === undefined"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":287,"column":75,"nodeType":"Literal","messageId":"error","endLine":287,"endColumn":79,"suggestions":[{"messageId":"replace","fix":{"range":[12424,12428],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":288,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":288,"endColumn":15,"fix":{"range":[12439,12471],"text":"char.gold === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":289,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":289,"endColumn":15,"fix":{"range":[12497,12542],"text":"char.dailyExplorations === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":290,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":290,"endColumn":15,"fix":{"range":[12581,12623],"text":"char.lastDailyReset === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":291,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":291,"endColumn":15,"fix":{"range":[12668,12711],"text":"char.sessionXpGained === undefined"}},{"ruleId":"unicorn/no-typeof-undefined","severity":2,"message":"Compare with `undefined` directly instead of using `typeof`.","line":292,"column":9,"nodeType":"BinaryExpression","messageId":"no-typeof-undefined/error","endLine":292,"endColumn":15,"fix":{"range":[12748,12792],"text":"char.lastSessionReset === undefined"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":296,"column":7,"nodeType":"MemberExpression","endLine":296,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":297,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":297,"endColumn":6,"fix":{"range":[12906,12906],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (1094). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":1095,"endColumn":1},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":302,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":302,"endColumn":4,"fix":{"range":[12980,12980],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":302,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":302,"endColumn":15,"fix":{"range":[12988,13064],"text":"error) {\r\n    console.error(`Failed to read character data for ${userId}`, error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":303,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":303,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[13000,13066],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":304,"column":12,"nodeType":"Literal","messageId":"error","endLine":304,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[13079,13083],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[13079,13083],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":310,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":310,"endColumn":17,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[13175,13250],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":319,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":319,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[13470,13533],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found writeFileSync from package \"fs\" with non literal argument at index 0","line":320,"column":5,"nodeType":"CallExpression","endLine":320,"endColumn":65},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":320,"column":48,"nodeType":"Literal","messageId":"error","endLine":320,"endColumn":52,"suggestions":[{"messageId":"replace","fix":{"range":[13582,13586],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found renameSync from package \"fs\" with non literal argument at index 0,1","line":321,"column":5,"nodeType":"CallExpression","endLine":321,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":325,"column":7,"nodeType":"MemberExpression","endLine":325,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":328,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":328,"endColumn":4,"fix":{"range":[13748,13748],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":338,"column":33,"nodeType":"Literal","messageId":"error","endLine":338,"endColumn":37,"suggestions":[{"messageId":"remove","fix":{"range":[13967,13971],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[13967,13971],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":343,"column":23,"nodeType":"MemberExpression","endLine":343,"endColumn":51},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":354,"column":24,"nodeType":"Literal","messageId":"error","endLine":354,"endColumn":28,"suggestions":[{"messageId":"replace","fix":{"range":[14387,14391],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":355,"column":23,"nodeType":"Literal","messageId":"error","endLine":355,"endColumn":27,"suggestions":[{"messageId":"replace","fix":{"range":[14416,14420],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":358,"column":5,"nodeType":"MemberExpression","endLine":358,"endColumn":16},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":361,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":361,"endColumn":4,"fix":{"range":[14510,14510],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":372,"column":10,"nodeType":"MemberExpression","endLine":372,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":373,"column":12,"nodeType":"MemberExpression","endLine":373,"endColumn":23},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":376,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":376,"endColumn":4,"fix":{"range":[14815,14815],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 124. Maximum allowed is 120.","line":383,"column":1,"nodeType":"Program","messageId":"max","endLine":383,"endColumn":125},{"ruleId":"max-len","severity":2,"message":"This line has a length of 130. Maximum allowed is 120.","line":384,"column":1,"nodeType":"Program","messageId":"max","endLine":384,"endColumn":131},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":384,"column":22,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":384,"endColumn":23,"fix":{"range":[15105,15105],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 4 statements. Maximum allowed is 2.","line":384,"column":67,"nodeType":"IfStatement","messageId":"exceed","endLine":384,"endColumn":105},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":384,"column":128,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":384,"endColumn":129,"fix":{"range":[15210,15210],"text":"\n"}},{"ruleId":"sonarjs/prefer-immediate-return","severity":2,"message":"Immediately return this expression instead of assigning it to the temporary variable \"monster\".","line":394,"column":19,"nodeType":"ObjectExpression","messageId":"doImmediateAction","endLine":394,"endColumn":82,"fix":{"range":[15428,15526],"text":"return { name: `Goblin L${lvl}`, hp: 10 + lvl * 3, atk: 3 + lvl, lvl }"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":425,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":425,"endColumn":4,"fix":{"range":[16553,16553],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":425,"column":12,"nodeType":"Identifier","messageId":"catch-error-name","endLine":425,"endColumn":15,"fix":{"range":[16561,16610],"text":"error) {\r\n    console.error('Narration failed', error"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":426,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":426,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[16573,16612],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":441,"column":10,"nodeType":"MemberExpression","endLine":441,"endColumn":38},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":441,"column":42,"nodeType":"Literal","messageId":"error","endLine":441,"endColumn":46,"suggestions":[{"messageId":"replace","fix":{"range":[16969,16973],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":509,"column":20,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":509,"endColumn":28,"fix":{"range":[20772,20780],"text":"0x8B_8B_8B"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":510,"column":22,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":510,"endColumn":30,"fix":{"range":[20818,20826],"text":"0x4C_AF_50"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":511,"column":18,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":511,"endColumn":26,"fix":{"range":[20860,20868],"text":"0x21_96_F3"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":512,"column":23,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":512,"endColumn":31,"fix":{"range":[20907,20915],"text":"0xFF_98_00"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":526,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":526,"endColumn":4,"fix":{"range":[21355,21355],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":548,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":548,"endColumn":17,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"warn"},"fix":{"range":[22015,22128],"text":""},"desc":"Remove the console.warn()."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":565,"column":10,"nodeType":"MemberExpression","endLine":565,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":569,"column":10,"nodeType":"MemberExpression","endLine":569,"endColumn":23},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":569,"column":27,"nodeType":"Literal","messageId":"error","endLine":569,"endColumn":31,"suggestions":[{"messageId":"replace","fix":{"range":[22860,22864],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":573,"column":10,"nodeType":"MemberExpression","endLine":573,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":579,"column":16,"nodeType":"MemberExpression","endLine":579,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":584,"column":3,"nodeType":"MemberExpression","endLine":584,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":584,"column":29,"nodeType":"MemberExpression","endLine":584,"endColumn":51},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":592,"column":16,"nodeType":"MemberExpression","endLine":592,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":595,"column":27,"nodeType":"MemberExpression","endLine":595,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":597,"column":27,"nodeType":"MemberExpression","endLine":597,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":600,"column":3,"nodeType":"MemberExpression","endLine":600,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":601,"column":7,"nodeType":"MemberExpression","endLine":601,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":601,"column":43,"nodeType":"MemberExpression","endLine":601,"endColumn":65},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":609,"column":16,"nodeType":"MemberExpression","endLine":609,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":621,"column":18,"nodeType":"MemberExpression","endLine":621,"endColumn":31},{"ruleId":"complexity","severity":2,"message":"Function 'useConsumableItem' has a complexity of 11. Maximum allowed is 10.","line":630,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":671,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":631,"column":16,"nodeType":"MemberExpression","endLine":631,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":637,"column":16,"nodeType":"MemberExpression","endLine":637,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":642,"column":27,"nodeType":"MemberExpression","endLine":642,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":666,"column":3,"nodeType":"MemberExpression","endLine":666,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":667,"column":7,"nodeType":"MemberExpression","endLine":667,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":667,"column":43,"nodeType":"MemberExpression","endLine":667,"endColumn":65},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'equipItem' has too many lines (51). Maximum allowed is 50.","line":673,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":723,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'equipItem' has a complexity of 21. Maximum allowed is 10.","line":673,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":723,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":674,"column":16,"nodeType":"MemberExpression","endLine":674,"endColumn":29},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":680,"column":16,"nodeType":"MemberExpression","endLine":680,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":683,"column":27,"nodeType":"MemberExpression","endLine":683,"endColumn":49},{"ruleId":"complexity","severity":2,"message":"Function 'unequipItem' has a complexity of 13. Maximum allowed is 10.","line":725,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":759,"endColumn":2},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":727,"column":16,"nodeType":"MemberExpression","endLine":727,"endColumn":27},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":731,"column":16,"nodeType":"Literal","messageId":"error","endLine":731,"endColumn":20,"suggestions":[{"messageId":"remove","fix":{"range":[27454,27461],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[27457,27461],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":734,"column":9,"nodeType":"MemberExpression","endLine":734,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":735,"column":19,"nodeType":"MemberExpression","endLine":735,"endColumn":32},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":737,"column":28,"nodeType":"Literal","messageId":"error","endLine":737,"endColumn":32,"suggestions":[{"messageId":"replace","fix":{"range":[27655,27659],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":738,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":738,"endColumn":4,"fix":{"range":[27665,27665],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":740,"column":9,"nodeType":"MemberExpression","endLine":740,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":741,"column":19,"nodeType":"MemberExpression","endLine":741,"endColumn":32},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":743,"column":27,"nodeType":"Literal","messageId":"error","endLine":743,"endColumn":31,"suggestions":[{"messageId":"replace","fix":{"range":[27856,27860],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":744,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":744,"endColumn":4,"fix":{"range":[27866,27866],"text":"\n"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":767,"column":18,"nodeType":"MemberExpression","endLine":767,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":780,"column":10,"nodeType":"MemberExpression","endLine":780,"endColumn":31},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":780,"column":35,"nodeType":"MemberExpression","endLine":780,"endColumn":56},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":792,"column":18,"nodeType":"MemberExpression","endLine":792,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'inventory' is assigned a value but never used.","line":796,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":796,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'xpResult' is assigned a value but never used.","line":816,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":816,"endColumn":17},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":823,"column":11,"nodeType":"MemberExpression","endLine":823,"endColumn":24},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":835,"column":7,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":835,"endColumn":8,"fix":{"range":[30923,30923],"text":"\n"}},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":835,"column":46,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":835,"endColumn":52,"fix":{"range":[30959,30967],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":835,"column":62,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":835,"endColumn":63,"fix":{"range":[30978,30978],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":835,"column":62,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":835,"endColumn":63,"fix":{"range":[30977,30977],"text":"\n"}},{"ruleId":"unicorn/prefer-optional-catch-binding","severity":2,"message":"Remove unused catch binding `error`.","line":835,"column":71,"nodeType":"Identifier","messageId":"with-name","endLine":835,"endColumn":76,"fix":{"range":[30985,30993],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":835,"column":78,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":835,"endColumn":79,"fix":{"range":[30994,30994],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":835,"column":80,"nodeType":"ReturnStatement","messageId":"exceed","endLine":835,"endColumn":90},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":835,"column":91,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":835,"endColumn":92,"fix":{"range":[31006,31006],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":841,"column":41,"nodeType":"Literal","messageId":"error","endLine":841,"endColumn":45,"suggestions":[{"messageId":"replace","fix":{"range":[31235,31239],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":846,"column":3,"nodeType":"MemberExpression","endLine":846,"endColumn":14},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":846,"column":17,"nodeType":"MemberExpression","endLine":846,"endColumn":28},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":848,"column":3,"nodeType":"MemberExpression","endLine":848,"endColumn":14},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":870,"column":22,"nodeType":"MemberExpression","endLine":870,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":873,"column":5,"nodeType":"MemberExpression","endLine":873,"endColumn":22},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":874,"column":5,"nodeType":"MemberExpression","endLine":874,"endColumn":16},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":883,"column":10,"nodeType":"MemberExpression","endLine":883,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":922,"column":15,"nodeType":"MemberExpression","endLine":922,"endColumn":26},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":924,"column":18,"nodeType":"Literal","messageId":"error","endLine":924,"endColumn":22,"suggestions":[{"messageId":"remove","fix":{"range":[34372,34376],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[34372,34376],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'spendSkillPoints' has too many lines (72). Maximum allowed is 50.","line":946,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":1017,"endColumn":2},{"ruleId":"max-statements","severity":1,"message":"Function 'spendSkillPoints' has too many statements (41). Maximum allowed is 30.","line":946,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":1017,"endColumn":2},{"ruleId":"complexity","severity":2,"message":"Function 'spendSkillPoints' has a complexity of 30. Maximum allowed is 10.","line":946,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":1017,"endColumn":2},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 3.","line":947,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":947,"endColumn":4,"fix":{"range":[34986,34989],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":948,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":948,"endColumn":5,"fix":{"range":[35009,35013],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":949,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":949,"endColumn":7,"fix":{"range":[35059,35065],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":950,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":950,"endColumn":5,"fix":{"range":[35129,35133],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":952,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":952,"endColumn":5,"fix":{"range":[35138,35142],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":953,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":953,"endColumn":7,"fix":{"range":[35184,35190],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":954,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":954,"endColumn":5,"fix":{"range":[35261,35265],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":956,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":956,"endColumn":5,"fix":{"range":[35270,35274],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":957,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":957,"endColumn":5,"fix":{"range":[35377,35381],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":958,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":958,"endColumn":7,"fix":{"range":[35413,35419],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":959,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":959,"endColumn":5,"fix":{"range":[35489,35493],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":961,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":961,"endColumn":5,"fix":{"range":[35498,35502],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":962,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":962,"endColumn":5,"fix":{"range":[35525,35529],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":963,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":963,"endColumn":5,"fix":{"range":[35602,35606],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":964,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":964,"endColumn":7,"fix":{"range":[35641,35647],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":965,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":965,"endColumn":5,"fix":{"range":[35750,35754],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":967,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":967,"endColumn":5,"fix":{"range":[35759,35763],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":968,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":968,"endColumn":7,"fix":{"range":[35789,35795],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":969,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":969,"endColumn":5,"fix":{"range":[35876,35880],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":971,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":971,"endColumn":5,"fix":{"range":[35885,35889],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":972,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":972,"endColumn":5,"fix":{"range":[35909,35913],"text":"  "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":973,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":973,"endColumn":7,"fix":{"range":[35920,35926],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":974,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":974,"endColumn":7,"fix":{"range":[35959,35965],"text":"    "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":974,"column":20,"nodeType":"MemberExpression","endLine":974,"endColumn":31},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":976,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":976,"endColumn":7,"fix":{"range":[35994,36000],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":977,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":977,"endColumn":9,"fix":{"range":[36014,36022],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":978,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":978,"endColumn":7,"fix":{"range":[36083,36089],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":980,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":980,"endColumn":7,"fix":{"range":[36094,36100],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":981,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":981,"endColumn":7,"fix":{"range":[36136,36142],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":982,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":982,"endColumn":9,"fix":{"range":[36163,36171],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":983,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":983,"endColumn":7,"fix":{"range":[36276,36282],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":985,"column":1,"nodeType":"Line","messageId":"wrongIndentation","endLine":985,"endColumn":7,"fix":{"range":[36287,36293],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":986,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":986,"endColumn":7,"fix":{"range":[36332,36338],"text":"    "}},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":986,"column":7,"nodeType":null,"messageId":"prefer-switch","endLine":986,"endColumn":26,"fix":{"range":[36338,37258],"text":"switch (stat) {\n      case 'hp': {\r\n        const currentHp = char.hp || 0;\r\n        const maxHp = char.maxHp || 20;\r\n        char.hp = Math.min(currentHp + amount * 2, maxHp);\r\n      \n      break;\n      }\n      case 'maxhp': {\r\n        char.maxHp = (char.maxHp || 20) + amount * 5;\r\n        char.hp = Math.min((char.hp || 0) + amount * 2, char.maxHp);\r\n      \n      break;\n      }\n      case 'mp': {\r\n        const currentMp = char.mp || 0;\r\n        const maxMp = char.maxMp || 10;\r\n        char.mp = Math.min(currentMp + amount * 3, maxMp);\r\n      \n      break;\n      }\n      case 'maxmp': {\r\n        char.maxMp = (char.maxMp || 10) + amount * 5;\r\n        char.mp = Math.min((char.mp || 0) + amount * 3, char.maxMp);\r\n      \n      break;\n      }\n      case 'atk': {\r\n        char.atk = (char.atk || 5) + amount;\r\n      \n      break;\n      }\n      case 'def': {\r\n        char.def = (char.def || 2) + amount;\r\n      \n      break;\n      }\n      case 'spd': {\r\n        char.spd = (char.spd || 2) + amount;\r\n      \n      break;\n      }\n      // No default\n      }"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":987,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":987,"endColumn":9,"fix":{"range":[36360,36368],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":988,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":988,"endColumn":9,"fix":{"range":[36401,36409],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":989,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":989,"endColumn":9,"fix":{"range":[36442,36450],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":990,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":990,"endColumn":7,"fix":{"range":[36502,36508],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":990,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":990,"endColumn":8,"fix":{"range":[36509,36509],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":991,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":991,"endColumn":9,"fix":{"range":[36540,36548],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":992,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":992,"endColumn":9,"fix":{"range":[36595,36603],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":993,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":993,"endColumn":7,"fix":{"range":[36665,36671],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":993,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":993,"endColumn":8,"fix":{"range":[36672,36672],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":994,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":994,"endColumn":9,"fix":{"range":[36700,36708],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":995,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":995,"endColumn":9,"fix":{"range":[36741,36749],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":996,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":996,"endColumn":9,"fix":{"range":[36782,36790],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":997,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":997,"endColumn":7,"fix":{"range":[36842,36848],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":997,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":997,"endColumn":8,"fix":{"range":[36849,36849],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":998,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":998,"endColumn":9,"fix":{"range":[36880,36888],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":999,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":999,"endColumn":9,"fix":{"range":[36935,36943],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1000,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1000,"endColumn":7,"fix":{"range":[37005,37011],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1000,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1000,"endColumn":8,"fix":{"range":[37012,37012],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":1001,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1001,"endColumn":9,"fix":{"range":[37041,37049],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1002,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1002,"endColumn":7,"fix":{"range":[37087,37093],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1002,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1002,"endColumn":8,"fix":{"range":[37094,37094],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":1003,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1003,"endColumn":9,"fix":{"range":[37123,37131],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1004,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1004,"endColumn":7,"fix":{"range":[37169,37175],"text":"    "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1004,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1004,"endColumn":8,"fix":{"range":[37176,37176],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 6 spaces but found 8.","line":1005,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1005,"endColumn":9,"fix":{"range":[37205,37213],"text":"      "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1006,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1006,"endColumn":7,"fix":{"range":[37251,37257],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1008,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1008,"endColumn":7,"fix":{"range":[37262,37268],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1009,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1009,"endColumn":7,"fix":{"range":[37302,37308],"text":"    "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":1009,"column":7,"nodeType":"MemberExpression","endLine":1009,"endColumn":18},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1010,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1010,"endColumn":7,"fix":{"range":[37329,37335],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1012,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1012,"endColumn":7,"fix":{"range":[37353,37359],"text":"    "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":1012,"column":75,"nodeType":"MemberExpression","endLine":1012,"endColumn":85},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1013,"column":1,"nodeType":"Keyword","messageId":"wrongIndentation","endLine":1013,"endColumn":7,"fix":{"range":[37443,37449],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":1014,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1014,"endColumn":5,"fix":{"range":[37482,37486],"text":"  "}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":1014,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":1014,"endColumn":6,"fix":{"range":[37487,37487],"text":"\n"}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 4 spaces but found 6.","line":1015,"column":1,"nodeType":"Identifier","messageId":"wrongIndentation","endLine":1015,"endColumn":7,"fix":{"range":[37499,37505],"text":"    "}},{"ruleId":"indent","severity":2,"message":"Expected indentation of 2 spaces but found 4.","line":1016,"column":1,"nodeType":"Punctuator","messageId":"wrongIndentation","endLine":1016,"endColumn":5,"fix":{"range":[37528,37532],"text":"  "}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":1022,"column":16,"nodeType":"MemberExpression","endLine":1022,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":1051,"column":16,"nodeType":"MemberExpression","endLine":1051,"endColumn":27},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":1069,"column":16,"nodeType":"MemberExpression","endLine":1069,"endColumn":27}],"suppressedMessages":[],"errorCount":264,"fatalErrorCount":0,"warningCount":93,"fixableErrorCount":225,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { generate } from './model-client.js';\r\nimport { logger } from './logger.js';\r\nimport { inputValidator, sanitizeInput, validateString, validateNumber } from './validation.js';\r\nimport { CommandError } from './errorHandler.js';\r\n\r\nconst PLAYERS_DIR = path.join(process.cwd(), 'data', 'players');\r\n\r\n// in-memory cache to reduce fs reads/writes\r\nlet cache = null;\r\n// simple per-user locks to avoid concurrent writes\r\nconst locks = new Set();\r\n\r\n// Character classes with unique abilities and stat bonuses\r\nconst CHARACTER_CLASSES = {\r\n  warrior: {\r\n    name: 'Warrior',\r\n    description: 'Strong melee fighter with high HP and defense',\r\n    baseStats: { hp: 25, maxHp: 25, mp: 10, maxMp: 10, atk: 7, def: 3, spd: 1 },\r\n    statGrowth: { hp: 3, maxHp: 3, mp: 1, maxMp: 1, atk: 2, def: 1, spd: 0 },\r\n    abilities: ['Power Strike', 'Shield Block', 'Battle Cry'],\r\n    color: 0xFF0000\r\n  },\r\n  mage: {\r\n    name: 'Mage',\r\n    description: 'Powerful spellcaster with magic attacks',\r\n    baseStats: { hp: 15, maxHp: 15, mp: 30, maxMp: 30, atk: 10, def: 1, spd: 2 },\r\n    statGrowth: { hp: 1, maxHp: 1, mp: 4, maxMp: 4, atk: 3, def: 0, spd: 1 },\r\n    abilities: ['Fireball', 'Magic Shield', 'Mana Surge'],\r\n    color: 0x9933FF\r\n  },\r\n  rogue: {\r\n    name: 'Rogue',\r\n    description: 'Fast and agile with critical strike chance',\r\n    baseStats: { hp: 18, maxHp: 18, mp: 15, maxMp: 15, atk: 6, def: 2, spd: 4 },\r\n    statGrowth: { hp: 2, maxHp: 2, mp: 2, maxMp: 2, atk: 2, def: 1, spd: 2 },\r\n    abilities: ['Backstab', 'Dodge', 'Sprint'],\r\n    color: 0x333333\r\n  },\r\n  paladin: {\r\n    name: 'Paladin',\r\n    description: 'Holy warrior with healing and protective abilities',\r\n    baseStats: { hp: 22, maxHp: 22, mp: 20, maxMp: 20, atk: 5, def: 4, spd: 1 },\r\n    statGrowth: { hp: 3, maxHp: 3, mp: 3, maxMp: 3, atk: 1, def: 2, spd: 0 },\r\n    abilities: ['Holy Strike', 'Heal', 'Divine Shield'],\r\n    color: 0xFFD700\r\n  }\r\n};\r\n\r\nfunction ensureDir() {\r\n  if (!fs.existsSync(PLAYERS_DIR)) fs.mkdirSync(PLAYERS_DIR, { recursive: true });\r\n}\r\n\r\nfunction readAll() {\r\n  ensureDir();\r\n  const all = {};\r\n\r\n  // Migrate from old data/rpg.json if it exists\r\n  const oldFile = path.join(process.cwd(), 'data', 'rpg.json');\r\n  if (fs.existsSync(oldFile)) {\r\n    try {\r\n      const oldData = JSON.parse(fs.readFileSync(oldFile, 'utf8')) || {};\r\n      console.log(`[RPG DEBUG] Migrating ${Object.keys(oldData).length} characters from old rpg.json`);\r\n      for (const [userId, char] of Object.entries(oldData)) {\r\n        // Ensure defaults\r\n        if (typeof char.xp === 'undefined') char.xp = 0;\r\n        if (typeof char.lvl === 'undefined') char.lvl = levelFromXp(char.xp);\r\n        if (typeof char.skillPoints === 'undefined') char.skillPoints = 0;\r\n        if (typeof char.hp === 'undefined') char.hp = 20;\r\n        if (typeof char.maxHp === 'undefined') char.maxHp = 20;\r\n        if (typeof char.mp === 'undefined') char.mp = 10;\r\n        if (typeof char.maxMp === 'undefined') char.maxMp = 10;\r\n        if (typeof char.atk === 'undefined') char.atk = 5;\r\n        if (typeof char.def === 'undefined') char.def = 2;\r\n        if (typeof char.spd === 'undefined') char.spd = 2;\r\n        if (typeof char.class === 'undefined') char.class = 'warrior';\r\n        if (typeof char.abilities === 'undefined') char.abilities = CHARACTER_CLASSES[char.class]?.abilities || CHARACTER_CLASSES.warrior.abilities;\r\n        if (typeof char.color === 'undefined') char.color = CHARACTER_CLASSES[char.class]?.color || CHARACTER_CLASSES.warrior.color;\r\n        if (typeof char.inventory === 'undefined') char.inventory = {};\r\n        if (typeof char.equipped_weapon === 'undefined') char.equipped_weapon = null;\r\n        if (typeof char.equipped_armor === 'undefined') char.equipped_armor = null;\r\n        if (typeof char.gold === 'undefined') char.gold = 0;\r\n        if (typeof char.dailyExplorations === 'undefined') char.dailyExplorations = 0;\r\n        if (typeof char.lastDailyReset === 'undefined') char.lastDailyReset = Date.now();\r\n        if (typeof char.sessionXpGained === 'undefined') char.sessionXpGained = 0;\r\n        if (typeof char.lastSessionReset === 'undefined') char.lastSessionReset = Date.now();\r\n        if (typeof char.createdAt === 'undefined') char.createdAt = Date.now();\r\n        all[userId] = char;\r\n        // Save to individual file\r\n        const filePath = path.join(PLAYERS_DIR, `${userId}.json`);\r\n        const tmp = `${filePath}.tmp`;\r\n        fs.writeFileSync(tmp, JSON.stringify(char, null, 2), 'utf8');\r\n        fs.renameSync(tmp, filePath);\r\n      }\r\n      // Backup and remove old file\r\n      fs.copyFileSync(oldFile, `${oldFile}.bak`);\r\n      fs.unlinkSync(oldFile);\r\n      console.log(`[RPG DEBUG] Migration completed, old file backed up`);\r\n    } catch (err) {\r\n      console.error('Failed to migrate old RPG data:', err);\r\n    }\r\n  }\r\n\r\n  // Read all player files from data/players/\r\n  if (fs.existsSync(PLAYERS_DIR)) {\r\n    const files = fs.readdirSync(PLAYERS_DIR).filter(f => f.endsWith('.json'));\r\n    for (const file of files) {\r\n      const userId = path.basename(file, '.json');\r\n      try {\r\n        const char = JSON.parse(fs.readFileSync(path.join(PLAYERS_DIR, file), 'utf8')) || {};\r\n        // migrate / ensure defaults for older characters\r\n        if (typeof char.xp === 'undefined') char.xp = 0;\r\n        if (typeof char.lvl === 'undefined') char.lvl = levelFromXp(char.xp);\r\n        if (typeof char.skillPoints === 'undefined') char.skillPoints = 0;\r\n        if (typeof char.hp === 'undefined') char.hp = 20;\r\n        if (typeof char.maxHp === 'undefined') char.maxHp = 20;\r\n        if (typeof char.mp === 'undefined') char.mp = 10;\r\n        if (typeof char.maxMp === 'undefined') char.maxMp = 10;\r\n        if (typeof char.atk === 'undefined') char.atk = 5;\r\n        if (typeof char.def === 'undefined') char.def = 2;\r\n        if (typeof char.spd === 'undefined') char.spd = 2;\r\n        if (typeof char.class === 'undefined') char.class = 'warrior';\r\n        if (typeof char.abilities === 'undefined') char.abilities = CHARACTER_CLASSES[char.class]?.abilities || CHARACTER_CLASSES.warrior.abilities;\r\n        if (typeof char.color === 'undefined') char.color = CHARACTER_CLASSES[char.class]?.color || CHARACTER_CLASSES.warrior.color;\r\n        if (typeof char.inventory === 'undefined') char.inventory = {};\r\n        if (typeof char.equipped_weapon === 'undefined') char.equipped_weapon = null;\r\n        if (typeof char.equipped_armor === 'undefined') char.equipped_armor = null;\r\n        if (typeof char.gold === 'undefined') char.gold = 0;\r\n        if (typeof char.dailyExplorations === 'undefined') char.dailyExplorations = 0;\r\n        if (typeof char.lastDailyReset === 'undefined') char.lastDailyReset = Date.now();\r\n        if (typeof char.sessionXpGained === 'undefined') char.sessionXpGained = 0;\r\n        if (typeof char.lastSessionReset === 'undefined') char.lastSessionReset = Date.now();\r\n        all[userId] = char;\r\n      } catch (err) {\r\n        console.error(`Failed to read player data for ${userId}`, err);\r\n      }\r\n    }\r\n  }\r\n\r\n  cache = all;\r\n  return all;\r\n}\r\n\r\nfunction writeAll(obj) {\r\n  ensureDir();\r\n  try {\r\n    // Save each user's data to individual files\r\n    for (const [userId, char] of Object.entries(obj)) {\r\n      const filePath = path.join(PLAYERS_DIR, `${userId}.json`);\r\n      const tmp = `${filePath}.tmp`;\r\n      console.log(`[RPG DEBUG] Writing player data: ${filePath}`);\r\n      fs.writeFileSync(tmp, JSON.stringify(char, null, 2), 'utf8');\r\n      fs.renameSync(tmp, filePath);\r\n    }\r\n    cache = obj;\r\n  } catch (err) {\r\n    console.error('Failed to write RPG data:', err);\r\n    // Attempt to restore from cache if available\r\n    if (cache) {\r\n      console.log('Restoring from cache after write failure');\r\n    } else {\r\n      throw new Error(`Failed to save RPG data: ${err.message}`);\r\n    }\r\n  }\r\n}\r\n\r\nexport function createCharacter(userId, name, charClass = 'warrior') {\r\n   // Validate inputs\r\n   if (!userId || typeof userId !== 'string') {\r\n     throw new CommandError('Invalid user ID', 'INVALID_ARGUMENT');\r\n   }\r\n\r\n   const sanitizedName = sanitizeInput(name || `Player${userId.slice(0,4)}`);\r\n   const nameValidation = validateString(sanitizedName, { minLength: 2, maxLength: 32 });\r\n   if (!nameValidation.valid) {\r\n     throw new CommandError(nameValidation.reason, 'INVALID_ARGUMENT');\r\n   }\r\n\r\n   // Validate character class\r\n   if (!charClass || typeof charClass !== 'string') {\r\n     throw new CommandError('Invalid character class', 'INVALID_ARGUMENT');\r\n   }\r\n\r\n   const classData = CHARACTER_CLASSES[charClass];\r\n   if (!classData) {\r\n     throw new CommandError(`Invalid character class: ${charClass}. Available classes: warrior, mage, rogue, paladin`, 'INVALID_ARGUMENT');\r\n   }\r\n\r\n   if (locks.has(userId)) {\r\n     throw new CommandError('Character creation already in progress', 'RATE_LIMITED');\r\n   }\r\n\r\n   locks.add(userId);\r\n   try {\r\n     const all = cache || readAll();\r\n     if (all[userId]) {\r\n       throw new CommandError('Character already exists for this user', 'ALREADY_EXISTS');\r\n     }\r\n\r\n     const char = {\r\n       name: sanitizedName,\r\n       class: charClass,\r\n       ...classData.baseStats,\r\n       lvl: 1,\r\n       xp: 0,\r\n       skillPoints: 0,\r\n       abilities: [...classData.abilities],\r\n       color: classData.color,\r\n       inventory: {},\r\n       equipped_weapon: null,\r\n       equipped_armor: null,\r\n       gold: 0,\r\n       createdAt: Date.now()\r\n     };\r\n\r\n     all[userId] = char;\r\n     writeAll(all);\r\n\r\n     logger.info('Character created', { userId, name: sanitizedName, class: charClass });\r\n     return char;\r\n   } finally {\r\n     locks.delete(userId);\r\n   }\r\n}\r\n\r\nexport function levelFromXp(xp) {\r\n  // simple formula: 20 XP per level, starting at level 1\r\n  return Math.floor(1 + (xp || 0) / 20);\r\n}\r\n\r\n// apply xp to character in-memory and grant skill points for levels gained\r\nexport function applyXp(userId, char, amount = 0) {\r\n  const oldLvl = char.lvl || levelFromXp(char.xp || 0);\r\n  const oldXp = char.xp || 0;\r\n  char.xp = oldXp + (amount || 0);\r\n  const newLvl = levelFromXp(char.xp);\r\n  let gained = 0;\r\n  if (newLvl > oldLvl) {\r\n    gained = newLvl - oldLvl;\r\n    char.skillPoints = (char.skillPoints || 0) + gained;\r\n    char.lvl = newLvl;\r\n    // Restore HP and MP on level up\r\n    char.hp = char.maxHp || 20;\r\n    char.mp = char.maxMp || 10;\r\n    logger.info('Level up', { userId, oldLvl, newLvl, gained, xp: char.xp });\r\n  } else {\r\n    char.lvl = newLvl;\r\n  }\r\n\r\n  // Track session XP gained\r\n  char.sessionXpGained = (char.sessionXpGained || 0) + amount;\r\n\r\n  logger.debug('XP applied', { userId, oldXp, amount, newXp: char.xp, oldLvl, newLvl, skillPointsGained: gained });\r\n  return { char, oldLvl, newLvl, gained };\r\n}\r\n\r\nexport function getCharacter(userId) {\r\n  // Try cache first\r\n  if (cache && cache[userId]) {\r\n    return cache[userId];\r\n  }\r\n\r\n  // Otherwise read from file\r\n  ensureDir();\r\n  const filePath = path.join(PLAYERS_DIR, `${userId}.json`);\r\n  if (!fs.existsSync(filePath)) return null;\r\n\r\n  try {\r\n    const char = JSON.parse(fs.readFileSync(filePath, 'utf8')) || {};\r\n    // migrate / ensure defaults for older characters\r\n    if (typeof char.xp === 'undefined') char.xp = 0;\r\n    if (typeof char.lvl === 'undefined') char.lvl = levelFromXp(char.xp);\r\n    if (typeof char.skillPoints === 'undefined') char.skillPoints = 0;\r\n    if (typeof char.hp === 'undefined') char.hp = 20;\r\n    if (typeof char.maxHp === 'undefined') char.maxHp = 20;\r\n    if (typeof char.mp === 'undefined') char.mp = 10;\r\n    if (typeof char.maxMp === 'undefined') char.maxMp = 10;\r\n    if (typeof char.atk === 'undefined') char.atk = 5;\r\n    if (typeof char.def === 'undefined') char.def = 2;\r\n    if (typeof char.spd === 'undefined') char.spd = 2;\r\n    if (typeof char.class === 'undefined') char.class = 'warrior';\r\n    if (typeof char.abilities === 'undefined') char.abilities = CHARACTER_CLASSES[char.class]?.abilities || CHARACTER_CLASSES.warrior.abilities;\r\n    if (typeof char.color === 'undefined') char.color = CHARACTER_CLASSES[char.class]?.color || CHARACTER_CLASSES.warrior.color;\r\n    if (typeof char.inventory === 'undefined') char.inventory = {};\r\n    if (typeof char.equipped_weapon === 'undefined') char.equipped_weapon = null;\r\n    if (typeof char.equipped_armor === 'undefined') char.equipped_armor = null;\r\n    if (typeof char.gold === 'undefined') char.gold = 0;\r\n    if (typeof char.dailyExplorations === 'undefined') char.dailyExplorations = 0;\r\n    if (typeof char.lastDailyReset === 'undefined') char.lastDailyReset = Date.now();\r\n    if (typeof char.sessionXpGained === 'undefined') char.sessionXpGained = 0;\r\n    if (typeof char.lastSessionReset === 'undefined') char.lastSessionReset = Date.now();\r\n\r\n    // Update cache\r\n    if (cache) {\r\n      cache[userId] = char;\r\n    } else {\r\n      cache = { [userId]: char };\r\n    }\r\n\r\n    return char;\r\n  } catch (err) {\r\n    console.error(`Failed to read character data for ${userId}`, err);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function saveCharacter(userId, char) {\r\n  if (locks.has(userId)) {\r\n    console.warn(`Save operation blocked for user ${userId} - already locked`);\r\n    return false;\r\n  }\r\n  locks.add(userId);\r\n  try {\r\n    // Save directly to individual file\r\n    ensureDir();\r\n    const filePath = path.join(PLAYERS_DIR, `${userId}.json`);\r\n    const tmp = `${filePath}.tmp`;\r\n    console.log(`[RPG DEBUG] Writing character data: ${filePath}`);\r\n    fs.writeFileSync(tmp, JSON.stringify(char, null, 2), 'utf8');\r\n    fs.renameSync(tmp, filePath);\r\n\r\n    // Update cache if it exists\r\n    if (cache) {\r\n      cache[userId] = char;\r\n    }\r\n    return true;\r\n  } finally {\r\n    locks.delete(userId);\r\n  }\r\n}\r\n\r\nexport function getAllCharacters() {\r\n  return cache || readAll();\r\n}\r\n\r\nexport function resetCharacter(userId, charClass = 'warrior') {\r\n  if (locks.has(userId)) return null;\r\n\r\n  locks.add(userId);\r\n  try {\r\n    const all = cache || readAll();\r\n    const classData = CHARACTER_CLASSES[charClass];\r\n    const def = {\r\n      name: `Player${userId.slice(0,4)}`,\r\n      class: charClass,\r\n      ...classData.baseStats,\r\n      lvl: 1,\r\n      xp: 0,\r\n      skillPoints: 0,\r\n      abilities: [...classData.abilities],\r\n      color: classData.color,\r\n      inventory: {},\r\n      equipped_weapon: null,\r\n      equipped_armor: null,\r\n      gold: 0\r\n    };\r\n    all[userId] = def;\r\n    writeAll(all);\r\n    return def;\r\n  } finally {\r\n    locks.delete(userId);\r\n  }\r\n}\r\n\r\nexport function deleteCharacter(userId) {\r\n  if (locks.has(userId)) return false;\r\n\r\n  locks.add(userId);\r\n  try {\r\n    const all = cache || readAll();\r\n    if (!all[userId]) return false;\r\n    delete all[userId];\r\n    writeAll(all);\r\n    return true;\r\n  } finally {\r\n    locks.delete(userId);\r\n  }\r\n}\r\n\r\nexport function getLeaderboard(limit = 10, offset = 0) {\r\n  const all = cache || readAll();\r\n  const arr = Object.entries(all).map(([id, c]) => ({ id, name: c.name, lvl: c.lvl || 1, xp: c.xp || 0, atk: c.atk || 0 }));\r\n  arr.sort((a, b) => { if (b.lvl !== a.lvl) return b.lvl - a.lvl; if (b.xp !== a.xp) return b.xp - a.xp; return b.atk - a.atk; });\r\n  return arr.slice(offset, offset + limit);\r\n}\r\n\r\nexport function getLeaderboardCount() {\r\n  const all = cache || readAll();\r\n  return Object.keys(all).length;\r\n}\r\n\r\nexport function encounterMonster(lvl = 1) {\r\n  const monster = { name: `Goblin L${lvl}`, hp: 10 + lvl * 3, atk: 3 + lvl, lvl };\r\n  return monster;\r\n}\r\n\r\nexport function fightTurn(attacker, defender) {\r\n  // Calculate damage with new stats\r\n  let damage = Math.max(1, attacker.atk + Math.floor(Math.random() * 6) - 2);\r\n\r\n  // Apply defense reduction (each point of defense reduces damage by 0.5)\r\n  const defense = defender.def || 2;\r\n  damage = Math.max(1, damage - Math.floor(defense * 0.5));\r\n\r\n  // Speed affects hit chance (higher speed = higher chance to hit)\r\n  const speed = attacker.spd || 2;\r\n  const hitChance = Math.min(95, 50 + speed * 10); // 50-95% hit chance based on speed\r\n  const hitRoll = Math.floor(Math.random() * 100);\r\n\r\n  if (hitRoll >= hitChance) {\r\n    logger.debug('Attack missed', { speed, hitChance, hitRoll });\r\n    return 0; // Miss\r\n  }\r\n\r\n  defender.hp -= damage;\r\n  logger.debug('Attack hit', { damage, attackerHp: attacker.hp, defenderHp: defender.hp });\r\n  return damage;\r\n}\r\n\r\nexport async function narrate(guildId, prompt, fallback) {\r\n  try {\r\n    const out = await generate(guildId, prompt);\r\n    return out || fallback || '';\r\n  } catch (err) {\r\n    console.error('Narration failed', err);\r\n    return fallback || '';\r\n  }\r\n}\r\n\r\nexport function randomEventType() {\r\n  const types = ['monster', 'treasure', 'trap', 'npc'];\r\n  return types[Math.floor(Math.random() * types.length)];\r\n}\r\n\r\nexport function getCharacterClasses() {\r\n  return CHARACTER_CLASSES;\r\n}\r\n\r\nexport function getClassInfo(charClass) {\r\n  return CHARACTER_CLASSES[charClass] || null;\r\n}\r\n\r\n// Item and Inventory System\r\nconst ITEMS = {\r\n  // Weapons\r\n  'rusty_sword': { name: 'Rusty Sword', type: 'weapon', rarity: 'common', atk: 3, value: 10, description: 'A worn but serviceable blade' },\r\n  'iron_sword': { name: 'Iron Sword', type: 'weapon', rarity: 'uncommon', atk: 7, value: 50, description: 'A well-crafted iron blade' },\r\n  'magic_staff': { name: 'Magic Staff', type: 'weapon', rarity: 'rare', atk: 12, value: 200, description: 'Channels magical energy' },\r\n  'legendary_blade': { name: 'Legendary Blade', type: 'weapon', rarity: 'legendary', atk: 20, value: 1000, description: 'A blade of ancient power' },\r\n\r\n  // Armor\r\n  'leather_armor': { name: 'Leather Armor', type: 'armor', rarity: 'common', def: 2, value: 15, description: 'Basic protective gear' },\r\n  'chain_mail': { name: 'Chain Mail', type: 'armor', rarity: 'uncommon', def: 5, value: 75, description: 'Interlinked metal rings' },\r\n  'plate_armor': { name: 'Plate Armor', type: 'armor', rarity: 'rare', def: 10, value: 300, description: 'Heavy steel protection' },\r\n  'dragon_armor': { name: 'Dragon Armor', type: 'armor', rarity: 'legendary', def: 18, value: 1500, description: 'Forged from dragon scales' },\r\n\r\n  // Consumables\r\n  'health_potion': { name: 'Health Potion', type: 'consumable', rarity: 'common', hp_restore: 20, value: 25, description: 'Restores 20 HP' },\r\n  'mana_potion': { name: 'Mana Potion', type: 'consumable', rarity: 'uncommon', mp_restore: 30, value: 40, description: 'Restores 30 MP' },\r\n  'revive_crystal': { name: 'Revive Crystal', type: 'consumable', rarity: 'rare', revive: true, value: 150, description: 'Brings you back from defeat' },\r\n\r\n  // Materials\r\n  'iron_ore': { name: 'Iron Ore', type: 'material', rarity: 'common', value: 5, description: 'Raw iron for crafting' },\r\n  'magic_crystal': { name: 'Magic Crystal', type: 'material', rarity: 'rare', value: 100, description: 'Contains magical energy' },\r\n  'dragon_scale': { name: 'Dragon Scale', type: 'material', rarity: 'legendary', value: 500, description: 'Priceless crafting material' },\r\n  'gold_ore': { name: 'Gold Ore', type: 'material', rarity: 'uncommon', value: 50, description: 'Shiny gold for high-value crafting' },\r\n  'mithril_ingot': { name: 'Mithril Ingot', type: 'material', rarity: 'legendary', value: 2000, description: 'Lightweight and incredibly strong' },\r\n  'wood': { name: 'Wood', type: 'material', rarity: 'common', value: 2, description: 'Basic building material' },\r\n  'leather': { name: 'Leather', type: 'material', rarity: 'common', value: 3, description: 'Tough animal hide' },\r\n  'gemstone': { name: 'Gemstone', type: 'material', rarity: 'rare', value: 150, description: 'Sparkling precious stone' }\r\n};\r\n\r\n// Crafting recipes\r\nconst CRAFTING_RECIPES = {\r\n  'iron_sword': {\r\n    materials: { 'iron_ore': 3, 'wood': 1 },\r\n    description: 'Craft an iron sword from iron ore and wood',\r\n    required_level: 3\r\n  },\r\n  'chain_mail': {\r\n    materials: { 'iron_ore': 5, 'leather': 2 },\r\n    description: 'Craft chain mail armor from iron and leather',\r\n    required_level: 4\r\n  },\r\n  'health_potion': {\r\n    materials: { 'magic_crystal': 1, 'wood': 1 },\r\n    description: 'Craft a health potion using magic and wood',\r\n    required_level: 1\r\n  },\r\n  'mana_potion': {\r\n    materials: { 'magic_crystal': 2, 'gemstone': 1 },\r\n    description: 'Craft a mana potion using crystals and gems',\r\n    required_level: 5\r\n  },\r\n  'magic_staff': {\r\n    materials: { 'wood': 2, 'magic_crystal': 3, 'gemstone': 1 },\r\n    description: 'Craft a powerful magic staff',\r\n    required_level: 8\r\n  },\r\n  'plate_armor': {\r\n    materials: { 'iron_ore': 8, 'leather': 3, 'mithril_ingot': 1 },\r\n    description: 'Craft heavy plate armor',\r\n    required_level: 10\r\n  }\r\n};\r\n\r\nconst ITEM_RARITIES = {\r\n  common: { color: 0x8B8B8B, chance: 50 },\r\n  uncommon: { color: 0x4CAF50, chance: 25 },\r\n  rare: { color: 0x2196F3, chance: 15 },\r\n  legendary: { color: 0xFF9800, chance: 10 }\r\n};\r\n\r\nexport function generateRandomItem(level = 1) {\r\n  const rarityRoll = Math.random() * 100;\r\n  let selectedRarity = 'common';\r\n\r\n  // Adjust rarity chances based on level\r\n  const adjustedRarities = { ...ITEM_RARITIES };\r\n  if (level >= 20) {\r\n    adjustedRarities.legendary.chance += 5;\r\n    adjustedRarities.rare.chance += 5;\r\n    adjustedRarities.uncommon.chance += 5;\r\n    adjustedRarities.common.chance -= 15;\r\n  } else if (level >= 10) {\r\n    adjustedRarities.rare.chance += 3;\r\n    adjustedRarities.uncommon.chance += 3;\r\n    adjustedRarities.common.chance -= 6;\r\n  }\r\n\r\n  let cumulativeChance = 0;\r\n  for (const [rarity, data] of Object.entries(adjustedRarities)) {\r\n    cumulativeChance += data.chance;\r\n    if (rarityRoll <= cumulativeChance) {\r\n      selectedRarity = rarity;\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Filter items by rarity and level-appropriate types\r\n  const availableItems = Object.entries(ITEMS).filter(([key, item]) =>\r\n    item.rarity === selectedRarity &&\r\n    (level >= getItemLevelRequirement(key))\r\n  );\r\n\r\n  if (availableItems.length === 0) {\r\n    console.warn(`No items available for rarity ${selectedRarity} at level ${level}, falling back to health_potion`);\r\n    return { id: 'health_potion', ...ITEMS['health_potion'] };\r\n  }\r\n\r\n  const randomItem = availableItems[Math.floor(Math.random() * availableItems.length)];\r\n  return { id: randomItem[0], ...randomItem[1] };\r\n}\r\n\r\nfunction getItemLevelRequirement(itemKey) {\r\n  const levelReqs = {\r\n    rusty_sword: 1, iron_sword: 3, magic_staff: 8, legendary_blade: 15,\r\n    leather_armor: 1, chain_mail: 4, plate_armor: 10, dragon_armor: 20,\r\n    health_potion: 1, mana_potion: 5, revive_crystal: 12,\r\n    iron_ore: 1, magic_crystal: 7, dragon_scale: 18,\r\n    gold_ore: 5, mithril_ingot: 25,\r\n    wood: 1, leather: 1, gemstone: 10\r\n  };\r\n  return levelReqs[itemKey] || 1;\r\n}\r\n\r\nexport function getItemInfo(itemId) {\r\n  return ITEMS[itemId] || null;\r\n}\r\n\r\nexport function getItemRarityInfo(rarity) {\r\n  return ITEM_RARITIES[rarity] || ITEM_RARITIES.common;\r\n}\r\n\r\n// Inventory Management Functions\r\nexport function addItemToInventory(userId, itemId, quantity = 1) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n\r\n  char.inventory = char.inventory || {};\r\n  char.inventory[itemId] = (char.inventory[itemId] || 0) + quantity;\r\n\r\n  writeAll(all);\r\n  return { success: true, char };\r\n}\r\n\r\nexport function removeItemFromInventory(userId, itemId, quantity = 1) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n  if (!char.inventory || !char.inventory[itemId]) return { success: false, reason: 'item_not_found' };\r\n\r\n  const currentQuantity = char.inventory[itemId];\r\n  if (currentQuantity < quantity) return { success: false, reason: 'insufficient_quantity' };\r\n\r\n  char.inventory[itemId] -= quantity;\r\n  if (char.inventory[itemId] <= 0) delete char.inventory[itemId];\r\n\r\n  writeAll(all);\r\n  return { success: true, char };\r\n}\r\n\r\nexport function getInventory(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char || !char.inventory) return {};\r\n\r\n  return char.inventory;\r\n}\r\n\r\nexport function getInventoryValue(userId) {\r\n  const inventory = getInventory(userId);\r\n  let totalValue = 0;\r\n\r\n  for (const [itemId, quantity] of Object.entries(inventory)) {\r\n    const item = ITEMS[itemId];\r\n    if (item) {\r\n      totalValue += item.value * quantity;\r\n    }\r\n  }\r\n\r\n  return totalValue;\r\n}\r\n\r\nexport function useConsumableItem(userId, itemId) {\r\n  const item = ITEMS[itemId];\r\n  if (!item || item.type !== 'consumable') {\r\n    return { success: false, reason: 'not_consumable' };\r\n  }\r\n\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n\r\n  // Check if item is in inventory\r\n  if (!char.inventory || !char.inventory[itemId]) {\r\n    return { success: false, reason: 'item_not_in_inventory' };\r\n  }\r\n\r\n  // Apply item effects\r\n  let effects = {};\r\n  if (item.hp_restore) {\r\n    const oldHp = char.hp;\r\n    char.hp = Math.min(char.maxHp, char.hp + item.hp_restore);\r\n    effects.hp_restored = char.hp - oldHp;\r\n  }\r\n\r\n  if (item.mp_restore) {\r\n    const oldMp = char.mp;\r\n    char.mp = Math.min(char.maxMp, char.mp + item.mp_restore);\r\n    effects.mp_restored = char.mp - oldMp;\r\n  }\r\n\r\n  if (item.revive) {\r\n    char.hp = char.maxHp;\r\n    effects.revive = true;\r\n  }\r\n\r\n  // Remove item from inventory\r\n  char.inventory[itemId]--;\r\n  if (char.inventory[itemId] <= 0) delete char.inventory[itemId];\r\n\r\n  writeAll(all);\r\n  return { success: true, char, effects };\r\n}\r\n\r\nexport function equipItem(userId, itemId) {\r\n  const item = ITEMS[itemId];\r\n  if (!item || (item.type !== 'weapon' && item.type !== 'armor')) {\r\n    return { success: false, reason: 'not_equippable' };\r\n  }\r\n\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n  if (!char.inventory || !char.inventory[itemId]) {\r\n    return { success: false, reason: 'item_not_in_inventory' };\r\n  }\r\n\r\n  // Unequip current item of same type\r\n  if (item.type === 'weapon' && char.equipped_weapon) {\r\n    addItemToInventory(userId, char.equipped_weapon, 1);\r\n    if (ITEMS[char.equipped_weapon]) {\r\n      char.atk -= ITEMS[char.equipped_weapon].atk || 0;\r\n    }\r\n  }\r\n\r\n  if (item.type === 'armor' && char.equipped_armor) {\r\n    addItemToInventory(userId, char.equipped_armor, 1);\r\n    if (ITEMS[char.equipped_armor]) {\r\n      char.def -= ITEMS[char.equipped_armor].def || 0;\r\n    }\r\n  }\r\n\r\n  // Equip new item\r\n  if (item.type === 'weapon') {\r\n    char.equipped_weapon = itemId;\r\n    char.atk += item.atk || 0;\r\n  }\r\n\r\n  if (item.type === 'armor') {\r\n    char.equipped_armor = itemId;\r\n    char.def += item.def || 0;\r\n  }\r\n\r\n  // Remove from inventory\r\n  const removeResult = removeItemFromInventory(userId, itemId, 1);\r\n  if (!removeResult.success) {\r\n    logger.error('Failed to remove item from inventory during equip', { userId, itemId });\r\n    return { success: false, reason: 'inventory_error' };\r\n  }\r\n\r\n  writeAll(all);\r\n  logger.info('Item equipped', { userId, itemId, type: item.type });\r\n  return { success: true, char };\r\n}\r\n\r\nexport function unequipItem(userId, slot) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n\r\n  let itemId = null;\r\n  if (slot === 'weapon' && char.equipped_weapon) {\r\n    itemId = char.equipped_weapon;\r\n    if (ITEMS[itemId]) {\r\n      char.atk -= ITEMS[itemId].atk || 0;\r\n    }\r\n    char.equipped_weapon = null;\r\n  } else if (slot === 'armor' && char.equipped_armor) {\r\n    itemId = char.equipped_armor;\r\n    if (ITEMS[itemId]) {\r\n      char.def -= ITEMS[itemId].def || 0;\r\n    }\r\n    char.equipped_armor = null;\r\n  } else {\r\n    return { success: false, reason: 'no_item_equipped' };\r\n  }\r\n\r\n  if (itemId) {\r\n    const addResult = addItemToInventory(userId, itemId, 1);\r\n    if (!addResult.success) {\r\n      logger.error('Failed to add item to inventory during unequip', { userId, itemId });\r\n      return { success: false, reason: 'inventory_error' };\r\n    }\r\n  }\r\n\r\n  writeAll(all);\r\n  logger.info('Item unequipped', { userId, slot, itemId });\r\n  return { success: true, char };\r\n}\r\n\r\n// Crafting System\r\nexport function getCraftingRecipes() {\r\n  return CRAFTING_RECIPES;\r\n}\r\n\r\nexport function canCraftItem(userId, itemId) {\r\n  const recipe = CRAFTING_RECIPES[itemId];\r\n  if (!recipe) return { success: false, reason: 'not_craftable' };\r\n\r\n  const character = getCharacter(userId);\r\n  if (!character) return { success: false, reason: 'no_character' };\r\n  if (character.lvl < recipe.required_level) {\r\n    return { success: false, reason: 'level_too_low', required: recipe.required_level };\r\n  }\r\n\r\n  const inventory = getInventory(userId);\r\n\r\n  // Check if all required materials are available\r\n  for (const [materialId, requiredQuantity] of Object.entries(recipe.materials)) {\r\n    if (!inventory[materialId] || inventory[materialId] < requiredQuantity) {\r\n      return { success: false, reason: 'missing_materials', missing: materialId };\r\n    }\r\n  }\r\n\r\n  return { success: true };\r\n}\r\n\r\nexport function craftItem(userId, itemId) {\r\n  const canCraft = canCraftItem(userId, itemId);\r\n  if (!canCraft.success) return canCraft;\r\n\r\n  const recipe = CRAFTING_RECIPES[itemId];\r\n  const character = getCharacter(userId);\r\n  if (!character) return { success: false, reason: 'no_character' };\r\n\r\n  const inventory = getInventory(userId);\r\n\r\n  // Remove materials\r\n  for (const [materialId, requiredQuantity] of Object.entries(recipe.materials)) {\r\n    const removeResult = removeItemFromInventory(userId, materialId, requiredQuantity);\r\n    if (!removeResult.success) {\r\n      logger.error('Failed to remove material during crafting', { userId, itemId, materialId, required: requiredQuantity });\r\n      return { success: false, reason: 'material_removal_failed' };\r\n    }\r\n  }\r\n\r\n  // Add crafted item\r\n  const addResult = addItemToInventory(userId, itemId, 1);\r\n  if (!addResult.success) {\r\n    logger.error('Failed to add crafted item to inventory', { userId, itemId });\r\n    return { success: false, reason: 'item_add_failed' };\r\n  }\r\n\r\n  // Award XP for crafting\r\n  const xpReward = Math.floor(character.lvl * 2);\r\n  const xpResult = applyXp(userId, character, xpReward);\r\n\r\n  logger.info('Item crafted successfully', { userId, itemId, xpGained: xpReward });\r\n  return {\r\n    success: true,\r\n    char: character,\r\n    xpGained: xpReward,\r\n    item: ITEMS[itemId]\r\n  };\r\n}\r\n\r\nexport function bossEncounter(lvl = 5) {\r\n  return { name: `Dragon L${lvl}`, hp: 50 + lvl * 20, atk: 8 + lvl * 2, lvl };\r\n}\r\n\r\n// simple quest storage inside RPG file\r\nfunction readQuests() {\r\n  const p = path.join(process.cwd(), 'data', 'quests.json');\r\n  if (!fs.existsSync(p)) return {};\r\n  try { return JSON.parse(fs.readFileSync(p, 'utf8')) || {}; } catch (error) { return {}; }\r\n}\r\n\r\nfunction writeQuests(q) {\r\n  const p = path.join(process.cwd(), 'data', 'quests.json');\r\n  if (!fs.existsSync(path.dirname(p))) fs.mkdirSync(path.dirname(p), { recursive: true });\r\n  fs.writeFileSync(p, JSON.stringify(q, null, 2), 'utf8');\r\n}\r\n\r\nexport function createQuest(userId, title, desc) {\r\n  const all = readQuests();\r\n  all[userId] = all[userId] || [];\r\n  const q = { id: Date.now(), title, desc, status: 'open' };\r\n  all[userId].push(q);\r\n  writeQuests(all);\r\n  return q;\r\n}\r\n\r\nexport function generateRandomQuest(userId, level = 1) {\r\n  const questTypes = [\r\n    { title: `Slay ${5 + level * 2} Goblins`, desc: `Defeat ${5 + level * 2} goblins in combat.`, requirement: 'goblins_defeated', amount: 5 + level * 2 },\r\n    { title: `Collect ${3 + level} Health Potions`, desc: `Gather ${3 + level} health potions from exploration.`, requirement: 'potions_collected', amount: 3 + level },\r\n    { title: `Reach Level ${level + 5}`, desc: `Gain enough XP to reach level ${level + 5}.`, requirement: 'level_reached', amount: level + 5 },\r\n    { title: `Earn ${100 + level * 50} Gold`, desc: `Accumulate ${100 + level * 50} gold through various activities.`, requirement: 'gold_earned', amount: 100 + level * 50 },\r\n    { title: `Explore ${2 + level} Locations`, desc: `Discover and explore ${2 + level} new locations.`, requirement: 'locations_explored', amount: 2 + level },\r\n    { title: `Craft ${1 + level} Items`, desc: `Use materials to craft ${1 + level} new items.`, requirement: 'items_crafted', amount: 1 + level }\r\n  ];\r\n\r\n  const randomType = questTypes[Math.floor(Math.random() * questTypes.length)];\r\n  const quest = createQuest(userId, randomType.title, randomType.desc);\r\n  quest.requirement = randomType.requirement;\r\n  quest.amount = randomType.amount;\r\n\r\n  // Update the quest in storage\r\n  const all = readQuests();\r\n  const userQuests = all[userId] || [];\r\n  const index = userQuests.findIndex(q => q.id === quest.id);\r\n  if (index !== -1) {\r\n    userQuests[index] = quest;\r\n    all[userId] = userQuests;\r\n    writeQuests(all);\r\n  }\r\n\r\n  return quest;\r\n}\r\n\r\nexport function listQuests(userId) {\r\n  const all = readQuests();\r\n  return all[userId] || [];\r\n}\r\n\r\nfunction calculateQuestXpReward(quest) {\r\n  const baseXp = 50; // Base XP for completing any quest\r\n  const typeMultipliers = {\r\n    'goblins_defeated': 2,\r\n    'potions_collected': 1.5,\r\n    'level_reached': 3,\r\n    'gold_earned': 1,\r\n    'locations_explored': 2.5,\r\n    'items_crafted': 2\r\n  };\r\n\r\n  const multiplier = typeMultipliers[quest.requirement] || 1;\r\n  const levelBonus = (quest.amount || 1) * 2;\r\n\r\n  return Math.floor(baseXp * multiplier + levelBonus);\r\n}\r\n\r\nfunction calculateQuestGoldReward(quest) {\r\n  const baseGold = 25; // Base gold for completing any quest\r\n  const typeMultipliers = {\r\n    'goblins_defeated': 1.5,\r\n    'potions_collected': 1,\r\n    'level_reached': 2,\r\n    'gold_earned': 0, // No gold for gold-earning quests\r\n    'locations_explored': 1.8,\r\n    'items_crafted': 1.2\r\n  };\r\n\r\n  const multiplier = typeMultipliers[quest.requirement] || 1;\r\n  const levelBonus = (quest.amount || 1);\r\n\r\n  return Math.floor(baseGold * multiplier + levelBonus * 5);\r\n}\r\n\r\nexport function completeQuest(userId, questId) {\r\n  const all = readQuests();\r\n  const arr = all[userId] || [];\r\n  const q = arr.find(x => x.id === Number(questId));\r\n  if (!q) return null;\r\n  q.status = 'completed';\r\n  writeQuests(all);\r\n\r\n  // Award XP based on quest type and level\r\n  const xpReward = calculateQuestXpReward(q);\r\n  const goldReward = calculateQuestGoldReward(q);\r\n\r\n  // Apply XP and gold rewards\r\n  const char = getCharacter(userId);\r\n  if (char) {\r\n    applyXp(userId, char, xpReward);\r\n    char.gold = (char.gold || 0) + goldReward;\r\n    saveCharacter(userId, char);\r\n  }\r\n\r\n  return { ...q, xpReward, goldReward };\r\n}\r\n\r\n// Removed duplicate function\r\n\r\n// Spend skill points for a character and persist change\r\nexport function spendSkillPoints(userId, stat, amount = 1) {\r\n   // Validate inputs\r\n    if (!userId || typeof userId !== 'string') {\r\n      throw new CommandError('Invalid user ID', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (!stat || typeof stat !== 'string') {\r\n      throw new CommandError('Invalid stat specified', 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    const amountValidation = validateNumber(amount, { min: 1, max: 100, integer: true, positive: true });\r\n    if (!amountValidation.valid) {\r\n      throw new CommandError(amountValidation.reason, 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    // Validate stat type\r\n    const validStats = ['hp', 'maxhp', 'mp', 'maxmp', 'atk', 'def', 'spd'];\r\n    if (!validStats.includes(stat)) {\r\n      throw new CommandError(`Invalid stat. Must be one of: ${validStats.join(', ')}`, 'INVALID_ARGUMENT');\r\n    }\r\n\r\n    if (locks.has(userId)) {\r\n      throw new CommandError('Character update already in progress', 'RATE_LIMITED');\r\n    }\r\n\r\n    locks.add(userId);\r\n    try {\r\n      const all = cache || readAll();\r\n      const char = all[userId];\r\n\r\n      if (!char) {\r\n        throw new CommandError('Character not found', 'NOT_FOUND');\r\n      }\r\n\r\n      const pts = char.skillPoints || 0;\r\n      if (pts < amount) {\r\n        throw new CommandError(`Not enough skill points. Have: ${pts}, Need: ${amount}`, 'INSUFFICIENT_FUNDS');\r\n      }\r\n\r\n      // Apply stat changes with validation\r\n      if (stat === 'hp') {\r\n        const currentHp = char.hp || 0;\r\n        const maxHp = char.maxHp || 20;\r\n        char.hp = Math.min(currentHp + amount * 2, maxHp);\r\n      } else if (stat === 'maxhp') {\r\n        char.maxHp = (char.maxHp || 20) + amount * 5;\r\n        char.hp = Math.min((char.hp || 0) + amount * 2, char.maxHp);\r\n      } else if (stat === 'mp') {\r\n        const currentMp = char.mp || 0;\r\n        const maxMp = char.maxMp || 10;\r\n        char.mp = Math.min(currentMp + amount * 3, maxMp);\r\n      } else if (stat === 'maxmp') {\r\n        char.maxMp = (char.maxMp || 10) + amount * 5;\r\n        char.mp = Math.min((char.mp || 0) + amount * 3, char.maxMp);\r\n      } else if (stat === 'atk') {\r\n        char.atk = (char.atk || 5) + amount;\r\n      } else if (stat === 'def') {\r\n        char.def = (char.def || 2) + amount;\r\n      } else if (stat === 'spd') {\r\n        char.spd = (char.spd || 2) + amount;\r\n      }\r\n\r\n      char.skillPoints = pts - amount;\r\n      all[userId] = char;\r\n      writeAll(all);\r\n\r\n      logger.info('Skill points spent', { userId, stat, amount, newValue: char[stat] });\r\n      return { success: true, char };\r\n    } finally {\r\n      locks.delete(userId);\r\n    }\r\n}\r\n\r\n// Function to check daily exploration limit\r\nexport function checkDailyLimit(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { allowed: false, reason: 'no_character' };\r\n\r\n  const now = Date.now();\r\n  const dayInMs = 24 * 60 * 60 * 1000;\r\n\r\n  // Check if we need to reset daily count\r\n  if (now - (char.lastDailyReset || 0) >= dayInMs) {\r\n    char.dailyExplorations = 0;\r\n    char.lastDailyReset = now;\r\n    writeAll(all);\r\n  }\r\n\r\n  const maxDaily = 10; // 10 explorations per day\r\n  const used = char.dailyExplorations || 0;\r\n  const allowed = used < maxDaily;\r\n\r\n  return {\r\n    allowed,\r\n    used,\r\n    max: maxDaily,\r\n    remaining: maxDaily - used,\r\n    resetTime: char.lastDailyReset\r\n  };\r\n}\r\n\r\n// Function to increment daily exploration count\r\nexport function incrementDailyExploration(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { success: false, reason: 'no_character' };\r\n\r\n  // Check daily limit first\r\n  const check = checkDailyLimit(userId);\r\n  if (!check.allowed) {\r\n    return { success: false, reason: 'daily_limit_reached' };\r\n  }\r\n\r\n  char.dailyExplorations = (char.dailyExplorations || 0) + 1;\r\n  writeAll(all);\r\n\r\n  return { success: true, newCount: char.dailyExplorations };\r\n}\r\n\r\n// Function to check session XP cap\r\nexport function checkSessionXpCap(userId) {\r\n  const all = cache || readAll();\r\n  const char = all[userId];\r\n  if (!char) return { allowed: false, reason: 'no_character' };\r\n\r\n  const now = Date.now();\r\n  const sessionDurationMs = 24 * 60 * 60 * 1000; // 24 hours\r\n\r\n  // Check if we need to reset session XP\r\n  if (now - (char.lastSessionReset || 0) >= sessionDurationMs) {\r\n    char.sessionXpGained = 0;\r\n    char.lastSessionReset = now;\r\n    writeAll(all);\r\n  }\r\n\r\n  const maxSessionXp = 1000; // 1000 XP per session\r\n  const used = char.sessionXpGained || 0;\r\n  const allowed = used < maxSessionXp;\r\n\r\n  return {\r\n    allowed,\r\n    used,\r\n    max: maxSessionXp,\r\n    remaining: maxSessionXp - used,\r\n    resetTime: char.lastSessionReset\r\n  };\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\scheduler.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":12,"column":19,"nodeType":"Literal","messageId":"error","endLine":12,"endColumn":23,"suggestions":[{"messageId":"replace","fix":{"range":[325,329],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":41,"column":63,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":41,"endColumn":69,"fix":{"range":[974,982],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":43,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":43,"endColumn":6,"fix":{"range":[1022,1022],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":44,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":44,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1046,1096],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":56,"column":71,"nodeType":"Literal","messageId":"error","endLine":56,"endColumn":75,"suggestions":[{"messageId":"replace","fix":{"range":[1338,1342],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":57,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":57,"endColumn":6,"fix":{"range":[1355,1355],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":58,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":58,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1379,1429],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":64,"column":50,"nodeType":"CallExpression","messageId":"substr","endLine":64,"endColumn":89,"fix":{"range":[1594,1605],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":72,"column":44,"nodeType":"Literal","messageId":"error","endLine":72,"endColumn":48,"suggestions":[{"messageId":"replace","fix":{"range":[1838,1842],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":80,"column":10,"nodeType":"MemberExpression","endLine":80,"endColumn":42},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":81,"column":7,"nodeType":"MemberExpression","endLine":81,"endColumn":39},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":84,"column":5,"nodeType":"MemberExpression","endLine":84,"endColumn":37},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":136,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":136,"endColumn":10,"fix":{"range":[3619,3619],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":140,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":140,"endColumn":8,"fix":{"range":[3767,3767],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":141,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":141,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[3793,3842],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":157,"column":37,"nodeType":"CallExpression","messageId":"substr","endLine":157,"endColumn":76,"fix":{"range":[4286,4297],"text":"slice(2, 11"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":175,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":175,"endColumn":20,"fix":{"range":[4809,4893],"text":" {\r\n        date.setDate(date.getDate() + (recurrence.interval || 1));\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":178,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":178,"endColumn":21,"fix":{"range":[4915,5005],"text":" {\r\n        date.setDate(date.getDate() + ((recurrence.interval || 1) * 7));\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":181,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":181,"endColumn":22,"fix":{"range":[5028,5114],"text":" {\r\n        date.setMonth(date.getMonth() + (recurrence.interval || 1));\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":184,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":184,"endColumn":21,"fix":{"range":[5136,5222],"text":" {\r\n        date.setHours(date.getHours() + (recurrence.interval || 1));\r\n        break;\n      }"}},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":194,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":194,"endColumn":83,"fix":{"range":[5396,5407],"text":"slice(2, 11"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":201,"column":39,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":201,"endColumn":46,"fix":{"range":[5613,5620],"text":"3_600_000"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":240,"column":21,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":240,"endColumn":28,"fix":{"range":[6568,6977],"text":"for (const [index, reminderOffset] of event.reminders.entries()) {\r\n      const reminderTime = event.scheduledFor - reminderOffset;\r\n      if (reminderTime > Date.now()) {\r\n        const reminderTimerId = setTimeout(() => {\r\n          this.sendEventReminder(event, reminderOffset);\r\n        }, reminderTime - Date.now());\r\n\r\n        this.activeTimers.set(`${event.id}_reminder_${index}`, reminderTimerId);\r\n      }\r\n    }"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":273,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":273,"endColumn":10,"fix":{"range":[7767,7767],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":277,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":277,"endColumn":8,"fix":{"range":[7912,7912],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":278,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":278,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[7938,7984],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":290,"column":56,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":290,"endColumn":61,"fix":{"range":[8253,8258],"text":"60_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":299,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":299,"endColumn":10,"fix":{"range":[8667,8667],"text":"\n"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (587). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":587,"endColumn":20},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":303,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":303,"endColumn":8,"fix":{"range":[8812,8812],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":304,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":304,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[8838,8893],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":322,"column":24,"nodeType":"Identifier","messageId":"error","endLine":322,"endColumn":32,"fix":{"range":[9306,9314],"text":"Number.parseInt"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":327,"column":19,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":327,"endColumn":24,"fix":{"range":[9449,9454],"text":"60_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":328,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":328,"endColumn":24,"fix":{"range":[9473,9480],"text":"3_600_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":329,"column":16,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":329,"endColumn":24,"fix":{"range":[9498,9506],"text":"86_400_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":330,"column":17,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":330,"endColumn":26,"fix":{"range":[9525,9534],"text":"604_800_000"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":333,"column":42,"nodeType":"MemberExpression","endLine":333,"endColumn":59},{"ruleId":"security/detect-unsafe-regex","severity":2,"message":"Unsafe Regular Expression","line":362,"column":40,"nodeType":"Literal","endLine":362,"endColumn":75},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":364,"column":19,"nodeType":"Identifier","messageId":"error","endLine":364,"endColumn":27,"fix":{"range":[10736,10744],"text":"Number.parseInt"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.parseInt` over `parseInt`.","line":365,"column":23,"nodeType":"Identifier","messageId":"error","endLine":365,"endColumn":31,"fix":{"range":[10783,10791],"text":"Number.parseInt"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":375,"column":12,"nodeType":"Literal","messageId":"error","endLine":375,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[11069,11073],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[11069,11073],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":394,"column":23,"nodeType":"MemberExpression","endLine":394,"endColumn":55},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":402,"column":20,"nodeType":"MemberExpression","endLine":402,"endColumn":50},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":410,"column":23,"nodeType":"MemberExpression","endLine":410,"endColumn":55},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":427,"column":20,"nodeType":"MemberExpression","endLine":427,"endColumn":50},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":442,"column":21,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":442,"endColumn":28,"fix":{"range":[12764,12877],"text":"for (const [index, _] of event.reminders.entries()) {\r\n      this.activeTimers.delete(`${eventId}_reminder_${index}`);\r\n    }"}},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":456,"column":5,"nodeType":"MemberExpression","endLine":456,"endColumn":40},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":457,"column":10,"nodeType":"MemberExpression","endLine":457,"endColumn":45},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":467,"column":12,"nodeType":"MemberExpression","endLine":467,"endColumn":49},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":489,"column":19,"nodeType":"MemberExpression","endLine":489,"endColumn":47},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":503,"column":30,"nodeType":"MemberExpression","endLine":503,"endColumn":62},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":511,"column":27,"nodeType":"MemberExpression","endLine":511,"endColumn":57},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":526,"column":29,"nodeType":"MemberExpression","endLine":526,"endColumn":61}],"suppressedMessages":[],"errorCount":36,"fatalErrorCount":0,"warningCount":21,"fixableErrorCount":29,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst SCHEDULES_FILE = path.join(process.cwd(), 'data', 'schedules.json');\r\n\r\n// Advanced Scheduling and Reminder System\r\nclass SchedulerManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadSchedules();\r\n    this.activeTimers = new Map();\r\n    this.client = null;\r\n    this.started = false;\r\n  }\r\n\r\n  setClient(client) {\r\n    this.client = client;\r\n    if (!this.started) {\r\n      this.startScheduler();\r\n      this.started = true;\r\n    }\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(SCHEDULES_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(SCHEDULES_FILE)) {\r\n      fs.writeFileSync(SCHEDULES_FILE, JSON.stringify({\r\n        reminders: {},\r\n        events: {},\r\n        recurring: {},\r\n        stats: {}\r\n      }));\r\n    }\r\n  }\r\n\r\n  loadSchedules() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(SCHEDULES_FILE, 'utf8'));\r\n      this.schedules = data;\r\n    } catch (error) {\r\n      console.error('Failed to load schedules:', error);\r\n      this.schedules = {\r\n        reminders: {},\r\n        events: {},\r\n        recurring: {},\r\n        stats: {}\r\n      };\r\n    }\r\n  }\r\n\r\n  saveSchedules() {\r\n    try {\r\n      fs.writeFileSync(SCHEDULES_FILE, JSON.stringify(this.schedules, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save schedules:', error);\r\n    }\r\n  }\r\n\r\n  // Advanced Reminder System\r\n  createReminder(userId, reminderData) {\r\n    const reminderId = `reminder_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const reminder = {\r\n      id: reminderId,\r\n      userId,\r\n      title: reminderData.title,\r\n      message: reminderData.message,\r\n      scheduledFor: reminderData.scheduledFor,\r\n      recurring: reminderData.recurring || null,\r\n      channelId: reminderData.channelId,\r\n      guildId: reminderData.guildId,\r\n      created: Date.now(),\r\n      active: true,\r\n      executed: false\r\n    };\r\n\r\n    if (!this.schedules.reminders[userId]) {\r\n      this.schedules.reminders[userId] = [];\r\n    }\r\n\r\n    this.schedules.reminders[userId].push(reminder);\r\n\r\n    // Schedule the reminder\r\n    this.scheduleReminder(reminder);\r\n\r\n    this.saveSchedules();\r\n    return reminder;\r\n  }\r\n\r\n  scheduleReminder(reminder) {\r\n    const delay = reminder.scheduledFor - Date.now();\r\n\r\n    if (delay <= 0) {\r\n      // Execute immediately if time has passed\r\n      this.executeReminder(reminder);\r\n      return;\r\n    }\r\n\r\n    const timerId = setTimeout(() => {\r\n      this.executeReminder(reminder);\r\n    }, delay);\r\n\r\n    this.activeTimers.set(reminder.id, timerId);\r\n  }\r\n\r\n  async executeReminder(reminder) {\r\n    // Mark as executed\r\n    reminder.executed = true;\r\n    reminder.executedAt = Date.now();\r\n\r\n    // Update stats\r\n    if (!this.schedules.stats[reminder.userId]) {\r\n      this.schedules.stats[reminder.userId] = { reminders_sent: 0, events_executed: 0 };\r\n    }\r\n    this.schedules.stats[reminder.userId].reminders_sent++;\r\n\r\n    // Handle recurring reminders\r\n    if (reminder.recurring) {\r\n      this.createRecurringReminder(reminder);\r\n    }\r\n\r\n    this.saveSchedules();\r\n    this.activeTimers.delete(reminder.id);\r\n\r\n    // Send the reminder via Discord\r\n    if (this.client) {\r\n      try {\r\n        const message = `‚è∞ **Reminder: ${reminder.title}**\\n${reminder.message}`;\r\n        if (reminder.guildId) {\r\n          const guild = await this.client.guilds.fetch(reminder.guildId);\r\n          const channel = await guild.channels.fetch(reminder.channelId);\r\n          await channel.send(message);\r\n        } else {\r\n          const channel = await this.client.channels.fetch(reminder.channelId);\r\n          await channel.send(message);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to send reminder:', error);\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      reminder,\r\n      message: `‚è∞ **Reminder: ${reminder.title}**\\n${reminder.message}`\r\n    };\r\n  }\r\n\r\n  createRecurringReminder(originalReminder) {\r\n    const nextExecution = this.calculateNextRecurrence(originalReminder.scheduledFor, originalReminder.recurring);\r\n\r\n    const newReminder = {\r\n      ...originalReminder,\r\n      id: `reminder_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      scheduledFor: nextExecution,\r\n      executed: false,\r\n      created: Date.now()\r\n    };\r\n\r\n    if (!this.schedules.reminders[originalReminder.userId]) {\r\n      this.schedules.reminders[originalReminder.userId] = [];\r\n    }\r\n\r\n    this.schedules.reminders[originalReminder.userId].push(newReminder);\r\n    this.scheduleReminder(newReminder);\r\n  }\r\n\r\n  calculateNextRecurrence(lastExecution, recurrence) {\r\n    const date = new Date(lastExecution);\r\n\r\n    switch (recurrence.type) {\r\n      case 'daily':\r\n        date.setDate(date.getDate() + (recurrence.interval || 1));\r\n        break;\r\n      case 'weekly':\r\n        date.setDate(date.getDate() + ((recurrence.interval || 1) * 7));\r\n        break;\r\n      case 'monthly':\r\n        date.setMonth(date.getMonth() + (recurrence.interval || 1));\r\n        break;\r\n      case 'hourly':\r\n        date.setHours(date.getHours() + (recurrence.interval || 1));\r\n        break;\r\n    }\r\n\r\n    return date.getTime();\r\n  }\r\n\r\n  // Event Management System\r\n  createEvent(eventData) {\r\n    const eventId = `event_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const event = {\r\n      id: eventId,\r\n      title: eventData.title,\r\n      description: eventData.description,\r\n      scheduledFor: eventData.scheduledFor,\r\n      duration: eventData.duration || 3600000, // 1 hour default\r\n      channelId: eventData.channelId,\r\n      guildId: eventData.guildId,\r\n      creatorId: eventData.creatorId,\r\n      maxParticipants: eventData.maxParticipants || 0,\r\n      participants: [],\r\n      reminders: eventData.reminders || [],\r\n      created: Date.now(),\r\n      active: true\r\n    };\r\n\r\n    if (!this.schedules.events[eventData.guildId]) {\r\n      this.schedules.events[eventData.guildId] = [];\r\n    }\r\n\r\n    this.schedules.events[eventData.guildId].push(event);\r\n\r\n    // Schedule the event\r\n    this.scheduleEvent(event);\r\n\r\n    this.saveSchedules();\r\n    return event;\r\n  }\r\n\r\n  scheduleEvent(event) {\r\n    const delay = event.scheduledFor - Date.now();\r\n\r\n    if (delay <= 0) {\r\n      this.executeEvent(event);\r\n      return;\r\n    }\r\n\r\n    const timerId = setTimeout(() => {\r\n      this.executeEvent(event);\r\n    }, delay);\r\n\r\n    this.activeTimers.set(event.id, timerId);\r\n\r\n    // Schedule reminders if any\r\n    event.reminders.forEach((reminderOffset, index) => {\r\n      const reminderTime = event.scheduledFor - reminderOffset;\r\n      if (reminderTime > Date.now()) {\r\n        const reminderTimerId = setTimeout(() => {\r\n          this.sendEventReminder(event, reminderOffset);\r\n        }, reminderTime - Date.now());\r\n\r\n        this.activeTimers.set(`${event.id}_reminder_${index}`, reminderTimerId);\r\n      }\r\n    });\r\n  }\r\n\r\n  async executeEvent(event) {\r\n    event.active = false;\r\n    event.executedAt = Date.now();\r\n\r\n    // Update stats\r\n    if (!this.schedules.stats[event.creatorId]) {\r\n      this.schedules.stats[event.creatorId] = { reminders_sent: 0, events_executed: 0 };\r\n    }\r\n    this.schedules.stats[event.creatorId].events_executed++;\r\n\r\n    this.saveSchedules();\r\n    this.activeTimers.delete(event.id);\r\n\r\n    // Send the event via Discord\r\n    if (this.client) {\r\n      try {\r\n        const message = `üìÖ **Event Started: ${event.title}**\\n${event.description}`;\r\n        if (event.guildId) {\r\n          const guild = await this.client.guilds.fetch(event.guildId);\r\n          const channel = await guild.channels.fetch(event.channelId);\r\n          await channel.send(message);\r\n        } else {\r\n          const channel = await this.client.channels.fetch(event.channelId);\r\n          await channel.send(message);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to send event:', error);\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      event,\r\n      message: `üìÖ **Event Started: ${event.title}**\\n${event.description}`\r\n    };\r\n  }\r\n\r\n  async sendEventReminder(event, reminderOffset) {\r\n    const timeUntilEvent = Math.round(reminderOffset / 60000); // Convert to minutes\r\n    const message = `‚è∞ **Event Reminder: ${event.title}**\\nStarts in ${timeUntilEvent} minutes!\\n${event.description}`;\r\n\r\n    if (this.client) {\r\n      try {\r\n        if (event.guildId) {\r\n          const guild = await this.client.guilds.fetch(event.guildId);\r\n          const channel = await guild.channels.fetch(event.channelId);\r\n          await channel.send(message);\r\n        } else {\r\n          const channel = await this.client.channels.fetch(event.channelId);\r\n          await channel.send(message);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to send event reminder:', error);\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      message\r\n    };\r\n  }\r\n\r\n  // Advanced Time Parsing\r\n  parseTime(timeString) {\r\n    const now = new Date();\r\n\r\n    // Parse relative time (e.g., \"in 30 minutes\", \"tomorrow at 3pm\")\r\n    if (timeString.includes('in ')) {\r\n      const match = timeString.match(/in\\s+(\\d+)\\s*(second|minute|hour|day|week)s?/i);\r\n      if (match) {\r\n        const amount = parseInt(match[1]);\r\n        const unit = match[2].toLowerCase();\r\n\r\n        const multipliers = {\r\n          second: 1000,\r\n          minute: 60000,\r\n          hour: 3600000,\r\n          day: 86400000,\r\n          week: 604800000\r\n        };\r\n\r\n        return now.getTime() + (amount * multipliers[unit]);\r\n      }\r\n    }\r\n\r\n    // Parse absolute time (e.g., \"tomorrow 3pm\", \"next friday 2pm\")\r\n    if (timeString.includes('tomorrow')) {\r\n      const tomorrow = new Date(now);\r\n      tomorrow.setDate(tomorrow.getDate() + 1);\r\n      return this.parseTimeWithDate(timeString.replace('tomorrow', ''), tomorrow);\r\n    }\r\n\r\n    if (timeString.includes('next ')) {\r\n      const dayMatch = timeString.match(/next\\s+(monday|tuesday|wednesday|thursday|friday|saturday|sunday)/i);\r\n      if (dayMatch) {\r\n        const targetDay = this.getDayOfWeek(dayMatch[1]);\r\n        const currentDay = now.getDay();\r\n        const daysToAdd = (targetDay - currentDay + 7) % 7 || 7;\r\n\r\n        const targetDate = new Date(now);\r\n        targetDate.setDate(targetDate.getDate() + daysToAdd);\r\n        return this.parseTimeWithDate(timeString.replace(/next\\s+\\w+/i, ''), targetDate);\r\n      }\r\n    }\r\n\r\n    // Parse with current date\r\n    return this.parseTimeWithDate(timeString, now);\r\n  }\r\n\r\n  parseTimeWithDate(timeString, date) {\r\n    const timeMatch = timeString.match(/(\\d{1,2})(?::(\\d{2}))?\\s*(am|pm)/i);\r\n    if (timeMatch) {\r\n      let hours = parseInt(timeMatch[1]);\r\n      const minutes = parseInt(timeMatch[2] || '0');\r\n      const ampm = timeMatch[3].toLowerCase();\r\n\r\n      if (ampm === 'pm' && hours !== 12) hours += 12;\r\n      if (ampm === 'am' && hours === 12) hours = 0;\r\n\r\n      date.setHours(hours, minutes, 0, 0);\r\n      return date.getTime();\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  getDayOfWeek(dayName) {\r\n    const days = {\r\n      sunday: 0,\r\n      monday: 1,\r\n      tuesday: 2,\r\n      wednesday: 3,\r\n      thursday: 4,\r\n      friday: 5,\r\n      saturday: 6\r\n    };\r\n\r\n    return days[dayName.toLowerCase()] || 0;\r\n  }\r\n\r\n  // User Schedule Management\r\n  getUserReminders(userId, limit = 20) {\r\n    const reminders = this.schedules.reminders[userId] || [];\r\n    return reminders\r\n      .filter(r => r.active && !r.executed)\r\n      .sort((a, b) => a.scheduledFor - b.scheduledFor)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  getUserEvents(guildId, limit = 20) {\r\n    const events = this.schedules.events[guildId] || [];\r\n    return events\r\n      .filter(e => e.active)\r\n      .sort((a, b) => a.scheduledFor - b.scheduledFor)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  cancelReminder(userId, reminderId) {\r\n    const reminders = this.schedules.reminders[userId];\r\n    if (!reminders) return false;\r\n\r\n    const reminder = reminders.find(r => r.id === reminderId);\r\n    if (!reminder) return false;\r\n\r\n    reminder.active = false;\r\n    reminder.cancelledAt = Date.now();\r\n\r\n    // Cancel the timer\r\n    this.activeTimers.delete(reminderId);\r\n\r\n    this.saveSchedules();\r\n    return true;\r\n  }\r\n\r\n  cancelEvent(guildId, eventId, userId) {\r\n    const events = this.schedules.events[guildId];\r\n    if (!events) return false;\r\n\r\n    const event = events.find(e => e.id === eventId);\r\n    if (!event) return false;\r\n\r\n    // Check if user is the creator\r\n    if (event.creatorId !== userId) return false;\r\n\r\n    event.active = false;\r\n    event.cancelledAt = Date.now();\r\n    event.cancelledBy = userId;\r\n\r\n    // Cancel all related timers\r\n    this.activeTimers.delete(eventId);\r\n    event.reminders.forEach((_, index) => {\r\n      this.activeTimers.delete(`${eventId}_reminder_${index}`);\r\n    });\r\n\r\n    this.saveSchedules();\r\n    return true;\r\n  }\r\n\r\n  // Time Zone Support\r\n  setUserTimeZone(userId, timeZone) {\r\n    if (!this.schedules.userSettings) {\r\n      this.schedules.userSettings = {};\r\n    }\r\n\r\n    this.schedules.userSettings[userId] = {\r\n      ...this.schedules.userSettings[userId],\r\n      timeZone,\r\n      updated: Date.now()\r\n    };\r\n\r\n    this.saveSchedules();\r\n    return true;\r\n  }\r\n\r\n  getUserTimeZone(userId) {\r\n    return this.schedules.userSettings?.[userId]?.timeZone || 'UTC';\r\n  }\r\n\r\n  // Calendar Integration\r\n  getUpcomingEvents(userId, guildId, days = 7) {\r\n    const endTime = Date.now() + (days * 24 * 60 * 60 * 1000);\r\n    const userReminders = this.getUserReminders(userId, 100);\r\n    const guildEvents = this.getUserEvents(guildId, 100);\r\n\r\n    const allEvents = [\r\n      ...userReminders.map(r => ({ ...r, type: 'reminder' })),\r\n      ...guildEvents.map(e => ({ ...e, type: 'event' }))\r\n    ];\r\n\r\n    return allEvents\r\n      .filter(item => item.scheduledFor <= endTime)\r\n      .sort((a, b) => a.scheduledFor - b.scheduledFor)\r\n      .slice(0, 20);\r\n  }\r\n\r\n  // Statistics and Analytics\r\n  getSchedulerStats(userId) {\r\n    const stats = this.schedules.stats[userId] || { reminders_sent: 0, events_executed: 0 };\r\n\r\n    return {\r\n      remindersSent: stats.reminders_sent,\r\n      eventsExecuted: stats.events_executed,\r\n      totalScheduled: stats.reminders_sent + stats.events_executed,\r\n      activeReminders: this.getUserReminders(userId, 100).length\r\n    };\r\n  }\r\n\r\n  // Advanced Features\r\n  startScheduler() {\r\n    // Load existing schedules and set up timers\r\n    for (const userId in this.schedules.reminders) {\r\n      for (const reminder of this.schedules.reminders[userId]) {\r\n        if (reminder.active && !reminder.executed && reminder.scheduledFor > Date.now()) {\r\n          this.scheduleReminder(reminder);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const guildId in this.schedules.events) {\r\n      for (const event of this.schedules.events[guildId]) {\r\n        if (event.active && event.scheduledFor > Date.now()) {\r\n          this.scheduleEvent(event);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Cleanup and Maintenance\r\n  cleanup() {\r\n    const now = Date.now();\r\n    const expiredReminders = [];\r\n\r\n    // Find expired reminders\r\n    for (const userId in this.schedules.reminders) {\r\n      const userReminders = this.schedules.reminders[userId];\r\n      for (const reminder of userReminders) {\r\n        if (reminder.scheduledFor < now - (24 * 60 * 60 * 1000) && !reminder.executed) {\r\n          expiredReminders.push(reminder.id);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Clean up expired timers\r\n    for (const [timerId] of this.activeTimers) {\r\n      if (expiredReminders.includes(timerId)) {\r\n        clearTimeout(this.activeTimers.get(timerId));\r\n        this.activeTimers.delete(timerId);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const schedulerManager = new SchedulerManager();\r\n\r\n// Convenience functions\r\nexport function createReminder(userId, reminderData) {\r\n  return schedulerManager.createReminder(userId, reminderData);\r\n}\r\n\r\nexport function createEvent(eventData) {\r\n  return schedulerManager.createEvent(eventData);\r\n}\r\n\r\nexport function parseTime(timeString) {\r\n  return schedulerManager.parseTime(timeString);\r\n}\r\n\r\nexport function getUserReminders(userId, limit = 20) {\r\n  return schedulerManager.getUserReminders(userId, limit);\r\n}\r\n\r\nexport function getUserEvents(guildId, limit = 20) {\r\n  return schedulerManager.getUserEvents(guildId, limit);\r\n}\r\n\r\nexport function cancelReminder(userId, reminderId) {\r\n  return schedulerManager.cancelReminder(userId, reminderId);\r\n}\r\n\r\nexport function cancelEvent(guildId, eventId, userId) {\r\n  return schedulerManager.cancelEvent(guildId, eventId, userId);\r\n}\r\n\r\nexport function getUpcomingEvents(userId, guildId, days = 7) {\r\n  return schedulerManager.getUpcomingEvents(userId, guildId, days);\r\n}\r\n\r\nexport function getSchedulerStats(userId) {\r\n  return schedulerManager.getSchedulerStats(userId);\r\n}\r\n\r\n// Auto-cleanup every hour\r\nsetInterval(() => {\r\n  schedulerManager.cleanup();\r\n}, 60 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\simple-bot.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `simpleBot.js` or `SimpleBot.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":6,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[128,176],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":9,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":9,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[245,317],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":10,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":10,"endColumn":18},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":23,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":23,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[582,625],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":26,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":26,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[667,722],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":27,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":27,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[726,768],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":28,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":28,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[772,827],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":29,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":29,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[831,934],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[964,1023],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":34,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":34,"endColumn":20},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":39,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":39,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1125,1177],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":40,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":40,"endColumn":18}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import 'dotenv/config';\r\nimport { Client, GatewayIntentBits } from 'discord.js';\r\n\r\nconst TOKEN = process.env.DISCORD_TOKEN;\r\n\r\nconsole.log('üöÄ Starting Simple Bot Test...\\n');\r\n\r\nif (!TOKEN || TOKEN.includes('your-') || TOKEN.length < 50) {\r\n  console.error('‚ùå INVALID TOKEN - Please get a valid Discord bot token');\r\n  process.exit(1);\r\n}\r\n\r\nconst client = new Client({\r\n  intents: [\r\n    GatewayIntentBits.Guilds,\r\n    GatewayIntentBits.DirectMessages,\r\n    GatewayIntentBits.MessageContent,\r\n    GatewayIntentBits.GuildMessages,\r\n    GatewayIntentBits.GuildMembers\r\n  ]\r\n});\r\n\r\nconsole.log('üîÑ Connecting to Discord...');\r\n\r\nclient.once('clientReady', () => {\r\n  console.log('üéâ SUCCESS! Bot is connected and ready!');\r\n  console.log(`ü§ñ Bot: ${client.user.tag}`);\r\n  console.log(`üåê Servers: ${client.guilds.cache.size}`);\r\n  console.log(`üë• Users: ${client.guilds.cache.reduce((total, guild) => total + guild.memberCount, 0)}`);\r\n\r\n  setTimeout(() => {\r\n    console.log('\\n‚úÖ Simple bot test completed successfully!');\r\n    client.destroy();\r\n    process.exit(0);\r\n  }, 5000);\r\n});\r\n\r\nclient.on('error', (error) => {\r\n  console.error('‚ùå Connection error:', error.message);\r\n  process.exit(1);\r\n});\r\n\r\nclient.login(TOKEN);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\storage.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":6,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":6,"endColumn":20,"fix":{"range":[157,157],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":7,"column":1,"nodeType":"ImportDeclaration","endLine":7,"endColumn":25,"fix":{"range":[187,187],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":7,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":7,"endColumn":24,"fix":{"range":[181,181],"text":"node:"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":29,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":29,"endColumn":4,"fix":{"range":[783,783],"text":"\n"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":59,"column":7,"nodeType":"CallExpression","endLine":59,"endColumn":30},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":63,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":63,"endColumn":6,"fix":{"range":[1674,1674],"text":"\n"}},{"ruleId":"unicorn/prefer-type-error","severity":2,"message":"`new Error()` is too unspecific for a type check. Use `new TypeError()` instead.","line":81,"column":15,"nodeType":"Identifier","messageId":"prefer-type-error","endLine":81,"endColumn":20,"fix":{"range":[2121,2121],"text":"Type"}},{"ruleId":"unicorn/no-useless-undefined","severity":2,"message":"Do not use useless `undefined`.","line":87,"column":14,"nodeType":"Identifier","messageId":"no-useless-undefined","endLine":87,"endColumn":23,"fix":{"range":[2342,2352],"text":""}},{"ruleId":"complexity","severity":2,"message":"Function 'readAll' has a complexity of 12. Maximum allowed is 10.","line":97,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":143,"endColumn":2},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":101,"column":8,"nodeType":"CallExpression","endLine":101,"endColumn":31},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found statSync from package \"fs\" with non literal argument at index 0","line":107,"column":19,"nodeType":"CallExpression","endLine":107,"endColumn":40},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":109,"column":46,"nodeType":"Literal","messageId":"error","endLine":109,"endColumn":50,"suggestions":[{"messageId":"replace","fix":{"range":[2902,2906],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":113,"column":18,"nodeType":"CallExpression","endLine":113,"endColumn":61},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":121,"column":51,"nodeType":"Literal","messageId":"error","endLine":121,"endColumn":55,"suggestions":[{"messageId":"replace","fix":{"range":[3334,3338],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":126,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":126,"endColumn":4,"fix":{"range":[3433,3433],"text":"\n"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found existsSync from package \"fs\" with non literal argument at index 0","line":130,"column":9,"nodeType":"CallExpression","endLine":130,"endColumn":34},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found readFileSync from package \"fs\" with non literal argument at index 0","line":133,"column":28,"nodeType":"CallExpression","endLine":133,"endColumn":73},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":133,"column":56,"nodeType":"Identifier","messageId":"prefer-json-parse-buffer","endLine":133,"endColumn":72,"fix":{"range":[3799,3817],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":137,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":137,"endColumn":8,"fix":{"range":[3984,3984],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":160,"column":54,"nodeType":"Literal","messageId":"error","endLine":160,"endColumn":58,"suggestions":[{"messageId":"replace","fix":{"range":[4572,4576],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":169,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":169,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[4921,4989],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found writeFileSync from package \"fs\" with non literal argument at index 0","line":170,"column":5,"nodeType":"CallExpression","endLine":170,"endColumn":61},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found renameSync from package \"fs\" with non literal argument at index 0,1","line":171,"column":5,"nodeType":"CallExpression","endLine":171,"endColumn":38},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":174,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":174,"endColumn":4,"fix":{"range":[5195,5195],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":188,"column":12,"nodeType":"Literal","messageId":"error","endLine":188,"endColumn":16,"suggestions":[{"messageId":"remove","fix":{"range":[5551,5555],"text":""},"data":{},"desc":"Remove `null`."},{"messageId":"replace","fix":{"range":[5551,5555],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":21,"nodeType":"MemberExpression","endLine":192,"endColumn":28},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":192,"column":32,"nodeType":"Literal","messageId":"error","endLine":192,"endColumn":36,"suggestions":[{"messageId":"replace","fix":{"range":[5622,5626],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":5,"nodeType":"MemberExpression","endLine":217,"endColumn":12},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":28,"nodeType":"MemberExpression","endLine":217,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":52,"nodeType":"MemberExpression","endLine":217,"endColumn":59},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":217,"column":71,"nodeType":"MemberExpression","endLine":217,"endColumn":78},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":222,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":222,"endColumn":4,"fix":{"range":[6537,6537],"text":"\n"}}],"suppressedMessages":[],"errorCount":20,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":12,"fixableWarningCount":0,"source":"/**\r\n * Storage utilities for Discord bot data persistence.\r\n * Provides JSON file-based storage with error handling and validation.\r\n */\r\n\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { logger } from './logger.js';\r\n\r\n/**\r\n * Configuration constants for storage.\r\n */\r\nconst DATA_DIR = path.join(process.cwd(), 'data');\r\nconst GUILDS_FILE = 'guilds.json';\r\nconst DEFAULT_ENCODING = 'utf8';\r\nconst JSON_INDENT = 2;\r\nconst MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB max file size\r\nconst BACKUP_SUFFIX = '.backup';\r\n\r\n/**\r\n * Ensures the data directory exists.\r\n */\r\nfunction ensureDataDirectory() {\r\n  try {\r\n    if (!fs.existsSync(DATA_DIR)) {\r\n      fs.mkdirSync(DATA_DIR, { recursive: true });\r\n      logger.info('Created data directory', { path: DATA_DIR });\r\n    }\r\n  } catch (error) {\r\n    logger.error('Failed to create data directory', error, { path: DATA_DIR });\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Initializes the database by ensuring the data directory exists.\r\n */\r\nexport function initializeDatabase() {\r\n  ensureDataDirectory();\r\n}\r\n\r\n/**\r\n * Gets the full path to a storage file.\r\n * @param {string} filename - The filename\r\n * @returns {string} Full path to the file\r\n */\r\nfunction getFilePath(filename) {\r\n  return path.join(DATA_DIR, filename);\r\n}\r\n\r\n/**\r\n * Creates a backup of the storage file.\r\n * @param {string} filename - The filename to backup\r\n */\r\nfunction createBackup(filename) {\r\n  const filePath = getFilePath(filename);\r\n  const backupPath = filePath + BACKUP_SUFFIX;\r\n\r\n  if (fs.existsSync(filePath)) {\r\n    try {\r\n      fs.copyFileSync(filePath, backupPath);\r\n      logger.debug('Created backup', { filePath, backupPath });\r\n    } catch (error) {\r\n      logger.warn('Failed to create backup', error, { filePath, backupPath });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Validates and sanitizes data before storage.\r\n * @param {any} data - Data to validate\r\n * @returns {object} Validated data object\r\n * @throws {Error} If data is invalid\r\n */\r\nfunction validateData(data) {\r\n  if (data === null || data === undefined) {\r\n    return {};\r\n  }\r\n\r\n  if (typeof data !== 'object') {\r\n    throw new Error('Data must be an object');\r\n  }\r\n\r\n  // Basic sanitization - remove circular references and functions\r\n  return JSON.parse(JSON.stringify(data, (key, value) => {\r\n    if (typeof value === 'function') {\r\n      return undefined; // Remove functions\r\n    }\r\n    return value;\r\n  }));\r\n}\r\n\r\n/**\r\n * Reads all data from the guilds storage file.\r\n * @returns {object} The stored data object\r\n */\r\nexport function readAll() {\r\n  ensureDataDirectory();\r\n  const filePath = getFilePath(GUILDS_FILE);\r\n\r\n  if (!fs.existsSync(filePath)) {\r\n    logger.debug('Storage file does not exist, returning empty object', { filePath });\r\n    return {};\r\n  }\r\n\r\n  try {\r\n    const stats = fs.statSync(filePath);\r\n    if (stats.size > MAX_FILE_SIZE) {\r\n      logger.error('Storage file too large', null, { filePath, size: stats.size, maxSize: MAX_FILE_SIZE });\r\n      return {};\r\n    }\r\n\r\n    const data = fs.readFileSync(filePath, DEFAULT_ENCODING);\r\n    if (!data || data.trim() === '') {\r\n      logger.warn('Storage file is empty', { filePath });\r\n      return {};\r\n    }\r\n\r\n    const parsed = JSON.parse(data);\r\n    if (typeof parsed !== 'object' || Array.isArray(parsed)) {\r\n      logger.error('Invalid storage file format', null, { filePath, type: typeof parsed });\r\n      return {};\r\n    }\r\n\r\n    return parsed || {};\r\n  } catch (error) {\r\n    logger.error('Failed to read storage file', error, { filePath });\r\n    // Try to restore from backup if available\r\n    const backupPath = filePath + BACKUP_SUFFIX;\r\n    if (fs.existsSync(backupPath)) {\r\n      try {\r\n        logger.info('Attempting to restore from backup', { backupPath });\r\n        const backupData = fs.readFileSync(backupPath, DEFAULT_ENCODING);\r\n        const parsedBackup = JSON.parse(backupData);\r\n        fs.copyFileSync(backupPath, filePath); // Restore backup\r\n        return parsedBackup || {};\r\n      } catch (backupError) {\r\n        logger.error('Failed to restore from backup', backupError, { backupPath });\r\n      }\r\n    }\r\n    return {};\r\n  }\r\n}\r\n\r\n/**\r\n * Writes all data to the guilds storage file.\r\n * @param {object} data - The data object to write\r\n */\r\nexport function writeAll(data) {\r\n  ensureDataDirectory();\r\n  const filePath = getFilePath(GUILDS_FILE);\r\n\r\n  try {\r\n    // Validate data before writing\r\n    const validatedData = validateData(data);\r\n\r\n    // Create backup before writing\r\n    createBackup(GUILDS_FILE);\r\n\r\n    const jsonString = JSON.stringify(validatedData, null, JSON_INDENT);\r\n\r\n    // Check file size before writing\r\n    if (Buffer.byteLength(jsonString, DEFAULT_ENCODING) > MAX_FILE_SIZE) {\r\n      throw new Error(`Data size exceeds maximum allowed size of ${MAX_FILE_SIZE} bytes`);\r\n    }\r\n\r\n    // Write to temporary file first, then rename for atomicity\r\n    const tempPath = filePath + '.tmp';\r\n    console.log(`[STORAGE DEBUG] Writing to storage file: ${filePath}`);\r\n    fs.writeFileSync(tempPath, jsonString, DEFAULT_ENCODING);\r\n    fs.renameSync(tempPath, filePath);\r\n\r\n    logger.debug('Successfully wrote to storage file', { filePath, size: jsonString.length });\r\n  } catch (error) {\r\n    logger.error('Failed to write storage file', error, { filePath });\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Gets guild data by ID.\r\n * @param {string} id - Guild ID\r\n * @returns {object|null} Guild data or null if not found\r\n */\r\nexport function getGuild(id) {\r\n  if (!id) {\r\n    logger.warn('getGuild called with empty ID');\r\n    return null;\r\n  }\r\n\r\n  const all = readAll();\r\n  const guildData = all[id] || null;\r\n\r\n  logger.debug('Retrieved guild data', { id, found: !!guildData });\r\n  return guildData;\r\n}\r\n\r\n/**\r\n * Sets guild data by ID.\r\n * @param {string} id - Guild ID\r\n * @param {object} data - Guild data to store\r\n * @returns {boolean} True if successful, false otherwise\r\n */\r\nexport function setGuild(id, data) {\r\n  if (!id || typeof id !== 'string') {\r\n    logger.warn('setGuild called with invalid ID', { id, idType: typeof id });\r\n    return false;\r\n  }\r\n\r\n  if (!data || typeof data !== 'object') {\r\n    logger.warn('setGuild called with invalid data', { id, dataType: typeof data });\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const all = readAll();\r\n    all[id] = { ...(typeof all[id] === 'object' && all[id] !== null ? all[id] : {}), ...data, lastUpdated: new Date().toISOString() };\r\n    writeAll(all);\r\n\r\n    logger.debug('Updated guild data', { id, dataKeys: Object.keys(data) });\r\n    return true;\r\n  } catch (error) {\r\n    logger.error('Failed to set guild data', error, { id });\r\n    return false;\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\test-commands.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testCommands.js` or `TestCommands.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":2,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":20,"fix":{"range":[41,41],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":3,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":24,"fix":{"range":[65,65],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:url` over `url`.","line":4,"column":31,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":4,"endColumn":36,"fix":{"range":[104,104],"text":"node:"}},{"ruleId":"max-statements","severity":1,"message":"Async arrow function has too many statements (35). Maximum allowed is 30.","line":6,"column":2,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":64,"endColumn":2},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":6,"column":7,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":6,"endColumn":8,"fix":{"range":[119,120],"text":""}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":7,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":7,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[131,178],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":12,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":12,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[296,344],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":13,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":13,"endColumn":20},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":17,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":17,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[468,529],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":24,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":24,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[682,721],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":34,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":34,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[994,1040],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":40,"column":9,"nodeType":"MemberExpression","messageId":"unexpected","endLine":40,"endColumn":22,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1186,1250],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":45,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":45,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1324,1392],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":47,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":47,"endColumn":6,"fix":{"range":[1401,1401],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":48,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":48,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1425,1468],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":49,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":49,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1476,1561],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":54,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":54,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1613,1642],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":54,"column":15,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":54,"endColumn":30,"fix":{"range":[1625,1640],"text":"'\\nüìä Results:'"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":55,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":55,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1646,1699],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":56,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":56,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1703,1761],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":59,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":59,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1805,1841],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":59,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":59,"endColumn":39,"fix":{"range":[1817,1839],"text":"'\\n‚ùå Failed commands:'"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":60,"column":20,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":60,"endColumn":27,"fix":{"range":[1847,1905],"text":"for (const cmd of failedCommands) console.log(`   - ${cmd}`);"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":60,"column":35,"nodeType":"MemberExpression","messageId":"unexpected","endLine":60,"endColumn":46},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":61,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":61,"endColumn":4,"fix":{"range":[1910,1910],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":62,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":62,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1923,1977],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":62,"column":17,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":62,"endColumn":57,"fix":{"range":[1935,1975],"text":"'\\nüéâ All commands loaded successfully!'"}}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":10,"fixableWarningCount":0,"source":"import 'dotenv/config';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { pathToFileURL } from 'url';\r\n\r\n(async () => {\r\n  console.log('üîç Testing command loading...\\n');\r\n\r\n  const commandsPath = path.join(process.cwd(), 'src', 'commands');\r\n\r\n  if (!fs.existsSync(commandsPath)) {\r\n    console.error('‚ùå Commands directory not found');\r\n    process.exit(1);\r\n  }\r\n\r\n  const commandFiles = fs.readdirSync(commandsPath).filter(file => file.endsWith('.js'));\r\n  console.log(`üìÅ Found ${commandFiles.length} command files`);\r\n\r\n  let loadedCount = 0;\r\n  let failedCommands = [];\r\n\r\n  for (const file of commandFiles) {\r\n    const filePath = path.join(commandsPath, file);\r\n    console.log(`\\nüìã Testing ${file}...`);\r\n\r\n    try {\r\n      // Test if file can be imported\r\n      const moduleUrl = pathToFileURL(filePath).href;\r\n      const module = await import(moduleUrl);\r\n      loadedCount++;\r\n\r\n      // Validate command structure\r\n      if (!module.data || !module.data.name) {\r\n        console.error(`‚ùå ${file}: Missing data.name`);\r\n        failedCommands.push(file);\r\n        continue;\r\n      }\r\n\r\n      if (!module.execute || typeof module.execute !== 'function') {\r\n        console.error(`‚ùå ${file}: Missing or invalid execute function`);\r\n        failedCommands.push(file);\r\n        continue;\r\n      }\r\n\r\n      console.log(`‚úÖ ${file}: Loaded successfully (${module.data.name})`);\r\n\r\n    } catch (error) {\r\n      console.error(`‚ùå ${file}: Failed to load`);\r\n      console.error(`   Error: ${error instanceof Error ? error.message : String(error)}`);\r\n      failedCommands.push(file);\r\n    }\r\n  }\r\n\r\n  console.log(`\\nüìä Results:`);\r\n  console.log(`‚úÖ Successfully loaded: ${loadedCount}`);\r\n  console.log(`‚ùå Failed to load: ${failedCommands.length}`);\r\n\r\n  if (failedCommands.length > 0) {\r\n    console.log(`\\n‚ùå Failed commands:`);\r\n    failedCommands.forEach(cmd => console.log(`   - ${cmd}`));\r\n  } else {\r\n    console.log(`\\nüéâ All commands loaded successfully!`);\r\n  }\r\n})();","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\test-modules.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testModules.js` or `TestModules.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":4,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[84,134],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":9,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":9,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[247,319],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":10,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":10,"endColumn":18},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":13,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":13,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[346,382],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":16,"column":1,"nodeType":"MemberExpression","messageId":"unexpected","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[424,478],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":22,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":22,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[637,691],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":23,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":23,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[695,742],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":33,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":33,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[879,928],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'logger' is assigned a value but never used.","line":35,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":19},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":36,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":36,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[996,1040],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":38,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":38,"endColumn":4,"fix":{"range":[1063,1063],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":39,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":39,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1085,1134],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":40,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":40,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1140,1224],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":47,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":47,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1311,1358],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'handleMessage' is assigned a value but never used.","line":49,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":26},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":50,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":50,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1431,1480],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":52,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":52,"endColumn":4,"fix":{"range":[1503,1503],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":53,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":53,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1525,1579],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":60,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":60,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1671,1723],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'isOnCooldown' is assigned a value but never used.","line":62,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":25},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":63,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":63,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[1800,1854],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":65,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":65,"endColumn":4,"fix":{"range":[1877,1877],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":66,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":66,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1899,1958],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":73,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":73,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2050,2102],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'getLocations' is assigned a value but never used.","line":75,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":25},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":76,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":76,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2179,2233],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":78,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":78,"endColumn":4,"fix":{"range":[2256,2256],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":79,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":79,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2278,2337],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":85,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":85,"endColumn":14,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2394,2444],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'getActiveAuctions' is assigned a value but never used.","line":87,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":30},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":88,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":88,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2524,2576],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":89,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":89,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"log"},"fix":{"range":[2582,2640],"text":""},"desc":"Remove the console.log()."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":90,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":90,"endColumn":4,"fix":{"range":[2645,2645],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":91,"column":5,"nodeType":"MemberExpression","messageId":"unexpected","endLine":91,"endColumn":18,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2667,2724],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":28,"fixableErrorCount":5,"fixableWarningCount":0,"source":"import 'dotenv/config';\r\nimport { Client, GatewayIntentBits } from 'discord.js';\r\n\r\nconsole.log('üîç Testing modules one by one...\\n');\r\n\r\nconst TOKEN = process.env.DISCORD_TOKEN;\r\n\r\nif (!TOKEN || TOKEN.includes('your-') || TOKEN.length < 50) {\r\n  console.error('‚ùå INVALID TOKEN - Please get a valid Discord bot token');\r\n  process.exit(1);\r\n}\r\n\r\nconsole.log('‚úÖ Token format valid');\r\n\r\n// Test 1: Basic Discord client only\r\nconsole.log('\\nüìã Test 1: Basic Discord client only');\r\nconst basicClient = new Client({\r\n  intents: [GatewayIntentBits.Guilds, GatewayIntentBits.DirectMessages]\r\n});\r\n\r\nbasicClient.once('clientReady', () => {\r\n  console.log('‚úÖ Basic client connected successfully!');\r\n  console.log(`ü§ñ Bot: ${basicClient.user.tag}`);\r\n\r\n  basicClient.destroy();\r\n  testNext();\r\n});\r\n\r\nbasicClient.login(TOKEN);\r\n\r\nasync function testNext() {\r\n  // Test 2: Add logger\r\n  console.log('\\nüìã Test 2: Adding logger module');\r\n  try {\r\n    const { logger } = await import('./logger.js');\r\n    console.log('‚úÖ Logger loaded successfully');\r\n    testNext2();\r\n  } catch (error) {\r\n    console.error('‚ùå Logger failed:', error.message);\r\n    console.error('üîß This is the issue! The logger module has ES6/CommonJS conflicts');\r\n    return;\r\n  }\r\n}\r\n\r\nasync function testNext2() {\r\n  // Test 3: Add chat module\r\n  console.log('\\nüìã Test 3: Adding chat module');\r\n  try {\r\n    const { handleMessage } = await import('./chat.js');\r\n    console.log('‚úÖ Chat module loaded successfully');\r\n    testNext3();\r\n  } catch (error) {\r\n    console.error('‚ùå Chat module failed:', error.message);\r\n    return;\r\n  }\r\n}\r\n\r\nasync function testNext3() {\r\n  // Test 4: Add cooldowns module\r\n  console.log('\\nüìã Test 4: Adding cooldowns module');\r\n  try {\r\n    const { isOnCooldown } = await import('./cooldowns.js');\r\n    console.log('‚úÖ Cooldowns module loaded successfully');\r\n    testNext4();\r\n  } catch (error) {\r\n    console.error('‚ùå Cooldowns module failed:', error.message);\r\n    return;\r\n  }\r\n}\r\n\r\nasync function testNext4() {\r\n  // Test 5: Add locations module\r\n  console.log('\\nüìã Test 5: Adding locations module');\r\n  try {\r\n    const { getLocations } = await import('./locations.js');\r\n    console.log('‚úÖ Locations module loaded successfully');\r\n    testNext5();\r\n  } catch (error) {\r\n    console.error('‚ùå Locations module failed:', error.message);\r\n    return;\r\n  }\r\n}\r\n\r\nasync function testNext5() {\r\n  console.log('\\nüìã Test 6: Adding trading module');\r\n  try {\r\n    const { getActiveAuctions } = await import('./trading.js');\r\n    console.log('‚úÖ Trading module loaded successfully');\r\n    console.log('\\nüéâ All core modules loaded successfully!');\r\n  } catch (error) {\r\n    console.error('‚ùå Trading module failed:', error.message);\r\n    return;\r\n  }\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\trading.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":25,"fix":{"range":[46,46],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"no-unused-vars","severity":1,"message":"'transferBalance' is defined but never used.","line":4,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":54},{"ruleId":"unicorn/prefer-json-parse-buffer","severity":2,"message":"Prefer reading the JSON file as a buffer.","line":28,"column":60,"nodeType":"Literal","messageId":"prefer-json-parse-buffer","endLine":28,"endColumn":66,"fix":{"range":[905,913],"text":""}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":31,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":31,"endColumn":6,"fix":{"range":[1018,1018],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":32,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":32,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1042,1089],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":44,"column":58,"nodeType":"Literal","messageId":"error","endLine":44,"endColumn":62,"suggestions":[{"messageId":"replace","fix":{"range":[1360,1364],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":45,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":45,"endColumn":6,"fix":{"range":[1377,1377],"text":"\n"}},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":46,"column":7,"nodeType":"MemberExpression","messageId":"unexpected","endLine":46,"endColumn":20,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[1401,1448],"text":""},"desc":"Remove the console.error()."}]},{"ruleId":"max-params","severity":1,"message":"Method 'createTradeRequest' has too many parameters (6). Maximum allowed is 4.","line":51,"column":3,"nodeType":"FunctionExpression","messageId":"exceed","endLine":51,"endColumn":21},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":52,"column":44,"nodeType":"CallExpression","messageId":"substr","endLine":52,"endColumn":83,"fix":{"range":[1687,1698],"text":"slice(2, 11"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'executeTrade' has too many lines (63). Maximum allowed is 50.","line":120,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":182,"endColumn":4},{"ruleId":"max-statements","severity":1,"message":"Method 'executeTrade' has too many statements (36). Maximum allowed is 30.","line":120,"column":15,"nodeType":"FunctionExpression","messageId":"exceed","endLine":182,"endColumn":4},{"ruleId":"complexity","severity":2,"message":"Method 'executeTrade' has a complexity of 13. Maximum allowed is 10.","line":120,"column":15,"nodeType":"FunctionExpression","messageId":"complex","endLine":182,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":188,"column":10,"nodeType":"MemberExpression","endLine":188,"endColumn":38},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":189,"column":7,"nodeType":"MemberExpression","endLine":189,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":191,"column":10,"nodeType":"MemberExpression","endLine":191,"endColumn":35},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":192,"column":7,"nodeType":"MemberExpression","endLine":192,"endColumn":32},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":195,"column":5,"nodeType":"MemberExpression","endLine":195,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":196,"column":5,"nodeType":"MemberExpression","endLine":196,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":197,"column":5,"nodeType":"MemberExpression","endLine":197,"endColumn":33},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":199,"column":5,"nodeType":"MemberExpression","endLine":199,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":200,"column":5,"nodeType":"MemberExpression","endLine":200,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":201,"column":5,"nodeType":"MemberExpression","endLine":201,"endColumn":30},{"ruleId":"security/detect-object-injection","severity":1,"message":"Generic Object Injection Sink","line":224,"column":12,"nodeType":"MemberExpression","endLine":224,"endColumn":35},{"ruleId":"unicorn/prefer-string-slice","severity":2,"message":"Prefer `String#slice()` over `String#substr()`.","line":229,"column":48,"nodeType":"CallExpression","messageId":"substr","endLine":229,"endColumn":87,"fix":{"range":[7645,7656],"text":"slice(2, 11"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":237,"column":22,"nodeType":"Literal","messageId":"error","endLine":237,"endColumn":26,"suggestions":[{"messageId":"replace","fix":{"range":[7822,7826],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/prefer-spread","severity":2,"message":"Prefer the spread operator over `Array.from(‚Ä¶)`.","line":294,"column":12,"nodeType":"CallExpression","messageId":"array-from","endLine":294,"endColumn":46,"fix":{"range":[9666,9700],"text":"[...this.auctions.values()]"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (456). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":456,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":328,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":328,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'offeredItems' is defined but never used.","line":328,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":328,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'offeredGold' is defined but never used.","line":328,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":328,"endColumn":55},{"ruleId":"no-unused-vars","severity":1,"message":"'userId' is defined but never used.","line":338,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":338,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'requestedItems' is defined but never used.","line":338,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":338,"endColumn":46},{"ruleId":"no-unused-vars","severity":1,"message":"'requestedGold' is defined but never used.","line":338,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":338,"endColumn":61},{"ruleId":"no-unused-vars","severity":1,"message":"'auctionId' is assigned a value but never used.","line":378,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":378,"endColumn":28},{"ruleId":"max-len","severity":2,"message":"This line has a length of 129. Maximum allowed is 120.","line":397,"column":1,"nodeType":"Program","messageId":"max","endLine":397,"endColumn":130},{"ruleId":"max-params","severity":1,"message":"Function 'createTradeRequest' has too many parameters (6). Maximum allowed is 4.","line":397,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":397,"endColumn":35},{"ruleId":"max-len","severity":2,"message":"This line has a length of 128. Maximum allowed is 120.","line":398,"column":1,"nodeType":"Program","messageId":"max","endLine":398,"endColumn":129}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\nimport { getCharacter, addItemToInventory, removeItemFromInventory } from './rpg.js';\r\nimport { getBalance, subtractBalance, transferBalance, addBalance } from './economy.js';\r\n\r\nconst TRADES_FILE = path.join(process.cwd(), 'data', 'trades.json');\r\n\r\n// Advanced Trading System for Player Economy\r\nclass TradingManager {\r\n  constructor() {\r\n    this.ensureStorage();\r\n    this.loadTrades();\r\n    this.activeTrades = new Map(); // In-memory storage for active trade sessions\r\n  }\r\n\r\n  ensureStorage() {\r\n    const dir = path.dirname(TRADES_FILE);\r\n    if (!fs.existsSync(dir)) {\r\n      fs.mkdirSync(dir, { recursive: true });\r\n    }\r\n    if (!fs.existsSync(TRADES_FILE)) {\r\n      fs.writeFileSync(TRADES_FILE, JSON.stringify({ completed: [], stats: {} }));\r\n    }\r\n  }\r\n\r\n  loadTrades() {\r\n    try {\r\n      const data = JSON.parse(fs.readFileSync(TRADES_FILE, 'utf8'));\r\n      this.completedTrades = data.completed || [];\r\n      this.tradeStats = data.stats || {};\r\n    } catch (error) {\r\n      console.error('Failed to load trades:', error);\r\n      this.completedTrades = [];\r\n      this.tradeStats = {};\r\n    }\r\n  }\r\n\r\n  saveTrades() {\r\n    try {\r\n      const data = {\r\n        completed: this.completedTrades,\r\n        stats: this.tradeStats\r\n      };\r\n      fs.writeFileSync(TRADES_FILE, JSON.stringify(data, null, 2));\r\n    } catch (error) {\r\n      console.error('Failed to save trades:', error);\r\n    }\r\n  }\r\n\r\n  // Trade Creation and Management\r\n  createTradeRequest(initiatorId, targetUserId, offeredItems, requestedItems, offeredGold = 0, requestedGold = 0) {\r\n    const tradeId = `trade_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const trade = {\r\n      id: tradeId,\r\n      initiator: initiatorId,\r\n      target: targetUserId,\r\n      status: 'pending',\r\n      created: Date.now(),\r\n      offer: {\r\n        items: offeredItems || [],\r\n        gold: offeredGold\r\n      },\r\n      request: {\r\n        items: requestedItems || [],\r\n        gold: requestedGold\r\n      },\r\n      responses: {}\r\n    };\r\n\r\n    this.activeTrades.set(tradeId, trade);\r\n    return { success: true, trade };\r\n  }\r\n\r\n  acceptTrade(tradeId, userId) {\r\n    const trade = this.activeTrades.get(tradeId);\r\n    if (!trade) return { success: false, reason: 'trade_not_found' };\r\n    if (trade.target !== userId) return { success: false, reason: 'not_trade_target' };\r\n    if (trade.status !== 'pending') return { success: false, reason: 'trade_not_pending' };\r\n\r\n    trade.status = 'accepted';\r\n    trade.acceptedAt = Date.now();\r\n    return { success: true, trade };\r\n  }\r\n\r\n  declineTrade(tradeId, userId) {\r\n    const trade = this.activeTrades.get(tradeId);\r\n    if (!trade) return { success: false, reason: 'trade_not_found' };\r\n    if (trade.target !== userId && trade.initiator !== userId) {\r\n      return { success: false, reason: 'not_involved_in_trade' };\r\n    }\r\n\r\n    trade.status = 'declined';\r\n    trade.declinedAt = Date.now();\r\n\r\n    // Move to completed trades\r\n    this.completedTrades.push({ ...trade });\r\n    this.activeTrades.delete(tradeId);\r\n\r\n    this.saveTrades();\r\n    return { success: true };\r\n  }\r\n\r\n  cancelTrade(tradeId, userId) {\r\n    const trade = this.activeTrades.get(tradeId);\r\n    if (!trade) return { success: false, reason: 'trade_not_found' };\r\n    if (trade.initiator !== userId) return { success: false, reason: 'not_trade_initiator' };\r\n\r\n    trade.status = 'cancelled';\r\n    trade.cancelledAt = Date.now();\r\n\r\n    // Move to completed trades\r\n    this.completedTrades.push({ ...trade });\r\n    this.activeTrades.delete(tradeId);\r\n\r\n    this.saveTrades();\r\n    return { success: true };\r\n  }\r\n\r\n  executeTrade(tradeId) {\r\n    const trade = this.activeTrades.get(tradeId);\r\n    if (!trade) return { success: false, reason: 'trade_not_found' };\r\n    if (trade.status !== 'accepted') return { success: false, reason: 'trade_not_accepted' };\r\n\r\n    // Implement actual item/gold transfer\r\n\r\n    const initiatorChar = getCharacter(trade.initiator);\r\n    const targetChar = getCharacter(trade.target);\r\n\r\n    if (!initiatorChar || !targetChar) {\r\n      return { success: false, reason: 'character_not_found' };\r\n    }\r\n\r\n    // Transfer gold\r\n    if (trade.offer.gold > 0) {\r\n      const initiatorBalance = getBalance(trade.initiator);\r\n      if (initiatorBalance < trade.offer.gold) {\r\n        return { success: false, reason: 'insufficient_gold_initiator' };\r\n      }\r\n      subtractBalance(trade.initiator, trade.offer.gold);\r\n      addBalance(trade.target, trade.offer.gold);\r\n    }\r\n\r\n    if (trade.request.gold > 0) {\r\n      const targetBalance = getBalance(trade.target);\r\n      if (targetBalance < trade.request.gold) {\r\n        return { success: false, reason: 'insufficient_gold_target' };\r\n      }\r\n      subtractBalance(trade.target, trade.request.gold);\r\n      addBalance(trade.initiator, trade.request.gold);\r\n    }\r\n\r\n    // Transfer items\r\n    for (const itemId of trade.offer.items) {\r\n      const result = removeItemFromInventory(trade.initiator, itemId, 1);\r\n      if (!result.success) {\r\n        return { success: false, reason: 'item_transfer_failed' };\r\n      }\r\n      addItemToInventory(trade.target, itemId, 1);\r\n    }\r\n\r\n    for (const itemId of trade.request.items) {\r\n      const result = removeItemFromInventory(trade.target, itemId, 1);\r\n      if (!result.success) {\r\n        return { success: false, reason: 'item_transfer_failed' };\r\n      }\r\n      addItemToInventory(trade.initiator, itemId, 1);\r\n    }\r\n\r\n    trade.status = 'completed';\r\n    trade.completedAt = Date.now();\r\n\r\n    // Move to completed trades\r\n    this.completedTrades.push({ ...trade });\r\n    this.activeTrades.delete(tradeId);\r\n\r\n    // Update trade statistics\r\n    this.updateTradeStats(trade);\r\n\r\n    this.saveTrades();\r\n    return { success: true, trade };\r\n  }\r\n\r\n  updateTradeStats(trade) {\r\n    const initiatorId = trade.initiator;\r\n    const targetId = trade.target;\r\n\r\n    if (!this.tradeStats[initiatorId]) {\r\n      this.tradeStats[initiatorId] = { trades_completed: 0, gold_traded: 0, items_traded: 0 };\r\n    }\r\n    if (!this.tradeStats[targetId]) {\r\n      this.tradeStats[targetId] = { trades_completed: 0, gold_traded: 0, items_traded: 0 };\r\n    }\r\n\r\n    this.tradeStats[initiatorId].trades_completed++;\r\n    this.tradeStats[initiatorId].gold_traded += trade.offer.gold + trade.request.gold;\r\n    this.tradeStats[initiatorId].items_traded += trade.offer.items.length + trade.request.items.length;\r\n\r\n    this.tradeStats[targetId].trades_completed++;\r\n    this.tradeStats[targetId].gold_traded += trade.offer.gold + trade.request.gold;\r\n    this.tradeStats[targetId].items_traded += trade.offer.items.length + trade.request.items.length;\r\n  }\r\n\r\n  // Trade Browsing and Market System\r\n  getTradeListings(limit = 20) {\r\n    // Return recent completed trades for market research\r\n    return this.completedTrades\r\n      .filter(trade => trade.status === 'completed')\r\n      .sort((a, b) => b.completedAt - a.completedAt)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  getUserTradeHistory(userId, limit = 10) {\r\n    return this.completedTrades\r\n      .filter(trade =>\r\n        (trade.initiator === userId || trade.target === userId) &&\r\n        trade.status === 'completed'\r\n      )\r\n      .sort((a, b) => b.completedAt - a.completedAt)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  getTradeStats(userId) {\r\n    return this.tradeStats[userId] || { trades_completed: 0, gold_traded: 0, items_traded: 0 };\r\n  }\r\n\r\n  // Auction House System\r\n  createAuction(itemId, startingBid, durationHours = 24, sellerId) {\r\n    const auctionId = `auction_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    const auction = {\r\n      id: auctionId,\r\n      itemId,\r\n      seller: sellerId,\r\n      startingBid,\r\n      currentBid: startingBid,\r\n      highestBidder: null,\r\n      bids: [],\r\n      status: 'active',\r\n      created: Date.now(),\r\n      ends: Date.now() + (durationHours * 60 * 60 * 1000),\r\n      buyoutPrice: startingBid * 3 // Buyout at 3x starting price\r\n    };\r\n\r\n    this.auctions = this.auctions || new Map();\r\n    this.auctions.set(auctionId, auction);\r\n\r\n    return { success: true, auction };\r\n  }\r\n\r\n  placeBid(auctionId, bidderId, bidAmount) {\r\n    const auction = this.auctions?.get(auctionId);\r\n    if (!auction) return { success: false, reason: 'auction_not_found' };\r\n    if (auction.status !== 'active') return { success: false, reason: 'auction_ended' };\r\n    if (Date.now() > auction.ends) {\r\n      auction.status = 'ended';\r\n      return { success: false, reason: 'auction_expired' };\r\n    }\r\n    if (bidAmount <= auction.currentBid) return { success: false, reason: 'bid_too_low' };\r\n\r\n    // Refund previous highest bidder if exists\r\n    if (auction.highestBidder && auction.highestBidder !== bidderId) {\r\n      addBalance(auction.highestBidder, auction.currentBid);\r\n    }\r\n\r\n    auction.currentBid = bidAmount;\r\n    auction.highestBidder = bidderId;\r\n    auction.bids.push({\r\n      bidder: bidderId,\r\n      amount: bidAmount,\r\n      timestamp: Date.now()\r\n    });\r\n\r\n    return { success: true, auction };\r\n  }\r\n\r\n  buyoutAuction(auctionId, buyerId) {\r\n    const auction = this.auctions?.get(auctionId);\r\n    if (!auction) return { success: false, reason: 'auction_not_found' };\r\n    if (auction.status !== 'active') return { success: false, reason: 'auction_ended' };\r\n\r\n    auction.status = 'sold';\r\n    auction.buyer = buyerId;\r\n    auction.finalPrice = auction.buyoutPrice;\r\n    auction.soldAt = Date.now();\r\n\r\n    return { success: true, auction };\r\n  }\r\n\r\n  getActiveAuctions(limit = 20) {\r\n    if (!this.auctions) return [];\r\n\r\n    const now = Date.now();\r\n    return Array.from(this.auctions.values())\r\n      .filter(auction => auction.status === 'active' && auction.ends > now)\r\n      .sort((a, b) => b.currentBid - a.currentBid)\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // Market Price Tracking\r\n  getMarketPrices(itemId, days = 7) {\r\n    const cutoffTime = Date.now() - (days * 24 * 60 * 60 * 1000);\r\n\r\n    const relevantTrades = this.completedTrades.filter(trade => {\r\n      const tradeTime = trade.completedAt || trade.created;\r\n      return tradeTime > cutoffTime &&\r\n             (trade.offer.items.includes(itemId) || trade.request.items.includes(itemId));\r\n    });\r\n\r\n    if (relevantTrades.length === 0) {\r\n      return { average: 0, min: 0, max: 0, trades: 0 };\r\n    }\r\n\r\n    const prices = relevantTrades.map(trade => {\r\n      // Calculate price based on gold involved in trade\r\n      return (trade.offer.gold + trade.request.gold) || 50; // Use gold amount or default\r\n    });\r\n\r\n    return {\r\n      average: Math.round(prices.reduce((a, b) => a + b, 0) / prices.length),\r\n      min: Math.min(...prices),\r\n      max: Math.max(...prices),\r\n      trades: prices.length\r\n    };\r\n  }\r\n\r\n  // Trade Security and Validation\r\n  validateTradeOffer(userId, offeredItems, offeredGold) {\r\n    // Check if user has the items and gold they're offering\r\n    // This would integrate with inventory and character systems\r\n    return {\r\n      valid: true,\r\n      missingItems: [],\r\n      insufficientGold: false\r\n    };\r\n  }\r\n\r\n  validateTradeRequest(userId, requestedItems, requestedGold) {\r\n    // Check if requested items are reasonable (not asking for impossible items)\r\n    return { valid: true };\r\n  }\r\n\r\n  // Trade Analytics\r\n  getTradeAnalytics(userId) {\r\n    const userTrades = this.completedTrades.filter(trade =>\r\n      trade.initiator === userId || trade.target === userId\r\n    );\r\n\r\n    const successfulTrades = userTrades.filter(t => t.status === 'completed');\r\n    const totalValue = successfulTrades.reduce((sum, trade) =>\r\n      sum + trade.offer.gold + trade.request.gold, 0\r\n    );\r\n\r\n    return {\r\n      totalTrades: userTrades.length,\r\n      successfulTrades: successfulTrades.length,\r\n      totalValueTraded: totalValue,\r\n      successRate: userTrades.length > 0 ? (successfulTrades.length / userTrades.length) * 100 : 0,\r\n      averageTradeValue: successfulTrades.length > 0 ? totalValue / successfulTrades.length : 0\r\n    };\r\n  }\r\n\r\n  // Cleanup expired trades and auctions\r\n  cleanup() {\r\n    const now = Date.now();\r\n\r\n    // Clean up expired active trades (older than 24 hours)\r\n    for (const [tradeId, trade] of this.activeTrades) {\r\n      if (now - trade.created > 24 * 60 * 60 * 1000) {\r\n        trade.status = 'expired';\r\n        this.completedTrades.push({ ...trade });\r\n        this.activeTrades.delete(tradeId);\r\n      }\r\n    }\r\n\r\n    // Clean up ended auctions\r\n    if (this.auctions) {\r\n      for (const [auctionId, auction] of this.auctions) {\r\n        if (auction.status === 'active' && now > auction.ends) {\r\n          auction.status = 'ended';\r\n          if (auction.highestBidder) {\r\n            auction.status = 'sold';\r\n            auction.finalPrice = auction.currentBid;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.saveTrades();\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const tradingManager = new TradingManager();\r\n\r\n// Convenience functions\r\nexport function createTradeRequest(initiatorId, targetUserId, offeredItems, requestedItems, offeredGold = 0, requestedGold = 0) {\r\n  return tradingManager.createTradeRequest(initiatorId, targetUserId, offeredItems, requestedItems, offeredGold, requestedGold);\r\n}\r\n\r\nexport function acceptTrade(tradeId, userId) {\r\n  return tradingManager.acceptTrade(tradeId, userId);\r\n}\r\n\r\nexport function declineTrade(tradeId, userId) {\r\n  return tradingManager.declineTrade(tradeId, userId);\r\n}\r\n\r\nexport function cancelTrade(tradeId, userId) {\r\n  return tradingManager.cancelTrade(tradeId, userId);\r\n}\r\n\r\nexport function executeTrade(tradeId) {\r\n  return tradingManager.executeTrade(tradeId);\r\n}\r\n\r\nexport function getTradeListings(limit = 20) {\r\n  return tradingManager.getTradeListings(limit);\r\n}\r\n\r\nexport function getUserTradeHistory(userId, limit = 10) {\r\n  return tradingManager.getUserTradeHistory(userId, limit);\r\n}\r\n\r\nexport function getTradeStats(userId) {\r\n  return tradingManager.getTradeStats(userId);\r\n}\r\n\r\nexport function createAuction(itemId, startingBid, durationHours, sellerId) {\r\n  return tradingManager.createAuction(itemId, startingBid, durationHours, sellerId);\r\n}\r\n\r\nexport function placeBid(auctionId, bidderId, bidAmount) {\r\n  return tradingManager.placeBid(auctionId, bidderId, bidAmount);\r\n}\r\n\r\nexport function buyoutAuction(auctionId, buyerId) {\r\n  return tradingManager.buyoutAuction(auctionId, buyerId);\r\n}\r\n\r\nexport function getActiveAuctions(limit = 20) {\r\n  return tradingManager.getActiveAuctions(limit);\r\n}\r\n\r\nexport function getMarketPrices(itemId, days = 7) {\r\n  return tradingManager.getMarketPrices(itemId, days);\r\n}\r\n\r\nexport function getTradeAnalytics(userId) {\r\n  return tradingManager.getTradeAnalytics(userId);\r\n}\r\n\r\n// Auto-cleanup every 5 minutes\r\nsetInterval(() => {\r\n  tradingManager.cleanup();\r\n}, 5 * 60 * 1000);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\src\\validation.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"no-unused-vars","severity":1,"message":"'MAX_LOCATION_LENGTH' is assigned a value but never used.","line":15,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'MAX_QUESTION_LENGTH' is assigned a value but never used.","line":16,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'MAX_OPTION_LENGTH' is assigned a value but never used.","line":17,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":24},{"ruleId":"unicorn/no-hex-escape","severity":2,"message":"Use Unicode escapes instead of hexadecimal escapes.","line":22,"column":3,"nodeType":"Literal","messageId":"no-hex-escape","endLine":22,"endColumn":18,"fix":{"range":[664,679],"text":"/[^\\u0020-\\u007E]/g"}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 18 to the 15 allowed.","line":33,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":33,"endColumn":17},{"ruleId":"complexity","severity":2,"message":"Method 'validateString' has a complexity of 18. Maximum allowed is 10.","line":33,"column":17,"nodeType":"FunctionExpression","messageId":"complex","endLine":78,"endColumn":4},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":38,"column":24,"nodeType":"Literal","messageId":"error","endLine":38,"endColumn":28,"suggestions":[{"messageId":"replace","fix":{"range":[1147,1151],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"security/detect-non-literal-regexp","severity":1,"message":"Found non-literal argument to RegExp Constructor","line":59,"column":37,"nodeType":"NewExpression","endLine":59,"endColumn":71},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":74,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":74,"endColumn":6,"fix":{"range":[2425,2425],"text":"\n"}},{"ruleId":"complexity","severity":2,"message":"Method 'validateNumber' has a complexity of 12. Maximum allowed is 10.","line":86,"column":17,"nodeType":"FunctionExpression","messageId":"complex","endLine":121,"endColumn":4},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.NEGATIVE_INFINITY` over `-Infinity`.","line":88,"column":13,"nodeType":"UnaryExpression","messageId":"error","endLine":88,"endColumn":22,"fix":{"range":[2949,2958],"text":"Number.NEGATIVE_INFINITY"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.POSITIVE_INFINITY` over `Infinity`.","line":89,"column":13,"nodeType":"Identifier","messageId":"error","endLine":89,"endColumn":21,"fix":{"range":[2973,2981],"text":"Number.POSITIVE_INFINITY"}},{"ruleId":"unicorn/prefer-number-properties","severity":2,"message":"Prefer `Number.isNaN` over `isNaN`.","line":100,"column":9,"nodeType":"Identifier","messageId":"error","endLine":100,"endColumn":14,"suggestions":[{"messageId":"suggestion","fix":{"range":[3272,3277],"text":"Number.isNaN"},"data":{"description":"isNaN","property":"isNaN"},"desc":"Replace `isNaN` with `Number.isNaN`."}]},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":226,"column":77,"nodeType":"Literal","messageId":"error","endLine":226,"endColumn":81,"suggestions":[{"messageId":"replace","fix":{"range":[6900,6904],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":230,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":230,"endColumn":18,"fix":{"range":[6961,7011],"text":" {\r\n        return this.validateRPGCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":232,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":232,"endColumn":20,"fix":{"range":[7032,7084],"text":" {\r\n        return this.validateGuildCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":234,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":234,"endColumn":20,"fix":{"range":[7105,7157],"text":" {\r\n        return this.validateTradeCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":236,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":236,"endColumn":24,"fix":{"range":[7182,7238],"text":" {\r\n        return this.validateInventoryCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":238,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":238,"endColumn":22,"fix":{"range":[7261,7315],"text":" {\r\n        return this.validateWeatherCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":240,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":240,"endColumn":19,"fix":{"range":[7335,7386],"text":" {\r\n        return this.validatePollCommand(options);\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":242,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":242,"endColumn":15,"fix":{"range":[7402,7435],"text":" {\r\n        return { valid: true };\n      }"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'validateRPGCommand' has too many lines (57). Maximum allowed is 50.","line":247,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":303,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 26 to the 15 allowed.","line":247,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":247,"endColumn":21},{"ruleId":"complexity","severity":2,"message":"Method 'validateRPGCommand' has a complexity of 25. Maximum allowed is 10.","line":247,"column":21,"nodeType":"FunctionExpression","messageId":"complex","endLine":303,"endColumn":4},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":253,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":253,"endColumn":20,"fix":{"range":[7715,8098],"text":" {\r\n        if (subOptions.name) {\r\n          const nameValidation = this.validateUsername(subOptions.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        if (subOptions.class) {\r\n          const classValidation = this.validateCharacterClass(subOptions.class);\r\n          if (!classValidation.valid) return classValidation;\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":264,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":264,"endColumn":22,"fix":{"range":[8123,8595],"text":" {\r\n        if (subOptions.stat) {\r\n          const statValidation = this.validateRPGStat(subOptions.stat);\r\n          if (!statValidation.valid) return statValidation;\r\n        }\r\n        if (subOptions.amount) {\r\n          const amountValidation = this.validateNumber(subOptions.amount, {\r\n            min: 1, max: 100, integer: true, positive: true, required: true\r\n          });\r\n          if (!amountValidation.valid) return amountValidation;\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":285,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":285,"endColumn":20,"fix":{"range":[8797,8867],"text":" {\r\n        // No additional validation needed for these\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":289,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":289,"endColumn":20,"fix":{"range":[8890,9187],"text":" {\r\n        if (subOptions.action) {\r\n          const validActions = ['create', 'list', 'complete'];\r\n          if (!validActions.includes(subOptions.action)) {\r\n            return { valid: false, reason: 'Invalid quest action. Use: create, list, complete' };\r\n          }\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":298,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":298,"endColumn":15,"fix":{"range":[9205,9273],"text":" {\r\n        return { valid: false, reason: 'Invalid RPG subcommand' };\n      }"}},{"ruleId":"max-lines","severity":1,"message":"File has too many lines (629). Maximum allowed is 300.","line":301,"column":1,"nodeType":null,"messageId":"exceed","endLine":629,"endColumn":2},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 22 to the 15 allowed.","line":305,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":305,"endColumn":23},{"ruleId":"complexity","severity":2,"message":"Method 'validateGuildCommand' has a complexity of 14. Maximum allowed is 10.","line":305,"column":23,"nodeType":"FunctionExpression","messageId":"complex","endLine":342,"endColumn":4},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":309,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":309,"endColumn":21,"fix":{"range":[9463,9652],"text":" {\r\n        if (options.name) {\r\n          const nameValidation = this.validateGuildName(options.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        break;\n      }"}},{"ruleId":"sonarjs/no-duplicated-branches","severity":2,"message":"This case's code block is the same as the block for the case on line 309.","line":316,"column":7,"nodeType":"SwitchCase","messageId":"sameConditionalBlock","endLine":321,"endColumn":15},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":316,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":316,"endColumn":19,"fix":{"range":[9674,9863],"text":" {\r\n        if (options.name) {\r\n          const nameValidation = this.validateGuildName(options.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":323,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":323,"endColumn":20,"fix":{"range":[9886,10387],"text":" {\r\n        if (options.action) {\r\n          const validActions = ['create', 'join', 'leave'];\r\n          if (!validActions.includes(options.action)) {\r\n            return { valid: false, reason: 'Invalid party action. Use: create, join, leave' };\r\n          }\r\n        }\r\n        if (options.action === 'join' && options.party_id) {\r\n          if (!options.party_id.startsWith('party_')) {\r\n            return { valid: false, reason: 'Invalid party ID format' };\r\n          }\r\n        }\r\n        break;\n      }"}},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":330,"column":9,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":330,"endColumn":11},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":331,"column":11,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":333,"endColumn":12,"fix":{"range":[10168,10371],"text":"(options.action === 'join' && options.party_id && !options.party_id.startsWith('party_')) {\r\n            return { valid: false, reason: 'Invalid party ID format' };\r\n          }"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":337,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":337,"endColumn":15,"fix":{"range":[10405,10475],"text":" {\r\n        return { valid: false, reason: 'Invalid guild subcommand' };\n      }"}},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'validateTradeCommand' has too many lines (53). Maximum allowed is 50.","line":344,"column":3,"nodeType":"MethodDefinition","messageId":"exceed","endLine":396,"endColumn":4},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 43 to the 15 allowed.","line":344,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":344,"endColumn":23},{"ruleId":"complexity","severity":2,"message":"Method 'validateTradeCommand' has a complexity of 18. Maximum allowed is 10.","line":344,"column":23,"nodeType":"FunctionExpression","messageId":"complex","endLine":396,"endColumn":4},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":348,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":348,"endColumn":20,"fix":{"range":[10664,11592],"text":" {\r\n        if (options.offer_gold) {\r\n          const goldValidation = this.validateNumber(options.offer_gold, {\r\n            min: 0, max: 100000, integer: true, required: false\r\n          });\r\n          if (!goldValidation.valid) return goldValidation;\r\n        }\r\n        if (options.request_gold) {\r\n          const goldValidation = this.validateNumber(options.request_gold, {\r\n            min: 0, max: 100000, integer: true, required: false\r\n          });\r\n          if (!goldValidation.valid) return goldValidation;\r\n        }\r\n        if (options.offer_items) {\r\n          const items = options.offer_items.split(',').map(s => s.trim());\r\n          for (const item of items) {\r\n            if (item) {\r\n              const itemValidation = this.validateItemName(item);\r\n              if (!itemValidation.valid) return { valid: false, reason: `Invalid item: ${item}` };\r\n            }\r\n          }\r\n        }\r\n        break;\n      }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":351,"column":26,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":351,"endColumn":32,"fix":{"range":[10802,10808],"text":"100_000"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":357,"column":26,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":357,"endColumn":32,"fix":{"range":[11069,11075],"text":"100_000"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":366,"column":15,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":366,"endColumn":99},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":372,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":372,"endColumn":22,"fix":{"range":[11617,12305],"text":" {\r\n        if (options.action === 'create') {\r\n          if (options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 10000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }\r\n        }\r\n        if (options.action === 'bid') {\r\n          if (options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 100000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }\r\n        }\r\n        break;\n      }"}},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":373,"column":9,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":373,"endColumn":11},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":374,"column":11,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":379,"endColumn":12,"fix":{"range":[11630,11954],"text":"(options.action === 'create' && options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 10000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":376,"column":28,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":376,"endColumn":33,"fix":{"range":[11796,11801],"text":"10_000"}},{"ruleId":"sonarjs/no-collapsible-if","severity":2,"message":"Merge this if statement with the nested one.","line":381,"column":9,"nodeType":null,"messageId":"mergeNestedIfStatement","endLine":381,"endColumn":11},{"ruleId":"unicorn/no-lonely-if","severity":2,"message":"Unexpected `if` as the only statement in a `if` block without `else`.","line":382,"column":11,"nodeType":"IfStatement","messageId":"no-lonely-if","endLine":387,"endColumn":12,"fix":{"range":[11967,12289],"text":"(options.action === 'bid' && options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 100000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":384,"column":28,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":384,"endColumn":34,"fix":{"range":[12130,12136],"text":"100_000"}},{"ruleId":"unicorn/switch-case-braces","severity":2,"message":"Missing braces in case clause.","line":391,"column":7,"nodeType":"SwitchCase","messageId":"switch-case-braces/missing","endLine":391,"endColumn":15,"fix":{"range":[12323,12393],"text":" {\r\n        return { valid: false, reason: 'Invalid trade subcommand' };\n      }"}},{"ruleId":"no-unused-vars","severity":1,"message":"'options' is defined but never used.","line":398,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":398,"endColumn":35},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":465,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":465,"endColumn":6,"fix":{"range":[14397,14397],"text":"\n"}},{"ruleId":"sonarjs/cognitive-complexity","severity":2,"message":"Refactor this function to reduce its Cognitive Complexity from 37 to the 15 allowed.","line":520,"column":3,"nodeType":null,"messageId":"refactorFunction","endLine":520,"endColumn":17},{"ruleId":"complexity","severity":2,"message":"Method 'validateObject' has a complexity of 24. Maximum allowed is 10.","line":520,"column":17,"nodeType":"FunctionExpression","messageId":"complex","endLine":568,"endColumn":4},{"ruleId":"security/detect-object-injection","severity":1,"message":"Variable Assigned to Object Injection Sink","line":533,"column":23,"nodeType":"MemberExpression","endLine":533,"endColumn":31},{"ruleId":"unicorn/prefer-switch","severity":2,"message":"Use `switch` instead of multiple `else-if`.","line":541,"column":11,"nodeType":null,"messageId":"prefer-switch","endLine":541,"endColumn":40,"fix":{"range":[16644,17707],"text":"switch (rules.type) {\n          case 'string': {\r\n            const stringValidation = this.validateString(value, rules);\r\n            if (!stringValidation.valid) errors.push(`${key}: ${stringValidation.reason}`);\r\n          \n          break;\n          }\n          case 'number': {\r\n            const numberValidation = this.validateNumber(value, rules);\r\n            if (!numberValidation.valid) errors.push(`${key}: ${numberValidation.reason}`);\r\n          \n          break;\n          }\n          case 'userId': {\r\n            const userIdValidation = this.validateUserId(value);\r\n            if (!userIdValidation.valid) errors.push(`${key}: ${userIdValidation.reason}`);\r\n          \n          break;\n          }\n          case 'channelId': {\r\n            const channelIdValidation = this.validateChannelId(value);\r\n            if (!channelIdValidation.valid) errors.push(`${key}: ${channelIdValidation.reason}`);\r\n          \n          break;\n          }\n          case 'roleId': {\r\n            const roleIdValidation = this.validateRoleId(value);\r\n            if (!roleIdValidation.valid) errors.push(`${key}: ${roleIdValidation.reason}`);\r\n          \n          break;\n          }\n          // No default\n          }"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":543,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":543,"endColumn":92},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":544,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":544,"endColumn":12,"fix":{"range":[16853,16853],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":546,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":546,"endColumn":92},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":547,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":547,"endColumn":12,"fix":{"range":[17068,17068],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":549,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":549,"endColumn":92},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":550,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":550,"endColumn":12,"fix":{"range":[17276,17276],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":552,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":552,"endColumn":98},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":553,"column":11,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":553,"endColumn":12,"fix":{"range":[17499,17499],"text":"\n"}},{"ruleId":"max-depth","severity":2,"message":"Blocks are nested too deeply (5). Maximum allowed is 4.","line":555,"column":13,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":555,"endColumn":92},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":564,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":564,"endColumn":6,"fix":{"range":[17815,17815],"text":"\n"}}],"suppressedMessages":[],"errorCount":63,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":37,"fixableWarningCount":0,"source":"/**\r\n * Comprehensive Input Validation System for Discord Bot.\r\n * Provides validation for various data types and command inputs with security measures.\r\n */\r\n\r\nimport { logger } from './logger.js';\r\n\r\n/**\r\n * Configuration constants for validation.\r\n */\r\nconst DISCORD_ID_REGEX = /^\\d{17,19}$/;\r\nconst MAX_STRING_LENGTH = 1000;\r\nconst MAX_USERNAME_LENGTH = 32;\r\nconst MAX_GUILD_NAME_LENGTH = 20;\r\nconst MAX_LOCATION_LENGTH = 50;\r\nconst MAX_QUESTION_LENGTH = 200;\r\nconst MAX_OPTION_LENGTH = 50;\r\nconst SANITIZATION_PATTERNS = [\r\n  /[<>]/g, // Remove potential HTML tags\r\n  /javascript:/gi, // Remove javascript: protocol\r\n  /on\\w+=/gi, // Remove event handlers\r\n  /[^\\x20-\\x7E]/g // Remove non-printable characters\r\n];\r\n\r\nclass InputValidator {\r\n\r\n  /**\r\n   * Validates string input with various constraints.\r\n   * @param {string} input - The string to validate\r\n   * @param {object} options - Validation options\r\n   * @returns {object} Validation result with valid boolean and reason\r\n   */\r\n  validateString(input, options = {}) {\r\n    try {\r\n      const {\r\n        minLength = 0,\r\n        maxLength = MAX_STRING_LENGTH,\r\n        allowedChars = null,\r\n        blockedWords = [],\r\n        required = false\r\n      } = options;\r\n\r\n      if (required && (!input || input.trim() === '')) {\r\n        return { valid: false, reason: 'This field is required' };\r\n      }\r\n\r\n      if (input && typeof input !== 'string') {\r\n        return { valid: false, reason: 'Input must be a string' };\r\n      }\r\n\r\n      if (input && input.length < minLength) {\r\n        return { valid: false, reason: `Must be at least ${minLength} characters` };\r\n      }\r\n\r\n      if (input && input.length > maxLength) {\r\n        return { valid: false, reason: `Must be no more than ${maxLength} characters` };\r\n      }\r\n\r\n      if (input && allowedChars && !new RegExp(`^[${allowedChars}]+$`).test(input)) {\r\n        return { valid: false, reason: `Contains invalid characters. Allowed: ${allowedChars}` };\r\n      }\r\n\r\n      if (input && blockedWords.length > 0) {\r\n        const lowerInput = input.toLowerCase();\r\n        for (const word of blockedWords) {\r\n          if (lowerInput.includes(word.toLowerCase())) {\r\n            logger.warn('Blocked word detected in input', { word: word.toLowerCase() });\r\n            return { valid: false, reason: 'Contains inappropriate content' };\r\n          }\r\n        }\r\n      }\r\n\r\n      return { valid: true };\r\n    } catch (error) {\r\n      logger.error('Error in validateString', error, { input: typeof input, options });\r\n      return { valid: false, reason: 'Validation error occurred' };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates number input with various constraints.\r\n   * @param {any} input - The value to validate as a number\r\n   * @param {object} options - Validation options\r\n   * @returns {object} Validation result with valid boolean, reason, and parsed value\r\n   */\r\n  validateNumber(input, options = {}) {\r\n    const {\r\n      min = -Infinity,\r\n      max = Infinity,\r\n      integer = false,\r\n      positive = false,\r\n      required = false\r\n    } = options;\r\n\r\n    if (required && (input === null || input === undefined || input === '')) {\r\n      return { valid: false, reason: 'This field is required' };\r\n    }\r\n\r\n    const num = Number(input);\r\n    if (isNaN(num)) {\r\n      return { valid: false, reason: 'Must be a valid number' };\r\n    }\r\n\r\n    if (integer && !Number.isInteger(num)) {\r\n      return { valid: false, reason: 'Must be a whole number' };\r\n    }\r\n\r\n    if (positive && num <= 0) {\r\n      return { valid: false, reason: 'Must be a positive number' };\r\n    }\r\n\r\n    if (num < min) {\r\n      return { valid: false, reason: `Must be at least ${min}` };\r\n    }\r\n\r\n    if (num > max) {\r\n      return { valid: false, reason: `Must be no more than ${max}` };\r\n    }\r\n\r\n    return { valid: true, value: num };\r\n  }\r\n\r\n  /**\r\n   * Validates username with character constraints.\r\n   * @param {string} username - Username to validate\r\n   * @param {object} options - Validation options\r\n   * @returns {object} Validation result\r\n   */\r\n  validateUsername(username, options = {}) {\r\n    const {\r\n      minLength = 2,\r\n      maxLength = MAX_USERNAME_LENGTH,\r\n      allowSpaces = false,\r\n      allowSpecialChars = false\r\n    } = options;\r\n\r\n    let allowedChars = 'a-zA-Z0-9';\r\n    if (allowSpaces) allowedChars += ' ';\r\n    if (allowSpecialChars) allowedChars += '_-';\r\n\r\n    return this.validateString(username, {\r\n      minLength,\r\n      maxLength,\r\n      allowedChars,\r\n      required: true\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Validates item name against allowed items list.\r\n   * @param {string} itemName - Item name to validate\r\n   * @returns {object} Validation result\r\n   */\r\n  validateItemName(itemName) {\r\n    const validItems = [\r\n      'rusty_sword', 'iron_sword', 'magic_staff', 'legendary_blade',\r\n      'leather_armor', 'chain_mail', 'plate_armor', 'dragon_armor',\r\n      'health_potion', 'mana_potion', 'revive_crystal',\r\n      'iron_ore', 'magic_crystal', 'dragon_scale'\r\n    ];\r\n\r\n    if (!validItems.includes(itemName)) {\r\n      return { valid: false, reason: `Invalid item name. Valid items: ${validItems.join(', ')}` };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Validates guild name with length and character constraints.\r\n   * @param {string} guildName - Guild name to validate\r\n   * @returns {object} Validation result\r\n   */\r\n  validateGuildName(guildName) {\r\n    return this.validateString(guildName, {\r\n      minLength: 3,\r\n      maxLength: MAX_GUILD_NAME_LENGTH,\r\n      allowedChars: 'a-zA-Z0-9 ',\r\n      required: true\r\n    });\r\n  }\r\n\r\n  // Location validation\r\n  validateLocation(locationName) {\r\n    const validLocations = [\r\n      'whispering_woods', 'crystal_caverns', 'volcano_summit',\r\n      'forgotten_temple', 'shadow_realm', 'celestial_spire'\r\n    ];\r\n\r\n    if (!validLocations.includes(locationName)) {\r\n      return { valid: false, reason: 'Invalid location' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  // RPG stat validation\r\n  validateRPGStat(stat) {\r\n    const validStats = ['hp', 'maxhp', 'atk', 'def', 'spd'];\r\n\r\n    if (!validStats.includes(stat)) {\r\n      return { valid: false, reason: 'Invalid stat. Use: hp, maxhp, atk, def, spd' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  // Character class validation\r\n  validateCharacterClass(charClass) {\r\n    const validClasses = ['warrior', 'mage', 'rogue', 'paladin'];\r\n\r\n    if (!validClasses.includes(charClass)) {\r\n      return { valid: false, reason: 'Invalid class. Use: warrior, mage, rogue, paladin' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  // Command-specific validation\r\n  validateCommandInput(interaction) {\r\n    const commandName = interaction.commandName;\r\n    const options = {};\r\n\r\n    // Extract all option values\r\n    for (const option of interaction.options.data) {\r\n      options[option.name] = interaction.options.get(option.name)?.value || null;\r\n    }\r\n\r\n    switch (commandName) {\r\n      case 'rpg':\r\n        return this.validateRPGCommand(options);\r\n      case 'guild':\r\n        return this.validateGuildCommand(options);\r\n      case 'trade':\r\n        return this.validateTradeCommand(options);\r\n      case 'inventory':\r\n        return this.validateInventoryCommand(options);\r\n      case 'weather':\r\n        return this.validateWeatherCommand(options);\r\n      case 'poll':\r\n        return this.validatePollCommand(options);\r\n      default:\r\n        return { valid: true };\r\n    }\r\n  }\r\n\r\n  validateRPGCommand(options) {\r\n    // For slash commands, subcommand is accessed differently\r\n    const subcommand = options.subcommand || options.subcommand_group || options.sub;\r\n    const subOptions = options;\r\n\r\n    switch (subcommand) {\r\n      case 'start':\r\n        if (subOptions.name) {\r\n          const nameValidation = this.validateUsername(subOptions.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        if (subOptions.class) {\r\n          const classValidation = this.validateCharacterClass(subOptions.class);\r\n          if (!classValidation.valid) return classValidation;\r\n        }\r\n        break;\r\n\r\n      case 'levelup':\r\n        if (subOptions.stat) {\r\n          const statValidation = this.validateRPGStat(subOptions.stat);\r\n          if (!statValidation.valid) return statValidation;\r\n        }\r\n        if (subOptions.amount) {\r\n          const amountValidation = this.validateNumber(subOptions.amount, {\r\n            min: 1, max: 100, integer: true, positive: true, required: true\r\n          });\r\n          if (!amountValidation.valid) return amountValidation;\r\n        }\r\n        break;\r\n\r\n      case 'fight':\r\n      case 'explore':\r\n      case 'boss':\r\n      case 'stats':\r\n      case 'leaderboard':\r\n      case 'reset':\r\n      case 'class':\r\n      case 'inventory':\r\n      case 'craft':\r\n        // No additional validation needed for these\r\n        break;\r\n\r\n      case 'quest':\r\n        if (subOptions.action) {\r\n          const validActions = ['create', 'list', 'complete'];\r\n          if (!validActions.includes(subOptions.action)) {\r\n            return { valid: false, reason: 'Invalid quest action. Use: create, list, complete' };\r\n          }\r\n        }\r\n        break;\r\n\r\n      default:\r\n        return { valid: false, reason: 'Invalid RPG subcommand' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  validateGuildCommand(options) {\r\n    const subcommand = options.subcommand || options.sub;\r\n\r\n    switch (subcommand) {\r\n      case 'create':\r\n        if (options.name) {\r\n          const nameValidation = this.validateGuildName(options.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        break;\r\n\r\n      case 'join':\r\n        if (options.name) {\r\n          const nameValidation = this.validateGuildName(options.name);\r\n          if (!nameValidation.valid) return nameValidation;\r\n        }\r\n        break;\r\n\r\n      case 'party':\r\n        if (options.action) {\r\n          const validActions = ['create', 'join', 'leave'];\r\n          if (!validActions.includes(options.action)) {\r\n            return { valid: false, reason: 'Invalid party action. Use: create, join, leave' };\r\n          }\r\n        }\r\n        if (options.action === 'join' && options.party_id) {\r\n          if (!options.party_id.startsWith('party_')) {\r\n            return { valid: false, reason: 'Invalid party ID format' };\r\n          }\r\n        }\r\n        break;\r\n\r\n      default:\r\n        return { valid: false, reason: 'Invalid guild subcommand' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  validateTradeCommand(options) {\r\n    const subcommand = options.subcommand || options.sub;\r\n\r\n    switch (subcommand) {\r\n      case 'offer':\r\n        if (options.offer_gold) {\r\n          const goldValidation = this.validateNumber(options.offer_gold, {\r\n            min: 0, max: 100000, integer: true, required: false\r\n          });\r\n          if (!goldValidation.valid) return goldValidation;\r\n        }\r\n        if (options.request_gold) {\r\n          const goldValidation = this.validateNumber(options.request_gold, {\r\n            min: 0, max: 100000, integer: true, required: false\r\n          });\r\n          if (!goldValidation.valid) return goldValidation;\r\n        }\r\n        if (options.offer_items) {\r\n          const items = options.offer_items.split(',').map(s => s.trim());\r\n          for (const item of items) {\r\n            if (item) {\r\n              const itemValidation = this.validateItemName(item);\r\n              if (!itemValidation.valid) return { valid: false, reason: `Invalid item: ${item}` };\r\n            }\r\n          }\r\n        }\r\n        break;\r\n\r\n      case 'auction':\r\n        if (options.action === 'create') {\r\n          if (options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 10000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }\r\n        }\r\n        if (options.action === 'bid') {\r\n          if (options.price) {\r\n            const priceValidation = this.validateNumber(options.price, {\r\n              min: 1, max: 100000, integer: true, positive: true, required: true\r\n            });\r\n            if (!priceValidation.valid) return priceValidation;\r\n          }\r\n        }\r\n        break;\r\n\r\n      default:\r\n        return { valid: false, reason: 'Invalid trade subcommand' };\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  validateInventoryCommand(options) {\r\n    // Inventory commands generally don't need complex validation\r\n    return { valid: true };\r\n  }\r\n\r\n  validateWeatherCommand(options) {\r\n    if (options.location) {\r\n      const locationValidation = this.validateString(options.location, {\r\n        minLength: 2,\r\n        maxLength: 50,\r\n        required: true\r\n      });\r\n      if (!locationValidation.valid) return locationValidation;\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  validatePollCommand(options) {\r\n    if (options.question) {\r\n      const questionValidation = this.validateString(options.question, {\r\n        minLength: 5,\r\n        maxLength: 200,\r\n        required: true\r\n      });\r\n      if (!questionValidation.valid) return questionValidation;\r\n    }\r\n\r\n    for (let i = 1; i <= 4; i++) {\r\n      if (options[`option${i}`]) {\r\n        const optionValidation = this.validateString(options[`option${i}`], {\r\n          minLength: 1,\r\n          maxLength: 50,\r\n          required: i <= 2 // First two options are required\r\n        });\r\n        if (!optionValidation.valid) return optionValidation;\r\n      }\r\n    }\r\n\r\n    if (options.duration) {\r\n      const durationValidation = this.validateNumber(options.duration, {\r\n        min: 1, max: 60, integer: true, positive: true, required: false\r\n      });\r\n      if (!durationValidation.valid) return durationValidation;\r\n    }\r\n\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Sanitizes user input to prevent XSS and other security issues.\r\n   * @param {any} input - Input to sanitize\r\n   * @returns {any} Sanitized input\r\n   */\r\n  sanitizeInput(input) {\r\n    if (typeof input !== 'string') return input;\r\n\r\n    try {\r\n      let sanitized = input.trim();\r\n\r\n      // Apply all sanitization patterns\r\n      for (const pattern of SANITIZATION_PATTERNS) {\r\n        sanitized = sanitized.replace(pattern, '');\r\n      }\r\n\r\n      // Limit length\r\n      return sanitized.slice(0, MAX_STRING_LENGTH);\r\n    } catch (error) {\r\n      logger.error('Error in sanitizeInput', error, { inputType: typeof input });\r\n      return ''; // Return empty string on error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates Discord user ID format.\r\n   * @param {string} userId - User ID to validate\r\n   * @returns {object} Validation result\r\n   */\r\n  validateUserId(userId) {\r\n    if (!userId || typeof userId !== 'string') {\r\n      return { valid: false, reason: 'User ID must be a string' };\r\n    }\r\n\r\n    if (!DISCORD_ID_REGEX.test(userId)) {\r\n      return { valid: false, reason: 'Invalid user ID format' };\r\n    }\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Validates Discord channel ID format.\r\n   * @param {string} channelId - Channel ID to validate\r\n   * @returns {object} Validation result\r\n   */\r\n  validateChannelId(channelId) {\r\n    if (!channelId || typeof channelId !== 'string') {\r\n      return { valid: false, reason: 'Channel ID must be a string' };\r\n    }\r\n\r\n    if (!DISCORD_ID_REGEX.test(channelId)) {\r\n      return { valid: false, reason: 'Invalid channel ID format' };\r\n    }\r\n    return { valid: true };\r\n  }\r\n\r\n  /**\r\n   * Validates Discord role ID format.\r\n   * @param {string} roleId - Role ID to validate\r\n   * @returns {object} Validation result\r\n   */\r\n  validateRoleId(roleId) {\r\n    if (!roleId || typeof roleId !== 'string') {\r\n      return { valid: false, reason: 'Role ID must be a string' };\r\n    }\r\n\r\n    if (!DISCORD_ID_REGEX.test(roleId)) {\r\n      return { valid: false, reason: 'Invalid role ID format' };\r\n    }\r\n    return { valid: true };\r\n  }\r\n\r\n  // Bulk validation for complex objects\r\n  validateObject(obj, schema) {\r\n    try {\r\n      if (!obj || typeof obj !== 'object') {\r\n        return { valid: false, errors: ['Input must be an object'] };\r\n      }\r\n\r\n      if (!schema || typeof schema !== 'object') {\r\n        return { valid: false, errors: ['Schema must be an object'] };\r\n      }\r\n\r\n      const errors = [];\r\n\r\n      for (const [key, rules] of Object.entries(schema)) {\r\n        const value = obj[key];\r\n\r\n        if (rules.required && (value === null || value === undefined)) {\r\n          errors.push(`${key} is required`);\r\n          continue;\r\n        }\r\n\r\n        if (value !== null && value !== undefined) {\r\n          if (rules.type === 'string') {\r\n            const stringValidation = this.validateString(value, rules);\r\n            if (!stringValidation.valid) errors.push(`${key}: ${stringValidation.reason}`);\r\n          } else if (rules.type === 'number') {\r\n            const numberValidation = this.validateNumber(value, rules);\r\n            if (!numberValidation.valid) errors.push(`${key}: ${numberValidation.reason}`);\r\n          } else if (rules.type === 'userId') {\r\n            const userIdValidation = this.validateUserId(value);\r\n            if (!userIdValidation.valid) errors.push(`${key}: ${userIdValidation.reason}`);\r\n          } else if (rules.type === 'channelId') {\r\n            const channelIdValidation = this.validateChannelId(value);\r\n            if (!channelIdValidation.valid) errors.push(`${key}: ${channelIdValidation.reason}`);\r\n          } else if (rules.type === 'roleId') {\r\n            const roleIdValidation = this.validateRoleId(value);\r\n            if (!roleIdValidation.valid) errors.push(`${key}: ${roleIdValidation.reason}`);\r\n          }\r\n        }\r\n      }\r\n\r\n      return {\r\n        valid: errors.length === 0,\r\n        errors\r\n      };\r\n    } catch (error) {\r\n      logger.error('Error in validateObject', error, { objKeys: Object.keys(obj || {}), schemaKeys: Object.keys(schema || {}) });\r\n      return { valid: false, errors: ['Validation error occurred'] };\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const inputValidator = new InputValidator();\r\n\r\n// Convenience functions\r\nexport function validateString(input, options = {}) {\r\n  return inputValidator.validateString(input, options);\r\n}\r\n\r\nexport function validateNumber(input, options = {}) {\r\n  return inputValidator.validateNumber(input, options);\r\n}\r\n\r\nexport function validateUsername(username, options = {}) {\r\n  return inputValidator.validateUsername(username, options);\r\n}\r\n\r\nexport function validateItemName(itemName) {\r\n  return inputValidator.validateItemName(itemName);\r\n}\r\n\r\nexport function validateGuildName(guildName) {\r\n  return inputValidator.validateGuildName(guildName);\r\n}\r\n\r\nexport function validateLocation(locationName) {\r\n  return inputValidator.validateLocation(locationName);\r\n}\r\n\r\nexport function validateRPGStat(stat) {\r\n  return inputValidator.validateRPGStat(stat);\r\n}\r\n\r\nexport function validateCharacterClass(charClass) {\r\n  return inputValidator.validateCharacterClass(charClass);\r\n}\r\n\r\nexport function validateCommandInput(interaction) {\r\n  return inputValidator.validateCommandInput(interaction);\r\n}\r\n\r\nexport function sanitizeInput(input) {\r\n  return inputValidator.sanitizeInput(input);\r\n}\r\n\r\nexport function validateUserId(userId) {\r\n  return inputValidator.validateUserId(userId);\r\n}\r\n\r\nexport function validateChannelId(channelId) {\r\n  return inputValidator.validateChannelId(channelId);\r\n}\r\n\r\nexport function validateRoleId(roleId) {\r\n  return inputValidator.validateRoleId(roleId);\r\n}\r\n\r\nexport function validateObject(obj, schema) {\r\n  return inputValidator.validateObject(obj, schema);\r\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\comprehensive-tests.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `comprehensiveTests.js` or `ComprehensiveTests.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"no-unused-vars","severity":1,"message":"'play' is defined but never used.","line":4,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'validateUser' is defined but never used.","line":5,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'validateGuild' is defined but never used.","line":5,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":51},{"ruleId":"no-unused-vars","severity":1,"message":"'validatePermissions' is defined but never used.","line":5,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":72},{"ruleId":"no-unused-vars","severity":1,"message":"'validateRange' is defined but never used.","line":5,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":87},{"ruleId":"no-unused-vars","severity":1,"message":"'validateNotEmpty' is defined but never used.","line":5,"column":89,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":105},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":6,"column":1,"nodeType":"ImportDeclaration","endLine":6,"endColumn":118,"fix":{"range":[741,741],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'inputValidator' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":24},{"ruleId":"import/order","severity":2,"message":"`assert` import should occur before import of `../src/economy.js`","line":7,"column":1,"nodeType":"ImportDeclaration","endLine":7,"endColumn":29,"fix":{"range":[0,773],"text":"import assert from 'assert';\r\nimport { getBalance, addBalance, transferBalance, buyFromMarket, sellToMarket, createInvestment, getUserInvestments, getMarketPrice } from '../src/economy.js';\r\nimport { warnUser, muteUser, isUserMuted, checkAutoMod, getUserModStats } from '../src/moderation.js';\r\nimport { createCharacter, getCharacter, applyXp, addItemToInventory, getInventory, deleteCharacter } from '../src/rpg.js';\r\nimport { searchSongs, play, pause, stop, getQueue } from '../src/music.js';\r\nimport { CommandError, validateUser, validateGuild, validatePermissions, validateRange, validateNotEmpty, createRateLimiter } from '../src/errorHandler.js';\r\nimport { inputValidator, sanitizeInput, validateUserId, validateNumber, validateString } from '../src/validation.js';\r\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'assert' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":14},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:assert` over `assert`.","line":7,"column":20,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":7,"endColumn":28,"fix":{"range":[763,763],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"`fs` import should occur before import of `../src/economy.js`","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":21,"fix":{"range":[0,795],"text":"import fs from 'fs';\r\nimport { getBalance, addBalance, transferBalance, buyFromMarket, sellToMarket, createInvestment, getUserInvestments, getMarketPrice } from '../src/economy.js';\r\nimport { warnUser, muteUser, isUserMuted, checkAutoMod, getUserModStats } from '../src/moderation.js';\r\nimport { createCharacter, getCharacter, applyXp, addItemToInventory, getInventory, deleteCharacter } from '../src/rpg.js';\r\nimport { searchSongs, play, pause, stop, getQueue } from '../src/music.js';\r\nimport { CommandError, validateUser, validateGuild, validatePermissions, validateRange, validateNotEmpty, createRateLimiter } from '../src/errorHandler.js';\r\nimport { inputValidator, sanitizeInput, validateUserId, validateNumber, validateString } from '../src/validation.js';\r\nimport assert from 'assert';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":8,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":8,"endColumn":20,"fix":{"range":[789,789],"text":"node:"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":36,"column":1,"nodeType":"Program","messageId":"max","endLine":36,"endColumn":145},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":49,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":49,"endColumn":6,"fix":{"range":[2013,2013],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":91,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":91,"endColumn":6,"fix":{"range":[3887,3887],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":104,"column":96,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":104,"endColumn":101,"fix":{"range":[4368,4373],"text":"60_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":122,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":122,"endColumn":6,"fix":{"range":[5214,5214],"text":"\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 177. Maximum allowed is 120.","line":153,"column":1,"nodeType":"Program","messageId":"max","endLine":153,"endColumn":178},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":155,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":155,"endColumn":6,"fix":{"range":[6622,6622],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":178,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":178,"endColumn":6,"fix":{"range":[7354,7354],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'buyResult' is assigned a value but never used.","line":189,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":189,"endColumn":22},{"ruleId":"max-len","severity":2,"message":"This line has a length of 126. Maximum allowed is 120.","line":191,"column":1,"nodeType":"Program","messageId":"max","endLine":191,"endColumn":127},{"ruleId":"max-len","severity":2,"message":"This line has a length of 153. Maximum allowed is 120.","line":205,"column":1,"nodeType":"Program","messageId":"max","endLine":205,"endColumn":154},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":207,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":207,"endColumn":6,"fix":{"range":[8863,8863],"text":"\n"}},{"ruleId":"unicorn/numeric-separators-style","severity":2,"message":"Invalid group length in numeric value.","line":230,"column":85,"nodeType":"Literal","messageId":"numeric-separators-style","endLine":230,"endColumn":90,"fix":{"range":[9982,9987],"text":"10_000"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":247,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":247,"endColumn":10,"fix":{"range":[10737,10737],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":255,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":255,"endColumn":6,"fix":{"range":[11000,11000],"text":"\n"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":279,"column":90,"nodeType":"Literal","messageId":"error","endLine":279,"endColumn":94,"suggestions":[{"messageId":"replace","fix":{"range":[11860,11864],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":296,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":296,"endColumn":45},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":296,"column":18,"nodeType":"ConditionalExpression","messageId":"thenShouldReturnOrThrow","endLine":296,"endColumn":44},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":299,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":299,"endColumn":20}],"suppressedMessages":[],"errorCount":26,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":15,"fixableWarningCount":0,"source":"import { getBalance, addBalance, transferBalance, buyFromMarket, sellToMarket, createInvestment, getUserInvestments, getMarketPrice } from '../src/economy.js';\r\nimport { warnUser, muteUser, isUserMuted, checkAutoMod, getUserModStats } from '../src/moderation.js';\r\nimport { createCharacter, getCharacter, applyXp, addItemToInventory, getInventory, deleteCharacter } from '../src/rpg.js';\r\nimport { searchSongs, play, pause, stop, getQueue } from '../src/music.js';\r\nimport { CommandError, validateUser, validateGuild, validatePermissions, validateRange, validateNotEmpty, createRateLimiter } from '../src/errorHandler.js';\r\nimport { inputValidator, sanitizeInput, validateUserId, validateNumber, validateString } from '../src/validation.js';\r\nimport assert from 'assert';\r\nimport fs from 'fs';\r\n\r\nclass ComprehensiveTestSuite {\r\n  constructor() {\r\n    this.testResults = [];\r\n    this.testCount = 0;\r\n    this.passCount = 0;\r\n    this.failCount = 0;\r\n    // Generate unique user IDs for each test run to avoid conflicts\r\n    this.testUsers = [\r\n      `testuser_${Date.now()}_1`,\r\n      `testuser_${Date.now()}_2`,\r\n      `testuser_${Date.now()}_3`\r\n    ];\r\n    this.testGuild = 'testguild1';\r\n  }\r\n\r\n  log(message, success = true) {\r\n    const status = success ? '‚úÖ' : '‚ùå';\r\n    console.log(`${status} ${message}`);\r\n    this.testResults.push({ message, success, timestamp: new Date().toISOString() });\r\n    this.testCount++;\r\n    if (success) this.passCount++;\r\n    else this.failCount++;\r\n  }\r\n\r\n  logError(message, error) {\r\n    console.error(`‚ùå ${message}: ${error.message}`);\r\n    this.testResults.push({ message: `${message}: ${error.message}`, success: false, timestamp: new Date().toISOString(), error: error.stack });\r\n    this.testCount++;\r\n    this.failCount++;\r\n  }\r\n\r\n  async delay(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  cleanupTestCharacter(userId) {\r\n    try {\r\n      deleteCharacter(userId);\r\n      this.log(`Cleaned up character for ${userId}`, true);\r\n    } catch (error) {\r\n      this.logError(`Failed to clean up character for ${userId}`, error);\r\n    }\r\n  }\r\n\r\n  async testEconomy() {\r\n    console.log('\\nüí∞ Testing Economy System');\r\n    try {\r\n      // Test balance operations\r\n      const initialBalance = getBalance(this.testUsers[0]);\r\n      this.log(`Initial balance: ${initialBalance}`, true);\r\n\r\n      addBalance(this.testUsers[0], 1000);\r\n      const newBalance = getBalance(this.testUsers[0]);\r\n      this.log(`Balance after add: ${newBalance}`, newBalance === initialBalance + 1000);\r\n\r\n      // Test transfer\r\n      const transferResult = transferBalance(this.testUsers[0], this.testUsers[1], 500);\r\n      this.log(`Transfer successful: ${transferResult.success}`, transferResult.success);\r\n\r\n      const balance1 = getBalance(this.testUsers[0]);\r\n      const balance2 = getBalance(this.testUsers[1]);\r\n      this.log(`Balance after transfer: ${balance1}, ${balance2}`, balance1 === 500 && balance2 === 500);\r\n\r\n      // Test market\r\n      const price = getMarketPrice('health_potion');\r\n      this.log(`Market price: ${price}`, price > 0);\r\n\r\n      const buyResult = buyFromMarket(this.testUsers[1], 'health_potion', 2);\r\n      this.log(`Buy successful: ${buyResult.success}`, buyResult.success);\r\n\r\n      const sellResult = sellToMarket(this.testUsers[1], 'health_potion', 1);\r\n      this.log(`Sell successful: ${sellResult.success}`, sellResult.success);\r\n\r\n      // Test investment\r\n      const investmentTypes = await import('../src/economy.js').then(m => m.getInvestmentTypes());\r\n      const invResult = createInvestment(this.testUsers[0], investmentTypes.bank, 100);\r\n      this.log(`Investment created: ${invResult.success}`, invResult.success);\r\n\r\n      const investments = getUserInvestments(this.testUsers[0]);\r\n      this.log(`Investments count: ${investments.length}`, investments.length > 0);\r\n\r\n    } catch (error) {\r\n      this.logError('Economy test failed', error);\r\n    }\r\n  }\r\n\r\n  async testModeration() {\r\n    console.log('\\nüõ°Ô∏è Testing Moderation System');\r\n    try {\r\n      // Test warning\r\n      const warn = warnUser(this.testGuild, this.testUsers[0], this.testUsers[1], 'Test warning', 'low');\r\n      this.log(`Warning issued: ${warn.id}`, !!warn.id);\r\n\r\n      // Test mute\r\n      const mute = muteUser(this.testGuild, this.testUsers[0], this.testUsers[1], 'Test mute', 60000);\r\n      this.log(`Mute issued: ${mute.id}`, !!mute.id);\r\n\r\n      // Test is muted\r\n      const muted = isUserMuted(this.testGuild, this.testUsers[0]);\r\n      this.log(`User is muted: ${muted.muted}`, muted.muted);\r\n\r\n      // Test auto mod\r\n      const autoMod = checkAutoMod(this.testGuild, { content: 'Hello world' }, this.testUsers[0]);\r\n      this.log(`Auto mod triggered: ${autoMod.triggered}`, !autoMod.triggered);\r\n\r\n      const autoModSpam = checkAutoMod(this.testGuild, { content: 'SPAM SPAM SPAM' }, this.testUsers[0]);\r\n      this.log(`Auto mod spam detected: ${autoModSpam.triggered}`, autoModSpam.violations.some(v => v.type === 'caps'));\r\n\r\n      // Test stats\r\n      const stats = getUserModStats(this.testGuild, this.testUsers[0]);\r\n      this.log(`User mod stats: warnings ${stats.warnings}`, stats.warnings > 0);\r\n\r\n    } catch (error) {\r\n      this.logError('Moderation test failed', error);\r\n    }\r\n  }\r\n\r\n  async testRPG() {\r\n    console.log('\\n‚öîÔ∏è Testing RPG System');\r\n    try {\r\n      // Cleanup any existing character before creating\r\n      this.cleanupTestCharacter(this.testUsers[0]);\r\n\r\n      // Test character creation\r\n      const char = createCharacter(this.testUsers[0], 'TestHero');\r\n      this.log(`Character created: ${char.name}`, char.name === 'TestHero');\r\n\r\n      // Test XP apply\r\n      const xpResult = applyXp(this.testUsers[0], char, 100);\r\n      this.log(`XP applied: gained ${xpResult.gained}`, xpResult.gained > 0);\r\n\r\n      // Test inventory\r\n      const itemResult = addItemToInventory(this.testUsers[0], 'health_potion', 5);\r\n      this.log(`Item added: ${itemResult.success}`, itemResult.success);\r\n\r\n      const inventory = getInventory(this.testUsers[0]);\r\n      this.log(`Inventory count: ${Object.keys(inventory).length}`, Object.keys(inventory).length > 0);\r\n\r\n      // Test get character\r\n      const savedChar = getCharacter(this.testUsers[0]);\r\n      this.log(`Character retrieved: ${savedChar ? savedChar.name : 'null'}`, !!savedChar);\r\n\r\n      // Verify character has proper structure after creation\r\n      this.log(`Character has required properties: ${savedChar.hp !== undefined && savedChar.maxHp !== undefined}`, savedChar.hp !== undefined && savedChar.maxHp !== undefined);\r\n\r\n    } catch (error) {\r\n      this.logError('RPG test failed', error);\r\n    }\r\n  }\r\n\r\n  async testMusic() {\r\n    console.log('\\nüéµ Testing Music System');\r\n    try {\r\n      // Test search\r\n      const results = await searchSongs('test song', 3);\r\n      this.log(`Search results: ${results.length}`, results.length > 0);\r\n\r\n      // Test queue\r\n      const queue = getQueue(this.testGuild);\r\n      this.log(`Queue length: ${queue.length}`, Array.isArray(queue));\r\n\r\n      // Test pause/stop\r\n      const pauseResult = await pause(this.testGuild);\r\n      this.log(`Pause executed: ${pauseResult || !pauseResult}`, true);\r\n\r\n      const stopResult = await stop(this.testGuild);\r\n      this.log(`Stop executed: ${stopResult}`, true);\r\n\r\n    } catch (error) {\r\n      this.logError('Music test failed', error);\r\n    }\r\n  }\r\n\r\n  async testIntegrations() {\r\n    console.log('\\nüîó Testing System Integrations and Security');\r\n    try {\r\n      // Test RPG-Economy integration: Buy item with gold\r\n      addBalance(this.testUsers[0], 1000);\r\n      const balanceBefore = getBalance(this.testUsers[0]);\r\n      const buyResult = buyFromMarket(this.testUsers[0], 'health_potion', 1);\r\n      const balanceAfter = getBalance(this.testUsers[0]);\r\n      this.log(`RPG-Economy integration: Balance decreased by ${balanceBefore - balanceAfter}`, balanceBefore > balanceAfter);\r\n\r\n      // Test adding item to RPG inventory after purchase (simulate)\r\n      const invResult = addItemToInventory(this.testUsers[0], 'health_potion', 1);\r\n      this.log(`Inventory updated after purchase: ${invResult.success}`, invResult.success);\r\n\r\n      // Test input sanitization in integration\r\n      const unsafeContent = '<script>alert(\"xss\")</script>Test message';\r\n      const safeContent = sanitizeInput(unsafeContent);\r\n      this.log(`Cross-site scripting prevented: ${safeContent !== unsafeContent}`, safeContent !== unsafeContent);\r\n\r\n      // Test SQL injection prevention (simulated)\r\n      const sqlInjectionAttempt = \"'; DROP TABLE users; --\";\r\n      const sanitizedSQL = sanitizeInput(sqlInjectionAttempt);\r\n      this.log(`SQL injection attempt sanitized: ${sanitizedSQL.length < sqlInjectionAttempt.length}`, sanitizedSQL.length < sqlInjectionAttempt.length);\r\n\r\n    } catch (error) {\r\n      this.logError('Integration test failed', error);\r\n    }\r\n  }\r\n\r\n  async testErrorHandling() {\r\n    console.log('\\nüö® Testing Error Handling and Validation');\r\n    try {\r\n      // Test validation functions\r\n      const stringValidation = validateString('test', { minLength: 2, maxLength: 10 });\r\n      this.log(`String validation: ${stringValidation.valid}`, stringValidation.valid);\r\n\r\n      const numberValidation = validateNumber(5, { min: 1, max: 10, integer: true });\r\n      this.log(`Number validation: ${numberValidation.valid}`, numberValidation.valid);\r\n\r\n      const userIdValidation = validateUserId('123456789012345678'); // Valid Discord snowflake\r\n      this.log(`User ID validation: ${userIdValidation.valid}`, userIdValidation.valid);\r\n\r\n      // Test input sanitization\r\n      const sanitized = sanitizeInput('<script>alert(\"xss\")</script>Hello');\r\n      this.log(`Input sanitization: ${sanitized === 'alert(\"xss\")Hello'}`, sanitized === 'alert(\"xss\")Hello');\r\n\r\n      // Test invalid transfer\r\n      const invalidTransfer = transferBalance(this.testUsers[0], this.testUsers[1], 10000);\r\n      this.log(`Invalid transfer rejected: ${!invalidTransfer.success}`, !invalidTransfer.success);\r\n\r\n      // Test insufficient funds\r\n      const insufficientBuy = buyFromMarket(this.testUsers[0], 'health_potion', 1000);\r\n      this.log(`Insufficient funds rejected: ${!insufficientBuy.success}`, !insufficientBuy.success);\r\n\r\n      // Test invalid character\r\n      const invalidChar = getCharacter('nonexistent');\r\n      this.log(`Invalid character handled: ${!invalidChar}`, !invalidChar);\r\n\r\n      // Test rate limiter\r\n      const rateLimiter = createRateLimiter(3, 1000, (key) => key);\r\n      let rateLimitTriggered = false;\r\n      for (let i = 0; i < 5; i++) {\r\n        try {\r\n          await rateLimiter.consume('test_user');\r\n        } catch (error) {\r\n          if (error instanceof CommandError && error.code === 'RATE_LIMITED') {\r\n            rateLimitTriggered = true;\r\n          }\r\n        }\r\n      }\r\n      this.log(`Rate limiter working: ${rateLimitTriggered}`, rateLimitTriggered);\r\n\r\n    } catch (error) {\r\n      this.logError('Error handling test failed', error);\r\n    }\r\n  }\r\n\r\n  async runAllTests() {\r\n    console.log('üöÄ Starting Comprehensive Bot System Test Suite');\r\n    console.log('=' .repeat(60));\r\n\r\n    await this.testEconomy();\r\n    await this.testModeration();\r\n    await this.testRPG();\r\n    await this.testMusic();\r\n    await this.testIntegrations();\r\n    await this.testErrorHandling();\r\n\r\n    console.log('\\n' + '=' .repeat(60));\r\n    console.log('üìä Test Results Summary:');\r\n    console.log(`Total Tests: ${this.testCount}`);\r\n    console.log(`‚úÖ Passed: ${this.passCount}`);\r\n    console.log(`‚ùå Failed: ${this.failCount}`);\r\n    console.log(`Success Rate: ${((this.passCount / this.testCount) * 100).toFixed(1)}%`);\r\n\r\n    // Save results\r\n    fs.writeFileSync('comprehensive-test-results.json', JSON.stringify(this.testResults, null, 2));\r\n    console.log('\\nüìÑ Detailed results saved to comprehensive-test-results.json');\r\n\r\n    return {\r\n      total: this.testCount,\r\n      passed: this.passCount,\r\n      failed: this.failCount,\r\n      successRate: ((this.passCount / this.testCount) * 100).toFixed(1)\r\n    };\r\n  }\r\n}\r\n\r\n// Run tests if executed directly\r\nif (import.meta.url === `file://${process.argv[1]}`) {\r\n  const testSuite = new ComprehensiveTestSuite();\r\n  testSuite.runAllTests().then(results => {\r\n    console.log('\\nüèÅ Test execution completed');\r\n    process.exit(results.failed > 0 ? 1 : 0);\r\n  }).catch(error => {\r\n    console.error('Test suite failed:', error);\r\n    process.exit(1);\r\n  });\r\n}\r\n\r\nexport default ComprehensiveTestSuite;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\rpg.test.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:assert` over `assert`.","line":1,"column":20,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":28,"fix":{"range":[20,20],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":2,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":20,"fix":{"range":[46,46],"text":"node:"}},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":3,"column":1,"nodeType":"ImportDeclaration","endLine":3,"endColumn":25,"fix":{"range":[76,76],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":3,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":24,"fix":{"range":[70,70],"text":"node:"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":18,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":18,"endColumn":4,"fix":{"range":[670,670],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":61,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":61,"endColumn":4,"fix":{"range":[1990,1990],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":66,"column":13,"nodeType":"Identifier","messageId":"catch-error-name","endLine":66,"endColumn":16,"fix":{"range":[2044,2070],"text":"error => { console.error(error"}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":66,"column":20,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":66,"endColumn":21,"fix":{"range":[2052,2052],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":66,"column":42,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":66,"endColumn":58},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":66,"column":42,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":66,"endColumn":57},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":66,"column":59,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":66,"endColumn":60,"fix":{"range":[2090,2090],"text":"\n"}}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import assert from 'assert';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { createCharacter, getCharacter, applyXp, spendSkillPoints, getLeaderboard, getLeaderboardCount, resetCharacter } from '../src/rpg.js';\r\n\r\n// Use a temp data dir to avoid clobbering real data during tests\r\nconst DATA_DIR = path.join(process.cwd(), 'data');\r\nconst BACKUP = path.join(process.cwd(), 'data', 'rpg.json.bak');\r\nconst FILE = path.join(DATA_DIR, 'rpg.json');\r\n\r\nfunction backupData() {\r\n  if (fs.existsSync(FILE)) fs.copyFileSync(FILE, BACKUP);\r\n}\r\nfunction restoreData() {\r\n  if (fs.existsSync(BACKUP)) {\r\n    fs.copyFileSync(BACKUP, FILE);\r\n    fs.unlinkSync(BACKUP);\r\n  } else {\r\n    // remove test file if created\r\n    if (fs.existsSync(FILE)) fs.unlinkSync(FILE);\r\n  }\r\n}\r\n\r\nasync function run() {\r\n  backupData();\r\n  try {\r\n    // ensure clean start\r\n    if (fs.existsSync(FILE)) fs.unlinkSync(FILE);\r\n\r\n    const uid = 'testuser1';\r\n    const char = createCharacter(uid, 'Tester');\r\n    assert.ok(char, 'Character created');\r\n    assert.equal(char.name, 'Tester');\r\n\r\n    // apply xp and confirm level changes\r\n    const res = applyXp(uid, char, 45); // should gain 2 levels with 20xp per level\r\n    assert.ok(res.gained >= 2, 'Gained expected levels');\r\n    // save and retrieve\r\n    const saved = getCharacter(uid);\r\n    assert.ok(saved, 'Character saved and retrievable');\r\n\r\n    // spend skill points\r\n    const before = saved.skillPoints || 0;\r\n    if (before > 0) {\r\n      const s = spendSkillPoints(uid, 'atk', 1);\r\n      assert.ok(s.success, 'Spend succeeded');\r\n    }\r\n\r\n    // leaderboard functions\r\n    const total = getLeaderboardCount();\r\n    assert.ok(total >= 1, 'Leaderboard count at least 1');\r\n    const list = getLeaderboard(10, 0);\r\n    assert.ok(Array.isArray(list), 'Leaderboard returns array');\r\n\r\n    // reset character\r\n    const def = resetCharacter(uid);\r\n    assert.equal(def.xp, 0);\r\n    assert.equal(def.lvl, 1);\r\n\r\n    console.log('All tests passed');\r\n  } finally {\r\n    restoreData();\r\n  }\r\n}\r\n\r\nrun().catch(err => { console.error(err); process.exit(1); });\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-button-interactions.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testButtonInteractions.js` or `TestButtonInteractions.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":73,"fix":{"range":[133,133],"text":"\n"}},{"ruleId":"import/namespace","severity":2,"message":"Parse errors in imported module '../src/interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":2,"column":41,"nodeType":"Literal","endLine":2,"endColumn":72},{"ruleId":"import/no-deprecated","severity":1,"message":"Parse errors in imported module '../src/interactionHandlers.js': Missing catch or finally clause. (1102:3) (1102:3)","line":2,"column":41,"nodeType":"Literal","endLine":2,"endColumn":72},{"ruleId":"import/order","severity":2,"message":"`assert` import should occur before import of `../src/interactionHandlers.js`","line":3,"column":1,"nodeType":"ImportDeclaration","endLine":3,"endColumn":29,"fix":{"range":[61,165],"text":"import assert from 'assert';\r\nimport { handleButtonInteraction } from '../src/interactionHandlers.js';\r\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'assert' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":14},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:assert` over `assert`.","line":3,"column":20,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":28,"fix":{"range":[155,155],"text":"node:"}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":21,"column":15,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":21,"endColumn":16,"fix":{"range":[519,520],"text":""}},{"ruleId":"unicorn/no-useless-promise-resolve-reject","severity":2,"message":"Prefer `return value` over `return Promise.resolve(value)`.","line":23,"column":12,"nodeType":"MemberExpression","messageId":"resolve","endLine":23,"endColumn":27,"fix":{"range":[602,627],"text":"return;"}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":25,"column":16,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":25,"endColumn":17,"fix":{"range":[650,651],"text":""}},{"ruleId":"unicorn/no-useless-promise-resolve-reject","severity":2,"message":"Prefer `return value` over `return Promise.resolve(value)`.","line":27,"column":12,"nodeType":"MemberExpression","messageId":"resolve","endLine":27,"endColumn":27,"fix":{"range":[734,759],"text":"return;"}},{"ruleId":"space-before-function-paren","severity":2,"message":"Unexpected space before function parentheses.","line":29,"column":19,"nodeType":"ArrowFunctionExpression","messageId":"unexpectedSpace","endLine":29,"endColumn":20,"fix":{"range":[785,786],"text":""}},{"ruleId":"unicorn/no-useless-promise-resolve-reject","severity":2,"message":"Prefer `return value` over `return Promise.resolve(value)`.","line":31,"column":12,"nodeType":"MemberExpression","messageId":"resolve","endLine":31,"endColumn":27,"fix":{"range":[869,894],"text":"return;"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":87,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":87,"endColumn":4,"fix":{"range":[2686,2686],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":99,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":99,"endColumn":41},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":99,"column":18,"nodeType":"ConditionalExpression","messageId":"thenShouldReturnOrThrow","endLine":99,"endColumn":40},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":102,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":102,"endColumn":20}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":10,"fixableWarningCount":0,"source":"// Test script specifically for button interaction handlers\r\nimport { handleButtonInteraction } from '../src/interactionHandlers.js';\r\nimport assert from 'assert';\r\n\r\n// Mock interaction object\r\nconst mockInteraction = {\r\n  user: {\r\n    id: '123456789012345678',\r\n    username: 'testuser'\r\n  },\r\n  customId: 'test_button_action:test_param',\r\n  guild: {\r\n    id: '987654321098765432',\r\n    name: 'Test Guild'\r\n  },\r\n  message: {\r\n    id: '111111111111111111',\r\n    embeds: [{}],\r\n    components: []\r\n  },\r\n  reply: async (options) => {\r\n    console.log('Mock reply called with:', options.content);\r\n    return Promise.resolve();\r\n  },\r\n  update: async (options) => {\r\n    console.log('Mock update called with:', options.content);\r\n    return Promise.resolve();\r\n  },\r\n  showModal: async (modal) => {\r\n    console.log('Mock showModal called with:', modal.customId);\r\n    return Promise.resolve();\r\n  }\r\n};\r\n\r\n// Mock client\r\nconst mockClient = {\r\n  commands: new Map()\r\n};\r\n\r\nasync function testButtonHandlers() {\r\n  console.log('üß™ Testing Button Interaction Handlers');\r\n\r\n  try {\r\n    // Test 1: Unknown button action (should handle gracefully)\r\n    console.log('\\n1. Testing unknown button action...');\r\n    await handleButtonInteraction({\r\n      ...mockInteraction,\r\n      customId: 'unknown_action:param'\r\n    }, mockClient);\r\n    console.log('‚úÖ Unknown action handled gracefully');\r\n\r\n    // Test 2: Music pause button\r\n    console.log('\\n2. Testing music pause button...');\r\n    await handleButtonInteraction({\r\n      ...mockInteraction,\r\n      customId: 'music_pause:testguild'\r\n    }, mockClient);\r\n    console.log('‚úÖ Music pause handled gracefully');\r\n\r\n    // Test 3: Economy market button\r\n    console.log('\\n3. Testing economy market button...');\r\n    await handleButtonInteraction({\r\n      ...mockInteraction,\r\n      customId: 'economy_market:123456789012345678'\r\n    }, mockClient);\r\n    console.log('‚úÖ Economy market handled gracefully');\r\n\r\n    // Test 4: RPG leaderboard button\r\n    console.log('\\n4. Testing RPG leaderboard button...');\r\n    await handleButtonInteraction({\r\n      ...mockInteraction,\r\n      customId: 'rpg_leaderboard:0:123456789012345678'\r\n    }, mockClient);\r\n    console.log('‚úÖ RPG leaderboard handled gracefully');\r\n\r\n    // Test 5: Memory game button\r\n    console.log('\\n5. Testing memory game button...');\r\n    await handleButtonInteraction({\r\n      ...mockInteraction,\r\n      customId: 'memory_reset:123456789012345678'\r\n    }, mockClient);\r\n    console.log('‚úÖ Memory game handled gracefully');\r\n\r\n    console.log('\\nüéâ All button interaction tests passed!');\r\n    return { success: true, message: 'All button handlers work correctly' };\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Button interaction test failed:', error.message);\r\n    console.error('Stack:', error.stack);\r\n    return { success: false, message: error.message, error };\r\n  }\r\n}\r\n\r\n// Run the test if executed directly\r\nif (import.meta.url === `file://${process.argv[1]}`) {\r\n  testButtonHandlers().then(result => {\r\n    console.log('\\nüèÅ Button interaction test completed');\r\n    console.log('Result:', result);\r\n    process.exit(result.success ? 0 : 1);\r\n  }).catch(error => {\r\n    console.error('Test suite failed:', error);\r\n    process.exit(1);\r\n  });\r\n}\r\n\r\nexport default testButtonHandlers;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-fun-command.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testFunCommand.js` or `TestFunCommand.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":205,"fix":{"range":[204,204],"text":"\n"}},{"ruleId":"import/order","severity":2,"message":"`assert` import should occur before import of `../src/entertainment.js`","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":29,"fix":{"range":[0,236],"text":"import assert from 'assert';\r\nimport { getRandomJoke, generateStory, getRiddle, getFunFact, getRandomQuote, magic8Ball, generateFunName, createFunChallenge, updateEntertainmentStats, getFunLeaderboard } from '../src/entertainment.js';\r\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:assert` over `assert`.","line":2,"column":20,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":28,"fix":{"range":[226,226],"text":"node:"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":24,"column":1,"nodeType":"Program","messageId":"max","endLine":24,"endColumn":145},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":48,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":48,"endColumn":6,"fix":{"range":[1946,1946],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":78,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":78,"endColumn":6,"fix":{"range":[3205,3205],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":102,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":102,"endColumn":6,"fix":{"range":[4277,4277],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":119,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":119,"endColumn":6,"fix":{"range":[4911,4911],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":138,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":138,"endColumn":6,"fix":{"range":[5695,5695],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":155,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":155,"endColumn":25,"fix":{"range":[6362,6378],"text":"'It is certain.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":155,"column":27,"nodeType":"Literal","messageId":"wrongQuotes","endLine":155,"endColumn":48,"fix":{"range":[6380,6401],"text":"'It is decidedly so.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":155,"column":50,"nodeType":"Literal","messageId":"wrongQuotes","endLine":155,"endColumn":68,"fix":{"range":[6403,6421],"text":"'Without a doubt.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":155,"column":70,"nodeType":"Literal","messageId":"wrongQuotes","endLine":155,"endColumn":87,"fix":{"range":[6423,6440],"text":"'Yes definitely.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":156,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":156,"endColumn":30,"fix":{"range":[6451,6472],"text":"'You may rely on it.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":156,"column":32,"nodeType":"Literal","messageId":"wrongQuotes","endLine":156,"endColumn":51,"fix":{"range":[6474,6493],"text":"'As I see it, yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":156,"column":53,"nodeType":"Literal","messageId":"wrongQuotes","endLine":156,"endColumn":67,"fix":{"range":[6495,6509],"text":"'Most likely.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":156,"column":69,"nodeType":"Literal","messageId":"wrongQuotes","endLine":156,"endColumn":84,"fix":{"range":[6511,6526],"text":"'Outlook good.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":157,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":157,"endColumn":15,"fix":{"range":[6537,6543],"text":"'Yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":157,"column":17,"nodeType":"Literal","messageId":"wrongQuotes","endLine":157,"endColumn":38,"fix":{"range":[6545,6566],"text":"'Signs point to yes.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":158,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":158,"endColumn":33,"fix":{"range":[6577,6601],"text":"'Reply hazy, try again.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":158,"column":35,"nodeType":"Literal","messageId":"wrongQuotes","endLine":158,"endColumn":53,"fix":{"range":[6603,6621],"text":"'Ask again later.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":158,"column":55,"nodeType":"Literal","messageId":"wrongQuotes","endLine":158,"endColumn":81,"fix":{"range":[6623,6649],"text":"'Better not tell you now.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":159,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":159,"endColumn":30,"fix":{"range":[6660,6681],"text":"'Cannot predict now.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":159,"column":32,"nodeType":"Literal","messageId":"wrongQuotes","endLine":159,"endColumn":60,"fix":{"range":[6683,6711],"text":"'Concentrate and ask again.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":160,"column":31,"nodeType":"Literal","messageId":"wrongQuotes","endLine":160,"endColumn":48,"fix":{"range":[6744,6761],"text":"'My reply is no.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":160,"column":50,"nodeType":"Literal","messageId":"wrongQuotes","endLine":160,"endColumn":70,"fix":{"range":[6763,6783],"text":"'My sources say no.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":160,"column":72,"nodeType":"Literal","messageId":"wrongQuotes","endLine":160,"endColumn":94,"fix":{"range":[6785,6807],"text":"'Outlook not so good.'"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":161,"column":9,"nodeType":"Literal","messageId":"wrongQuotes","endLine":161,"endColumn":25,"fix":{"range":[6818,6834],"text":"'Very doubtful.'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":168,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":168,"endColumn":6,"fix":{"range":[6997,6997],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":186,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":186,"endColumn":6,"fix":{"range":[7711,7711],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":205,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":205,"endColumn":6,"fix":{"range":[8494,8494],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":233,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":233,"endColumn":6,"fix":{"range":[9716,9716],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":266,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":266,"endColumn":6,"fix":{"range":[11042,11042],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":307,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":307,"endColumn":45},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":307,"column":18,"nodeType":"ConditionalExpression","messageId":"thenShouldReturnOrThrow","endLine":307,"endColumn":44},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":310,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":310,"endColumn":20}],"suppressedMessages":[],"errorCount":39,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":32,"fixableWarningCount":0,"source":"import { getRandomJoke, generateStory, getRiddle, getFunFact, getRandomQuote, magic8Ball, generateFunName, createFunChallenge, updateEntertainmentStats, getFunLeaderboard } from '../src/entertainment.js';\r\nimport assert from 'assert';\r\n\r\nclass FunCommandTestSuite {\r\n  constructor() {\r\n    this.testResults = [];\r\n    this.testCount = 0;\r\n    this.passCount = 0;\r\n    this.failCount = 0;\r\n    this.testUserId = `testuser_fun_${Date.now()}`;\r\n  }\r\n\r\n  log(message, success = true) {\r\n    const status = success ? '‚úÖ' : '‚ùå';\r\n    console.log(`${status} ${message}`);\r\n    this.testResults.push({ message, success, timestamp: new Date().toISOString() });\r\n    this.testCount++;\r\n    if (success) this.passCount++;\r\n    else this.failCount++;\r\n  }\r\n\r\n  logError(message, error) {\r\n    console.error(`‚ùå ${message}: ${error.message}`);\r\n    this.testResults.push({ message: `${message}: ${error.message}`, success: false, timestamp: new Date().toISOString(), error: error.stack });\r\n    this.testCount++;\r\n    this.failCount++;\r\n  }\r\n\r\n  async testJokeFunctionality() {\r\n    console.log('\\nüòÇ Testing Joke Functionality');\r\n    try {\r\n      // Test different joke categories\r\n      const categories = ['general', 'programming', 'dad', 'math', 'science'];\r\n\r\n      for (const category of categories) {\r\n        const joke = getRandomJoke(category);\r\n        assert(joke && typeof joke.joke === 'string' && joke.joke.length > 0, `Joke for category ${category} should be valid`);\r\n        assert(joke.category === category, `Joke category should match ${category}`);\r\n        assert(joke.id, 'Joke should have an ID');\r\n        this.log(`Joke category ${category}: OK`);\r\n      }\r\n\r\n      // Test invalid category falls back to general\r\n      const invalidCategoryJoke = getRandomJoke('invalid');\r\n      assert(invalidCategoryJoke && invalidCategoryJoke.joke, 'Invalid category should fallback');\r\n      this.log('Invalid category fallback: OK');\r\n\r\n    } catch (error) {\r\n      this.logError('Joke functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testStoryFunctionality() {\r\n    console.log('\\nüìñ Testing Story Functionality');\r\n    try {\r\n      const testPrompt = 'a brave knight fighting a dragon';\r\n      const testGenre = 'fantasy';\r\n\r\n      const story = generateStory(testPrompt, testGenre);\r\n      assert(story && typeof story.story === 'string' && story.story.length > 0, 'Story should be generated');\r\n      assert(story.genre === testGenre, 'Story genre should match');\r\n      assert(story.prompt === testPrompt, 'Story prompt should match');\r\n      assert(story.id, 'Story should have an ID');\r\n\r\n      // Test story contains prompt elements\r\n      assert(story.story.toLowerCase().includes('knight') || story.story.toLowerCase().includes('brave'), 'Story should incorporate prompt elements');\r\n\r\n      this.log('Story generation: OK');\r\n\r\n      // Test different genres\r\n      const genres = ['fantasy', 'adventure', 'mystery', 'sciFi'];\r\n      for (const genre of genres) {\r\n        const genreStory = generateStory('test prompt', genre);\r\n        assert(genreStory.genre === genre, `Genre ${genre} should be set correctly`);\r\n        this.log(`Story genre ${genre}: OK`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logError('Story functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testRiddleFunctionality() {\r\n    console.log('\\nüß© Testing Riddle Functionality');\r\n    try {\r\n      const difficulties = ['easy', 'medium', 'hard'];\r\n\r\n      for (const difficulty of difficulties) {\r\n        const riddle = getRiddle(difficulty);\r\n        assert(riddle && typeof riddle.riddle === 'string' && riddle.riddle.length > 0, `Riddle for difficulty ${difficulty} should be valid`);\r\n        assert(riddle.difficulty === difficulty, `Riddle difficulty should match ${difficulty}`);\r\n        assert(riddle.answer, 'Riddle should have an answer');\r\n        assert(riddle.id, 'Riddle should have an ID');\r\n        this.log(`Riddle difficulty ${difficulty}: OK`);\r\n      }\r\n\r\n      // Test invalid difficulty falls back to medium\r\n      const invalidDifficultyRiddle = getRiddle('invalid');\r\n      assert(invalidDifficultyRiddle && invalidDifficultyRiddle.riddle, 'Invalid difficulty should fallback');\r\n      this.log('Invalid difficulty fallback: OK');\r\n\r\n    } catch (error) {\r\n      this.logError('Riddle functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testFunFactFunctionality() {\r\n    console.log('\\nüß† Testing Fun Fact Functionality');\r\n    try {\r\n      const categories = ['random', 'animals', 'space', 'science', 'history'];\r\n\r\n      for (const category of categories) {\r\n        const fact = getFunFact(category);\r\n        assert(fact && typeof fact.fact === 'string' && fact.fact.length > 0, `Fun fact for category ${category} should be valid`);\r\n        assert(fact.id, 'Fun fact should have an ID');\r\n        this.log(`Fun fact category ${category}: OK`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logError('Fun fact functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testQuoteFunctionality() {\r\n    console.log('\\nüí¨ Testing Quote Functionality');\r\n    try {\r\n      const categories = ['inspirational', 'motivational', 'wisdom', 'humor'];\r\n\r\n      for (const category of categories) {\r\n        const quote = getRandomQuote(category);\r\n        assert(quote && typeof quote.quote === 'string' && quote.quote.length > 0, `Quote for category ${category} should be valid`);\r\n        assert(quote.author, 'Quote should have an author');\r\n        assert(quote.category === category, `Quote category should match ${category}`);\r\n        assert(quote.id, 'Quote should have an ID');\r\n        this.log(`Quote category ${category}: OK`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logError('Quote functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testMagic8BallFunctionality() {\r\n    console.log('\\nüîÆ Testing Magic 8-Ball Functionality');\r\n    try {\r\n      const testQuestion = 'Will I be rich?';\r\n\r\n      const result = magic8Ball(testQuestion);\r\n      assert(result && typeof result.answer === 'string' && result.answer.length > 0, '8-ball should return an answer');\r\n      assert(result.question === testQuestion, '8-ball should return the question');\r\n      assert(result.id, '8-ball should have an ID');\r\n\r\n      // Test that answers are from the predefined list\r\n      const validResponses = [\r\n        \"It is certain.\", \"It is decidedly so.\", \"Without a doubt.\", \"Yes definitely.\",\r\n        \"You may rely on it.\", \"As I see it, yes.\", \"Most likely.\", \"Outlook good.\",\r\n        \"Yes.\", \"Signs point to yes.\",\r\n        \"Reply hazy, try again.\", \"Ask again later.\", \"Better not tell you now.\",\r\n        \"Cannot predict now.\", \"Concentrate and ask again.\",\r\n        \"Don't count on it.\", \"My reply is no.\", \"My sources say no.\", \"Outlook not so good.\",\r\n        \"Very doubtful.\"\r\n      ];\r\n\r\n      assert(validResponses.includes(result.answer), '8-ball answer should be from predefined list');\r\n\r\n      this.log('Magic 8-ball: OK');\r\n\r\n    } catch (error) {\r\n      this.logError('Magic 8-ball functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testFunNameFunctionality() {\r\n    console.log('\\nüé≠ Testing Fun Name Functionality');\r\n    try {\r\n      const types = ['superhero', 'villain', 'fantasy', 'sciFi'];\r\n\r\n      for (const type of types) {\r\n        const nameResult = generateFunName(type);\r\n        assert(nameResult && typeof nameResult.name === 'string' && nameResult.name.length > 0, `Fun name for type ${type} should be valid`);\r\n        assert(nameResult.type === type, `Fun name type should match ${type}`);\r\n        assert(nameResult.id, 'Fun name should have an ID');\r\n        this.log(`Fun name type ${type}: OK`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logError('Fun name functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testChallengeFunctionality() {\r\n    console.log('\\nüéØ Testing Fun Challenge Functionality');\r\n    try {\r\n      const types = ['daily', 'weekly', 'monthly'];\r\n\r\n      for (const type of types) {\r\n        const challenge = createFunChallenge(type);\r\n        assert(challenge && typeof challenge.challenge === 'string' && challenge.challenge.length > 0, `Challenge for type ${type} should be valid`);\r\n        assert(challenge.type === type, `Challenge type should match ${type}`);\r\n        assert(challenge.reward, 'Challenge should have a reward');\r\n        assert(challenge.id, 'Challenge should have an ID');\r\n        this.log(`Challenge type ${type}: OK`);\r\n      }\r\n\r\n    } catch (error) {\r\n      this.logError('Challenge functionality test failed', error);\r\n    }\r\n  }\r\n\r\n  async testEntertainmentStats() {\r\n    console.log('\\nüìä Testing Entertainment Stats');\r\n    try {\r\n      // Test updating stats\r\n      const initialStats = updateEntertainmentStats(this.testUserId, 'jokesHeard');\r\n      assert(initialStats && typeof initialStats.jokesHeard === 'number', 'Stats should be updated');\r\n\r\n      // Update multiple activities\r\n      updateEntertainmentStats(this.testUserId, 'storiesGenerated');\r\n      updateEntertainmentStats(this.testUserId, 'riddlesSolved');\r\n      updateEntertainmentStats(this.testUserId, 'factsLearned');\r\n\r\n      // Import function to get stats\r\n      const { getEntertainmentStats } = await import('../src/entertainment.js');\r\n      const stats = getEntertainmentStats(this.testUserId);\r\n\r\n      assert(stats.jokesHeard >= 1, 'Jokes heard should be incremented');\r\n      assert(stats.storiesGenerated >= 1, 'Stories generated should be incremented');\r\n      assert(stats.riddlesSolved >= 1, 'Riddles solved should be incremented');\r\n      assert(stats.factsLearned >= 1, 'Facts learned should be incremented');\r\n\r\n      this.log('Entertainment stats: OK');\r\n\r\n    } catch (error) {\r\n      this.logError('Entertainment stats test failed', error);\r\n    }\r\n  }\r\n\r\n  async testLeaderboard() {\r\n    console.log('\\nüèÜ Testing Fun Leaderboard');\r\n    try {\r\n      // Add some test data\r\n      updateEntertainmentStats(this.testUserId, 'jokesHeard');\r\n      updateEntertainmentStats(this.testUserId, 'storiesGenerated');\r\n\r\n      // Test leaderboard retrieval\r\n      const jokeLeaderboard = getFunLeaderboard('jokesHeard', 10);\r\n      const storyLeaderboard = getFunLeaderboard('storiesGenerated', 10);\r\n\r\n      assert(Array.isArray(jokeLeaderboard), 'Joke leaderboard should be an array');\r\n      assert(Array.isArray(storyLeaderboard), 'Story leaderboard should be an array');\r\n\r\n      // Check if our test user appears in leaderboard\r\n      const jokeEntry = jokeLeaderboard.find(entry => entry.userId === this.testUserId);\r\n      const storyEntry = storyLeaderboard.find(entry => entry.userId === this.testUserId);\r\n\r\n      if (jokeEntry) {\r\n        assert(typeof jokeEntry.score === 'number' && jokeEntry.score >= 1, 'Joke leaderboard entry should have valid score');\r\n      }\r\n\r\n      if (storyEntry) {\r\n        assert(typeof storyEntry.score === 'number' && storyEntry.score >= 1, 'Story leaderboard entry should have valid score');\r\n      }\r\n\r\n      this.log('Fun leaderboard: OK');\r\n\r\n    } catch (error) {\r\n      this.logError('Fun leaderboard test failed', error);\r\n    }\r\n  }\r\n\r\n  async runAllTests() {\r\n    console.log('üé™ Starting Fun Command Test Suite');\r\n    console.log('=' .repeat(50));\r\n\r\n    await this.testJokeFunctionality();\r\n    await this.testStoryFunctionality();\r\n    await this.testRiddleFunctionality();\r\n    await this.testFunFactFunctionality();\r\n    await this.testQuoteFunctionality();\r\n    await this.testMagic8BallFunctionality();\r\n    await this.testFunNameFunctionality();\r\n    await this.testChallengeFunctionality();\r\n    await this.testEntertainmentStats();\r\n    await this.testLeaderboard();\r\n\r\n    console.log('\\n' + '=' .repeat(50));\r\n    console.log('üìä Fun Command Test Results Summary:');\r\n    console.log(`Total Tests: ${this.testCount}`);\r\n    console.log(`‚úÖ Passed: ${this.passCount}`);\r\n    console.log(`‚ùå Failed: ${this.failCount}`);\r\n    console.log(`Success Rate: ${((this.passCount / this.testCount) * 100).toFixed(1)}%`);\r\n\r\n    return {\r\n      total: this.testCount,\r\n      passed: this.passCount,\r\n      failed: this.failCount,\r\n      successRate: ((this.passCount / this.testCount) * 100).toFixed(1)\r\n    };\r\n  }\r\n}\r\n\r\n// Run tests if executed directly\r\nif (import.meta.url === `file://${process.argv[1]}`) {\r\n  const testSuite = new FunCommandTestSuite();\r\n  testSuite.runAllTests().then(results => {\r\n    console.log('\\nüé™ Fun command test execution completed');\r\n    process.exit(results.failed > 0 ? 1 : 0);\r\n  }).catch(error => {\r\n    console.error('Fun command test suite failed:', error);\r\n    process.exit(1);\r\n  });\r\n}\r\n\r\nexport default FunCommandTestSuite;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-music-errors.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testMusicErrors.js` or `TestMusicErrors.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"import/order","severity":2,"message":"There should be at least one empty line between import groups","line":1,"column":1,"nodeType":"ImportDeclaration","endLine":1,"endColumn":127,"fix":{"range":[126,126],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'play' is defined but never used.","line":1,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":27},{"ruleId":"import/order","severity":2,"message":"`axios` import should occur before import of `../src/music.js`","line":2,"column":1,"nodeType":"ImportDeclaration","endLine":2,"endColumn":27,"fix":{"range":[0,156],"text":"import axios from 'axios';\r\nimport { searchSongs, play, pause, resume, skip, stop, getQueue, getMusicStats, setVolume, getVolume } from '../src/music.js';\r\n"}},{"ruleId":"max-len","severity":2,"message":"This line has a length of 144. Maximum allowed is 120.","line":24,"column":1,"nodeType":"Program","messageId":"max","endLine":24,"endColumn":145},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":47,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":47,"endColumn":8,"fix":{"range":[1802,1802],"text":"\n"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":53,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":57,"endColumn":8,"fix":{"range":[2021,2215],"text":"await (urlResults.length > 0 ? this.log(`Deezer URL search successful: ${urlResults[0].title}`) : this.log('Deezer URL search failed', false));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":55,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":55,"endColumn":8,"fix":{"range":[2139,2139],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":67,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":67,"endColumn":6,"fix":{"range":[2577,2577],"text":"\n"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":84,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":88,"endColumn":8,"fix":{"range":[3310,3504],"text":"await (ytResults.length > 0 ? this.log(`YouTube URL search successful: ${ytResults[0].title}`) : this.log('YouTube URL search failed', false));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":86,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":86,"endColumn":8,"fix":{"range":[3427,3427],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":90,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":90,"endColumn":6,"fix":{"range":[3513,3513],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":120,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":120,"endColumn":6,"fix":{"range":[4635,4635],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":144,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":144,"endColumn":6,"fix":{"range":[5649,5649],"text":"\n"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":161,"column":9,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":165,"endColumn":10,"fix":{"range":[6159,6335],"text":"await (results.length > 0 ? this.log(`Direct URL supported: ${url}`) : this.log(`Direct URL failed: ${url}`, false));"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":163,"column":9,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":163,"endColumn":10,"fix":{"range":[6254,6254],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":167,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":167,"endColumn":6,"fix":{"range":[6351,6351],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":199,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":199,"endColumn":6,"fix":{"range":[7710,7710],"text":"\n"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":209,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":213,"endColumn":8,"fix":{"range":[8053,8277],"text":"await (deezerResponse.data && deezerResponse.data.title ? this.log(`Deezer API connectivity: ‚úÖ Connected`) : this.log(`Deezer API connectivity: ‚ùå Invalid response`, false));"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":210,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":210,"endColumn":62,"fix":{"range":[8133,8171],"text":"'Deezer API connectivity: ‚úÖ Connected'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":211,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":211,"endColumn":8,"fix":{"range":[8182,8182],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":212,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":212,"endColumn":69,"fix":{"range":[8214,8259],"text":"'Deezer API connectivity: ‚ùå Invalid response'"}},{"ruleId":"unicorn/prefer-ternary","severity":2,"message":"This `if` statement can be replaced by a ternary expression.","line":217,"column":7,"nodeType":"IfStatement","messageId":"prefer-ternary","endLine":221,"endColumn":8,"fix":{"range":[8421,8617],"text":"await (ytResponse.status === 200 ? this.log(`YouTube connectivity: ‚úÖ Connected`) : this.log(`YouTube connectivity: ‚ùå Connection failed`, false));"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":218,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":218,"endColumn":59,"fix":{"range":[8478,8513],"text":"'YouTube connectivity: ‚úÖ Connected'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":219,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":219,"endColumn":8,"fix":{"range":[8524,8524],"text":"\n"}},{"ruleId":"quotes","severity":2,"message":"Strings must use singlequote.","line":220,"column":24,"nodeType":"TemplateLiteral","messageId":"wrongQuotes","endLine":220,"endColumn":67,"fix":{"range":[8556,8599],"text":"'YouTube connectivity: ‚ùå Connection failed'"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":223,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":223,"endColumn":6,"fix":{"range":[8626,8626],"text":"\n"}},{"ruleId":"no-unused-vars","severity":1,"message":"'mockVoiceChannel' is assigned a value but never used.","line":232,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":232,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'queue' is assigned a value but never used.","line":262,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":18},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":266,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":266,"endColumn":6,"fix":{"range":[10675,10675],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":292,"column":29,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":292,"endColumn":33,"fix":{"range":[11624,11624],"text":"node:"}},{"ruleId":"unicorn/no-null","severity":2,"message":"Use `undefined` instead of `null`.","line":293,"column":76,"nodeType":"Literal","messageId":"error","endLine":293,"endColumn":80,"suggestions":[{"messageId":"replace","fix":{"range":[11706,11710],"text":"undefined"},"data":{},"desc":"Replace `null` with `undefined`."}]},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":310,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":310,"endColumn":45},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":310,"column":18,"nodeType":"ConditionalExpression","messageId":"thenShouldReturnOrThrow","endLine":310,"endColumn":44},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":313,"column":5,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":313,"endColumn":20}],"suppressedMessages":[],"errorCount":34,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":26,"fixableWarningCount":0,"source":"import { searchSongs, play, pause, resume, skip, stop, getQueue, getMusicStats, setVolume, getVolume } from '../src/music.js';\r\nimport axios from 'axios';\r\n\r\nclass MusicTestSuite {\r\n  constructor() {\r\n    this.testResults = [];\r\n    this.guildId = 'test-guild-123';\r\n    this.testCount = 0;\r\n    this.passCount = 0;\r\n    this.failCount = 0;\r\n  }\r\n\r\n  async log(message, success = true) {\r\n    const status = success ? '‚úÖ' : '‚ùå';\r\n    console.log(`${status} ${message}`);\r\n    this.testResults.push({ message, success, timestamp: new Date().toISOString() });\r\n    this.testCount++;\r\n    if (success) this.passCount++;\r\n    else this.failCount++;\r\n  }\r\n\r\n  async logError(message, error) {\r\n    console.error(`‚ùå ${message}: ${error.message}`);\r\n    this.testResults.push({ message: `${message}: ${error.message}`, success: false, timestamp: new Date().toISOString(), error: error.stack });\r\n    this.testCount++;\r\n    this.failCount++;\r\n  }\r\n\r\n  async delay(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  async testDeezerSearch() {\r\n    console.log('\\nüéµ Testing Deezer Search Functionality');\r\n    try {\r\n      // Test 1: Basic Deezer search\r\n      const results = await searchSongs('billie eilish bad guy', 3);\r\n      if (results.length > 0) {\r\n        await this.log(`Deezer search returned ${results.length} results`);\r\n        // Verify Deezer results have required fields\r\n        const deezerResults = results.filter(r => r.source === 'deezer');\r\n        if (deezerResults.length > 0) {\r\n          const result = deezerResults[0];\r\n          const hasRequiredFields = result.title && result.artist && result.url && result.source === 'deezer';\r\n          await this.log(`Deezer result has required fields: ${hasRequiredFields}`, hasRequiredFields);\r\n        }\r\n      } else {\r\n        await this.log('Deezer search returned no results', false);\r\n      }\r\n\r\n      // Test 2: Deezer URL search\r\n      const urlResults = await searchSongs('https://www.deezer.com/track/3135556', 1);\r\n      if (urlResults.length > 0) {\r\n        await this.log(`Deezer URL search successful: ${urlResults[0].title}`);\r\n      } else {\r\n        await this.log('Deezer URL search failed', false);\r\n      }\r\n\r\n      // Test 3: Rate limiting (should handle gracefully)\r\n      const rateLimitResults = [];\r\n      for (let i = 0; i < 5; i++) {\r\n        const results = await searchSongs(`test query ${i}`, 1);\r\n        rateLimitResults.push(results.length);\r\n      }\r\n      await this.log(`Rate limiting test completed: ${rateLimitResults.join(', ')} requests`);\r\n\r\n    } catch (error) {\r\n      await this.logError('Deezer search test failed', error);\r\n    }\r\n  }\r\n\r\n  async testYouTubeFallback() {\r\n    console.log('\\nüì∫ Testing YouTube Fallback Functionality');\r\n    try {\r\n      // Test 1: Force YouTube fallback by using a term that might not exist on Deezer\r\n      const results = await searchSongs('very obscure song that probably does not exist', 3);\r\n      if (results.length > 0) {\r\n        const youtubeResults = results.filter(r => r.source === 'youtube');\r\n        await this.log(`YouTube fallback returned ${youtubeResults.length} results`);\r\n      }\r\n\r\n      // Test 2: YouTube URL search\r\n      const ytResults = await searchSongs('https://www.youtube.com/watch?v=dQw4w9WgXcQ', 1);\r\n      if (ytResults.length > 0) {\r\n        await this.log(`YouTube URL search successful: ${ytResults[0].title}`);\r\n      } else {\r\n        await this.log('YouTube URL search failed', false);\r\n      }\r\n\r\n    } catch (error) {\r\n      await this.logError('YouTube fallback test failed', error);\r\n    }\r\n  }\r\n\r\n  async testQueueManagement() {\r\n    console.log('\\nüìã Testing Queue Management');\r\n    try {\r\n      // Clear any existing queue - this would normally be called via Discord interaction\r\n      await this.log('Queue cleared successfully');\r\n\r\n      // Test queue operations\r\n      const stats = getMusicStats(this.guildId);\r\n      await this.log(`Initial queue length: ${stats.queueLength}`);\r\n\r\n      // Test volume operations\r\n      const volumeResult = await setVolume(this.guildId, 75);\r\n      await this.log(`Volume set to 75%: ${volumeResult === 75}`);\r\n\r\n      const currentVolume = getVolume(this.guildId);\r\n      await this.log(`Current volume retrieved: ${currentVolume === 75}`);\r\n\r\n      // Test queue operations\r\n      const queue = getQueue(this.guildId);\r\n      await this.log(`Queue operations working: ${Array.isArray(queue)}`);\r\n\r\n      // Test music stats\r\n      const updatedStats = getMusicStats(this.guildId);\r\n      await this.log(`Music stats retrieved: ${typeof updatedStats === 'object'}`);\r\n\r\n    } catch (error) {\r\n      await this.logError('Queue management test failed', error);\r\n    }\r\n  }\r\n\r\n  async testErrorHandling() {\r\n    console.log('\\nüö® Testing Error Handling');\r\n    try {\r\n      // Test 1: Invalid Deezer URL\r\n      const invalidDeezerResults = await searchSongs('https://www.deezer.com/track/999999999', 1);\r\n      await this.log(`Invalid Deezer URL handled: ${invalidDeezerResults.length === 0}`);\r\n\r\n      // Test 2: Invalid YouTube URL\r\n      const invalidYtResults = await searchSongs('https://www.youtube.com/watch?v=invalid', 1);\r\n      await this.log(`Invalid YouTube URL handled: ${invalidYtResults.length === 0}`);\r\n\r\n      // Test 3: Empty search\r\n      const emptyResults = await searchSongs('', 1);\r\n      await this.log(`Empty search handled: ${emptyResults.length === 0}`);\r\n\r\n      // Test 4: Special characters\r\n      const specialCharResults = await searchSongs('!@#$%^&*()', 1);\r\n      await this.log(`Special characters handled: ${Array.isArray(specialCharResults)}`);\r\n\r\n    } catch (error) {\r\n      await this.logError('Error handling test failed', error);\r\n    }\r\n  }\r\n\r\n  async testDirectUrlSupport() {\r\n    console.log('\\nüîó Testing Direct URL Support');\r\n    try {\r\n      // Test various URL formats\r\n      const testUrls = [\r\n        'https://www.youtube.com/watch?v=dQw4w9WgXcQ',\r\n        'https://youtu.be/dQw4w9WgXcQ',\r\n        'https://www.deezer.com/track/3135556'\r\n      ];\r\n\r\n      for (const url of testUrls) {\r\n        const results = await searchSongs(url, 1);\r\n        if (results.length > 0) {\r\n          await this.log(`Direct URL supported: ${url}`);\r\n        } else {\r\n          await this.log(`Direct URL failed: ${url}`, false);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      await this.logError('Direct URL test failed', error);\r\n    }\r\n  }\r\n\r\n  async testMusicControls() {\r\n    console.log('\\nüéõÔ∏è Testing Music Controls');\r\n    try {\r\n      // Test pause (should work even if nothing is playing)\r\n      const pauseResult = await pause(this.guildId);\r\n      await this.log(`Pause command executed: ${pauseResult || !pauseResult}`); // Both true/false are valid responses\r\n\r\n      // Test resume (should work even if nothing is paused)\r\n      const resumeResult = await resume(this.guildId);\r\n      await this.log(`Resume command executed: ${resumeResult || !resumeResult}`);\r\n\r\n      // Test skip (should work even if no queue)\r\n      const skipResult = await skip(this.guildId);\r\n      await this.log(`Skip command executed: ${skipResult || !skipResult}`);\r\n\r\n      // Test stop (should work even if nothing is playing)\r\n      const stopResult = await stop(this.guildId);\r\n      await this.log(`Stop command executed: ${stopResult === true}`);\r\n\r\n      // Test loop operations\r\n      const { setLoop, getLoop } = await import('../src/music.js');\r\n      const loopResult = setLoop(this.guildId, 'single');\r\n      await this.log(`Loop set to single: ${loopResult === true}`);\r\n\r\n      const currentLoop = getLoop(this.guildId);\r\n      await this.log(`Loop mode retrieved: ${currentLoop === 'single'}`);\r\n\r\n    } catch (error) {\r\n      await this.logError('Music controls test failed', error);\r\n    }\r\n  }\r\n\r\n  async testApiConnectivity() {\r\n    console.log('\\nüåê Testing API Connectivity');\r\n    try {\r\n      // Test Deezer API connectivity\r\n      const deezerResponse = await axios.get('https://api.deezer.com/track/3135556', { timeout: 5000 });\r\n      if (deezerResponse.data && deezerResponse.data.title) {\r\n        await this.log(`Deezer API connectivity: ‚úÖ Connected`);\r\n      } else {\r\n        await this.log(`Deezer API connectivity: ‚ùå Invalid response`, false);\r\n      }\r\n\r\n      // Test YouTube search functionality\r\n      const ytResponse = await axios.get('https://www.youtube.com/', { timeout: 5000 });\r\n      if (ytResponse.status === 200) {\r\n        await this.log(`YouTube connectivity: ‚úÖ Connected`);\r\n      } else {\r\n        await this.log(`YouTube connectivity: ‚ùå Connection failed`, false);\r\n      }\r\n\r\n    } catch (error) {\r\n      await this.logError('API connectivity test failed', error);\r\n    }\r\n  }\r\n\r\n  async testDiscordCommandSimulation() {\r\n    console.log('\\nüéÆ Testing Discord Command Simulation');\r\n    try {\r\n      // Simulate the full Discord command flow for music play\r\n      const mockVoiceChannel = {\r\n        id: 'mock-voice-channel-123',\r\n        name: 'Test Voice Channel',\r\n        guild: { voiceAdapterCreator: {} }\r\n      };\r\n\r\n      // Test 1: Simulate /music search command\r\n      const searchResults = await searchSongs('test song', 3);\r\n      if (searchResults.length > 0) {\r\n        await this.log(`Discord search command simulation: Found ${searchResults.length} results`);\r\n        // Check if YouTube results are prioritized (new priority system)\r\n        const youtubeCount = searchResults.filter(r => r.source === 'youtube').length;\r\n        await this.log(`YouTube results prioritized: ${youtubeCount > 0}`, youtubeCount > 0);\r\n      }\r\n\r\n      // Test 2: Simulate /music play command with Deezer track\r\n      if (searchResults.length > 0) {\r\n        const deezerSong = searchResults.find(s => s.source === 'deezer') || searchResults[0];\r\n        await this.log(`Selected song for playback: ${deezerSong.title} (${deezerSong.source})`);\r\n\r\n        // Simulate the command validation that would happen in Discord\r\n        const hasRequiredProps = deezerSong.title && deezerSong.artist && deezerSong.url;\r\n        await this.log(`Song has required properties: ${hasRequiredProps}`, hasRequiredProps);\r\n\r\n        // Test URL validation (this function is internal to the MusicManager class)\r\n        // In a real Discord environment, this would be called during the play command\r\n        await this.log(`Song ready for Discord playback: ${hasRequiredProps}`, hasRequiredProps);\r\n      }\r\n\r\n      // Test 3: Simulate queue and stats commands\r\n      const queue = getQueue(this.guildId);\r\n      const stats = getMusicStats(this.guildId);\r\n      await this.log(`Queue and stats accessible: ${typeof stats === 'object'}`);\r\n\r\n    } catch (error) {\r\n      await this.logError('Discord command simulation test failed', error);\r\n    }\r\n  }\r\n\r\n  async runAllTests() {\r\n    console.log('üöÄ Starting Comprehensive Music System Test Suite');\r\n    console.log('=' .repeat(60));\r\n\r\n    await this.testApiConnectivity();\r\n    await this.testDeezerSearch();\r\n    await this.testYouTubeFallback();\r\n    await this.testQueueManagement();\r\n    await this.testErrorHandling();\r\n    await this.testDirectUrlSupport();\r\n    await this.testMusicControls();\r\n    await this.testDiscordCommandSimulation();\r\n\r\n    console.log('\\n' + '=' .repeat(60));\r\n    console.log('üìä Test Results Summary:');\r\n    console.log(`Total Tests: ${this.testCount}`);\r\n    console.log(`‚úÖ Passed: ${this.passCount}`);\r\n    console.log(`‚ùå Failed: ${this.failCount}`);\r\n    console.log(`Success Rate: ${((this.passCount / this.testCount) * 100).toFixed(1)}%`);\r\n\r\n    // Save results to file\r\n    const fs = await import('fs');\r\n    fs.writeFileSync('test-results.json', JSON.stringify(this.testResults, null, 2));\r\n    console.log('\\nüìÑ Detailed results saved to test-results.json');\r\n\r\n    return {\r\n      total: this.testCount,\r\n      passed: this.passCount,\r\n      failed: this.failCount,\r\n      successRate: ((this.passCount / this.testCount) * 100).toFixed(1)\r\n    };\r\n  }\r\n}\r\n\r\n// Run the tests if this file is executed directly\r\nif (import.meta.url === `file://${process.argv[1]}`) {\r\n  const testSuite = new MusicTestSuite();\r\n  testSuite.runAllTests().then(results => {\r\n    console.log('\\nüèÅ Test execution completed');\r\n    process.exit(results.failed > 0 ? 1 : 0);\r\n  }).catch(error => {\r\n    console.error('Test suite failed:', error);\r\n    process.exit(1);\r\n  });\r\n}\r\n\r\nexport default MusicTestSuite;","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-music-playback.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testMusicPlayback.js` or `TestMusicPlayback.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"no-unused-vars","severity":1,"message":"'logger' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"max-statements","severity":1,"message":"Async function 'testMusicPlayback' has too many statements (45). Maximum allowed is 30.","line":5,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":80,"endColumn":2},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":25,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":25,"endColumn":6,"fix":{"range":[1073,1073],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":34,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":34,"endColumn":6,"fix":{"range":[1489,1489],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":43,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":43,"endColumn":6,"fix":{"range":[1894,1894],"text":"\n"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":59,"column":29,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":59,"endColumn":33,"fix":{"range":[2518,2518],"text":"node:"}},{"ruleId":"unicorn/no-array-for-each","severity":2,"message":"Use `for‚Ä¶of` instead of `.forEach(‚Ä¶)`.","line":65,"column":30,"nodeType":"Identifier","messageId":"no-array-for-each/error","endLine":65,"endColumn":37,"fix":{"range":[2861,2925],"text":"for (const line of errorLines.slice(-5)) console.log(`   ${line}`);"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":66,"column":7,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":66,"endColumn":8,"fix":{"range":[2934,2934],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":69,"column":5,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":69,"endColumn":6,"fix":{"range":[3008,3008],"text":"\n"}},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":73,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":73,"endColumn":4,"fix":{"range":[3101,3101],"text":"\n"}},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":85,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":85,"endColumn":32},{"ruleId":"promise/always-return","severity":2,"message":"Each then() should return a value or throw","line":85,"column":16,"nodeType":"ConditionalExpression","messageId":"thenShouldReturnOrThrow","endLine":85,"endColumn":31},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":88,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":88,"endColumn":18}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import { searchSongs } from '../src/music.js';\r\nimport { logger } from '../src/logger.js';\r\n\r\n// Test music search and basic functionality without requiring Discord interaction\r\nasync function testMusicPlayback() {\r\n  console.log('üéµ Testing Music Search and Playback Fixes');\r\n  console.log('=' .repeat(50));\r\n\r\n  try {\r\n    // Test 1: Basic search functionality (should work without Spotify API)\r\n    console.log('\\nüîç Testing basic search...');\r\n    const results = await searchSongs('test song', 3);\r\n    console.log(`‚úÖ Search returned ${results.length} results`);\r\n\r\n    if (results.length > 0) {\r\n      const song = results[0];\r\n      console.log(`‚úÖ First result: \"${song.title}\" by ${song.artist} (${song.source})`);\r\n\r\n      // Verify song object has required properties\r\n      const hasRequiredProps = song.title && song.artist && song.url && song.source;\r\n      console.log(`‚úÖ Song has required properties: ${hasRequiredProps}`);\r\n\r\n      // Test URL validation\r\n      console.log(`‚úÖ Song URL format: ${song.url.startsWith('http') ? 'Valid' : 'Invalid'}`);\r\n    } else {\r\n      console.log('‚ùå No search results found');\r\n    }\r\n\r\n    // Test 2: YouTube URL validation (should work without EFTYPE errors)\r\n    console.log('\\nüì∫ Testing YouTube URL validation...');\r\n    const ytResults = await searchSongs('https://www.youtube.com/watch?v=dQw4w9WgXcQ', 1);\r\n    if (ytResults.length > 0) {\r\n      console.log(`‚úÖ YouTube URL validation successful: \"${ytResults[0].title}\"`);\r\n    } else {\r\n      console.log('‚ùå YouTube URL validation failed');\r\n    }\r\n\r\n    // Test 3: Deezer URL validation (legacy support)\r\n    console.log('\\nüéµ Testing Deezer URL validation...');\r\n    const deezerResults = await searchSongs('https://www.deezer.com/track/3135556', 1);\r\n    if (deezerResults.length > 0) {\r\n      console.log(`‚úÖ Deezer URL validation successful: \"${deezerResults[0].title}\"`);\r\n    } else {\r\n      console.log('‚ùå Deezer URL validation failed');\r\n    }\r\n\r\n    console.log('\\nüéØ Test Summary:');\r\n    console.log('‚úÖ Search functionality works');\r\n    console.log('‚úÖ YouTube URL validation works');\r\n    console.log('‚úÖ Deezer URL validation works (legacy)');\r\n    console.log('‚úÖ No \"require is not defined\" errors');\r\n    console.log('‚úÖ No EFTYPE stream errors');\r\n    console.log('‚úÖ No \"Unknown interaction\" errors');\r\n\r\n    console.log('\\nüéâ Music system fixes verified successfully!');\r\n\r\n    // Check if there are any logs\r\n    console.log('\\nüìã Checking for error logs...');\r\n    const fs = await import('fs');\r\n    if (fs.existsSync('logs/bot-2025-10-31.log')) {\r\n      const logContent = fs.readFileSync('logs/bot-2025-10-31.log', 'utf8');\r\n      const errorLines = logContent.split('\\n').filter(line => line.includes('ERROR') || line.includes('error'));\r\n      if (errorLines.length > 0) {\r\n        console.log('‚ö†Ô∏è Found error logs:');\r\n        errorLines.slice(-5).forEach(line => console.log(`   ${line}`));\r\n      } else {\r\n        console.log('‚úÖ No errors found in logs');\r\n      }\r\n    } else {\r\n      console.log('üìù No log file found yet (bot not fully started)');\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Test failed:', error.message);\r\n    console.error('Stack:', error.stack);\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n// Run the test\r\ntestMusicPlayback().then(success => {\r\n  console.log('\\nüèÅ Test completed');\r\n  process.exit(success ? 0 : 1);\r\n}).catch(error => {\r\n  console.error('Test suite error:', error);\r\n  process.exit(1);\r\n});","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-rpg-standalone.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testRpgStandalone.js` or `TestRpgStandalone.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:fs` over `fs`.","line":1,"column":16,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":1,"endColumn":20,"fix":{"range":[16,16],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:path` over `path`.","line":2,"column":18,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":2,"endColumn":24,"fix":{"range":[40,40],"text":"node:"}},{"ruleId":"unicorn/prefer-node-protocol","severity":2,"message":"Prefer `node:assert` over `assert`.","line":3,"column":20,"nodeType":"Literal","messageId":"prefer-node-protocol","endLine":3,"endColumn":28,"fix":{"range":[68,68],"text":"node:"}},{"ruleId":"no-unused-vars","severity":1,"message":"'logger' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'inputValidator' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'sanitizeInput' is defined but never used.","line":7,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'validateString' is defined but never used.","line":7,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":55},{"ruleId":"no-unused-vars","severity":1,"message":"'validateNumber' is defined but never used.","line":7,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":71},{"ruleId":"import/order","severity":2,"message":"There should be no empty line within import group","line":8,"column":1,"nodeType":"ImportDeclaration","endLine":8,"endColumn":55},{"ruleId":"no-unused-vars","severity":1,"message":"'CommandError' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":22},{"ruleId":"import/first","severity":2,"message":"Import in body of module; reorder to top.","line":13,"column":1,"nodeType":"ImportDeclaration","endLine":13,"endColumn":143,"fix":{"range":[0,578],"text":"import fs from 'fs';\r\nimport path from 'path';\r\nimport assert from 'assert';\r\n\r\n// Stub the missing dependencies to run RPG tests in isolation\r\nimport { logger } from '../src/logger.js';\r\nimport { inputValidator, sanitizeInput, validateString, validateNumber } from '../src/validation.js';\r\nimport { CommandError } from '../src/errorHandler.js';\r\n\r\n// Import RPG functions\r\nimport { createCharacter, getCharacter, applyXp, spendSkillPoints, getLeaderboard, getLeaderboardCount, resetCharacter } from '../src/rpg.js';\r\n\r\nconst FILE = path.join(process.cwd(), 'data', 'rpg.json');"}},{"ruleId":"no-unused-vars","severity":1,"message":"'DATA_DIR' is assigned a value but never used.","line":16,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":15},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":26,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":26,"endColumn":4,"fix":{"range":[981,981],"text":"\n"}},{"ruleId":"security/detect-non-literal-fs-filename","severity":1,"message":"Found unlinkSync from package \"fs\" with non literal argument at index 0","line":42,"column":11,"nodeType":"CallExpression","endLine":42,"endColumn":52},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace appears on the same line as the subsequent block.","line":78,"column":3,"nodeType":"Punctuator","messageId":"sameLineClose","endLine":78,"endColumn":4,"fix":{"range":[2650,2650],"text":"\n"}},{"ruleId":"unicorn/catch-error-name","severity":2,"message":"The catch parameter `err` should be named `error`.","line":83,"column":13,"nodeType":"Identifier","messageId":"catch-error-name","endLine":83,"endColumn":16,"fix":{"range":[2704,2730],"text":"error => { console.error(error"}},{"ruleId":"brace-style","severity":2,"message":"Statement inside of curly braces should be on next line.","line":83,"column":20,"nodeType":"Punctuator","messageId":"blockSameLine","endLine":83,"endColumn":21,"fix":{"range":[2712,2712],"text":"\n"}},{"ruleId":"max-statements-per-line","severity":2,"message":"This line has 3 statements. Maximum allowed is 2.","line":83,"column":42,"nodeType":"ExpressionStatement","messageId":"exceed","endLine":83,"endColumn":58},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":83,"column":42,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":83,"endColumn":57},{"ruleId":"brace-style","severity":2,"message":"Closing curly brace should be on the same line as opening curly brace or on the line after the previous block.","line":83,"column":59,"nodeType":"Punctuator","messageId":"singleLineClose","endLine":83,"endColumn":60,"fix":{"range":[2750,2750],"text":"\n"}}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import fs from 'fs';\r\nimport path from 'path';\r\nimport assert from 'assert';\r\n\r\n// Stub the missing dependencies to run RPG tests in isolation\r\nimport { logger } from '../src/logger.js';\r\nimport { inputValidator, sanitizeInput, validateString, validateNumber } from '../src/validation.js';\r\nimport { CommandError } from '../src/errorHandler.js';\r\n\r\nconst FILE = path.join(process.cwd(), 'data', 'rpg.json');\r\n\r\n// Import RPG functions\r\nimport { createCharacter, getCharacter, applyXp, spendSkillPoints, getLeaderboard, getLeaderboardCount, resetCharacter } from '../src/rpg.js';\r\n\r\n// Use a temp data dir to avoid clobbering real data during tests\r\nconst DATA_DIR = path.join(process.cwd(), 'data');\r\nconst BACKUP = path.join(process.cwd(), 'data', 'rpg.json.bak');\r\n\r\nfunction backupData() {\r\n  if (fs.existsSync(FILE)) fs.copyFileSync(FILE, BACKUP);\r\n}\r\nfunction restoreData() {\r\n  if (fs.existsSync(BACKUP)) {\r\n    fs.copyFileSync(BACKUP, FILE);\r\n    fs.unlinkSync(BACKUP);\r\n  } else {\r\n    // remove test file if created\r\n    if (fs.existsSync(FILE)) fs.unlinkSync(FILE);\r\n  }\r\n}\r\n\r\nasync function run() {\r\n  backupData();\r\n  try {\r\n    // ensure clean start - remove both old and new data\r\n    if (fs.existsSync(FILE)) fs.unlinkSync(FILE);\r\n    const playerDir = path.join(process.cwd(), 'data', 'players');\r\n    if (fs.existsSync(playerDir)) {\r\n      const files = fs.readdirSync(playerDir);\r\n      for (const file of files) {\r\n        if (file.startsWith('testuser1')) {\r\n          fs.unlinkSync(path.join(playerDir, file));\r\n        }\r\n      }\r\n    }\r\n\r\n    const uid = 'testuser1';\r\n    const char = createCharacter(uid, 'Tester');\r\n    assert.ok(char, 'Character created');\r\n    assert.equal(char.name, 'Tester');\r\n\r\n    // apply xp and confirm level changes\r\n    const res = applyXp(uid, char, 45); // should gain 2 levels with 20xp per level\r\n    assert.ok(res.gained >= 2, 'Gained expected levels');\r\n    // save and retrieve\r\n    const saved = getCharacter(uid);\r\n    assert.ok(saved, 'Character saved and retrievable');\r\n\r\n    // spend skill points\r\n    const before = saved.skillPoints || 0;\r\n    if (before > 0) {\r\n      const s = spendSkillPoints(uid, 'atk', 1);\r\n      assert.ok(s.success, 'Spend succeeded');\r\n    }\r\n\r\n    // leaderboard functions\r\n    const total = getLeaderboardCount();\r\n    assert.ok(total >= 1, 'Leaderboard count at least 1');\r\n    const list = getLeaderboard(10, 0);\r\n    assert.ok(Array.isArray(list), 'Leaderboard returns array');\r\n\r\n    // reset character\r\n    const def = resetCharacter(uid);\r\n    assert.equal(def.xp, 0);\r\n    assert.equal(def.lvl, 1);\r\n\r\n    console.log('All RPG tests passed');\r\n  } finally {\r\n    restoreData();\r\n  }\r\n}\r\n\r\nrun().catch(err => { console.error(err); process.exit(1); });","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]},{"filePath":"c:\\Users\\9700X-5070\\Downloads\\DCB-1\\tests\\test-token.js","messages":[{"ruleId":"unicorn/no-unnecessary-polyfill-io","message":"Definition for rule 'unicorn/no-unnecessary-polyfill-io' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"sonarjs/no-one-iteration-loop","message":"Definition for rule 'sonarjs/no-one-iteration-loop' was not found.","line":1,"column":1,"endLine":1,"endColumn":2,"severity":2,"nodeType":null},{"ruleId":"unicorn/filename-case","severity":2,"message":"Filename is not in camel case or pascal case. Rename it to `testToken.js` or `TestToken.js`.","line":1,"column":1,"nodeType":null,"messageId":"filename-case"},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":16,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":16,"endColumn":18},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":22,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":22,"endColumn":18},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":40,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":40,"endColumn":18},{"ruleId":"unicorn/no-process-exit","severity":2,"message":"Only use `process.exit()` in CLI apps. Throw an error instead.","line":50,"column":3,"nodeType":"CallExpression","messageId":"no-process-exit","endLine":50,"endColumn":18}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import 'dotenv/config';\r\nimport { Client, GatewayIntentBits } from 'discord.js';\r\n\r\nconst TOKEN = process.env.DISCORD_TOKEN;\r\n\r\nconsole.log('üîç Testing Discord Token...\\n');\r\n\r\nif (!TOKEN || TOKEN.includes('your-') || TOKEN.length < 50) {\r\n  console.error('‚ùå INVALID TOKEN in .env file');\r\n  console.log('\\nüìã To fix this:');\r\n  console.log('1. Go to https://discord.com/developers/applications');\r\n  console.log('2. Select your bot application');\r\n  console.log('3. Go to \"Bot\" section');\r\n  console.log('4. Click \"Reset Token\"');\r\n  console.log('5. Copy the new token to .env file');\r\n  process.exit(1);\r\n}\r\n\r\nconst tokenParts = TOKEN.split('.');\r\nif (tokenParts.length !== 3) {\r\n  console.error('‚ùå Token format is wrong - should have 3 parts separated by dots');\r\n  process.exit(1);\r\n}\r\n\r\nconsole.log('‚úÖ Token format looks correct');\r\nconsole.log('üîÑ Testing connection to Discord...');\r\n\r\nconst testClient = new Client({\r\n  intents: [\r\n    GatewayIntentBits.Guilds,\r\n    GatewayIntentBits.DirectMessages,\r\n    GatewayIntentBits.MessageContent\r\n  ]\r\n});\r\n\r\ntestClient.on('ready', () => {\r\n  console.log('‚úÖ SUCCESS! Token is working!');\r\n  console.log(`ü§ñ Connected as: ${testClient.user.tag}`);\r\n  testClient.destroy();\r\n  process.exit(0);\r\n});\r\n\r\ntestClient.on('error', (error) => {\r\n  console.error('‚ùå CONNECTION FAILED:', error.message);\r\n  console.log('\\nThis usually means:');\r\n  console.log('- Token is expired or revoked');\r\n  console.log('- Bot is disabled in Discord');\r\n  console.log('- Missing required intents');\r\n  testClient.destroy();\r\n  process.exit(1);\r\n});\r\n\r\ntestClient.login(TOKEN);","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]},{"ruleId":"no-trailing-spaces","replacedBy":[]},{"ruleId":"no-multiple-empty-lines","replacedBy":[]},{"ruleId":"semi","replacedBy":[]},{"ruleId":"quotes","replacedBy":[]},{"ruleId":"indent","replacedBy":[]},{"ruleId":"comma-dangle","replacedBy":[]},{"ruleId":"object-curly-spacing","replacedBy":[]},{"ruleId":"array-bracket-spacing","replacedBy":[]},{"ruleId":"brace-style","replacedBy":[]},{"ruleId":"key-spacing","replacedBy":[]},{"ruleId":"keyword-spacing","replacedBy":[]},{"ruleId":"space-before-blocks","replacedBy":[]},{"ruleId":"space-before-function-paren","replacedBy":[]},{"ruleId":"space-in-parens","replacedBy":[]},{"ruleId":"space-infix-ops","replacedBy":[]},{"ruleId":"space-unary-ops","replacedBy":[]},{"ruleId":"spaced-comment","replacedBy":[]},{"ruleId":"arrow-spacing","replacedBy":[]},{"ruleId":"template-curly-spacing","replacedBy":[]},{"ruleId":"max-len","replacedBy":[]},{"ruleId":"max-statements-per-line","replacedBy":[]},{"ruleId":"unicorn/import-index","replacedBy":[]},{"ruleId":"unicorn/prefer-object-has-own","replacedBy":["prefer-object-has-own"]}]}]